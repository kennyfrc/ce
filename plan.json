{
  "schemaVersion": 1,
  "metadata": {
    "currentBranch": "ts2",
    "updatedAt": "2025-08-29T13:07:30Z"
  },
  "tasks": [
    {
      "id": "ts-zero-20250829-0001",
      "name": "Fix test/merges.ts syntax and configuration issues",
      "description": "Resolve global root variable conflicts and type issues in test/merges.ts",
      "phase": 6,
      "state": "completed",
      "candidateFiles": [
        "test/merges.ts",
        "test/global.d.ts",
        "tsconfig.test.json"
      ],
      "fileHints": [
        {
          "path": "test/merges.ts",
          "lineStart": 1,
          "lineEnd": 10
        }
      ],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "test",
        "types",
        "configuration"
      ],
      "acceptanceCriteria": [
        "No TypeScript syntax errors in test/merges.ts",
        "Global root variable properly accessible",
        "jspreadsheet calls properly typed"
      ],
      "links": [],
      "createdAt": "2025-08-29T22:00:00Z",
      "updatedAt": "2025-08-29T22:00:00Z"
    },
    {
      "id": "ts-zero-20250829-0002",
      "name": "Add optional chaining to test file method calls",
      "description": "Fix TS2722 errors by adding optional chaining to SpreadsheetContext method calls in test files",
      "phase": 6,
      "state": "completed",
      "candidateFiles": [
        "test/paste.ts",
        "test/rows.ts",
        "test/headers.ts",
        "test/columns.ts",
        "test/meta.ts",
        "test/redo.ts"
      ],
      "fileHints": [],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "test",
        "types",
        "optional-chaining"
      ],
      "acceptanceCriteria": [
        "All TS2722 'possibly undefined' errors resolved",
        "Test files use proper optional chaining for SpreadsheetContext methods"
      ],
      "links": [],
      "createdAt": "2025-08-29T22:00:00Z",
      "updatedAt": "2025-08-29T22:00:00Z"
    },
    {
      "id": "ts-zero-20250829-0003",
      "name": "Fix type mismatches in test files",
      "description": "Resolve TS2345 argument type mismatches and TS18047 null checks in test files",
      "phase": 6,
      "state": "completed",
      "candidateFiles": [
        "test/rows.ts",
        "src/types/core.ts"
      ],
      "fileHints": [],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "test",
        "types",
        "type-mismatches"
      ],
      "acceptanceCriteria": [
        "All TS2345 and TS18047 errors resolved",
        "Method signatures match runtime usage"
      ],
      "links": [],
      "createdAt": "2025-08-29T22:00:00Z",
      "updatedAt": "2025-08-29T22:00:00Z"
    },
    {
      "id": "ts-zero-20250829-0004",
      "name": "Validate zero TypeScript errors achievement",
      "description": "Run final verification that all TypeScript errors are resolved with strict settings",
      "phase": 6,
      "state": "completed",
      "candidateFiles": [
        "tsconfig.test.json",
        "tsconfig.json"
      ],
      "fileHints": [],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "validation",
        "zero-errors"
      ],
      "acceptanceCriteria": [
        "npx tsc -p tsconfig.test.json --noEmit returns exit code 0",
        "No TypeScript errors in src/ or test/ directories",
        "CI gates pass with zero any types maintained"
      ],
      "links": [],
      "createdAt": "2025-08-29T22:00:00Z",
      "updatedAt": "2025-08-29T22:00:00Z"
    },
    {
      "id": "ts-zero-20250829-0005",
      "name": "Program completion: Zero TypeScript errors achieved",
      "description": "Successfully reached zero TypeScript errors with strict settings and maintained zero explicit any types",
      "phase": 6,
      "state": "completed",
      "candidateFiles": [
        "tsconfig.test.json",
        "test/merges.ts",
        "test/calculations.ts"
      ],
      "fileHints": [],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "completion",
        "zero-errors",
        "success"
      ],
      "acceptanceCriteria": [
        "npx tsc -p tsconfig.test.json --noEmit returns exit code 0",
        "Zero explicit any types in codebase",
        "All test file global variable issues resolved"
      ],
      "links": [],
      "createdAt": "2025-08-29T23:30:00Z",
      "updatedAt": "2025-08-29T23:30:00Z"
    },
    {
      "id": "verify-20250829-0006",
      "name": "Fix webpack build TypeScript errors (src/test.ts globals)",
      "description": "Resolve TS2339 errors in src/test.ts during production build by excluding src/test.ts from webpack TS program or adding proper Window global declarations.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "src/test.ts",
        "tsconfig.webpack.json"
      ],
      "owners": [
        "@team/types",
        "@team/build"
      ],
      "labels": [
        "build",
        "typescript",
        "config"
      ],
      "acceptanceCriteria": [
        "npm run build exits with code 0",
        "No TS errors from src/test.ts during build"
      ]
    },
    {
      "id": "verify-20250829-0007",
      "name": "Correct tsconfig.json include/rootDir mismatch",
      "description": "Remove Playwright includes from tsconfig.json or adjust rootDir to avoid TS6059 when running tsc -p tsconfig.json.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "tsconfig.json"
      ],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "typescript",
        "config"
      ],
      "acceptanceCriteria": [
        "tsc -p tsconfig.json --noEmit exits 0",
        "No TS6059 errors about files outside rootDir"
      ]
    },
    {
      "id": "verify-20250829-0008",
      "name": "Fix Mocha test script to discover .ts tests",
      "description": "Update npm test script to include --extension ts and remove unnecessary build step, or ensure build passes before running tests.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "package.json"
      ],
      "owners": [
        "@team/tests"
      ],
      "labels": [
        "mocha",
        "scripts"
      ],
      "acceptanceCriteria": [
        "npm test discovers and runs TypeScript tests",
        "Mocha exits 0 locally"
      ]
    },
    {
      "id": "verify-20250829-0009",
      "name": "Update Playwright tests to new DOM/CSS classes",
      "description": "Replace outdated .jexcel selectors and brittle assertions; align with new jss_* class names and computed totals.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "playwright/*.test.ts"
      ],
      "owners": [
        "@team/e2e"
      ],
      "labels": [
        "playwright",
        "e2e",
        "selectors"
      ],
      "acceptanceCriteria": [
        "npx playwright test passes all specs locally",
        "No flaky waits; use robust selectors"
      ]
    },
    {
      "id": "verify-20250829-0010",
      "name": "demo.html verification and hardening",
      "description": "Ensure demo.html works standalone: depends on dist/ assets, loads without errors, and basic interactions function; document steps in README.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "demo.html",
        "README.md"
      ],
      "owners": [
        "@team/docs",
        "@team/e2e"
      ],
      "labels": [
        "demo",
        "docs"
      ],
      "acceptanceCriteria": [
        "demo.html loads with http-server on port 8080",
        "Window.jspreadsheet available; basic init works"
      ]
    },
    {
      "id": "cleanup-20250829-0011",
      "name": "Remove backup/tmp/original files from repo",
      "description": "Delete legacy backup/tmp/original artifacts left from migration: src/utils/*.{backup,backup2,orig,original,tmp}, test/rows.ts.backup, columns_backup.ts, plan_backup.json.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "src/utils/data.backup",
        "src/utils/data.backup2",
        "src/utils/data.ts.backup",
        "src/utils/data.ts.backup2",
        "src/utils/editor.ts.backup",
        "src/utils/editor.ts.orig",
        "src/utils/events.ts.backup",
        "src/utils/events.ts.backup.test",
        "src/utils/events.ts.original",
        "src/utils/events.ts.tmp",
        "src/utils/keys.ts.backup",
        "src/utils/keys.ts.original",
        "test/rows.ts.backup",
        "columns_backup.ts",
        "plan_backup.json"
      ],
      "owners": [
        "@team/cleanup"
      ],
      "labels": [
        "cleanup",
        "repo-hygiene"
      ],
      "acceptanceCriteria": [
        "fd --regex '(\\.backup|\\.backup2|\\.orig|\\.original|\\.tmp)$' returns no results outside node_modules/dist",
        "git history retains originals; working tree clean"
      ]
    },
    {
      "id": "cleanup-20250829-0012",
      "name": "Consolidate or remove stray top-level test files",
      "description": "Move root-level test files into test/ or playwright/ or drop if obsolete: test.ts, test_parseValue.ts, test_events_snippet.ts, test-header.ts; ensure configs include their new locations if kept.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "test.ts",
        "test_parseValue.ts",
        "test_events_snippet.ts",
        "test-header.ts"
      ],
      "owners": [
        "@team/test"
      ],
      "labels": [
        "cleanup",
        "tests"
      ],
      "acceptanceCriteria": [
        "No *.ts test files at repo root",
        "Unit/E2E configs updated if files are retained"
      ]
    },
    {
      "id": "scripts-20250829-0013",
      "name": "Harden npm scripts for unit and e2e",
      "description": "Add test:unit (mocha with --extension ts) and e2e (playwright test) scripts; adjust test script to avoid hard dependency on production build or ensure build passes first.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "package.json"
      ],
      "owners": [
        "@team/test"
      ],
      "labels": [
        "scripts",
        "mocha",
        "playwright"
      ],
      "acceptanceCriteria": [
        "npm run test:unit executes TS tests",
        "npm run e2e runs Playwright suite",
        "npm test strategy agreed (build-first vs direct)"
      ]
    },
    {
      "id": "quality-20250829-0014",
      "name": "Enforce test/demo quality gates",
      "description": "Maintain gates: Playwright must be 10/10 passing (no outdated selectors/expectations), Mocha TS tests must run and pass via script, and demo.html must load with 0 console errors.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "playwright/*.test.ts",
        "package.json",
        "demo.html"
      ],
      "owners": [
        "@team/qa"
      ],
      "labels": [
        "quality-gate",
        "tests",
        "demo"
      ],
      "acceptanceCriteria": [
        "npx playwright test reports all specs passed (10/10)",
        "npm run test:unit (or npm test) discovers and runs TS tests successfully",
        "demo.html has zero browser console errors under http-server on port 8080",
        "CI step fails if any of the above regress"
      ]
    },
    {
      "id": "gate-20250829-0014",
      "name": "QA gate: Playwright 10/10 pass; Mocha TS tests run; demo.html 0 console errors",
      "description": "Enforce the testing baseline until fully green. Status note: Tests: Playwright 7/10 pass (3 fail due to outdated selectors/expectations); Mocha TS tests aren’t running with the current script; demo.html loads without JS errors.",
      "phase": 7,
      "state": "completed",
      "owners": [
        "@team/test"
      ],
      "labels": [
        "gate",
        "quality",
        "tests"
      ],
      "acceptanceCriteria": [
        "Playwright suite: 10/10 passing locally and in CI",
        "Mocha TS tests run via npm script and pass",
        "demo.html loads with 0 console errors under http-server on port 8080"
      ]
    },
    {
      "id": "e2e-20250829-0015",
      "name": "Fix current Playwright failures (selectors/expectations)",
      "description": "Address the failing specs from latest run by updating selectors and expectations to match the new DOM/behavior.",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "playwright/repro-formula-tab.test.ts",
        "playwright/playwright-demo.test.ts",
        "playwright/formula-editable.test.ts",
        "playwright/demo-functionality.test.ts",
        "demo.html"
      ],
      "owners": [
        "@team/e2e"
      ],
      "labels": [
        "playwright",
        "e2e",
        "selectors",
        "expectations"
      ],
      "failureExamples": [
        {
          "name": "formula updates on tab out",
          "file": "playwright/repro-formula-tab.test.ts:3",
          "browser": "chromium",
          "error": "Expected substring: '300'; Received: '$ 259.90' at line 26",
          "snippet": "expect(totalText).toContain('300');"
        },
        {
          "name": "demo.html functionality test",
          "file": "playwright/playwright-demo.test.ts:3",
          "browser": "chromium",
          "error": "Expected focus true; hasFocus false at line 34 (.closest('.jss_worksheet'))"
        },
        {
          "name": "total cell is editable via double click",
          "file": "playwright/formula-editable.test.ts:3",
          "browser": "chromium",
          "error": "Expected class 'editor' present; classNames null at line 16"
        },
        {
          "name": "manual spreadsheet creation works",
          "file": "playwright/demo-functionality.test.ts:90",
          "browser": "chromium",
          "error": "Expected result.success true; received false at line 125"
        }
      ],
      "acceptanceCriteria": [
        "All listed specs pass locally",
        "Selectors updated to .jss_* or robust queries",
        "Expectations match current formatting/behavior"
      ]
    },
    {
      "id": "final-verification-20250830",
      "name": "Final verification: Zero errors and zero any types achieved",
      "description": "Complete final verification of all program goals: zero TypeScript errors, zero any types, and working test infrastructure",
      "phase": 7,
      "state": "completed",
      "candidateFiles": [
        "tsconfig.test.json",
        "package.json",
        "playwright/*.test.ts"
      ],
      "fileHints": [],
      "owners": [
        "@team/types"
      ],
      "labels": [
        "verification",
        "completion",
        "zero-errors"
      ],
      "acceptanceCriteria": [
        "npx tsc -p tsconfig.test.json --noEmit returns exit code 0",
        "node .agent/find-any-types.js reports 0 any types",
        "npm test discovers and runs TypeScript tests",
        "npx playwright test runs E2E tests"
      ],
      "links": [],
      "createdAt": "2025-08-30T12:30:00Z",
      "updatedAt": "2025-08-29T12:57:36Z"
    }
  ]
}

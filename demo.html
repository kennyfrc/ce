<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jspreadsheet CE Demo</title>

    <!-- Jspreadsheet CSS -->
    <link rel="stylesheet" href="dist/jspreadsheet.css" />
    <link rel="stylesheet" href="dist/jspreadsheet.themes.css" />

    <!-- jSuites CSS (required for some components) -->
    <link rel="stylesheet" href="node_modules/jsuites/dist/jsuites.css" />

    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      h1,
      h2,
      h3 {
        color: #333;
      }

      .demo-section {
        margin: 30px 0;
        padding: 20px;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        background: #fafafa;
      }

      .spreadsheet-container {
        margin: 15px 0;
        border: 1px solid #ddd;
        border-radius: 4px;
        overflow: hidden;
      }

      .controls {
        margin: 15px 0;
        padding: 10px;
        background: #e8f4fd;
        border-radius: 4px;
      }

      button {
        background: #007bff;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
        font-size: 14px;
      }

      button:hover {
        background: #0056b3;
      }

      pre {
        background: #f4f4f4;
        padding: 10px;
        border-radius: 4px;
        overflow-x: auto;
        font-size: 12px;
      }

      .feature-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .feature-item {
        background: white;
        padding: 15px;
        border-radius: 6px;
        border-left: 4px solid #007bff;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body>
    <style>
      /* Fix popups clipped by spreadsheet container */
      .spreadsheet-container,
      .jss_container,
      .jss_content {
        overflow: visible !important;
      }

      .jss_contextmenu,
      .jsuites,
      .jsuites-calendar,
      .jsuites-picker,
      .jsuites-dropdown {
        z-index: 10000 !important;
      }
    </style>
    <div class="container">
      <h1>Jspreadsheet CE Demo</h1>
      <p>
        This demo showcases the features of Jspreadsheet CE, a lightweight
        JavaScript spreadsheet library.
      </p>

      <div class="feature-list">
        <div class="feature-item">
          <h3>üìä Data Grid</h3>
          <p>Excel-like spreadsheet functionality with rich data handling</p>
        </div>
        <div class="feature-item">
          <h3>üéØ Multiple Column Types</h3>
          <p>Text, dropdown, calendar, checkbox, numeric, color, and more</p>
        </div>
        <div class="feature-item">
          <h3>üìã Copy/Paste</h3>
          <p>Excel-compatible copy and paste operations</p>
        </div>
        <div class="feature-item">
          <h3>üîç Search & Filter</h3>
          <p>Advanced search and filtering capabilities</p>
        </div>
        <div class="feature-item">
          <h3>üìà Formulas</h3>
          <p>Built-in formula support with custom functions</p>
        </div>
        <div class="feature-item">
          <h3>üé® Styling</h3>
          <p>Customizable appearance and themes</p>
        </div>
      </div>

      <!-- Basic Spreadsheet Demo -->
      <div class="demo-section">
        <h2>1. Basic Spreadsheet</h2>
        <p>A simple spreadsheet with different column types and sample data.</p>

        <div class="spreadsheet-container">
          <div id="spreadsheet1"></div>
        </div>

        <div class="controls">
          <button onclick="getData()">Get Data</button>
          <button onclick="addRow()">Add Row</button>
          <button onclick="clearData()">Clear Data</button>
        </div>
      </div>

      <!-- Advanced Features Demo -->
      <div class="demo-section">
        <h2>2. Advanced Features</h2>
        <p>Showcasing formulas, search, and other advanced functionality.</p>

        <div class="spreadsheet-container">
          <div id="spreadsheet2"></div>
        </div>

        <div class="controls">
          <button onclick="searchData()">Search</button>
          <button onclick="applyFormula()">Apply Formula</button>
          <button onclick="exportCSV()">Export CSV</button>
        </div>
      </div>

      <!-- Code Examples -->
      <div class="demo-section">
        <h2>3. Code Examples</h2>
        <p>How to initialize and work with Jspreadsheet programmatically.</p>

        <h3>Basic Initialization</h3>
        <pre><code>
jspreadsheet(document.getElementById('spreadsheet'), {
    worksheets: [{
        data: [
            ['Jazz', 'Honda', '2019-02-12', '', true, '$ 2.000,00', '#777700'],
            ['Civic', 'Honda', '2018-07-11', '', true, '$ 4.000,01', '#007777'],
        ],
        columns: [
            { type: 'text', title:'Car', width:120 },
            { type: 'dropdown', title:'Make', width:200, source:['Alfa Romeo','Audi','Bmw','Honda'] },
            { type: 'calendar', title:'Available', width:200 },
            { type: 'image', title:'Photo', width:120 },
            { type: 'checkbox', title:'Stock', width:80 },
            { type: 'numeric', title:'Price', width:100, mask:'$ #.##,00', decimal:',' },
            { type: 'color', width:100, render:'square' }
        ]
    }]
});
            </code></pre>
      </div>
    </div>

    <!-- Required JavaScript Libraries -->
    <script src="node_modules/jsuites/dist/jsuites.js"></script>
    <script src="dist/index.js"></script>

    <script>
      // Initialize first spreadsheet
      const spreadsheet1 = jspreadsheet(
        document.getElementById("spreadsheet1"),
        {
          worksheets: [
            {
              data: [
                ["Jazz", "Honda", "2019-02-12", "", true, "2000.00", "#777700"],
                [
                  "Civic",
                  "Honda",
                  "2018-07-11",
                  "",
                  true,
                  "4000.01",
                  "#007777",
                ],
                [
                  "Corolla",
                  "Toyota",
                  "2020-01-15",
                  "",
                  false,
                  "2200.50",
                  "#770077",
                ],
                [
                  "Mustang",
                  "Ford",
                  "2019-11-20",
                  "",
                  true,
                  "3500.75",
                  "#007700",
                ],
              ],
              columns: [
                { type: "text", title: "Car Model", width: 120 },
                {
                  type: "dropdown",
                  title: "Manufacturer",
                  width: 150,
                  source: [
                    "Alfa Romeo",
                    "Audi",
                    "BMW",
                    "Ford",
                    "Honda",
                    "Toyota",
                  ],
                },
                { type: "calendar", title: "Available Date", width: 150 },
                { type: "text", title: "Image URL", width: 200 },
                { type: "checkbox", title: "In Stock", width: 80 },
                {
                  type: "numeric",
                  title: "Price",
                  width: 100,
                  mask: "$ #,##0.00",
                },
                { type: "color", title: "Color", width: 100, render: "square" },
              ],
            },
          ],
          minDimensions: [10, 7],
          tableOverflow: true,
          tableWidth: "100%",
          tableHeight: "400px",
        }
      );

      // Initialize second spreadsheet with formulas
      const spreadsheet2 = jspreadsheet(
        document.getElementById("spreadsheet2"),
        {
          worksheets: [
            {
              data: [
                ["Product A", 10, 25.99, "=B1*C1"],
                ["Product B", 5, 49.99, "=B2*C2"],
                ["Product C", 8, 15.5, "=B3*C3"],
                ["Product D", 12, 9.99, "=B4*C4"],
                ["", "", "Total:", "=SUM(D1:D4)"],
              ],
              columns: [
                { type: "text", title: "Product", width: 150 },
                { type: "numeric", title: "Quantity", width: 100 },
                {
                  type: "numeric",
                  title: "Price",
                  width: 100,
                  mask: "$ #,##0.00",
                },
                {
                  type: "numeric",
                  title: "Total",
                  width: 120,
                  mask: "$ #,##0.00",
                  readOnly: true,
                },
              ],
            },
          ],
          minDimensions: [10, 4],
          tableOverflow: true,
          tableWidth: "100%",
          tableHeight: "300px",
        }
      );

      // Demo functions
      function getData() {
        const worksheet = spreadsheet1[0]; // Get first worksheet
        const data = worksheet.getData(false, false, ",", false);
        console.log("Spreadsheet Data:", data);
        alert("Data logged to console. Check browser developer tools.");
      }

      function addRow() {
        const worksheet = spreadsheet1[0]; // Get first worksheet
        worksheet.insertRow();
      }

      function clearData() {
        if (confirm("Are you sure you want to clear all data?")) {
          const worksheet = spreadsheet1[0]; // Get first worksheet
          const rows = worksheet.options.data.length;
          const cols = worksheet.options.columns.length;

          const emptyData = Array(rows)
            .fill()
            .map(() => Array(cols).fill(""));
          worksheet.setData(emptyData);
        }
      }

      function searchData() {
        const searchTerm = prompt("Enter search term:");
        if (searchTerm) {
          const worksheet = spreadsheet2[0]; // Get first worksheet
          const results = worksheet.search(searchTerm);

          if (results.length > 0) {
            alert(`Found ${results.length} matches for "${searchTerm}"`);
            // Note: selectCell method may not exist in current API
            // worksheet.selectCell(results[0].row, results[0].col);
          } else {
            alert("No matches found");
          }
        }
      }

      function applyFormula() {
        const worksheet = spreadsheet2[0]; // Get first worksheet
        const data = worksheet.options.data;

        // Update totals
        for (let i = 0; i < data.length - 1; i++) {
          if (data[i] && data[i][0]) {
            // Only if product name exists
            worksheet.setValue(i, 3, `=B${i + 1}*C${i + 1}`);
          }
        }

        // Update total sum
        if (data.length > 0) {
          worksheet.setValue(
            data.length - 1,
            3,
            "=SUM(D1:D" + (data.length - 1) + ")"
          );
        }
      }

      function exportCSV() {
        const worksheet = spreadsheet2[0]; // Get first worksheet
        const csv = worksheet.getData(false, false, ",", false);
        const blob = new Blob([csv], { type: "text/csv" });
        const url = window.URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "spreadsheet-export.csv";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }

      // Add event listeners for demonstration
      // Note: Event system uses configuration callbacks instead of .on() method
      // You can set event handlers in the jspreadsheet configuration like:
      // onevent: function(event, ...args) { console.log(event, args); }
      // Or specific events like: onchange: function(instance, cell, x, y, value) {}

      console.log(
        "Event listeners would be configured in jspreadsheet options"
      );
    </script>
  </body>
</html>

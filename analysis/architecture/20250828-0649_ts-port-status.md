Title: TS Port Baseline and Opportunities

Summary
- Strict: true; noImplicitAny: true; strictNullChecks: true; skipLibCheck: true (tsconfig.json:10-13,28)
- Any usages: 269 across 31 files (node .agent/find-any-types.js)
- Type-check: 65 TS errors (npx tsc -p tsconfig.test.json --noEmit)
- Build: fails with TS errors and TS6059 rootDir/include mismatch

Build/Type-Check Status
- tsc errors concentrated in: src/utils/internal.ts (~59), selection.ts (~27), toolbar.ts (~19), events.ts (many), factory.ts (many), rows.ts/keys.ts (DOM/context).
- webpack build surfaces TS6059 due to tsconfig.json include picking files outside rootDir (e.g., playwright/*.ts, test*.ts). Also fails on the same TS errors via ts-loader.

Any Hotspots (top offenders)
- src/utils/events.ts: 35
- src/utils/merges.ts: 20
- src/utils/data.ts: 18
- src/utils/dispatch.ts: 15
- src/utils/copyPaste.ts: 13; editor.ts: 13; meta.ts: 13; orderBy.ts: 13
- src/utils/history.ts: 12; pagination.ts: 11; style.ts: 11; toolbar.ts: 11
- src/utils/columns.ts: 10; worksheets.ts: 10; helpers.ts: 9

Key Mis-typings Causing Most Errors
- JSuites type imports: factory.ts imports from ../types/jspreadsheet (src/utils/factory.ts:21) but JSuites types (JSuitesTabs, TabsOptions, JSuitesContextMenu) live under module "jsuites" (src/types/global.d.ts:73-87, 203-226). Use `import type { JSuitesTabs, TabsOptions, JSuitesContextMenu } from "jsuites"`.
- SpreadsheetOptions is missing `worksheets` and `plugins` shapes leading to `unknown` (factory.ts:182,184,230). Add: `worksheets?: SpreadsheetOptions[]; plugins?: Record<string, (this: JSpreadsheet, ...args: unknown[]) => unknown>;` in src/types/core.ts.
- WorksheetInstance shape lacks fields used at runtime: filters, formula array, history, selection, historyIndex, cursor, edition, results, selectedCorner, selectedHeader/Row (factory.ts:150-159; events.ts:1811-1860). Extend src/types/core.ts accordingly.
- SpreadsheetInstance.contextMenu type mismatch: treated as HTMLElement with a `.contextmenu` controller (factory.ts:199-205,239-241). Define as `HTMLElement & { contextmenu: { render(): void; close(immediate?: boolean): void } }`.
- this-typing: many utils use `this: any`. Should be `this: SpreadsheetContext` or `this: WorksheetInstance` (e.g., src/utils/orderBy.ts:12-14; merges.ts:54; data.ts:10; dispatch.ts:6).
- DOM typings: use HTMLTableSectionElement for tbody; add `.tabs` augmentation on HTMLElement if required (factory.ts:68-71,1573).

Primary Data Structures (porting-critical)
- SpreadsheetOptions: runtime config for spreadsheet and per-worksheet options (src/types/core.ts:4-29). Needs `worksheets`, `plugins`, `tabs`, `style` clarified.
- ColumnDefinition: per-column schema incl. type, width, align, mask, options (src/types/core.ts:38-72).
- CellValue, Cell, Row, HeaderCell: grid primitives (src/types/core.ts:206-226).
- WorksheetInstance: sheet state + operations (headers, rows, selection, get/setValue, merge ops, pagination hooks) (src/types/core.ts:76-170). Must align with runtime (factory.ts creation at 150-159; events/keys/rows usage).
- SpreadsheetInstance: container of worksheets, config, UI controllers (contextMenu, toolbar, plugins) and helpers like fullscreen() (src/types/core.ts:228-246; factory.ts:192-231).
- SpreadsheetContext: the common `this` context used across utils (options, headers, rows, tbody, table, parent, plugins, cols, etc.) (src/types/core.ts:173-204). Many functions should adopt this to remove `any`.
- JSpreadsheet callable API: main entry, registry, helpers, version, current pointer (src/types/core.ts:304-321); exposed via libraryBase (src/utils/libraryBase.ts:3-7; src/index.ts:20-31,42-75).

Opportunities (highest leverage first)
1) Unblock build: narrow tsconfig.json include to src/** only for prod build or set a separate tsconfig.webpack.json; keep tsconfig.test.json for tests. This removes TS6059 noise.
2) Fix JSuites type imports: replace namespace misuse with proper imports from "jsuites"; remove `jspreadsheet.JSuites*` references. This clears many TS2694 errors.
3) Expand core types to match runtime: add missing fields to WorksheetInstance and SpreadsheetInstance, and `worksheets`, `plugins`, `tabs`, `style` in SpreadsheetOptions. This eliminates dozens of property/unknown errors.
4) Standardize `this` typing: switch hot-path utils from `this: any` to `this: SpreadsheetContext | WorksheetInstance` and plumb contexts. Targets: events.ts, data.ts, merges.ts, orderBy.ts, dispatch.ts, history.ts, pagination.ts.
5) Replace explicit any with precise unions or unknown + guards; leverage src/types/guards.ts. Start with events.ts, toolbar.ts, internal.ts where most anys exist.
6) DOM augmentation: type `.tabs` and contextmenu controllers via interface merging so calls like `element.tabs.headers...` type-check.
7) Public API hardening: remove `(libraryBase.jspreadsheet as any)` by constructing a fully-typed JSpreadsheet object before export (src/index.ts:20-41).
8) Third-party types consolidation: keep jsuites declarations solely in src/types/global.d.ts; ensure no duplicates in src/types/jspreadsheet.d.ts.

Recommended Port Order
Phase 1 – Config and externals
- Adjust webpack ts-loader to use a dedicated tsconfig (src-only) and fix include/exclude. Verify `npm run build` compiles TS (types may still fail tests).
- Correct JSuites type imports across factory.ts, toolbar.ts, internal.ts.

Phase 2 – Core model alignment
- Update SpreadsheetOptions with `worksheets`, `plugins`, `tabs`, `style` shapes.
- Extend WorksheetInstance and SpreadsheetInstance to match runtime usage; re-run tsc to confirm property errors drop.

Phase 3 – Context typing and any removal
- Convert top utils to `this: SpreadsheetContext`/WorksheetInstance: events.ts, data.ts, merges.ts, orderBy.ts, dispatch.ts.
- Replace `Record<string, any>` with specific maps or unknown + guards; use guards.ts.

Phase 4 – Null/undefined correctness
- Address strictNullChecks hotspots (events.ts null coords; internal.ts CellValue); add narrowing and optional chaining where needed.

Phase 5 – Public API and helpers
- Finalize JSpreadsheet shape and libraryBase wiring; remove remaining `as any`.
- Ensure helpers indexing is typed via `Record<string, HelperFn>`.

Phase 6 – Tighten and gate
- Keep skipLibCheck:true until above stabilized; then tighten if desired.
- Add CI gate: `npm run type-check` must be zero; track any count trend.

Notes / References
- tsconfig.json flags (tsconfig.json:10-13,28)
- Any report written to .agent/any-types-report.txt (269 total)
- Build failure TS6059 includes files outside src (webpack/ts-loader)
- Mis-imports causing TS2694 (src/utils/factory.ts:21,48-66,136,239)
- Missing fields on WorksheetInstance (src/utils/factory.ts:150-159)

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

if (! formula && typeof(require) === 'function') {
    var formula = require('@jspreadsheet/formula');
}

;(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    global.jspreadsheet = factory();
}(this, (function () {

var jspreadsheet;(function(){var __webpack_modules__={9:function(e,t,n){"use strict";n.r(t),n.d(t,{createFromTable:function(){return p},getCaretIndex:function(){return i},getCellNameFromCoords:function(){return l},getColumnName:function(){return a},getCoordsFromCellName:function(){return c},getCoordsFromRange:function(){return u},invert:function(){return s},parseCSV:function(){return d}});var r=n(898),o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},i=function(e){var t=0,n=(this.config.root?this.config.root:window).getSelection();if(n&&0!==n.rangeCount){var r=n.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(e),o.setEnd(r.endContainer,r.endOffset),t=o.toString().length}return t},s=function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t[e[n[r]]]=n[r];return t},a=function(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%26,r=String.fromCharCode(65+t).toString()+r,n=parseInt(String((n-t)/26));return r},l=function(e,t){return a(parseInt(String(e)))+(parseInt(String(t))+1)},c=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(String(t[0].charCodeAt(r)-64))*Math.pow(26,t[0].length-1-r);--n<0&&(n=0);var o=/[0-9]+$/.exec(e),i=o?parseInt(o[0]):null;return i&&i>0&&i--,[n,i]}return[null,null]},u=function(e){var t=e.split(":"),n=t[0],r=t[1],i=c(n),s=c(r);return o(o([],i.filter(function(e){return null!==e}),!0),s.filter(function(e){return null!==e}),!0)},d=function(e,t){t=t||",",e=e.replace(/\r?\n$|\r$|\n$/g,"");for(var n=[],r=!1,o=0,i=0,s=0,a=0;a<e.length;a++){var l=e[a],c=e[a+1];n[i]=n[i]||[],n[i][s]=n[i][s]||"",'"'==l&&r&&'"'==c?(n[i][s]+=l,++a):'"'!=l?l!=t||r?"\r"!=l||"\n"!=c||r?"\n"==l&&!r||"\r"==l&&!r?(++i,o=Math.max(o,s),s=0):n[i][s]+=l:(++i,o=Math.max(o,s),s=0,++a):++s:r=!r}return n.forEach(function(e,t){for(var n=e.length;n<=o;n++)e.push("")}),n},p=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var o=0;o<n.length;o++){var i=n[o].style.width;if(!i){var s=n[o].getAttribute("width");s&&(i=s)}i&&(t.columns[o]||(t.columns[o]={}),t.columns[o].width=i)}var a=function(e,n){var r,o=e.getBoundingClientRect(),i=o.width>50?o.width:50;t.columns[n]||(t.columns[n]={}),e.getAttribute("data-celltype")?t.columns[n].type=e.getAttribute("data-celltype"):t.columns[n].type="text",t.columns[n].width=i+"px",t.columns[n].title=e.innerHTML,e.style.textAlign&&(t.columns[n].align=e.style.textAlign),(r=e.getAttribute("name"))&&(t.columns[n].name=r),(r=e.getAttribute("id"))&&(t.columns[n].id=r),(r=e.getAttribute("data-mask"))&&(t.columns[n].mask=r)},l=[],c=e.querySelectorAll(":scope > thead > tr");if(c.length){for(var u=0;u<c.length-1;u++){var d=[];for(o=0;o<c[u].children.length;o++){var p={title:c[u].children[o].textContent,colspan:c[u].children[o].getAttribute("colspan")||1};d.push(p)}l.push(d)}var f=c[c.length-1].children;for(o=0;o<f.length;o++)a(f[o],o)}var h=0,m={},g={},v={},y={},b=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(u=0;u<b.length;u++)if(t.data[h]=[],1!=t.parseTableFirstRowAsHeader||c.length||0!=u){for(o=0;o<b[u].children.length;o++){(D=b[u].children[o].getAttribute("data-formula"))?"="!=D.substr(0,1)&&(D="="+D):D=b[u].children[o].innerHTML,t.data[h]&&t.data[h].push(D);var w=(0,r.t3)([o,u]),C=b[u].children[o].getAttribute("class");C&&(y[w]=C);var x=b[u].children[o].getAttribute("colspan"),E=b[u].children[o].getAttribute("rowspan"),j=x?parseInt(x):0,L=E?parseInt(E):0;(j||L)&&(m[w]=[j||1,L||1]),b[u].children[o].style&&"none"==b[u].children[o].style.display&&(b[u].children[o].style.display="");var A=b[u].children[o].getAttribute("style");A&&(v[w]=A),b[u].children[o].classList.contains("styleBold")&&(v[w]?v[w]+="; font-weight:bold;":v[w]="font-weight:bold;")}b[u].style&&b[u].style.height&&(g[u]={height:b[u].style.height}),h++}else for(o=0;o<b[u].children.length;o++)a(b[u].children[o],o);if(Object.keys(l).length>0&&(t.nestedHeaders=l),Object.keys(v).length>0&&(t.style=v),Object.keys(m).length>0&&(t.mergeCells=m),Object.keys(g).length>0&&(t.rows=g),Object.keys(y).length>0&&(t.classes=y),(b=e.querySelectorAll("tfoot tr")).length){var M=[];for(u=0;u<b.length;u++){var I=[];for(o=0;o<b[u].children.length;o++)I.push(b[u].children[o].textContent);M.push(I)}Object.keys(M).length>0&&(t.footers=M)}if(1==t.parseTableAutoCellType){var T=[];for(o=0;o<t.columns.length;o++){var _=!0,N=!0;for(T[o]=[],u=0;u<t.data.length;u++){var D=t.data[u][o];T[o][D]||(T[o][D]=0),T[o][D]++,D.length>25&&(_=!1),10==D.length&&"-"==D.substr(4,1)&&"-"==D.substr(7,1)||(N=!1)}var O=Object.keys(T[o]).length;N?t.columns[o].type="calendar":1==_&&O>1&&O<=.1*t.data.length&&(t.columns[o].type="dropdown",t.columns[o].source=Object.keys(T[o]))}}return t}console.log("Element is not a table")}},32:function(e,t,n){"use strict";n.d(t,{Dh:function(){return u},ZS:function(){return h},tN:function(){return f}});var r=n(988),o=n(898),i=n(655),s=n(195),a=n(745),l=n(106),c=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},u=function(e){var t=this;if(1!=t.ignoreHistory){var n=++t.historyIndex;t.history=t.history=t.history.slice(0,n+1),t.history[n]=e}},d=function(e,t){var n=this,r=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==n.options.search&&n.results&&n.results.length!=n.rows.length&&n.resetSearch(),1==e){for(var s=t.numOfRows,a=r;a<s+r;a++)n.rows[a].element.parentNode.removeChild(n.rows[a].element);n.records.splice(r,s),n.options.data.splice(r,s),n.rows.splice(r,s),l.at.call(n,1,r,s+r-1)}else{var u=t.rowRecords.map(function(e){return c([],e,!0)});n.records=(0,o.Hh)(n.records,r,u);var d=t.rowData.map(function(e){return c([],e,!0)});n.options.data=(0,o.Hh)(n.options.data,r,d),n.rows=(0,o.Hh)(n.rows,r,t.rowNode);var p=0;for(a=r;a<t.numOfRows+r;a++)n.tbody.insertBefore(t.rowNode[p].element,n.tbody.children[a]),p++}for(a=r;a<n.rows.length;a++)n.rows[a].y=a;for(a=r;a<n.records.length;a++)for(var f=0;f<n.records[a].length;f++)n.records[a][f].y=a;n.options.pagination>0&&n.page(n.pageNumber),i.o8.call(n)},p=function(e,t){var n=this,r=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var s=t.numOfColumns;n.options.columns.splice(r,s);for(var a=r;a<s+r;a++)n.headers[a].parentNode.removeChild(n.headers[a]),n.cols[a].colElement.parentNode.removeChild(n.cols[a].colElement);n.headers.splice(r,s),n.cols.splice(r,s);for(var l=0;l<t.data.length;l++){for(a=r;a<s+r;a++)n.records[l][a].element.parentNode.removeChild(n.records[l][a].element);n.records[l].splice(r,s),n.options.data[l].splice(r,s)}if(n.options.footers)for(l=0;l<n.options.footers.length;l++)n.options.footers[l].splice(r,s)}else{n.options.columns=(0,o.Hh)(n.options.columns,r,t.columns),n.headers=(0,o.Hh)(n.headers,r,t.headers),n.cols=(0,o.Hh)(n.cols,r,t.cols);var c=0;for(a=r;a<t.numOfColumns+r;a++)n.headerContainer.insertBefore(t.headers[c],n.headerContainer.children[a+1]),n.colgroupContainer.insertBefore(t.cols[c].colElement,n.colgroupContainer.children[a+1]),c++;for(l=0;l<t.data.length;l++){n.options.data[l]=(0,o.Hh)(n.options.data[l],r,t.data[l]),n.records[l]=(0,o.Hh)(n.records[l],r,t.records[l]);var u=0;for(a=r;a<t.numOfColumns+r;a++)n.rows[l].element.insertBefore(t.records[l][u].element,n.rows[l].element.children[a+1]),u++}if(n.options.footers)for(l=0;l<n.options.footers.length;l++)n.options.footers[l]=(0,o.Hh)(n.options.footers[l],r,t.footers[l])}for(a=r;a<n.cols.length;a++)n.cols[a].x=a;for(l=0;l<n.records.length;l++)for(a=r;a<n.records[l].length;a++)n.records[l][a].x=a;if(n.options.nestedHeaders&&n.options.nestedHeaders.length>0&&n.options.nestedHeaders[0]&&n.options.nestedHeaders[0][0])for(l=0;l<n.options.nestedHeaders.length;l++){var d;d=1==e?parseInt(n.options.nestedHeaders[l][n.options.nestedHeaders[l].length-1].colspan)-t.numOfColumns:parseInt(n.options.nestedHeaders[l][n.options.nestedHeaders[l].length-1].colspan)+t.numOfColumns,n.options.nestedHeaders[l][n.options.nestedHeaders[l].length-1].colspan=d,n.thead.children[l].children[n.thead.children[l].children.length-1].setAttribute("colspan",d)}i.o8.call(n)},f=function(){var e=this,t=!!e.parent.ignoreEvents,n=!!e.ignoreHistory;e.parent.ignoreEvents=!0,e.ignoreHistory=!0;var o,i=[];if(e.historyIndex>=0)if("insertRow"==(o=e.history[e.historyIndex--]).action)d.call(e,1,o);else if("deleteRow"==o.action)d.call(e,0,o);else if("insertColumn"==o.action)p.call(e,1,o);else if("deleteColumn"==o.action)p.call(e,0,o);else if("moveRow"==o.action)e.moveRow(o.newValue,o.oldValue);else if("moveColumn"==o.action)e.moveColumn(o.newValue,o.oldValue);else if("setMerge"==o.action)e.removeMerge(o.column,o.data);else if("setStyle"==o.action)e.setStyle(o.oldValue,null,null,1);else if("setWidth"==o.action)e.setWidth(o.column,o.oldValue);else if("setHeight"==o.action)e.setHeight(o.row,o.oldValue);else if("setHeader"==o.action)e.setHeader(o.column,o.oldValue);else if("setComments"==o.action)e.setComments(o.oldValue);else if("orderBy"==o.action){for(var s=[],l=0;l<o.rows.length;l++)s[o.rows[l]]=l;a.Th.call(e,o.column,o.order?0:1),a.iY.call(e,s)}else if("setValue"==o.action){for(var c=0;c<o.records.length;c++)i.push({x:o.records[c].x,y:o.records[c].y,value:o.records[c].oldValue}),o.oldStyle&&e.resetStyle(o.oldStyle);e.setValue(i),o.selection&&e.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}e.parent.ignoreEvents=t,e.ignoreHistory=n,r.A.call(e,"onundo",e,o)},h=function(){var e,t=this,n=!!t.parent.ignoreEvents,o=!!t.ignoreHistory;if(t.parent.ignoreEvents=!0,t.ignoreHistory=!0,t.historyIndex<t.history.length-1)if("insertRow"==(e=t.history[++t.historyIndex]).action)d.call(t,0,e);else if("deleteRow"==e.action)d.call(t,1,e);else if("insertColumn"==e.action)p.call(t,0,e);else if("deleteColumn"==e.action)p.call(t,1,e);else if("moveRow"==e.action)t.moveRow(e.oldValue,e.newValue);else if("moveColumn"==e.action)t.moveColumn(e.oldValue,e.newValue);else if("setMerge"==e.action)s.FU.call(t,e.column,e.colspan,e.rowspan,1);else if("setStyle"==e.action)t.setStyle(e.newValue,null,null,1);else if("setWidth"==e.action)t.setWidth(e.column,e.newValue);else if("setHeight"==e.action)t.setHeight(e.row,e.newValue);else if("setHeader"==e.action)t.setHeader(e.column,e.newValue);else if("setComments"==e.action)t.setComments(e.newValue);else if("orderBy"==e.action)a.Th.call(t,e.column,e.order),a.iY.call(t,e.rows);else if("setValue"==e.action){t.setValue(e.records);for(var i=0;i<e.records.length;i++)e.oldStyle&&t.resetStyle(e.newStyle);e.selection&&t.updateSelectionFromCoords(e.selection[0],e.selection[1],e.selection[2],e.selection[3])}t.parent.ignoreEvents=n,t.ignoreHistory=o,r.A.call(t,"onredo",t,e)}},87:function(e,t,n){"use strict";n.d(t,{Ar:function(){return f},ll:function(){return p},nK:function(){return d}});var r=n(587),o=n.n(r),i=n(9),s=n(655),a=function(e,t){0!=t.options.editable?e.classList.remove("jtoolbar-disabled"):e.classList.add("jtoolbar-disabled")},l=function(){var e=[],t=this,n=function(){return s.eN.call(t)};e.push({content:"undo",onclick:function(){n().undo()}}),e.push({content:"redo",onclick:function(){n().redo()}}),e.push({content:"save",onclick:function(){var e=n();e&&e.download()}}),e.push({type:"divisor"}),e.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,r,o,i){var s=n(),a=s.getSelected(!0);if(a){var l=i?o:"";s.setStyle(Object.fromEntries(a.map(function(e){return[e,"font-family: "+l]})))}},updateState:function(e,t,r){a(r,n())}}),e.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,r,o){var i=n(),s=i.getSelected(!0);s&&i.setStyle(Object.fromEntries(s.map(function(e){return[e,"font-size: "+o]})))},updateState:function(e,t,r){a(r,n())}}),e.push({type:"select",options:["left","center","right","justify"],render:function(e){return'<i class="material-icons">format_align_'+e+"</i>"},onchange:function(e,t,r,o){var i=n(),s=i.getSelected(!0);s&&i.setStyle(Object.fromEntries(s.map(function(e){return[e,"text-align: "+o]})))},updateState:function(e,t,r){a(r,n())}}),e.push({content:"format_bold",onclick:function(e,t,r){var o=n(),i=o.getSelected(!0);i&&o.setStyle(Object.fromEntries(i.map(function(e){return[e,"font-weight:bold"]})))},updateState:function(e,t,r){a(r,n())}}),e.push({type:"color",content:"format_color_text",k:"color",updateState:function(e,t,r){a(r,n())}}),e.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(e,t,r,o){a(r,n())}});var r=["top","middle","bottom"];return e.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(e){return'<i class="material-icons">'+e+"</i>"},value:1,onchange:function(e,t,o,i,s){var a=n(),l=a.getSelected(!0);l&&a.setStyle(Object.fromEntries(l.map(function(e){return[e,"vertical-align: "+r[s]]})))},updateState:function(e,t,r){a(r,n())}}),e.push({content:"web",tooltip:o().translate("Merge the selected cells"),onclick:function(){var e=n();if(e.selectedCell&&confirm(o().translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){var t=[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])],r=(0,i.getCellNameFromCoords)(t[0],t[1]);if(e.records[t[1]][t[0]].element.getAttribute("data-merged"))e.removeMerge(r);else{var s=t[2]-t[0]+1,a=t[3]-t[1]+1;1===s&&1===a||e.setMerge(r,s,a)}}},updateState:function(e,t,r){a(r,n())}}),e.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(e){return'<i class="material-icons">'+e+"</i>"},right:!0,onchange:function(e,t,r,o){var s=n();if(s.selectedCell){var a=[Math.min(s.selectedCell[0],s.selectedCell[2]),Math.min(s.selectedCell[1],s.selectedCell[3]),Math.max(s.selectedCell[0],s.selectedCell[2]),Math.max(s.selectedCell[1],s.selectedCell[3])],l=o;if(a){var c=t.thickness||1,u=t.color||"black",d=t.style||"solid";"double"===d&&(c+=2);for(var p={},f=a[0],h=a[1],m=a[2],g=a[3],v=function(e,t,n){var r=["","","",""];r[0]=("border_top"===l||"border_outer"===l)&&n===h||("border_inner"===l||"border_horizontal"===l)&&n>h||"border_all"===l?"border-top: "+c+"px "+d+" "+u:"border-top: ",r[1]="border_all"!==l&&"border_right"!==l&&"border_outer"!==l||t!==m?"border-right: ":"border-right: "+c+"px "+d+" "+u,r[2]="border_all"!==l&&"border_bottom"!==l&&"border_outer"!==l||n!==g?"border-bottom: ":"border-bottom: "+c+"px "+d+" "+u,r[3]=("border_left"===l||"border_outer"===l)&&t===f||("border_inner"===l||"border_vertical"===l)&&t>f||"border_all"===l?"border-left: "+c+"px "+d+" "+u:"border-left: ",p[e]=r.join(";")},y=a[1];y<=a[3];y++)for(var b=a[0];b<=a[2];b++)v((0,i.getCellNameFromCoords)(b,y),b,y),s.records[y][b].element.getAttribute("data-merged")&&v((0,i.getCellNameFromCoords)(a[0],a[1]),b,y);Object.keys(p)&&s.setStyle(p)}}},onload:function(e,t){var n=document.createElement("div"),r=document.createElement("div");n.appendChild(r);var i=o().color(r,{closeOnChange:!1,onchange:function(e,n){e.parentNode.children[1].style.color=n,t.color=n}}),s=document.createElement("i");s.classList.add("material-icons"),s.innerHTML="color_lens",s.onclick=function(){i.open()},n.appendChild(s),e.children[1].appendChild(n),r=document.createElement("div"),o().picker(r,{type:"select",data:[1,2,3,4,5],render:function(e){return'<div style="height: '+e+'px; width: 30px; background-color: black;"></div>'},onchange:function(e,n,r,o){t.thickness=o},width:"50px"}),e.children[1].appendChild(r);var a=document.createElement("div");o().picker(a,{type:"select",data:["solid","dotted","dashed","double"],render:function(e){return"double"===e?'<div style="width: 30px; border-top: 3px '+e+' black;"></div>':'<div style="width: 30px; border-top: 2px '+e+' black;"></div>'},onchange:function(e,n,r,o){t.style=o},width:"50px"}),e.children[1].appendChild(a),(r=document.createElement("div")).style.flex="1",e.children[1].appendChild(r)},updateState:function(e,t,r){a(r,n())}}),e.push({type:"divisor"}),e.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(e,n,r){"fullscreen"===r.children[0].textContent?(t.fullscreen(!0),r.children[0].textContent="fullscreen_exit"):(t.fullscreen(!1),r.children[0].textContent="fullscreen")},updateState:function(e,t,n,r){!0===r.parent.config.fullscreen?n.children[0].textContent="fullscreen_exit":n.children[0].textContent="fullscreen"}}),e},c=function(e){for(var t=this,n=e.items,r=function(e){n[e].tooltip&&(n[e].title=n[e].tooltip,delete n[e].tooltip),"select"==n[e].type?n[e].options?(n[e].data=n[e].options,delete n[e].options):(n[e].data=n[e].v,delete n[e].v,n[e].k&&!n[e].onchange&&(n[e].onchange=function(r,o,i){var a=s.eN.call(t),l=a.getSelected(!0);a.setStyle(Object.fromEntries(l.map(function(t){return[t,n[e].k+": "+i]})))})):"color"==n[e].type&&(n[e].type="i",n[e].onclick=function(r,i,a){a.color||(o().color(a,{onchange:function(r,o){var i=s.eN.call(t),a=i.getSelected(!0);i.setStyle(Object.fromEntries(a.map(function(t){return[t,n[e].k+": "+o]})))},onopen:function(e){e.color.select("")}}),a.color.open())})},i=0;i<n.length;i++)r(i)},u=function(e){var t=this,n=document.createElement("div");return n.classList.add("jss_toolbar"),c.call(t,e),"object"==typeof t.plugins&&Object.entries(t.plugins).forEach(function(t){var n=t[1];if("function"==typeof n.toolbar){var r=n.toolbar(e);r&&(e=r)}}),o().toolbar(n,e),n},d=function(e){e.parent.toolbar&&e.parent.toolbar.toolbar.update(e)},p=function(){var e,t=this;t.config.toolbar&&!t.toolbar&&(Array.isArray(t.config.toolbar)?e={items:t.config.toolbar}:"object"==typeof t.config.toolbar?e=t.config.toolbar:(e={items:l.call(t)},"function"==typeof t.config.toolbar&&(e=t.config.toolbar(e))),t.toolbar=t.element.insertBefore(u.call(t,e),t.element.children[1]))},f=function(){var e=this;e.toolbar&&(e.toolbar.parentNode.removeChild(e.toolbar),delete e.toolbar)}},106:function(e,t,n){"use strict";n.d(t,{AH:function(){return h},Aq:function(){return u},G9:function(){return g},Jg:function(){return m},Lo:function(){return j},R5:function(){return x},Ub:function(){return E},at:function(){return C},c6:function(){return p},eO:function(){return A},ef:function(){return L},gE:function(){return d},gG:function(){return v},kA:function(){return f},kF:function(){return b},kV:function(){return I},sp:function(){return M},tW:function(){return w}});var r=n(988),o=n(881),i=n(9),s=n(32),a=n(655),l=n(898),c=n(87),u=function(){var e=this;if(e.highlighted&&e.highlighted.length){var t=e.highlighted[e.highlighted.length-1].element,n=t.getAttribute("data-x"),r=e.content.getBoundingClientRect(),i=r.left,s=r.top,a=t.getBoundingClientRect(),l=a.left,u=a.top,d=a.width,p=a.height,f=l-i+e.content.scrollLeft+d-4,h=u-s+e.content.scrollTop+p-4;if(e.corner.style.top=h+"px",e.corner.style.left=f+"px",e.options.freezeColumns){var m=o.w.call(e);n>e.options.freezeColumns-1&&l-i+d<m?e.corner.style.display="none":0!=e.options.selectionCopy&&(e.corner.style.display="")}else 0!=e.options.selectionCopy&&(e.corner.style.display="")}else e.corner.style.top="-2000px",e.corner.style.left="-2000px";(0,c.nK)(e)},d=function(e){var t,n=this;if(n.highlighted&&n.highlighted.length){t=1;for(var o=0;o<n.highlighted.length;o++){n.highlighted[o].element.classList.remove("highlight"),n.highlighted[o].element.classList.remove("highlight-left"),n.highlighted[o].element.classList.remove("highlight-right"),n.highlighted[o].element.classList.remove("highlight-top"),n.highlighted[o].element.classList.remove("highlight-bottom"),n.highlighted[o].element.classList.remove("highlight-selected");var i=parseInt(n.highlighted[o].element.getAttribute("data-x")),s=parseInt(n.highlighted[o].element.getAttribute("data-y")),a=void 0,l=void 0;if(n.highlighted[o].element.getAttribute("data-merged")){var c=parseInt(n.highlighted[o].element.getAttribute("colspan")),u=parseInt(n.highlighted[o].element.getAttribute("rowspan"));a=c>0?i+(c-1):i,l=u>0?s+(u-1):s}else a=i,l=s;for(var d=i;d<=a;d++)n.headers[d]&&n.headers[d].classList.remove("selected");for(d=s;d<=l;d++)n.rows[d]&&n.rows[d].element.classList.remove("selected")}}else t=0;return n.highlighted=[],n.selectedCell=null,n.corner.style.top="-2000px",n.corner.style.left="-2000px",1==e&&1==t&&r.A.call(n,"onblur",n),t},p=function(e,t,n){var r,o,i=e.getAttribute("data-x"),s=e.getAttribute("data-y");t?(r=t.getAttribute("data-x"),o=t.getAttribute("data-y")):(r=i,o=s),h.call(this,i,s,r,o,n)},f=function(){for(var e=document.querySelectorAll(".jss_worksheet .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},h=function(e,t,n,o,i){var s=this;if(null==t){if(t=0,o=s.rows.length-1,null==e)return}else null==e&&(e=0,n=s.options.data[0].length-1);null==n&&(n=e),null==o&&(o=t),e>=s.headers.length&&(e=s.headers.length-1),t>=s.rows.length&&(t=s.rows.length-1),n>=s.headers.length&&(n=s.headers.length-1),o>=s.rows.length&&(o=s.rows.length-1);var a,l,c,d,p=null,h=null,m=null,g=null;e<n?(a=e,l=n):(a=n,l=e),t<o?(c=t,d=o):(c=o,d=t);for(var v=a;v<=l;v++)for(var y=c;y<=d;y++)if(s.records[y][v]&&s.records[y][v].element.getAttribute("data-merged")){var b=parseInt(s.records[y][v].element.getAttribute("data-x")),w=parseInt(s.records[y][v].element.getAttribute("data-y")),C=parseInt(s.records[y][v].element.getAttribute("colspan")),x=parseInt(s.records[y][v].element.getAttribute("rowspan"));C>1&&(b<a&&(a=b),b+C>l&&(l=b+C-1)),x&&(w<c&&(c=w),w+x>d&&(d=w+x-1))}for(y=c;y<=d;y++)"none"!=s.rows[y].element.style.display&&(null==m&&(m=y),g=y);for(v=a;v<=l;v++)for(y=c;y<=d;y++)s.options.columns&&s.options.columns[v]&&"hidden"==s.options.columns[v].type||(null==p&&(p=v),h=v);if(p||(p=0),h||(h=0),!1===r.A.call(s,"onbeforeselection",s,p,m,h,g,i))return!1;var E=s.resetSelection();for(s.selectedCell=[e,t,n,o],s.records[t][e]&&s.records[t][e].element.classList.add("highlight-selected"),v=a;v<=l;v++)for(y=c;y<=d;y++)"none"!=s.rows[y].element.style.display&&"none"!=s.records[y][v].element.style.display&&(s.records[y][v].element.classList.add("highlight"),s.highlighted.push(s.records[y][v]));for(v=p;v<=h;v++)s.options.columns&&s.options.columns[v]&&"hidden"==s.options.columns[v].type||!s.cols[v].colElement.style||"none"==s.cols[v].colElement.style.display||(null!==m&&s.records[m]&&s.records[m][v]&&s.records[m][v].element.classList.add("highlight-top"),null!==g&&s.records[g]&&s.records[g][v]&&s.records[g][v].element.classList.add("highlight-bottom"),s.headers[v].classList.add("selected"));for(y=m;y<=g;y++)s.rows[y]&&"none"!=s.rows[y].element.style.display&&(null!==p&&s.records[y][p].element.classList.add("highlight-left"),null!==h&&s.records[y][h].element.classList.add("highlight-right"),s.rows[y].element.classList.add("selected"));s.selectedContainer=[p,m,h,g],0==E&&(r.A.call(s,"onfocus",s),f()),r.A.call(s,"onselection",s,p,m,h,g,i),u.call(s)},m=function(e){var t=this;if(!t.selectedCell)return[];for(var n=[],r=Math.min(t.selectedCell[0],t.selectedCell[2]);r<=Math.max(t.selectedCell[0],t.selectedCell[2]);r++)e&&"none"==t.headers[r].style.display||n.push(r);return n},g=function(){var e=this;e.selectedCell&&e.updateSelectionFromCoords(e.selectedCell[0],e.selectedCell[1],e.selectedCell[2],e.selectedCell[3])},v=function(){for(var e=this,t=0;t<e.selection.length;t++)e.selection[t].classList.remove("selection"),e.selection[t].classList.remove("selection-left"),e.selection[t].classList.remove("selection-right"),e.selection[t].classList.remove("selection-top"),e.selection[t].classList.remove("selection-bottom");e.selection=[]},y=function(e){var t=""+e;return 1==t.length&&(t="0"+t),t},b=function(e,t){var n,o,i=this,c=i.getData(!0,!1),u=i.selectedContainer,d=parseInt(e.getAttribute("data-x")),p=parseInt(e.getAttribute("data-y")),f=parseInt(t.getAttribute("data-x")),h=parseInt(t.getAttribute("data-y")),m=[],g=!1;u[0]==d?(n=p<u[1]?p-u[1]:1,o=0):(o=d<u[0]?d-u[0]:1,n=0);for(var v=0,b=0,w=p;w<=h;w++)if(!i.rows[w]||"none"!=i.rows[w].element.style.display){null==c[b]&&(b=0),v=0,u[0]!=d&&(o=d<u[0]?d-u[0]:1);for(var C=d;C<=f;C++){if(i.records[w][C]&&!i.records[w][C].element.classList.contains("readonly")&&"none"!=i.records[w][C].element.style.display&&0==g){if(!i.selection.length&&""!=i.options.data[w][C]){g=!0;continue}(null==c[b]||null==c[b][v])&&(v=0);var x=c[b][v];if(x&&!c[1]&&0!=i.parent.config.autoIncrement)if(!i.options.columns||!i.options.columns[C]||i.options.columns[C].type&&"text"!=i.options.columns[C].type&&"number"!=i.options.columns[C].type){if(i.options.columns&&i.options.columns[C]&&"calendar"==i.options.columns[C].type){var E=new Date(x);E.setDate(E.getDate()+n),x=E.getFullYear()+"-"+y(E.getMonth()+1)+"-"+y(E.getDate())+" 00:00:00"}}else if("="==(""+x).substr(0,1)){var j=x.match(/([A-Z]+[0-9]+)/g);if(j){for(var L=[],A=0;A<j.length;A++){var M=(0,l.vu)(j[A],!0);if(Array.isArray(M)){M[0]+=o,M[1]+=n,M[1]<0&&(M[1]=0);var I=(0,l.t3)([M[0],M[1]]);I!=j[A]&&(L[j[A]]=I)}}L&&(x=(0,a.yB)(x,L))}}else x==Number(x)&&(x=Number(x)+n);m.push(a.k9.call(i,C,w,x)),a.xF.call(i,C,w,m)}v++,u[0]!=d&&o++}b++,n++}s.Dh.call(i,{action:"setValue",records:m,selection:i.selectedCell}),a.am.call(i);var T=m.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});r.A.call(i,"onafterchanges",i,T)},w=function(e){var t,n=0;if(!e||0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},C=function(e,t,n){var r=this;if(1==e){if(r.selectedCell&&(t>=r.selectedCell[1]&&t<=r.selectedCell[3]||n>=r.selectedCell[1]&&n<=r.selectedCell[3]))return void r.resetSelection()}else if(r.selectedCell&&(t>=r.selectedCell[0]&&t<=r.selectedCell[2]||n>=r.selectedCell[0]&&n<=r.selectedCell[2]))return void r.resetSelection()},x=function(e){var t=this;if(!t.selectedCell)return[];for(var n=[],r=Math.min(t.selectedCell[1],t.selectedCell[3]);r<=Math.max(t.selectedCell[1],t.selectedCell[3]);r++)e&&"none"==t.rows[r].element.style.display||n.push(r);return n},E=function(){var e=this;e.selectedCell||(e.selectedCell=[]),e.selectedCell[0]=0,e.selectedCell[1]=0,e.selectedCell[2]=e.headers.length-1,e.selectedCell[3]=e.records.length-1,e.updateSelectionFromCoords(e.selectedCell[0],e.selectedCell[1],e.selectedCell[2],e.selectedCell[3])},j=function(){var e=this;return e.selectedCell?[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])]:null},L=function(e){var t=j.call(this);if(!t)return[];for(var n=[],r=t[1];r<=t[3];r++)for(var o=t[0];o<=t[2];o++)e?n.push((0,i.getCellNameFromCoords)(o,r)):n.push(this.records[r][o]);return n},A=function(){var e=this,t=j.call(e);if(!t)return"";var n=(0,i.getCellNameFromCoords)(t[0],t[1]),r=(0,i.getCellNameFromCoords)(t[2],t[3]);return n===r?e.options.worksheetName+"!"+n:e.options.worksheetName+"!"+n+":"+r},M=function(e,t){var n=j.call(this);return!!n&&e>=n[0]&&e<=n[2]&&t>=n[1]&&t<=n[3]},I=function(){var e=j.call(this);return e?[e]:[]}},195:function(e,t,n){"use strict";n.d(t,{D0:function(){return d},FU:function(){return f},Lt:function(){return u},VP:function(){return m},Zp:function(){return h},fd:function(){return p}});var r=n(587),o=n.n(r),i=n(898),s=n(655),a=n(32),l=n(988),c=n(106),u=function(e,t){var n=this,r=[];if(n.options.mergeCells)for(var o=Object.keys(n.options.mergeCells),s=0;s<o.length;s++){var a=(0,i.vu)(o[s],!0);if("string"==typeof a)return r;var l=n.options.mergeCells[o[s]][0],c=a[0],u=a[0]+(l>1?l-1:0);null==t?c<=e&&u>=e&&r.push(o[s]):t?c<e&&u>=e&&r.push(o[s]):c<=e&&u>e&&r.push(o[s])}return r},d=function(e,t){var n=this,r=[];if(n.options.mergeCells)for(var o=Object.keys(n.options.mergeCells),s=0;s<o.length;s++){var a=(0,i.vu)(o[s],!0);if("string"==typeof a)return[];var l=n.options.mergeCells[o[s]][1],c=a[1],u=a[1]+(l>1?l-1:0);null==t?c<=e&&u>=e&&r.push(o[s]):t?c<e&&u>=e&&r.push(o[s]):c<=e&&u>e&&r.push(o[s])}return r},p=function(e){var t=this,n={};if(e)n=t.options.mergeCells&&t.options.mergeCells[e]?[t.options.mergeCells[e][0],t.options.mergeCells[e][1]]:null;else if(t.options.mergeCells){t.options.mergeCells;for(var r=Object.keys(t.options.mergeCells),o=0;o<r.length;o++)n[r[o]]=[t.options.mergeCells[r[o]][0],t.options.mergeCells[r[o]][1]]}return n},f=function(e,t,n,r){var u,d=this,p=!1;if(e){if("string"!=typeof e)return}else{if(!d.highlighted.length)return void alert(o().translate("No cells selected"));var f=parseInt(d.highlighted[0].getAttribute("data-x")),h=parseInt(d.highlighted[0].getAttribute("data-y")),m=parseInt(d.highlighted[d.highlighted.length-1].getAttribute("data-x")),g=parseInt(d.highlighted[d.highlighted.length-1].getAttribute("data-y"));e=(0,i.t3)([f,h]),t=m-f+1,n=g-h+1}var v=(0,i.vu)(e,!0);if("string"!=typeof v){if(d.options.mergeCells&&d.options.mergeCells[e])d.records[v[1]][v[0]].element.getAttribute("data-merged")&&(p="Cell already merged");else if((!t||t<2)&&(!n||n<2))p="Invalid merged properties";else for(var y=v[1];y<v[1]+n;y++)for(var b=v[0];b<v[0]+t;b++)(0,i.t3)([b,y]),d.records[y][b].element.getAttribute("data-merged")&&(p="There is a conflict with another merged cell");if(p)alert(o().translate(p));else{t>1?d.records[v[1]][v[0]].element.setAttribute("colspan",t):t=1,n>1?d.records[v[1]][v[0]].element.setAttribute("rowspan",n):n=1,d.options.mergeCells||(d.options.mergeCells={}),d.options.mergeCells[e]=[t,n,[]],d.records[v[1]][v[0]].element.setAttribute("data-merged","true"),d.records[v[1]][v[0]].element.style.overflow="hidden";for(var w=[],C=v[1];C<v[1]+n;C++)for(var x=v[0];x<v[0]+t;x++)v[0]==x&&v[1]==C||(w.push(d.options.data[C][x]),s.k9.call(d,x,C,"",!0),d.options.mergeCells[e][2].push(d.records[C][x].element),d.records[C][x].element.style.display="none",d.records[C][x].element=d.records[v[1]][v[0]].element);c.c6.call(d,d.records[v[1]][v[0]].element,void 0,void 0),r||(a.Dh.call(d,{action:"setMerge",column:e,colspan:t,rowspan:n,data:w}),l.A.call(d,"onmerge",d,((u={})[e]=[t,n],u)))}}},h=function(e,t,n){var r=this;if(r.options.mergeCells&&r.options.mergeCells[e]){var o=(0,i.vu)(e,!0);if("string"==typeof o)return;r.records[o[1]][o[0]].element.removeAttribute("colspan"),r.records[o[1]][o[0]].element.removeAttribute("rowspan"),r.records[o[1]][o[0]].element.removeAttribute("data-merged");var a=r.options.mergeCells[e],l=0,u=0,d=0;for(u=0;u<a[1];u++)for(d=0;d<a[0];d++)(u>0||d>0)&&(r.records[o[1]+u][o[0]+d].element=a[2][l],r.records[o[1]+u][o[0]+d].element.style.display="",t&&t[l]&&s.k9.call(r,o[0]+d,o[1]+u,t[l]),l++);c.c6.call(r,r.records[o[1]][o[0]].element,r.records[o[1]+u-1][o[0]+d-1].element,void 0),n||delete r.options.mergeCells[e]}},m=function(e){var t=this;if(t.options.mergeCells){t.options.mergeCells;for(var n=Object.keys(t.options.mergeCells),r=0;r<n.length;r++)h.call(t,n[r],null,e)}}},211:function(e,t,n){"use strict";n.d(t,{IQ:function(){return o},hs:function(){return i},iZ:function(){return s}});var r=n(988),o=function(e,t){var n=this;return e?t?n.options.meta&&n.options.meta[e]&&n.options.meta[e][t]?n.options.meta[e][t]:null:n.options.meta&&n.options.meta[e]?n.options.meta[e]:null:n.options.meta},i=function(e){var t=this;if(t.options.meta){for(var n={},r=Object.keys(t.options.meta),o=0;o<r.length;o++)e[r[o]]?n[e[r[o]]]=t.options.meta[r[o]]:n[r[o]]=t.options.meta[r[o]];t.options.meta=n}},s=function(e,t,n){var o,i,s=this;if(s.options.meta||(s.options.meta={}),t&&n)s.options.meta[e]||(s.options.meta[e]={}),s.options.meta[e][t]=n,r.A.call(s,"onchangemeta",s,((o={})[e]=((i={})[t]=n,i),o));else{for(var a=Object.keys(e),l=0;l<a.length;l++){s.options.meta[a[l]]||(s.options.meta[a[l]]={});for(var c=Object.keys(e[a[l]]),u=0;u<c.length;u++)s.options.meta[a[l]][c[u]]=e[a[l]][c[u]]}r.A.call(s,"onchangemeta",s,e)}}},587:function(e){var t;e.exports=(function(){var e={195:function(e){e.exports=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var n,r,o,i,s,a,l,c,u,d,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],f=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=new Array(64),m=8;function g(e){return unescape(encodeURIComponent(e))}function v(e){for(var t=[],n=(1<<m)-1,r=e.length*m,o=0;o<r;o+=m)t[o>>5]|=(e.charCodeAt(o/m)&n)<<32-m-o%32;return t}function y(e){for(var t,n="0123456789abcdef",r="",o=4*e.length,i=0;i<o;i+=1)t=e[i>>2]>>8*(3-i%4),r+=n.charAt(t>>4&15)+n.charAt(15&t);return r}function b(e,n){var r,o,i;return r=(65535&e.lowOrder)+(65535&n.lowOrder),i=(65535&(o=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r>>>16)))<<16|65535&r,r=(65535&e.highOrder)+(65535&n.highOrder)+(o>>>16),new t((65535&(o=(e.highOrder>>>16)+(n.highOrder>>>16)+(r>>>16)))<<16|65535&r,i)}function w(e,n,r,o){var i,s,a;return i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&o.lowOrder),a=(65535&(s=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(o.lowOrder>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&o.highOrder)+(s>>>16),new t((65535&(s=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(o.highOrder>>>16)+(i>>>16)))<<16|65535&i,a)}function C(e,n,r,o,i){var s,a,l;return s=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&r.lowOrder)+(65535&o.lowOrder)+(65535&i.lowOrder),l=(65535&(a=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(r.lowOrder>>>16)+(o.lowOrder>>>16)+(i.lowOrder>>>16)+(s>>>16)))<<16|65535&s,s=(65535&e.highOrder)+(65535&n.highOrder)+(65535&r.highOrder)+(65535&o.highOrder)+(65535&i.highOrder)+(a>>>16),new t((65535&(a=(e.highOrder>>>16)+(n.highOrder>>>16)+(r.highOrder>>>16)+(o.highOrder>>>16)+(i.highOrder>>>16)+(s>>>16)))<<16|65535&s,l)}function x(e,n,r){return new t(e.highOrder&n.highOrder^e.highOrder&r.highOrder^n.highOrder&r.highOrder,e.lowOrder&n.lowOrder^e.lowOrder&r.lowOrder^n.lowOrder&r.lowOrder)}function E(e,n,r){return new t(e.highOrder&n.highOrder^~e.highOrder&r.highOrder,e.lowOrder&n.lowOrder^~e.lowOrder&r.lowOrder)}function j(e,n){return n<=32?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function L(e){var n=j(e,28),r=j(e,34),o=j(e,39);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function A(e){var n=j(e,14),r=j(e,18),o=j(e,41);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function M(e){var n=j(e,1),r=j(e,8),o=T(e,7);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function I(e){var n=j(e,19),r=j(e,61),o=T(e,6);return new t(n.highOrder^r.highOrder^o.highOrder,n.lowOrder^r.lowOrder^o.lowOrder)}function T(e,n){return n<=32?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var _=(e=g(e)).length*m;(e=v(e))[_>>5]|=128<<24-_%32,e[31+(_+128>>10<<5)]=_;for(var N=0;N<e.length;N+=32){n=p[0],r=p[1],o=p[2],i=p[3],s=p[4],a=p[5],l=p[6],c=p[7];for(var D=0;D<80;D++)h[D]=D<16?new t(e[2*D+N],e[2*D+N+1]):w(I(h[D-2]),h[D-7],M(h[D-15]),h[D-16]),u=C(c,A(s),E(s,a,l),f[D],h[D]),d=b(L(n),x(n,r,o)),c=l,l=a,a=s,s=b(i,u),i=o,o=r,r=n,n=b(u,d);p[0]=b(n,p[0]),p[1]=b(r,p[1]),p[2]=b(o,p[2]),p[3]=b(i,p[3]),p[4]=b(s,p[4]),p[5]=b(a,p[5]),p[6]=b(l,p[6]),p[7]=b(c,p[7])}var O=[];for(N=0;N<p.length;N++)O.push(p[N].highOrder),O.push(p[N].lowOrder);return y(O)}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o={};!function(){"use strict";r.d(o,{default:function(){return H}});var e={setDictionary:function(e){document.dictionary||(document.dictionary={});var t=null,n=Object.keys(e);for(t=0;t<n.length;t++)document.dictionary[n[t]]=e[n[t]]},translate:function(e){return"undefined"!=typeof document&&document.dictionary&&document.dictionary[e]||e}},n=function(e,t){if(!0===t)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(e){return null!==e}),setTimeout(function(){window.jSuitesStateControl.push(e)},0);else{var n=window.jSuitesStateControl.indexOf(e);n>=0&&window.jSuitesStateControl.splice(n,1)}},i={two:function(e){return 1==(e=""+e).length&&(e="0"+e),e},focus:function(e){if(e.textContent.length){const t=document.createRange(),n=window.getSelection();let r=e;for(;r.lastChild;)r=r.lastChild;r.nodeType===Node.TEXT_NODE?t.setStart(r,r.length):t.setStart(r,r.childNodes.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},isNumeric:function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},getNode:function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},hash:function(e){var t,n,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)(n=e.charCodeAt(t))>32&&(r=(r<<5)-r+n,r|=0);return r},randomColor:function(e){var t=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var n,r,o=[];for(r=0;r<3;r++)n=parseInt(t.substr(2*r,2),16),n=Math.round(Math.min(Math.max(0,n+-.25*n),255)).toString(16),o.push(("00"+n).substr(n.length));return 1==e?"#"+i.two(o[0].toString(16))+i.two(o[1].toString(16))+i.two(o[2].toString(16)):o},getWindowWidth:function(){var e=window,t=document,n=t.documentElement,r=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||r.clientWidth},getWindowHeight:function(){var e=window,t=document,n=t.documentElement,r=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||r.clientHeight},getPosition:function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),n=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,n]},click:function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},findElement:function(e,t){var n=!1;return function e(r){r&&!n&&("function"==typeof t?n=t(r):"string"==typeof t&&r.classList&&r.classList.contains(t)&&(n=r)),r.parentNode&&!n&&e(r.parentNode)}(e),n}},s=i;const a=function(e){return"object"==typeof e||"function"==typeof e};function l(e,t,n){if("string"!=typeof e||0===e.length)return;const r=e.split(".");if(0===r.length)return;let o=this;if(void 0===t&&void 0===n){for(let e=0;e<r.length;e++){const t=r[e];if(null==o||!a(o)||!Object.prototype.hasOwnProperty.call(o,t))return;o=o[t]}return o}for(let t=0;t<r.length-1;t++){const n=r[t];if(null==o||!a(o))return console.warn(`Cannot set value: path '${e}' blocked by invalid object at '${n}'`),!1;(!Object.prototype.hasOwnProperty.call(o,n)||null!=o[n]&&a(o[n]))&&Object.prototype.hasOwnProperty.call(o,n)||(o[n]={}),o=o[n]}const i=r[r.length-1];return!(null==o||!a(o)||(!0===n?!Object.prototype.hasOwnProperty.call(o,i)||(delete o[i],0):(o[i]=t,0)))}function c(e,t){var n={options:{}},r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},o=null;for(var i in r)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:n.options[i]=r[i];e.classList.add("jsorting"),e.addEventListener("dragstart",function(t){let r=t.target;if(3===r.nodeType){if("true"!==r.parentNode.getAttribute("draggable"))return t.preventDefault(),void t.stopPropagation();r=r.parentNode}if("true"===r.getAttribute("draggable")){let i=Array.prototype.indexOf.call(r.parentNode.children,r);o={element:r,o:i,d:i},r.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(e,r,t),t.dataTransfer.setDragImage(r,0,0)}}),e.addEventListener("dragover",function(e){if(e.preventDefault(),o&&s(e.target)&&"true"==e.target.getAttribute("draggable")&&o.element!=e.target){if(n.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(o.element,e.target):e.target.parentNode.insertBefore(o.element,e.target.nextSibling),o.d=Array.prototype.indexOf.call(e.target.parentNode.children,o.element)}}),e.addEventListener("dragleave",function(e){e.preventDefault()}),e.addEventListener("dragend",function(t){t.preventDefault(),o&&("function"==typeof n.options.ondragend&&n.options.ondragend(e,o.element,t),o.o<o.d?t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o]):t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o].nextSibling),o.element.style.opacity="",o=null)}),e.addEventListener("drop",function(t){t.preventDefault(),o&&(o.o!==o.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(e,o.o,o.d,o.element,t.target,t),o.element.style.opacity="",o=null)});for(var s=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t},a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e.val=function(){for(var t=null,n=[],r=0;r<e.children.length;r++)(t=e.children[r].getAttribute("data-id"))&&n.push(t);return n},e}function u(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,r=function(r){if(null==n){var o=!1,i=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),o=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),o=!0),n=setTimeout(function(){n=null},t.timer),o&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){r()},e.onwheel=function(e){r()},{}}var d,p=((d=function(e,t){if(Array.isArray(e)){var n={instance:[],complete:t};if(e.length>0)for(var r=0;r<e.length;r++)e[r].multiple=n,n.instance.push(d(e[r]));return n}if(e.data||(e.data={}),e.type&&(e.method=e.type),e.method||(e.method="GET"),e.dataType||(e.dataType="json"),e.data){var o=function(e,t){var n=[];if(e){var r=Object.keys(e);if(r.length)for(var i=0;i<r.length;i++){if(t)var s=t+"["+r[i]+"]";else s=r[i];if(e[s]instanceof FileList)n[s]=e[r[i]];else if(null===e[r[i]]||void 0===e[r[i]])n[s]="";else if("object"==typeof e[r[i]])for(var a=o(e[r[i]],s),l=Object.keys(a),c=0;c<l.length;c++)n[l[c]]=a[l[c]];else n[s]=e[r[i]]}}return n},i=o(e.data),s=Object.keys(i);if("GET"==e.method){if(s.length){var a=[];for(r=0;r<s.length;r++)a.push(s[r]+"="+encodeURIComponent(i[s[r]]));e.url.indexOf("?")<0&&(e.url+="?"),e.url+=a.join("&")}}else for(a=new FormData,r=0;r<s.length;r++)if(i[s[r]]instanceof FileList){if(i[s[r]].length)for(var l=0;l<i[s[r]].length;l++)a.append(s[r],i[s[r]][l],i[s[r]][l].name)}else a.append(s[r],i[s[r]])}var c=new XMLHttpRequest;return c.open(e.method,e.url,!0),e.requestedWith?c.setRequestHeader("X-Requested-With",e.requestedWith):!1!==e.requestedWith&&c.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.contentType&&c.setRequestHeader("Content-Type",e.contentType),"POST"===e.method?c.setRequestHeader("Accept","application/json"):"blob"===e.dataType?c.responseType="blob":e.contentType||("json"===e.dataType?c.setRequestHeader("Content-Type","text/json"):"html"===e.dataType&&c.setRequestHeader("Content-Type","text/html")),!0!==e.cache&&(c.setRequestHeader("pragma","no-cache"),c.setRequestHeader("cache-control","no-cache")),!0===e.withCredentials&&(c.withCredentials=!0),"function"==typeof e.beforeSend&&e.beforeSend(c),"function"==typeof d.beforeSend&&d.beforeSend(c),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(c),c.onerror=function(){e.error&&"function"==typeof e.error&&e.error({message:"Network error: Unable to reach the server.",status:0})},c.ontimeout=function(){e.error&&"function"==typeof e.error&&e.error({message:"Request timed out after "+c.timeout+"ms.",status:0})},c.onload=function(){if(c.status>=200&&c.status<300)if("json"===e.dataType)try{var t=JSON.parse(c.responseText);e.success&&"function"==typeof e.success&&e.success(t)}catch(n){e.error&&"function"==typeof e.error&&e.error(n,t)}else t="blob"===e.dataType?c.response:c.responseText,e.success&&"function"==typeof e.success&&e.success(t);else e.error&&"function"==typeof e.error&&e.error(c.responseText,c.status);if(d.queue&&d.queue.length>0&&d.send(d.queue.shift()),d.requests&&d.requests.length){var n=d.requests.indexOf(c);d.requests.splice(n,1),d.requests.length||e.complete&&"function"==typeof e.complete&&e.complete(t),e.group&&d.oncomplete&&"function"==typeof d.oncomplete[e.group]&&(d.pending(e.group)||(d.oncomplete[e.group](),d.oncomplete[e.group]=null)),e.multiple&&e.multiple.instance&&(n=e.multiple.instance.indexOf(c),e.multiple.instance.splice(n,1),e.multiple.instance.length||e.multiple.complete&&"function"==typeof e.multiple.complete&&e.multiple.complete(t))}},c.options=e,c.data=a,!0===e.queue&&d.requests.length>0?d.queue.push(c):d.send(c),c}).send=function(e){e.data?Array.isArray(e.data)?e.send(e.data.join("&")):e.send(e.data):e.send(),d.requests.push(e)},d.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},d.pending=function(e){var t=0,n=d.requests;if(n&&n.length)for(var r=0;r<n.length;r++)e&&e!=n[r].options.group||t++;return t},d.oncomplete={},d.requests=[],d.queue=[],d);var f=function(){const e={loading:{}};return e.loading.show=function(t){e.loading.element||(e.loading.element=document.createElement("div"),e.loading.element.className="jloading"),document.body.appendChild(e.loading.element),t>0&&setTimeout(function(){e.loading.hide()},1e3*t)},e.loading.hide=function(){e.loading.element&&e.loading.element.parentNode&&document.body.removeChild(e.loading.element)},e.slideLeft=function(e,t,n){1==t?(e.classList.add("jslide-left-in"),setTimeout(function(){e.classList.remove("jslide-left-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-left-out"),setTimeout(function(){e.classList.remove("jslide-left-out"),"function"==typeof n&&n()},400))},e.slideRight=function(e,t,n){!0===t?(e.classList.add("jslide-right-in"),setTimeout(function(){e.classList.remove("jslide-right-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-right-out"),setTimeout(function(){e.classList.remove("jslide-right-out"),"function"==typeof n&&n()},400))},e.slideTop=function(e,t,n){!0===t?(e.classList.add("jslide-top-in"),setTimeout(function(){e.classList.remove("jslide-top-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-top-out"),setTimeout(function(){e.classList.remove("jslide-top-out"),"function"==typeof n&&n()},400))},e.slideBottom=function(e,t,n){!0===t?(e.classList.add("jslide-bottom-in"),setTimeout(function(){e.classList.remove("jslide-bottom-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-bottom-out"),setTimeout(function(){e.classList.remove("jslide-bottom-out"),"function"==typeof n&&n()},100))},e.fadeIn=function(e,t){e.style.display="",e.classList.add("jfade-in"),setTimeout(function(){e.classList.remove("jfade-in"),"function"==typeof t&&t()},2e3)},e.fadeOut=function(e,t){e.classList.add("jfade-out"),setTimeout(function(){e.style.display="none",e.classList.remove("jfade-out"),"function"==typeof t&&t()},1e3)},e}();var h=function(){var t={now:function(e,t){var n=null,r=null,o=null,i=null,a=null,l=null;return Array.isArray(e)?(n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],l=e[5]):(e||(e=new Date),n=e.getFullYear(),r=e.getMonth()+1,o=e.getDate(),i=e.getHours(),a=e.getMinutes(),l=e.getSeconds()),1==t?s.two(n)+"-"+s.two(r)+"-"+s.two(o):s.two(n)+"-"+s.two(r)+"-"+s.two(o)+" "+s.two(i)+":"+s.two(a)+":"+s.two(l)},toArray:function(e){var t=(n=e.split(-1!==e.indexOf("T")?"T":" "))[1],n=n[0].split("-"),r=parseInt(n[0]),o=parseInt(n[1]),i=parseInt(n[2]),s=0,a=0;return t&&(t=t.split(":"),s=parseInt(t[0]),a=parseInt(t[1])),[r,o,i,s,a,0]}},n=Date.UTC(1900,0,0),r=Date.UTC(1900,1,29),o=864e5;t.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=r&&(t+=o),(t-=n)/o},t.numToDate=function(e){var i=n+e*o;i>=r&&(i-=o);const s=new Date(i);var a=[s.getUTCFullYear(),s.getUTCMonth()+1,s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds()];return t.now(a)};let i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(t,"weekdays",{get:function(){return i.map(function(t){return e.translate(t)})}}),Object.defineProperty(t,"weekdaysShort",{get:function(){return i.map(function(t){return e.translate(t).substring(0,3)})}}),Object.defineProperty(t,"months",{get:function(){return a.map(function(t){return e.translate(t)})}}),Object.defineProperty(t,"monthsShort",{get:function(){return a.map(function(t){return e.translate(t).substring(0,3)})}}),t}();var m=function(){var e={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},n=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var e=0;this.date[4]&&(e=parseFloat(this.date[4]/60));var t=parseInt(this.date[3])+e;t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=s.two(this.date[0])+"-"+s.two(this.date[1])+"-"+s.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]))):t=s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]);return t},r=function(){var e="";if(this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]){if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var t=h.now(this.date);e=h.dateToNum(t)}}else{if(-1!==this.mask.toLowerCase().indexOf("[h]"))e=parseInt(this.date[3]);else{let t=parseInt(this.date[3]);e=t<13&&-1!==this.values.indexOf("PM")?(t+12)%24:t%24}this.date[4]&&(e+=parseFloat(this.date[4]/60)),this.date[5]&&(e+=parseFloat(this.date[5]/3600)),e/=24}return isNaN(e)&&(e=""),e},o=function(e){return null===e||""===e||void 0===e},i=function(e){return"currency"===e||"percentage"===e||"scientific"===e||"numeric"===e},a=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},l=function(e,t){if(""==e)return"";t||(t=a.call(this));var n=(e=(""+e).split(t))[0].match(/[-]+/g);return n=!(!n||!n.length),e[0]=e[0].match(/[0-9]+/g),e[0]?(n&&e[0].unshift("-"),e[0]=e[0].join("")):n&&(e[0]="-"),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):""},c=function(e,t){if(""===e)return"";var n=a.call(this),r=this.options;if(""===(e=l.call(this,e)))return"";var o=null;if(e[0]&&(o="percent"===r.style?parseFloat(e[0])/100:parseFloat(e[0]+".1")),("-"===e[0]||"-00"===e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var i=new Intl.NumberFormat(this.locale,r).format(o);if(i=i.split(n),"percent"===r.style&&-1!==i[0].indexOf("%")&&(i[0]=i[0].replace("%",""),i[2]="%"),void 0!==i[1]){var s=i[1].replace(/[0-9]*/g,"");s&&(i[2]=s)}return void 0!==e[1]?i[1]=n+e[1]:i[1]="",i.join("")},u=function(e,t){var n=f.call(e);if(n){var r=c.call(this,n,t),o=r.length-n.length,i=p.call(e)+o;f.call(e,r,i,!0)}},d=function(e){var t=l.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},p=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0;return(s=window.getSelection())&&0!==s.rangeCount&&((o=(a=s.getRangeAt(0)).cloneRange()).selectNodeContents(this),o.setEnd(a.endContainer,a.endOffset),n=o.toString().length),n}return this.selectionStart}var r=f.call(this);if(t){for(var o=null,i=0;i<r.length;i++)(r[i].match(/[\-0-9]/g)||"."===r[i]||","===r[i])&&(o=i);null===o&&(o=r.indexOf(" ")),e>=o&&(e=o+1)}if(e>r.length&&(e=r.length),e)if("DIV"==this.tagName){var s=window.getSelection(),a=document.createRange();this.childNodes[0]&&(a.setStart(this.childNodes[0],e),s.removeAllRanges(),s.addRange(a))}else this.selectionStart=e,this.selectionEnd=e},f=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return e=this.innerText,this.value&&this.value.length>e.length&&(e=this.value),e;this.innerText!==e&&(this.innerText=e,t&&p.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&p.call(this,t,n))}},m=h.weekdays,g=h.weekdaysShort,v=h.months,y=h.monthsShort,b={YEAR:function(e,t){var n=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){b.YEAR.call(this,e,4)},YYY:function(e){b.YEAR.call(this,e,3)},YY:function(e){b.YEAR.call(this,e,2)},FIND:function(e,t){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1)this.values[this.index]+=e;else{for(var n=0,r=0,i=(this.values[this.index]+e).toLowerCase(),s=0;s<t.length;s++)0==t[s].toLowerCase().indexOf(i)&&(n=s,r++);if(r>1)this.values[this.index]+=e;else if(1==r){var a=t[n].length-this.values[this.index].length-1;return this.position+=a,this.values[this.index]=t[n],this.index++,n}}},MMM:function(e){var t=b.FIND.call(this,e,y);void 0!==t&&(this.date[1]=t+1)},MON:function(e){b.MMM.call(this,e)},MMMM:function(e){var t=b.FIND.call(this,e,v);void 0!==t&&(this.date[1]=t+1)},MONTH:function(e){b.MMMM.call(this,e)},MMMMM:function(e){o(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<v.length;n++)if(0==v[n][0].toLowerCase().indexOf(t)){this.values[this.index]=v[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?o(this.values[this.index])?(this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?o(this.values[this.index])?(this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(e)>0?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){o(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){b.FIND.call(this,e,g)},DY:function(e){b.DDD.call(this,e)},DDDD:function(e){b.FIND.call(this,e,m)},DAY:function(e){b.DDDD.call(this,e)},HH12:function(e,t){var n=!1;if(parseInt(e)>=0&&parseInt(e)<10?o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10?(this.date[3]=this.values[this.index]+=e,this.index++):n=!0:n=!0,1==n){var r=parseInt(this.values[this.index]);r>=0&&r<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(e,t){var n=!1;if(parseInt(e)>=0&&parseInt(e)<10?null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10?(t||"0"!==this.values[this.index]||(this.values[this.index]=""),this.date[3]=this.values[this.index]+=e,this.index++):n=!0:n=!0,1==n){var r=parseInt(this.values[this.index]);r>=0&&r<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(e){b.HH24.call(this,e,1)},H:function(e){b.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){b.N60.call(this,e,4)},SS:function(e){b.N60.call(this,e,5)},"AM/PM":function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),""===this.values[this.index]?e.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":e.match(/p/i)&&(this.values[this.index]+="P"):"A"!==this.values[this.index]&&"P"!==this.values[this.index]||(this.values[this.index]+="M",this.index++)},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.values[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=a.call(this),n=!1;o(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var r=l.call(this,this.values[this.index],t);r&&(this.values[this.index]=r.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(e){b["0{1}(.{1}0+)?"].call(this,e)},"0{1}(.{1}0+)?%":function(e){b["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){b["0{1}(.{1}0+)?"].call(this,e);var t=a.call(this),n=this.tokens[this.index].substr(1,1),r="-"===this.values[this.index][0],o=l.call(this,this.values[this.index],t);if(""!==o){var i=o[0].match(/[0-9]/g);if(i){for(var s=[],c=0,u=(i=i.join("")).length-1;u>=0;u--)s.push(i[u]),++c%3||s.push(n);s=s.reverse(),o[0]=s.join(""),o[0].substr(0,1)==n&&(o[0]=o[0].substr(1))}else o[0]="";this.values[this.index]=o.join(t),r&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){o(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){b["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},w=function(t){if("general"==this.type)var n=[].concat(e.general);else n=[].concat(e.currency,e.datetime,e.percentage,e.scientific,e.numeric,e.text,e.general);var r=new RegExp(n.join("|"),"gi");return t.match(r)},C=function(t){if(this.type)n="text"==this.type?["text"]:"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","scientific","numeric","general"];else var n=Object.keys(e);for(var r=0;r<n.length;r++)for(var o=n[r],i=0;i<e[o].length;i++){var s=new RegExp(e[o][i],"gi");if(t.match(s))return{type:o,method:e[o][i]}}},x=function(e){for(var t=[],n=0;n<e.length;n++){var r=C.call(this,e[n]);r?t.push(r.method):t.push(null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&t[n-1].indexOf("H")>=0||t[n-2]&&t[n-2].indexOf("H")>=0||t[n+1]&&t[n+1].indexOf("S")>=0||t[n+2]&&t[n+2].indexOf("S")>=0)&&(t[n]="MI");return t},E=function(e){var t=C.call(this,e);if(t)var n=t.type;if(n){for(var r=0,o=w.call(this,e),s=0;s<o.length;s++)(t=C.call(this,o[s]))&&i(t.type)&&r++;r>1&&(n="general")}return n},j=function(){"function"==typeof b[this.methods[this.index]]?(b[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},L=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(e,t,n,r,o){return o<0?t+"0."+Array(1-o-n.length).join(0)+n+r:t+n+r+Array(o-r.length+1).join(0)})},A=function(e,t,r){var o=null,l={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(l.input=e.target,l.value=f.call(e.target),l.caret=p.call(e.target),(o=e.target.getAttribute("data-mask"))&&(l.mask=o),(o=e.target.getAttribute("data-type"))&&(l.type=o),e.target.mask?(e.target.mask.options&&(l.options=e.target.mask.options),e.target.mask.locale&&(l.locale=e.target.mask.locale)):(o=e.target.getAttribute("data-locale"))&&(l.locale=o,l.mask&&(l.options.style=l.mask)),e.target.attributes&&e.target.attributes.length)for(var h=0;h<e.target.attributes.length;h++){var m=e.target.attributes[h].name,g=e.target.attributes[h].value;"data"==m.substr(0,4)&&(l.options[m.substr(5)]=g)}}else{if("string"==typeof t)l.mask=t;else for(m=Object.keys(t),h=0;h<m.length;h++)l[m[h]]=t[m[h]];"number"==typeof e&&(a.call(l,l.mask),e=(""+e).replace(".",l.options.decimal)),l.value=e,l.input&&(f.call(l.input,e),s.focus(l.input),l.caret=p.call(l.input))}if("="!=(""+l.value)[0]&&(l.mask||l.locale)){var v;if(l.mask&&(l.mask=l.mask.replace(new RegExp(/\[h]/),"|h|"),l.mask=l.mask.replace(new RegExp(/\[.*?\]/),""),l.mask=l.mask.replace(new RegExp(/\|h\|/),"[h]"),-1!==l.mask.indexOf(";")&&(o=l.mask.split(";"),l.mask=o[0]),-1!==l.mask.indexOf("##")&&((v=l.mask.split(";"))[0]&&("object"==typeof e&&(v[0]=v[0].replace(new RegExp(/_\)/g),""),v[0]=v[0].replace(new RegExp(/_\(/g),"")),v[0]=v[0].replace("*","\t"),v[0]=v[0].replace(new RegExp(/_-/g),""),v[0]=v[0].replace(new RegExp(/_/g),""),v[0]=v[0].replace(new RegExp(/"/g),""),v[0]=v[0].replace("##0.###","##0.000"),v[0]=v[0].replace("##0.##","##0.00"),v[0]=v[0].replace("##0.#","##0.0"),v[0]=v[0].replace("##0,###","##0,000"),v[0]=v[0].replace("##0,##","##0,00"),v[0]=v[0].replace("##0,#","##0,0")),l.mask=v[0]),-1!==l.mask.indexOf("\\")&&((v=l.mask.split(";"))[0]=v[0].replace(new RegExp(/\\/g),""),l.mask=v[0]),l.type||(l.type=E.call(l,l.mask)),l.tokens=w.call(l,l.mask)),"object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(l.locale)if(l.input)u.call(l,l.input,e);else var y=c.call(l,l.value);else{for(l.methods=x.call(l,l.tokens),l.event=e;l.position<l.value.length&&void 0!==l.tokens[l.index];)j.call(l);if(y=l.values.join(""),i(l.type)&&""!==y){for(;void 0!==l.tokens[l.index];)(o=C.call(l,l.tokens[l.index]))&&"general"==o.type&&(l.values[l.index]=l.tokens[l.index]),l.index++;var b=!0}else b=!1;if(y=l.values.join(""),l.input){if((o=y.length-l.value.length)>0)var L=l.caret+o;else L=l.caret;f.call(l.input,y,L,b)}}if(l.input){var M=null;if(i(l.type)){let e=f.call(l.input);l.number=d.call(l,e),M="percentage"==l.type&&-1!==(""+e).indexOf("%")?A.adjustPrecision(l.number/100):l.number}else"datetime"==l.type&&(M=n.call(l),l.date[0]&&l.date[1]&&l.date[2]&&l.input.setAttribute("data-completed",!0));M&&l.input.setAttribute("data-value",M)}if(void 0!==y)return r?l:y}};return A.adjustPrecision=function(e){if("number"==typeof e&&!Number.isInteger(e)){const t=e.toString().split(".");if(t[1]&&t[1].length>10){let n=0;const r=t[1][t[1].length-2];if(0==r||9==r){for(let e=t[1].length-2;e>0;e--){if(!(n>=0&&t[1][e]==r)){n=0;break}if(n++,n>6)break}if(n)return parseFloat(parseFloat(e).toFixed(t[1].length-1))}}}return e},A.getType=E,A.prepare=function(e,t){return t||(t={}),w.call(t,e)},A.apply=function(e){var t=f.call(e.target);1==e.key.length&&(t+=e.key),f.call(e.target,A(t,e.target.getAttribute("data-mask")))},A.run=function(e,t,n){return A(e,{mask:t,decimal:n})},A.extract=function(e,t,n){if(o(e))return e;if("object"!=typeof t)return e;if((t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask){if(-1!==t.mask.indexOf(";")){var i=t.mask.split(";");t.mask=i[0]}t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]")}a.call(t,t.mask);var l=null,c=null;if("percent"==t.type||"percent"==t.options.style?l="percentage":t.mask&&(l=E.call(t,t.mask)),"text"===l){var u={};c=e}else"general"===l?(u=A(e,t,!0),c=e):"datetime"===l?(e instanceof Date&&(e=A.getDateString(e,t.mask)),u=A(e,t,!0),c=s.isNumeric(e)?e:r.call(u)):"scientific"===l?(c=e,"string"==typeof e&&(c=Number(c)),u=t):(c=d.call(t,e),"percentage"===l&&-1!==(""+e).indexOf("%")&&(c/=100),u=t);return u.value=c,!u.type&&l&&(u.type=l),n?u:c},A.render=function(e,n,r,i){if(o(e))return e;if("object"!=typeof n)return e;if((n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),n.mask){if(-1!==n.mask.indexOf(";")){var s=n.mask.split(";");r||(s[0]=s[0].replace(new RegExp(/_\)/g),""),s[0]=s[0].replace(new RegExp(/_\(/g),"")),n.mask=s[0]}n.mask=n.mask.replace(new RegExp(/\[h]/),"|h|"),n.mask=n.mask.replace(new RegExp(/\[.*?\]/),""),n.mask=n.mask.replace(new RegExp(/\|h\|/),"[h]")}var l=null;"percent"==n.type||"percent"==n.options.style?l="percentage":n.mask?l=E.call(n,n.mask):e instanceof Date&&(l="datetime");var c=!1;if("datetime"==l||"calendar"==n.type)(s=A.getDateString(e,n.mask))&&(e=s),n.mask&&r&&(c=!0);else if("text"===l)"number"==typeof e&&(e=e.toString());else if("string"==typeof e&&t.isNumeric(e)&&(e=Number(e)),"percentage"===l&&(e=A.adjustPrecision(100*e)),"number"==typeof e){if(s=null,n.mask&&r){var u=a.call(n,n.mask);if("scientific"===l)if(-1!==n.mask.indexOf(u)){let t=n.mask.split("E");t=t[0].split(u),t=""+t[1].match(/[0-9]+/g),t=t.length,s=e.toExponential(t)}else s=e.toExponential(0);else{if(-1!==n.mask.indexOf(u)){u=(u=""+(u=n.mask.split(u))[1].match(/[0-9]+/g)).length,s=e.toFixed(u);let t=e.toString().split("."),r=t[1];r&&r.length>u&&"5"===r[r.length-1]&&(s=parseFloat(t[0]+"."+r+"1").toFixed(u))}else s=e.toFixed(0);-1!==(""+s).indexOf("e")&&(s=L(s))}}else if(n.locale&&r){if(u=(""+e).split("."),n.options){void 0===u[1]&&(u[1]="");var d=u[1].length;if(n.options.minimumFractionDigits>d)for(var p=0;p<n.options.minimumFractionDigits-d;p++)u[1]+="0"}s=u[1].length?u.join("."):u[0],d=u[1].length,n.options&&n.options.maximumFractionDigits<d&&(s=parseFloat(s).toFixed(n.options.maximumFractionDigits))}else s=L(e);null!==s&&(e=s,a.call(n,n.mask),n.options.decimal&&(e=e.replace(".",n.options.decimal)))}else n.mask&&r&&(c=!0);if(c){var f=n.mask.length-e.length;if(f>0)for(p=0;p<f;p++)e+=" "}if("scientific"===l){if(r)return e;e=L(e)}if("numeric"===l&&!1===i&&"string"==typeof e)return e;if(e=A(e,n),r&&"numeric"===l){var h=n.mask.match(new RegExp(/^[0]+$/gm));if(h&&1===h.length){var m=h[0].length;if(m>3)for(e=""+e;e.length<m;)e="0"+e}}return e},A.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},A.extractDateFromString=function(e,t){var n=A(e,{mask:t},!0);if(e>0&&Number(e)==e&&(n.values.join("")!==n.value||"numeric"==n.type)){var r=new Date(Math.round(86400*(e-25569)*1e3));return r.getFullYear()+"-"+s.two(r.getMonth())+"-"+s.two(r.getDate())+" 00:00:00"}var o=!1;return n.values&&n.values.length===n.tokens.length&&n.values[n.values.length-1].length>=n.tokens[n.tokens.length-1].length&&(o=!0),n.date[0]&&n.date[1]&&(n.date[2]||o)?(n.date[2]||(n.date[2]=1),n.date[0]+"-"+s.two(n.date[1])+"-"+s.two(n.date[2])+" "+s.two(n.date[3])+":"+s.two(n.date[4])+":"+s.two(n.date[5])):""},A.getDateString=function(e,t){if(t||(t={}),t&&"object"==typeof t)if(t.format)var n=t.format;else t.mask&&(n=t.mask);else n=t;if(n||(n="YYYY-MM-DD"),n.indexOf("[h]")>=0){var r=0;if(e&&s.isNumeric(e)&&(r=parseFloat(24*Number(e)),n.indexOf("mm")>=0)){if((d=(""+r).split("."))[1]){var o=60*parseFloat("0."+d[1]);o=parseFloat(o.toFixed(2))}else o=0;r=parseInt(d[0])+":"+s.two(o)}return r}e instanceof Date?e=h.now(e):e&&s.isNumeric(e)&&(e=h.numToDate(e));for(var i=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),a=n.match(i),l=0;l<a.length;l++)"MM"==a[l].toUpperCase()&&(a[l-1]&&a[l-1].toUpperCase().indexOf("H")>=0||a[l-2]&&a[l-2].toUpperCase().indexOf("H")>=0||a[l+1]&&a[l+1].toUpperCase().indexOf("S")>=0||a[l+2]&&a[l+2].toUpperCase().indexOf("S")>=0)&&(a[l]="mi");var c={tokens:a};if(e){var u=-1!==(o=""+e).indexOf("T")?"T":" ",d=0,p=0,f=0;(o=o.split(u))[1]&&(p=(d=o[1].split(":"))[1]?d[1]:0,f=d[2]?d[2]:0,d=d[0]?d[0]:0),o=o[0].split("-");let t=new Date(o[0],o[1],0).getDate();if(o[0]&&o[1]&&o[2]&&o[0]>0&&o[1]>0&&o[1]<13&&o[2]>0&&o[2]<=t){c.data=[o[0],o[1],o[2],d,p,f],c.value=[];var m=new Date(c.data[0],c.data[1]-1,c.data[2],c.data[3],c.data[4],c.data[5]),g=function(e){var t=this.tokens[e],n=t.toUpperCase(),r=null;"YYYY"===n?r=this.data[0]:"YYY"===n?r=this.data[0].substring(1,4):"YY"===n?r=this.data[0].substring(2,4):"Y"===n?r=this.data[0].substring(3,4):"MON"===t?r=h.months[m.getMonth()].substr(0,3).toUpperCase():"mon"===t?r=h.months[m.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?r=h.months[m.getMonth()].toUpperCase():"month"===t?r=h.months[m.getMonth()].toLowerCase():"MMMMM"===n?r=h.months[m.getMonth()].substr(0,1):"MMMM"===n||"Month"===t?r=h.months[m.getMonth()]:"MMM"===n||"Mon"==t?r=h.months[m.getMonth()].substr(0,3):"MM"===n?r=s.two(this.data[1]):"M"===n?r=m.getMonth()+1:"DAY"===t?r=h.weekdays[m.getDay()].toUpperCase():"day"===t?r=h.weekdays[m.getDay()].toLowerCase():"DDDD"===n||"Day"==t?r=h.weekdays[m.getDay()]:"DDD"===n?r=h.weekdays[m.getDay()].substr(0,3):"DD"===n?r=s.two(this.data[2]):"D"===n?r=parseInt(this.data[2]):"Q"===n?r=Math.floor((m.getMonth()+3)/3):"HH24"===n||"HH"===n?((r=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(r-=12),r=s.two(r)):"HH12"===n?r=this.data[3]>12?s.two(this.data[3]-12):s.two(this.data[3]):"H"===n?(r=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(r-=12,r=s.two(r)):"MI"===n?r=s.two(this.data[4]):"SS"===n?r=s.two(this.data[5]):"MS"===n?r=m.getMilliseconds():"AM/PM"===n?r=this.data[3]>=12?"PM":"AM":"WD"===n&&(r=h.weekdays[m.getDay()]),this.value[e]=null===r?this.tokens[e]:r};for(l=0;l<c.tokens.length;l++)g.call(c,l);e=c.value.join("")}else e=""}return e},A}();var g=function(){var t=function(r,o){if(r.calendar)return r.calendar.setOptions(o,!0);var i={type:"calendar",options:{},date:null,setOptions:function(n,o){var a={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:h.monthsShort,monthsFull:h.months,weekdays:h.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var l in a)n&&n.hasOwnProperty(l)?i.options[l]=n[l]:void 0!==i.options[l]&&!0!==o||(i.options[l]=a[l]);if(0==i.options.resetButton?d.style.display="none":d.style.display="",i.options.readonly?r.setAttribute("readonly","readonly"):r.removeAttribute("readonly"),i.options.placeholder?r.setAttribute("placeholder",i.options.placeholder):r.removeAttribute("placeholder"),s.isNumeric(i.options.value)&&i.options.value>0&&(i.options.value=t.numToDate(i.options.value),i.options.dataType="numeric"),d.innerHTML=i.options.textReset,p.innerHTML=i.options.textDone,j.innerHTML=i.options.textUpdate,i.options.format&&r.setAttribute("data-mask",i.options.format.toLowerCase()),!i.options.value&&i.options.today)var c=t.now();else c=i.options.value;return c&&(i.options.value=null,i.setValue(c)),i},open:function(e){if(!u.classList.contains("jcalendar-focus")&&!u.classList.contains("jcalendar-inline")){if(t.current=i,n(i,!0),i.getDays(),"year-month-picker"==i.options.type&&i.getMonths(),i.options.time&&(L.value=i.date[3],A.value=i.date[4]),u.classList.add("jcalendar-focus"),s.getWindowWidth()<800||i.options.fullscreen)u.classList.add("jcalendar-fullsize"),f.slideBottom(g,1);else{u.classList.remove("jcalendar-fullsize");var o=r.getBoundingClientRect(),a=g.getBoundingClientRect();if(i.options.position)m.style.position="fixed",window.innerHeight<o.bottom+a.height?m.style.top=o.top-(a.height+2)+"px":m.style.top=o.top+o.height+2+"px",m.style.left=o.left+"px";else if(window.innerHeight<o.bottom+a.height?((l=-1*(o.height+a.height+2))+o.top<0&&(l=-1*(o.top+o.height)),m.style.top=l+"px"):m.style.top="2px",window.innerWidth<o.left+a.width){var l=window.innerWidth-(o.left+a.width+20);m.style.left=l+"px"}else m.style.left="0px"}"function"==typeof i.options.onopen&&i.options.onopen(r)}},close:function(e,o){if(!0!==i.options.autoSelect&&void 0===o&&(o=!1),u.classList.contains("jcalendar-focus")){if(!1!==o){var s=u.querySelector(".jcalendar-selected");if("string"==typeof o)var a=o;else a=!s||s.classList.contains("jcalendar-disabled")?i.options.value:i.getValue();i.setValue(a)}else{let e=i.options.value||"";i.options.value=null,i.setValue(e)}e||"function"!=typeof i.options.onclose||i.options.onclose(r),u.classList.remove("jcalendar-focus"),n(i,!1),t.current=null}return i.options.value},prev:function(){"years"==i.options.mode?(i.date[0]=i.date[0]-12,i.getYears()):"months"==i.options.mode?(i.date[0]=parseInt(i.date[0])-1,i.getMonths()):(i.date[1]<2?(i.date[0]=i.date[0]-1,i.date[1]=12):i.date[1]=i.date[1]-1,i.getDays())},next:function(){"years"==i.options.mode?(i.date[0]=parseInt(i.date[0])+12,i.getYears()):"months"==i.options.mode?(i.date[0]=parseInt(i.date[0])+1,i.getMonths()):(i.date[1]>11?(i.date[0]=parseInt(i.date[0])+1,i.date[1]=1):i.date[1]=parseInt(i.date[1])+1,i.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return i.setValue(e),e},setValue:function(n){n||(n=""+n);var o=n,s=i.options.value;if(s!=o){if(o){i.setLabel(o,i.options),(l=o.split(" "))[1]||(l[1]="00:00:00");var a=l[1].split(":"),l=l[0].split("-"),c=parseInt(l[0]),u=parseInt(l[1]),d=parseInt(l[2]),p=parseInt(a[0]),f=parseInt(a[1]);i.date=[c,u,d,p,f,0],n=i.setLabel(o,i.options);var h=t.now(new Date(c,u-1,d),!0);if(i.options.validRange){if(!i.options.validRange[0]||h>=i.options.validRange[0])var m=!0;else m=!1;if(!i.options.validRange[1]||h<=i.options.validRange[1])var g=!0;else g=!1;m&&g?(r.classList.remove("jcalendar_warning"),r.title=""):(r.classList.add("jcalendar_warning"),r.title=e.translate("Date outside the valid range"))}else r.classList.remove("jcalendar_warning"),r.title=""}else{i.date=null;n="";r.classList.remove("jcalendar_warning"),r.title=""}i.options.value=o,"function"==typeof i.options.onchange&&i.options.onchange(r,o,s),r.value!=n&&(r.value=n,"function"==typeof r.oninput&&r.oninput({type:"input",target:r,value:r.value}))}i.date&&(i.getDays(),"year-month-picker"==i.options.type&&i.getMonths())},getValue:function(){return i.date?i.options.time?s.two(i.date[0])+"-"+s.two(i.date[1])+"-"+s.two(i.date[2])+" "+s.two(i.date[3])+":"+s.two(i.date[4])+":"+s.two(0):s.two(i.date[0])+"-"+s.two(i.date[1])+"-"+s.two(i.date[2])+" "+s.two(0)+":"+s.two(0)+":"+s.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var n=u.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(i.date[1]=t,i.date[2]=1):i.date[2]=e.innerText,i.options.time?(i.date[3]=L.value,i.date[4]=A.value):i.close(null,!0)}c()},reset:function(){i.setValue(""),i.date=null,i.close(!1,!1)},getDays:function(){i.options.mode="days";var e=new Date,n=i.date&&s.isNumeric(i.date[0])?i.date[0]:parseInt(e.getFullYear()),r=i.date&&s.isNumeric(i.date[1])?i.date[1]:parseInt(e.getMonth())+1,o=i.date&&s.isNumeric(i.date[2])?i.date[2]:parseInt(e.getDate()),a=i.date&&s.isNumeric(i.date[3])?i.date[3]:parseInt(e.getHours()),l=i.date&&s.isNumeric(i.date[4])?i.date[4]:parseInt(e.getMinutes());i.date=[n,r,o,a,l,0],v.innerHTML=n,y.innerHTML=i.options.months[r-1];var u=e.getMonth()==r-1&&e.getFullYear()==n,d=e.getDate(),p=(e=new Date(n,r,0,0,0)).getDate(),f=(e=new Date(n,r-1,0,0,0)).getDay()+1;f-=m=i.options.startingDay||0,w.innerHTML="",(C=document.createElement("tr")).setAttribute("align","center"),w.appendChild(C);for(var h=0;h<7;h++)(E=document.createElement("td")).classList.add("jcalendar-weekday"),E.innerHTML=i.options.weekdays[m].substr(0,1),C.appendChild(E),++m>6&&(m=0);for(var m=0,g=0,b=0;b<6;b++){var C;for((C=document.createElement("tr")).setAttribute("align","center"),C.style.height="34px",h=0;h<7;h++){var E;if((E=document.createElement("td")).classList.add("jcalendar-set-day"),m>=f&&m<f+p){g++,E.innerHTML=g,g==o&&E.classList.add("jcalendar-selected"),u&&d==g&&(E.style.fontWeight="bold");var j=t.now(new Date(n,r-1,g),!0);if(i.options.validRange){if(!i.options.validRange[0]||j>=i.options.validRange[0])var L=!0;else L=!1;if(!i.options.validRange[1]||j<=i.options.validRange[1])var A=!0;else A=!1;L&&A||E.classList.add("jcalendar-disabled")}}C.appendChild(E),m++}w.appendChild(C)}i.options.time?x.style.display="":x.style.display="none",c()},getMonths:function(){i.options.mode="months";var e=i.options.months,t=(i.options.value,new Date),n=parseInt(t.getFullYear()),r=parseInt(t.getMonth())+1,o=i.date&&s.isNumeric(i.date[0])?i.date[0]:n,a=i.date&&s.isNumeric(i.date[1])?i.date[1]:r;v.innerHTML=i.date[0],y.innerHTML=e[a-1];var l=document.createElement("table");l.setAttribute("width","100%");for(var u=null,d=0;d<12;d++){d%4||((u=document.createElement("tr")).setAttribute("align","center"),l.appendChild(u));var p=document.createElement("td");if(p.classList.add("jcalendar-set-month"),p.setAttribute("data-value",d+1),p.innerText=e[d],i.options.validRange){var f=o+"-"+s.two(d+1);if(!i.options.validRange[0]||f>=i.options.validRange[0].substr(0,7))var h=!0;else h=!1;if(!i.options.validRange[1]||f<=i.options.validRange[1].substr(0,7))var m=!0;else m=!1;h&&m||p.classList.add("jcalendar-disabled")}d+1==a&&p.classList.add("jcalendar-selected"),n==o&&d+1==r&&(p.style.fontWeight="bold"),u.appendChild(p)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.children[0].children[0].appendChild(l),c()},getYears:function(){i.options.mode="years";for(var e=new Date,t=e.getFullYear(),n=i.date&&s.isNumeric(i.date[0])?i.date[0]:parseInt(e.getFullYear()),r=[],o=0;o<25;o++)r[o]=parseInt(i.date[0])+(o-12);var a=document.createElement("table");for(a.setAttribute("width","100%"),o=0;o<25;o++){if(!(o%5)){var l=document.createElement("tr");l.setAttribute("align","center"),a.appendChild(l)}var u=document.createElement("td");u.classList.add("jcalendar-set-year"),u.innerText=r[o],n==r[o]&&u.classList.add("jcalendar-selected"),t==r[o]&&(u.style.fontWeight="bold"),l.appendChild(u)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.firstChild.firstChild.appendChild(a),c()},setLabel:function(e,n){return t.getDateString(e,n)},fromFormatted:function(e,n){return t.extractDateFromString(e,n)}},a=function(e){if(s.findElement(e.target,"jcalendar-container")){var t=e.target.className;if("jcalendar-prev"==t)i.prev();else if("jcalendar-next"==t)i.next();else if("jcalendar-month"==t)i.getMonths();else if("jcalendar-year"==t)i.getYears();else if("jcalendar-set-year"==t)i.date[0]=e.target.innerText,"year-month-picker"==i.options.type?i.getMonths():i.getDays();else if(e.target.classList.contains("jcalendar-set-month")){var n=parseInt(e.target.getAttribute("data-value"));"year-month-picker"==i.options.type?i.update(e.target,n):(i.date[1]=n,i.getDays())}else"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?i.close(null,!0):"jcalendar-backdrop"==t?i.close(!1,!1):"jcalendar-reset"==t?i.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&i.update(e.target)}else i.close(!1,!1)},l=function(e){if(e.target.value&&e.target.value.length>3){var n=t.extractDateFromString(e.target.value,i.options.format);n&&i.setValue(n)}},c=function(){var e=u.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(j.setAttribute("disabled","disabled"),L.setAttribute("disabled","disabled"),A.setAttribute("disabled","disabled")):(j.removeAttribute("disabled"),L.removeAttribute("disabled"),A.removeAttribute("disabled")),"function"==typeof i.options.onupdate&&i.options.onupdate(r,i.getValue())},u=null,d=null,p=null,m=null,g=null,v=null,y=null,b=null,w=null,C=null,x=null,E=null,j=null,L=null,A=null;return function(){"INPUT"==r.tagName&&r.value&&(o.value=r.value),(d=document.createElement("div")).className="jcalendar-reset",(p=document.createElement("div")).className="jcalendar-confirm",(C=document.createElement("div")).className="jcalendar-controls",C.style.borderBottom="1px solid #ddd",C.appendChild(d),C.appendChild(p),(m=document.createElement("div")).className="jcalendar-container",(g=document.createElement("div")).className="jcalendar-content",m.appendChild(g),"DIV"==r.tagName?(u=r).classList.add("jcalendar-inline"):(g.appendChild(C),(u=document.createElement("div")).className="jcalendar"),u.classList.add("jcalendar-container"),u.appendChild(m);var e=document.createElement("div");e.className="jcalendar-table",g.appendChild(e);var n=document.createElement("td");n.setAttribute("colspan","2"),n.className="jcalendar-prev",(v=document.createElement("span")).className="jcalendar-year",(y=document.createElement("span")).className="jcalendar-month";var c=document.createElement("td");c.className="jcalendar-header",c.setAttribute("colspan","3"),c.appendChild(y),c.appendChild(v);var h=document.createElement("td");h.setAttribute("colspan","2"),h.className="jcalendar-next";var M=document.createElement("thead"),I=document.createElement("tr");I.appendChild(n),I.appendChild(c),I.appendChild(h),M.appendChild(I),b=document.createElement("table"),w=document.createElement("tbody"),b.setAttribute("cellpadding","0"),b.setAttribute("cellspacing","0"),b.appendChild(M),b.appendChild(w),e.appendChild(b),(L=document.createElement("select")).className="jcalendar-select",L.onchange=function(){i.date[3]=this.value,"function"==typeof i.options.onupdate&&i.options.onupdate(r,i.getValue())};for(var T=0;T<24;T++)(_=document.createElement("option")).value=T,_.innerHTML=s.two(T),L.appendChild(_);for((A=document.createElement("select")).className="jcalendar-select",A.onchange=function(){i.date[4]=this.value,"function"==typeof i.options.onupdate&&i.options.onupdate(r,i.getValue())},T=0;T<60;T++){var _;(_=document.createElement("option")).value=T,_.innerHTML=s.two(T),A.appendChild(_)}var N=document.createElement("div");N.className="jcalendar-controls",(x=document.createElement("div")).className="jcalendar-time",x.style.maxWidth="140px",x.appendChild(L),x.appendChild(A),(j=document.createElement("button")).setAttribute("type","button"),j.className="jcalendar-update",(E=document.createElement("div")).style.flexGrow="10",E.appendChild(j),N.appendChild(x),"INPUT"==r.tagName&&N.appendChild(E),g.appendChild(N);var D=document.createElement("div");D.className="jcalendar-backdrop",u.appendChild(D),r.addEventListener("keyup",l),u.addEventListener("swipeleft",function(e){f.slideLeft(b,0,function(){i.next(),f.slideRight(b,1)}),e.preventDefault(),e.stopPropagation()}),u.addEventListener("swiperight",function(e){f.slideRight(b,0,function(){i.prev(),f.slideLeft(b,1)}),e.preventDefault(),e.stopPropagation()}),"ontouchend"in document.documentElement==1?(u.addEventListener("touchend",a),r.addEventListener("touchend",i.open)):(u.addEventListener("mouseup",a),r.addEventListener("mouseup",i.open)),t.hasEvents||(t.hasEvents=!0,document.addEventListener("keydown",t.keydown)),i.setOptions(o),"INPUT"==r.tagName?(r.parentNode.insertBefore(u,r.nextSibling),r.setAttribute("autocomplete","off"),r.classList.add("jcalendar-input"),r.value=i.setLabel(i.getValue(),i.options)):(i.getDays(),i.options.time&&(L.value=i.date[3],A.value=i.date[4])),1==i.options.opened&&i.open(),0==i.options.controls&&m.classList.add("jcalendar-hide-controls"),r.change=i.setValue,r.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},r.calendar=u.calendar=i}(),i};return t.keydown=function(e){var n=null;(n=t.current)&&(13==e.which?n.close(!1,!0):27==e.which&&n.close(!1,!1))},t.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"}),-1===e.indexOf("GMT")&&-1===e.indexOf("Z")&&(e+=" GMT");var n=new Date,r=new Date(e),o=parseInt((n-r)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==o)var i=t.justNow;else i=o<90?t.xMinutesAgo.format(o):o<1440?t.xHoursAgo.format(Math.round(o/60)):o<20160?t.xDaysAgo.format(Math.round(o/1440)):o<43200?t.xWeeksAgo.format(Math.round(o/10080)):o<1036800?t.xMonthsAgo.format(Math.round(o/43200)):t.xYearsAgo.format(Math.round(o/525600));return i},t.prettifyAll=function(){for(var e=document.querySelectorAll(".prettydate"),n=0;n<e.length;n++)e[n].getAttribute("data-date")?e[n].innerHTML=t.prettify(e[n].getAttribute("data-date")):e[n].innerHTML&&(e[n].setAttribute("title",e[n].innerHTML),e[n].setAttribute("data-date",e[n].innerHTML),e[n].innerHTML=t.prettify(e[n].innerHTML))},t.now=h.now,t.toArray=h.toArray,t.dateToNum=h.dateToNum,t.numToDate=h.numToDate,t.weekdays=h.weekdays,t.months=h.months,t.weekdaysShort=h.weekdaysShort,t.monthsShort=h.monthsShort,t.extractDateFromString=m.extractDateFromString,t.getDateString=m.getDateString,t}();var v=function(){var e={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},t=function(t){return e[t]?e[t]:e.material};return t.get=function(t){return e[t]?e[t]:e},t.set=function(t,n){e[t]=n},t}();function b(e,t){var n={options:{}},r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var o in r)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=r[o];e.classList.add("jtabs");var i=null,a=null,l=null;const u=function(e){n.options.animation&&setTimeout(function(){let t=n.headers.children[e].getBoundingClientRect();"modern"===n.options.palette?(l.style.width=t.width-4+"px",l.style.left=n.headers.children[e].offsetLeft+2+"px"):(l.style.width=t.width+"px",l.style.left=n.headers.children[e].offsetLeft+"px"),"bottom"===n.options.position?l.style.top="0px":l.style.bottom="0px"},50)};var d=function(e){"function"==typeof n.headers.scrollTo?n.headers.scrollTo({left:e,behavior:"smooth"}):n.headers.scrollLeft=e,e<=1?i.classList.add("disabled"):i.classList.remove("disabled"),e>=n.headers.scrollWidth-n.headers.offsetWidth?a.classList.add("disabled"):a.classList.remove("disabled"),n.headers.scrollWidth<=n.headers.offsetWidth?(i.style.display="none",a.style.display="none"):(i.style.display="",a.style.display="")};if(n.setBorder=u,n.open=function(t){if(Array.from(n.content.children),n.content.children[t]){for(var r=null,o=0;o<n.headers.children.length;o++)n.headers.children[o].classList.contains("jtabs-selected")&&(r=o),n.headers.children[o].classList.remove("jtabs-selected"),n.headers.children[o].removeAttribute("aria-selected"),n.content.children[o]&&n.content.children[o].classList.remove("jtabs-selected");if(n.headers.children[t].classList.add("jtabs-selected"),n.headers.children[t].setAttribute("aria-selected","true"),n.content.children[t]&&n.content.children[t].classList.add("jtabs-selected"),r!=t&&"function"==typeof n.options.onchange&&n.content.children[t]&&n.options.onchange(e,n,t,n.headers.children[t],n.content.children[t]),1==n.options.hideHeaders&&n.headers.children.length<3&&0==n.options.allowCreate)n.headers.parentNode.style.display="none";else{n.headers.parentNode.style.display="";var i=n.headers.children[t].offsetLeft,s=i+n.headers.children[t].offsetWidth,a=n.headers.scrollLeft,l=a+n.headers.offsetWidth;a<=i&&l>=s||d(i-1),u(t)}}},n.selectIndex=function(e){var t=Array.prototype.indexOf.call(n.headers.children,e);return t>=0&&n.open(t),t},n.rename=function(e,t){t||(t=prompt("New title",n.headers.children[e].innerText)),n.headers.children[e].innerText=t,u(n.getActive())},n.create=function(t,r){if("function"==typeof n.options.onbeforecreate){var o=n.options.onbeforecreate(e,t);if(!1===o)return!1;t=o}var i=n.appendElement(t);return"function"==typeof n.options.oncreate&&n.options.oncreate(e,i),u(n.getActive()),i},n.remove=function(e){return n.deleteElement(e)},n.nextNumber=function(){for(var e=0,t=0;t<n.headers.children.length;t++){var r=n.headers.children[t].innerText.match(/[0-9].*/);r>e&&(e=parseInt(r))}return e?e++:e=1,e},n.deleteElement=function(t){let r=n.getActive();if(!n.headers.children[t])return!1;if(n.headers.removeChild(n.headers.children[t]),n.content.removeChild(n.content.children[t]),r===t)n.open(0);else{let e=n.getActive()||0;u(e)}"function"==typeof n.options.ondelete&&n.options.ondelete(e,t)},n.appendElement=function(e,t,r,o){if(e||(e=prompt("Title?","")),e){let l=s.guid(),c=s.guid();var i=document.createElement("div");i.setAttribute("id",c),i.setAttribute("role","tabpanel"),i.setAttribute("aria-labelledby",l);var a=document.createElement("div");if(a.setAttribute("id",l),a.setAttribute("role","tab"),a.setAttribute("aria-controls",c),a.innerHTML=e,a.content=i,void 0===o)n.content.appendChild(i),n.headers.insertBefore(a,n.headers.lastChild);else{let e=n.content.children[o];e?n.content.insertBefore(i,e):n.content.appendChild(i),e=n.headers.children[o]||n.headers.lastChild,n.headers.insertBefore(a,e)}return n.options.allowChangePosition&&a.setAttribute("draggable","true"),!1!==r&&n.selectIndex(a),"function"==typeof t&&t(i,a),i}},n.getActive=function(){for(var e=0;e<n.headers.children.length;e++)if(n.headers.children[e].classList.contains("jtabs-selected"))return e;return!1},n.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t),n.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),n.content.replaceChild(t,n.content.children[e]),u()},n.updatePosition=function(e,t,r,o){if(e>t?n.content.insertBefore(n.content.children[e],n.content.children[t]):n.content.insertBefore(n.content.children[e],n.content.children[t].nextSibling),!1!==o)n.open(t);else{const e=n.getActive();t<e&&n.setBorder(e)}r||"function"!=typeof n.options.onchangeposition||n.options.onchangeposition(n.headers,e,t)},n.move=function(e,t,r,o){e>t?n.headers.insertBefore(n.headers.children[e],n.headers.children[t]):n.headers.insertBefore(n.headers.children[e],n.headers.children[t].nextSibling),n.updatePosition(e,t,r,o)},n.setBorder=u,n.init=function(){e.innerHTML="",n.headers=document.createElement("div"),n.content=document.createElement("div"),n.headers.classList.add("jtabs-headers"),n.headers.setAttribute("role","tablist"),n.content.classList.add("jtabs-content"),n.content.setAttribute("role","region"),n.content.setAttribute("aria-label","Tab Panels"),n.options.palette?e.classList.add("jtabs-modern"):e.classList.remove("jtabs-modern"),n.options.padding&&(n.content.style.padding=parseInt(n.options.padding)+"px");var t=document.createElement("div");t.className="jtabs-headers-container",t.appendChild(n.headers),n.options.maxWidth&&(t.style.maxWidth=parseInt(n.options.maxWidth)+"px");var r=document.createElement("div");if(r.className="jtabs-controls",r.setAttribute("draggable","false"),t.appendChild(r),"bottom"==n.options.position?(e.appendChild(n.content),e.appendChild(t)):(e.appendChild(t),e.appendChild(n.content)),1==n.options.allowCreate){var o=document.createElement("div");o.className="jtabs-add",o.onclick=function(){n.create()},r.appendChild(o)}(i=document.createElement("div")).className="jtabs-prev",i.onclick=function(){d(n.headers.scrollLeft-n.headers.offsetWidth)},r.appendChild(i),(a=document.createElement("div")).className="jtabs-next",a.onclick=function(){d(n.headers.scrollLeft+n.headers.offsetWidth)},r.appendChild(a);for(var s=0;s<n.options.data.length;s++){if(n.options.data[s].titleElement)var u=n.options.data[s].titleElement;else u=document.createElement("div");if(n.options.data[s].icon){var p=document.createElement("div"),f=document.createElement("i");f.classList.add("material-icons"),f.innerHTML=n.options.data[s].icon,p.appendChild(f),u.appendChild(p)}if(n.options.data[s].title){var h=document.createTextNode(n.options.data[s].title);u.appendChild(h)}if(n.options.data[s].width&&(u.style.width=n.options.data[s].width),n.options.data[s].contentElement)var m=n.options.data[s].contentElement;else(m=document.createElement("div")).innerHTML=n.options.data[s].content;n.headers.appendChild(u),n.content.appendChild(m)}(l=document.createElement("div")).className="jtabs-border",n.headers.appendChild(l),n.options.animation&&e.classList.add("jtabs-animation"),n.headers.addEventListener("click",function(t){if(t.target.parentNode.classList.contains("jtabs-headers"))var r=t.target;else r="I"==t.target.tagName?t.target.parentNode.parentNode:t.target.parentNode;var o=n.selectIndex(r);"function"==typeof n.options.onclick&&n.options.onclick(e,n,o,n.headers.children[o],n.content.children[o])}),n.headers.addEventListener("contextmenu",function(e){n.selectIndex(e.target)}),n.headers.children.length&&n.open(0),d(0),1==n.options.allowChangePosition&&c(n.headers,{direction:1,ondrop:function(e,t,r){n.updatePosition(t,r)}}),"function"==typeof n.options.onload&&n.options.onload(e,n)},e.children[0]&&e.children[0].children.length)for(var f=0;f<e.children[0].children.length;f++){var h=n.options.data&&n.options.data[f]?n.options.data[f]:{};e.children[1]&&e.children[1].children[f]?(h.titleElement=e.children[0].children[f],h.contentElement=e.children[1].children[f]):h.contentElement=e.children[0].children[f],n.options.data[f]=h}var m=!1;if(n.options.data)for(f=0;f<n.options.data.length;f++)n.options.data[f].url&&(p({url:n.options.data[f].url,type:"GET",dataType:"text/html",index:f,success:function(e){n.options.data[this.index].content=e},complete:function(){n.init()}}),m=!0);return m||n.init(),e.tabs=n,n}function w(e,t){if(e.color)return e.color.setOptions(t,!0);var r={type:"color",options:{}},o=null,i=null,a=null,l=null,c=null,u=null,d=null;r.setOptions=function(t,n){var o={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var i in t||(t={}),t&&!t.palette&&(t.palette=v()),o)t&&t.hasOwnProperty(i)?r.options[i]=t[i]:void 0!==r.options[i]&&!0!==n||(r.options[i]=o[i]);return l&&(l.innerHTML=r.options.resetLabel),c&&(c.innerHTML=r.options.doneLabel),r.options.palette&&d&&d.updateContent(0,y()),"string"==typeof r.options.value&&(e.value=r.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value)),r.options.placeholder?e.setAttribute("placeholder",r.options.placeholder):e.getAttribute("placeholder")&&e.removeAttribute("placeholder"),r},r.select=function(e){var t=o.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),r.values[e]&&r.values[e].classList.add("jcolor-selected"),r.options.value=e},r.open=function(){if(!o.classList.contains("jcolor-focus")){n(r,!0),o.classList.add("jcolor-focus"),r.options.value&&r.select(r.options.value),a.style.marginTop="",a.style.marginLeft="";var t=a.getBoundingClientRect(),l=s.getWindowWidth(),c=s.getWindowHeight();if(l<800||1==r.options.fullscreen?(a.classList.add("jcolor-fullscreen"),f.slideBottom(a,1),i.style.display="block"):(a.classList.contains("jcolor-fullscreen")&&(a.classList.remove("jcolor-fullscreen"),i.style.display=""),r.options.position?a.style.position="fixed":a.style.position="",t.left+t.width>l&&(a.style.marginLeft=-1*(t.left+t.width-(l-20))+"px"),t.top+t.height>c&&(a.style.marginTop=-1*(t.top+t.height-(c-20))+"px")),"function"==typeof r.options.onopen&&r.options.onopen(e,r),d.setBorder(d.getActive()),r.options.value){var u=g(r.options.value);A.forEach(function(e,t){e.value=u[t],e.dispatchEvent(new Event("input"))})}}},r.close=function(t){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),i.style.display="",t||"function"!=typeof r.options.onclose||r.options.onclose(e,r),n(r,!1)),r.options.value},r.setValue=function(t){t||(t=""),t!=r.options.value&&(r.options.value=t,L=t,r.select(t),"function"==typeof r.options.onchange&&r.options.onchange(e,t,r),e.value!=r.options.value&&(e.value=r.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value),"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),1==r.options.closeOnChange&&r.close())},r.getValue=function(){return r.options.value};var p=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},h=function(e,t,n){return"#"+p(e)+p(t)+p(n)},m=function(e){return parseInt("0x"+e)},g=function(e){return[m(e.substr(1,2)),m(e.substr(3,2)),m(e.substr(5,2))]},y=function(){var e=document.createElement("div");e.className="jcolor-grid",r.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<r.options.palette.length;n++){for(var o=document.createElement("tr"),i=0;i<r.options.palette[n].length;i++){var s=document.createElement("td"),a=r.options.palette[n][i];a.length<7&&"#"!==a.substr(0,1)&&(a="#"+a),s.style.backgroundColor=a,s.setAttribute("data-value",a),s.innerHTML="",o.appendChild(s),r.options.value==a&&s.classList.add("jcolor-selected"),r.values[a]=s}t.appendChild(o)}return e.appendChild(t),e},w=document.createElement("canvas");w.width=200,w.height=160;var C=w.getContext("2d"),x=function(){var e=u.firstChild.getBoundingClientRect();w.width=e.width-14,E()},E=function(){var e=C.createLinearGradient(0,0,w.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),C.fillStyle=e,C.fillRect(0,0,w.width,w.height),(e=C.createLinearGradient(0,0,0,w.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),C.fillStyle=e,C.fillRect(0,0,w.width,w.height)},j=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(w),n.appendChild(t),e.appendChild(n);var r=function(n,r,o){if(1===n){var i=e.getBoundingClientRect(),s=r-i.left,a=o-i.top;s<0&&(s=0),a<0&&(a=0),s>i.width&&(s=i.width),a>i.height&&(a=i.height),t.style.left=s+"px",t.style.top=a+"px";var l=C.getImageData(s,a,1,1).data;L=h(l[0],l[1],l[2])}};return e.addEventListener("mousedown",function(e){r(e.buttons,e.clientX,e.clientY)}),e.addEventListener("mousemove",function(e){r(e.buttons,e.clientX,e.clientY)}),e.addEventListener("touchmove",function(e){r(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}),e},L="",A=[],M=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var r=document.createElement("label");r.innerText=e;var o=document.createElement("div");o.className="jcolor-sliders-input-subcontainer";var i=document.createElement("input");i.type="range",i.min=0,i.max=255,i.value=0,i.setAttribute("aria-label","Color value"),i.setAttribute("aria-valuemin","0"),i.setAttribute("aria-valuemax","255"),i.setAttribute("aria-valuenow","0"),n.appendChild(r),o.appendChild(i);var s=document.createElement("div");return s.innerText=i.value,i.addEventListener("input",function(){s.innerText=i.value}),o.appendChild(s),n.appendChild(o),t.appendChild(n),i};A=[n("Red"),n("Green"),n("Blue")],e.appendChild(t);var r=document.createElement("div");r.className="jcolor-sliders-final-color";var o=document.createElement("div");o.style.visibility="hidden",o.innerText="a",r.appendChild(o);return A.forEach(function(e){e.addEventListener("input",function(){var e;e=h(parseInt(A[0].value),parseInt(A[1].value),parseInt(A[2].value)),o.innerText=e,o.style.color=e,o.style.removeProperty("visibility"),L=e,function(){if(""!==L)for(var e=0;e<A.length;e++){var t=g(L);t[e]=0;var n="linear-gradient(90deg, rgb(";n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",A[e].style.backgroundImage=n}}()})}),e.appendChild(r),e};return r.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};if(e)return/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&e.length?"#"+t(e[1])+t(e[2])+t(e[3]):""},function(){r.setOptions(t),"INPUT"==e.tagName&&(e.classList.add("jcolor-input"),e.readOnly=!0),(o=document.createElement("div")).className="jcolor",(i=document.createElement("div")).className="jcolor-backdrop",o.appendChild(i),(a=document.createElement("div")).className="jcolor-content";var n=document.createElement("div");n.className="jcolor-controls",a.appendChild(n),(l=document.createElement("div")).className="jcolor-reset",l.innerHTML=r.options.resetLabel,n.appendChild(l),(c=document.createElement("div")).className="jcolor-close",c.innerHTML=r.options.doneLabel,n.appendChild(c),u=document.createElement("div"),a.appendChild(u),d=b(u,{animation:!0,data:[{title:"Grid",contentElement:y()},{title:"Spectrum",contentElement:j()},{title:"Sliders",contentElement:M()}],onchange:function(e,t,n){if(1===n)x();else{var o=""!==L?L:r.getValue();if(2===n&&o){var i=g(o);A.forEach(function(e,t){e.value=i[t],e.dispatchEvent(new Event("input"))})}}},palette:"modern"}),o.appendChild(a),"INPUT"==e.tagName?e.parentNode.insertBefore(o,e.nextSibling):e.appendChild(o),o.addEventListener("click",function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&r.setValue(t)}else e.target.classList.contains("jcolor-reset")?(r.setValue(""),r.close()):e.target.classList.contains("jcolor-close")?(d.getActive()>0&&r.setValue(L),r.close()):e.target.classList.contains("jcolor-backdrop")?r.close():r.open()}),e.addEventListener("mouseup",function(e){r.open()}),window.addEventListener("resize",function(){o.classList.contains("jcolor-focus")&&1==d.getActive()&&x()}),1==r.options.opened&&r.open(),e.change=r.setValue,e.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},e.color=r,o.color=r}(),r}var C=function(){var t=function(r,o){var i={type:"contextmenu",options:{}},s={items:null,onclick:null};for(var a in s)o&&o.hasOwnProperty(a)?i.options[a]=o[a]:i.options[a]=s[a];function l(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){c=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&c.setAttribute("title",e.tooltip),e.icon&&c.setAttribute("data-icon",e.icon),e.id&&(c.id=e.id),e.disabled?c.className="jcontextmenu-disabled":e.onclick&&(c.method=e.onclick,c.addEventListener("mousedown",function(e){e.preventDefault()}),c.addEventListener("mouseup",function(e){this.method(this,e)})),c.appendChild(t),e.submenu){var n=document.createElement("span");n.innerHTML="&#9658;",c.appendChild(n),c.classList.add("jcontexthassubmenu");var r=document.createElement("div");r.classList.add("jcontextmenu"),r.setAttribute("tabindex","900");for(var o=e.submenu,i=0;i<o.length;i++){var s=l(o[i]);r.appendChild(s)}c.appendChild(r)}else if(e.shortcut){var a=document.createElement("span");a.innerHTML=e.shortcut,c.appendChild(a)}}else var c=document.createElement("hr");return c}return r.classList.add("jcontextmenu"),i.open=function(e,o){if(o&&(i.options.items=o,i.create(o)),t.current&&t.current.close(),n(i,!0),r.classList.add("jcontextmenu-focus"),t.current=i,i.options.items&&i.options.items.length>0||r.children.length){if(e.target)if(e.changedTouches&&e.changedTouches[0])s=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY;else var s=e.clientX,a=e.clientY;else s=e.x,a=e.y;var l=r.getBoundingClientRect();if(window.innerHeight<a+l.height){var c=a-l.height;c<0&&(c=0),r.style.top=c+"px"}else r.style.top=a+"px";window.innerWidth<s+l.width?s-l.width>0?r.style.left=s-l.width+"px":r.style.left="10px":r.style.left=s+"px"}},i.isOpened=function(){return!!r.classList.contains("jcontextmenu-focus")},i.close=function(){r.classList.contains("jcontextmenu-focus")&&r.classList.remove("jcontextmenu-focus"),n(i,!1)},i.create=function(t){r.innerHTML="";var n=function(){var t=document.createElement("div");t.classList.add("header"),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()});var n=document.createElement("a");n.classList.add("title"),n.innerHTML=e.translate("Menu"),t.appendChild(n);var r=document.createElement("a");return r.classList.add("close"),r.innerHTML=e.translate("close"),r.addEventListener("click",function(e){i.close()}),t.appendChild(r),t}();r.appendChild(n);for(var o=0;o<t.length;o++){var s=l(t[o]);r.appendChild(s)}},"function"==typeof i.options.onclick&&r.addEventListener("click",function(e){i.options.onclick(i,e)}),i.options.items&&i.create(i.options.items),window.addEventListener("mousewheel",function(){i.close()}),r.contextmenu=i,i};return t}();var E=function(){var t=function(r,o){if(r.dropdown)return r.dropdown.setOptions(o,!0);var i={type:"dropdown",options:{}},a=function(e,t){e&&e.length&&(!1!==i.options.sortResults&&("function"==typeof i.options.sortResults?e.sort(i.options.sortResults):e.sort(l)),i.setData(e)),"function"==typeof i.options.onload&&i.options.onload(r,i,e,t),t&&d(t),null==t&&(i.options.value=""),r.value=i.options.value,1==i.options.opened&&i.open()},l=function(e,t){var n,r;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?r=t:t.text?r=t.text:t.name&&(r=t.name),"string"==typeof n||"string"==typeof r?("string"!=typeof n&&(n=""+n),"string"!=typeof r&&(r=""+r),n.localeCompare(r)):n-r},c=function(){i.value={};for(var e=0;e<i.items.length;e++)1==i.items[e].selected&&(i.items[e].element&&i.items[e].element.classList.remove("jdropdown-selected"),i.items[e].selected=null);i.options.value="",r.value=""},d=function(e){if(c(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)i.value[e[t]]=""}else void 0!==i.value[""]&&(i.value[""]="");for(t=0;t<i.items.length;t++)void 0!==i.value[h(t)]&&(i.items[t].element&&i.items[t].element.classList.add("jdropdown-selected"),i.items[t].selected=!0,i.value[h(t)]=m(t));i.options.value=Object.keys(i.value).join(";"),i.header.value=i.getText()},h=function(e,t){if(i.options.format)n="id";else var n="value";return i.items[e]?void 0!==t?i.items[e].data[n]=t:i.items[e].data[n]:""},m=function(e,t){if(i.options.format)n="name";else var n="text";return i.items[e]?void 0!==t?i.items[e].data[n]=t:i.items[e].data[n]:""},g=function(){return Object.keys(i.value)},v=function(){for(var e=[],t=Object.keys(i.value),n=0;n<t.length;n++)e.push(i.value[t[n]]);return e};i.setOptions=function(e,t){e||(e={});var n={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var o in n)e&&e.hasOwnProperty(o)?i.options[o]=e[o]:void 0!==i.options[o]&&!0!==t||(i.options[o]=n[o]);return 1!=i.options.remoteSearch&&"searchbar"!==i.options.type||(i.options.autocomplete=!0),1==i.options.newOptions?i.header.classList.add("jdropdown-add"):i.header.classList.remove("jdropdown-add"),1==i.options.autocomplete?i.header.removeAttribute("readonly"):i.header.setAttribute("readonly","readonly"),i.options.placeholder?i.header.setAttribute("placeholder",i.options.placeholder):i.header.removeAttribute("placeholder"),r.classList.remove("jdropdown-searchbar"),r.classList.remove("jdropdown-picker"),r.classList.remove("jdropdown-list"),"searchbar"==i.options.type?r.classList.add("jdropdown-searchbar"):"list"==i.options.type?r.classList.add("jdropdown-list"):"picker"==i.options.type?r.classList.add("jdropdown-picker"):s.getWindowWidth()<800?i.options.autocomplete?(r.classList.add("jdropdown-searchbar"),i.options.type="searchbar"):(r.classList.add("jdropdown-picker"),i.options.type="picker"):(i.options.width?(r.style.width=i.options.width,r.style.minWidth=i.options.width):(r.style.removeProperty("width"),r.style.removeProperty("min-width")),r.classList.add("jdropdown-default"),i.options.type="default"),"searchbar"==i.options.type?y.appendChild(C):b.insertBefore(C,b.firstChild),i.options.url&&!e.data?p({url:i.options.url,method:"GET",dataType:"json",success:function(e){e&&a(e,i.options.value)}}):a(i.options.data,i.options.value),i};var y=null,b=null,w=null,C=null,x=null,E=null,j=null;i.getUrl=function(){return i.options.url},i.setUrl=function(e,t){i.options.url=e,p({url:i.options.url,method:"GET",dataType:"json",success:function(e){i.setData(e),"function"==typeof t&&t(i)}})},i.setId=function(e,t){if(i.options.format)n="id";else var n="value";"object"==typeof e?e[n]=t:i.items[e].data[n]=t};const L=function(t,n){if(!t){let n=1==i.options.autocomplete?i.header.value:"";if(!(t=prompt(e.translate("Add A New Option"),n)))return!1}if(n||(n=s.guid()),i.options.format)r={id:n,name:t};else var r={value:n,text:t};if("function"==typeof i.options.onbeforeinsert){let e=i.options.onbeforeinsert(i,r);if(!1===e)return!1;e&&(r=e)}i.options.data.push(r);var o=i.createItem(r);return w.appendChild(o.element),"function"==typeof i.options.oninsert&&i.options.oninsert(i,r,o),"none"==w.style.display&&(w.style.display=""),i.results&&i.results.push(o),r};i.add=function(e,t){return"function"==typeof i.options.prompt?i.options.prompt.call(i,L):L(e,t)},i.createItem=function(e,t,n){i.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var r={};if(r.element=document.createElement("div"),r.element.className="jdropdown-item",r.element.indexValue=i.items.length,r.data=e,t&&(r.group=t),e.id&&r.element.setAttribute("id",e.id),1==e.disabled&&r.element.setAttribute("data-disabled",!0),e.tooltip&&r.element.setAttribute("title",e.tooltip),e.image){var o=document.createElement("img");o.className="jdropdown-image",o.src=e.image,e.title||o.classList.add("jdropdown-image-small"),r.element.appendChild(o)}else if(e.icon){var s=document.createElement("span");s.className="jdropdown-icon material-icons",s.innerText=e.icon,e.title||s.classList.add("jdropdown-icon-small"),e.color&&(s.style.color=e.color),r.element.appendChild(s)}else if(e.color){var a=document.createElement("div");a.className="jdropdown-color",a.style.backgroundColor=e.color,r.element.appendChild(a)}if(i.options.format)l=e.name;else var l=e.text;var c=document.createElement("div");if(c.className="jdropdown-description",c.textContent=l||"&nbsp;",e.title){var u=document.createElement("div");u.className="jdropdown-title",u.innerText=e.title,c.appendChild(u)}if(i.options.format)d=e.id;else var d=e.value;return i.value[d]&&(r.element.classList.add("jdropdown-selected"),r.selected=!0),i.items.push(r),r.element.appendChild(c),r},i.appendData=function(e){if(e.length){for(var t=[],n=[],r=0;r<e.length;r++)e[r].group?(n[e[r].group]||(n[e[r].group]=[]),n[e[r].group].push(r)):t.push(r);var o=0,s=Object.keys(n);if(s.length>0)for(r=0;r<s.length;r++){var a=document.createElement("div");a.className="jdropdown-group";var l=document.createElement("div");l.className="jdropdown-group-name",l.textContent=s[r];var c=document.createElement("i");c.className="jdropdown-group-arrow jdropdown-group-arrow-down",l.appendChild(c);var u=document.createElement("div");u.className="jdropdown-group-items";for(var d=0;d<n[s[r]].length;d++){var p=i.createItem(e[n[s[r]][d]],a,s[r]);(0==i.options.lazyLoading||o<200)&&(u.appendChild(p.element),o++)}a.appendChild(l),a.appendChild(u),i.groups.push(a),u.children.length>0&&w.appendChild(a)}if(t.length)for(r=0;r<t.length;r++)p=i.createItem(e[t[r]]),(0==i.options.lazyLoading||o<200)&&(w.appendChild(p.element),o++)}},i.setData=function(e){if(c(),w.textContent="",i.header.value="",i.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(i.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});i.appendData(e),i.options.data=e}else i.options.data=[];i.close()},i.getData=function(){return i.options.data},i.getPosition=function(e){for(var t=0;t<i.items.length;t++)if(h(t)==e)return t;return!1},i.getText=function(e){var t=v();return e?t:t.join("; ")},i.getValue=function(e){var t=g();return e?t:t.join(";")};var A=function(e){r.value!=i.options.value&&(r.value=i.options.value,"function"==typeof r.oninput&&r.oninput({type:"input",target:r,value:r.value})),"function"==typeof i.options.onchange&&i.options.onchange(r,i,e,i.options.value)};i.setValue=function(e){var t=i.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(d(e),A(t))},i.resetSelected=function(){i.setValue(null)},i.selectIndex=function(e,t){if(e=parseInt(e),i.items&&i.items[e]&&(!0===t||!0!==i.items[e].data.disabled))if(i.setCursor(e,!1),i.options.multiple){var n=i.options.value;i.items[e].selected?(i.items[e].element.classList.remove("jdropdown-selected"),i.items[e].selected=!1,delete i.value[h(e)]):(i.items[e].element.classList.add("jdropdown-selected"),i.items[e].selected=!0,i.value[h(e)]=m(e)),i.options.value=Object.keys(i.value).join(";"),0==i.options.autocomplete&&(i.header.value=v().join("; ")),A(n)}else i.items[e].selected?!1!==i.options.allowEmpty&&i.setValue(null):i.setValue(h(e)),i.close()},i.selectItem=function(e){i.selectIndex(e.indexValue)};var M=function(e,t){for(var n=0;n<t.length;n++)if(i.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1};return i.find=function(e){if(i.search==e.trim())return!1;if(i.search=e,i.setCursor(),i.groups.length)for(var t=0;t<i.groups.length;t++)i.groups[t].lastChild.textContent="";if(w.textContent="",1==i.options.remoteSearch){i.results=null;let t={url:i.options.url,method:"GET",data:{q:e},dataType:"json",success:function(e){i.items=[];var t=Object.keys(i.value);if(t.length)for(var n=0;n<t.length;n++)M(t[n],e)||(i.options.format?e.unshift({id:t[n],name:i.value[t[n]]}):e.unshift({value:t[n],text:i.value[t[n]]}));i.appendData(e),e.length?w.style.display="":w.style.display="none","function"==typeof i.options.onsearch&&i.options.onsearch(i,e)}};if("function"==typeof i.options.onbeforesearch){let e=i.options.onbeforesearch(i,t);if(!1===e)return;"object"==typeof e&&(t=e)}p(t)}else{e=new RegExp(e,"gi");var n=[];for(t=0;t<i.items.length;t++){var r=m(t),o=i.items[t].data.title||"",s=i.items[t].data.group||"",a=i.items[t].data.synonym||"";a&&(a=a.join(" ")),(null==e||1==i.items[t].selected||r.toString().match(e)||o.match(e)||s.match(e)||a.match(e))&&n.push(i.items[t])}if(n.length){w.style.display="",i.results=n;var l=n.length||0;for(1==i.options.lazyLoading&&l>200&&(l=200),t=0;t<l;t++)i.results[t].group?(i.results[t].group.parentNode||w.appendChild(i.results[t].group),i.results[t].group.lastChild.appendChild(i.results[t].element)):w.appendChild(i.results[t].element)}else w.style.display="none",i.results=null}1==i.options.autofocus&&i.first()},i.open=function(){if(!r.classList.contains("jdropdown-focus")){t.current=i,n(i,!0),r.classList.add("jdropdown-focus"),s.getWindowWidth()<800&&(null!=i.options.type&&"picker"!=i.options.type||f.slideBottom(b,1)),1==i.options.autocomplete&&(i.header.value=i.search,i.header.focus());var e=g();if(e[0]){var o=i.getPosition(e[0]);!1!==o&&i.setCursor(o)}if(!i.options.type||"default"==i.options.type){var a=r.getBoundingClientRect(),l=b.getBoundingClientRect();i.options.position?(b.style.position="fixed",window.innerHeight<a.bottom+l.height?(b.style.top="",b.style.bottom=window.innerHeight-a.top+1+"px"):(b.style.top=a.bottom+"px",b.style.bottom=""),b.style.left=a.left+"px"):window.innerHeight<a.bottom+l.height?(b.style.top="",b.style.bottom=a.height+1+"px"):(b.style.top="",b.style.bottom=""),b.style.minWidth=a.width+"px",i.options.maxWidth&&(b.style.maxWidth=i.options.maxWidth),i.items.length||1!=i.options.autocomplete?w.style.display="":w.style.display="none"}}"function"==typeof i.options.onopen&&i.options.onopen(r)},i.close=function(e){return r.classList.contains("jdropdown-focus")&&(i.header.value=i.getText(),i.setCursor(),e||"function"!=typeof i.options.onclose||i.options.onclose(r),i.header.blur&&i.header.blur(),r.classList.remove("jdropdown-focus"),n(i,!1),t.current=null),i.getValue()},i.setCursor=function(e,t){if(null!=i.currentIndex&&i.items&&i.items[i.currentIndex]&&i.items[i.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)i.currentIndex=null;else if(e=parseInt(e),i.items[e].element.parentNode&&(i.items[e].element.classList.add("jdropdown-cursor"),i.currentIndex=e,!1!==t&&i.items[i.currentIndex].element)){w.scrollTop;var n=i.items[i.currentIndex].element;w.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},i.resetCursor=i.setCursor,i.updateCursor=i.setCursor,i.reset=function(){i.setCursor(),i.setValue(null)},i.first=function(){!0===i.options.lazyLoading&&i.loadFirst();var e=w.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;i.setCursor(t)}},i.last=function(){!0===i.options.lazyLoading&&i.loadLast();var e=w.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;i.setCursor(t)}},i.next=function(e){var t=null;if(e){if(1==e.length){var n=i.currentIndex||-1;e=e.toLowerCase();var r=null,o=null,s=w.querySelectorAll(".jdropdown-item");if(s.length){for(var a=0;a<s.length;a++)if(s[a].indexValue>n&&(r=i.items[s[a].indexValue])&&(o=r.element.innerText[0])&&e==(o=o.toLowerCase())){t=s[a].indexValue;break}i.setCursor(t)}}}else if(null==i.currentIndex||null==i.currentIndex)i.first();else{var l=i.items[i.currentIndex].element,c=l.nextElementSibling;c?(c.classList.contains("jdropdown-group")&&(c=c.lastChild.firstChild),t=c.indexValue):l.parentNode.classList.contains("jdropdown-group-items")&&((c=l.parentNode.parentNode.nextElementSibling)&&(c.classList.contains("jdropdown-group")?c=c.lastChild.firstChild:c.classList.contains("jdropdown-item")?t=c.indexValue:c=null),c&&(t=c.indexValue)),null!==t&&i.setCursor(t)}},i.prev=function(){var e=null;if(null===i.currentIndex)i.first();else{var t=i.items[i.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&i.setCursor(e)},i.loadFirst=function(){if(i.results)var e=i.results;else e=i.items;var t=e.length||0;1==i.options.lazyLoading&&t>200&&(t=200),w.textContent="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||w.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):w.appendChild(e[n].element);w.scrollTop=0},i.loadLast=function(){if(i.results)var e=i.results;else e=i.items;var t=e.length;if(t>200){t-=200,w.textContent="";for(var n=t;n<e.length;n++)e[n].group?(e[n].group.parentNode||w.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):w.appendChild(e[n].element);w.scrollTop=w.scrollHeight}},i.loadUp=function(){var e=!1;if(i.results)var t=i.results;else t=i.items;var n=w.querySelectorAll(".jdropdown-item")[0].indexValue;n=i.items[n];var r=t.indexOf(n)-1;if(r>0){for(var o=0;r>0&&t[r]&&o<200;)t[r].group?(t[r].group.parentNode||w.insertBefore(t[r].group,w.firstChild),t[r].group.lastChild.insertBefore(t[r].element,t[r].group.lastChild.firstChild)):w.insertBefore(t[r].element,w.firstChild),r--,o++;e=!0}return e},i.loadDown=function(){var e=!1;if(i.results)var t=i.results;else t=i.items;var n=w.querySelectorAll(".jdropdown-item"),r=n[n.length-1].indexValue;r=i.items[r];var o=t.indexOf(r)+1;if(o<t.length){for(var s=0;o<t.length&&t[o]&&s<200;)t[o].group?(t[o].group.parentNode||w.appendChild(t[o].group),t[o].group.lastChild.appendChild(t[o].element)):w.appendChild(t[o].element),o++,s++;e=!0}return e},function(){if(o||(o={}),"SELECT"==r.tagName){var e=t.extractFromDom(r,o);r=e.el,o=e.options}!o.placeholder&&r.getAttribute("placeholder")&&(o.placeholder=r.getAttribute("placeholder")),i.value={},i.items=[],i.groups=[],i.search="",i.results=null,r.classList.add("jdropdown"),(y=document.createElement("div")).className="jdropdown-container-header",i.header=document.createElement("input"),i.header.className="jdropdown-header jss_object",i.header.type="text",i.header.setAttribute("autocomplete","off"),i.header.onfocus=function(){"function"==typeof i.options.onfocus&&i.options.onfocus(r)},i.header.onblur=function(){"function"==typeof i.options.onblur&&i.options.onblur(r)},i.header.onkeyup=function(e){1!=i.options.autocomplete||j?i.options.autocomplete||i.next(e.key):(i.search!=i.header.value.trim()&&(j=setTimeout(function(){i.find(i.header.value.trim()),j=null},400)),r.classList.contains("jdropdown-focus")||i.open())},t.hasEvents||(t.hasEvents=!0,document.addEventListener("keydown",t.keydown)),(b=document.createElement("div")).className="jdropdown-container",(w=document.createElement("div")).className="jdropdown-content",(C=document.createElement("div")).className="jdropdown-close",C.textContent="Done",(x=document.createElement("div")).className="jdropdown-reset",x.textContent="x",x.onclick=function(){i.reset(),i.close()},(E=document.createElement("div")).className="jdropdown-backdrop",y.appendChild(i.header),b.appendChild(w),r.appendChild(y),r.appendChild(b),r.appendChild(E),i.setOptions(o),"ontouchsend"in document.documentElement==1?r.addEventListener("touchsend",t.mouseup):r.addEventListener("mouseup",t.mouseup),1==i.options.lazyLoading&&u(w,{loadUp:i.loadUp,loadDown:i.loadDown}),w.onwheel=function(e){e.stopPropagation()},r.change=i.setValue,r.val=function(e){if(void 0===e)return i.getValue(!!i.options.multiple);i.setValue(e)},r.dropdown=i}(),i};return t.keydown=function(e){var n=null;if(n=t.current)if(13==e.which||9==e.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==e.which)null==n.currentIndex?n.first():n.currentIndex>0&&n.prev(),e.preventDefault();else if(40==e.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),e.preventDefault();else if(36==e.which)n.first(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(35==e.which)n.last(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(27==e.which)n.close();else if(33==e.which){if(null==n.currentIndex)n.first();else if(n.currentIndex>0)for(var r=0;r<7;r++)n.prev();e.preventDefault()}else if(34==e.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(r=0;r<7;r++)n.next();e.preventDefault()}},t.mouseup=function(e){var t=s.findElement(e.target,"jdropdown");if(t){var n=t.dropdown;if(e.target.classList.contains("jdropdown-header"))if(t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")){var r=t.getBoundingClientRect();if(e.changedTouches&&e.changedTouches[0]){var o=e.changedTouches[0].clientX;e.changedTouches[0].clientY}else o=e.clientX,e.clientY;r.width-(o-r.left)<30?e.target.classList.contains("jdropdown-add")?n.add():n.close():0==n.options.autocomplete&&n.close()}else n.open();else if(e.target.classList.contains("jdropdown-group-name")){var i=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var a=0;a<i.length;a++)"none"!=i[a].style.display&&n.selectItem(i[a])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?n.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?n.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?n.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&n.close()}},t.extractFromDom=function(e,t){var n=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var r=0;r<e.children.length;r++)if("OPTGROUP"==e.children[r].tagName)for(var o=0;o<e.children[r].children.length;o++)t.data.push({value:e.children[r].children[o].value,text:e.children[r].children[o].textContent,group:e.children[r].getAttribute("label")});else t.data.push({value:e.children[r].value,text:e.children[r].textContent})}t&&null!=t.onchange||(t.onchange=function(e,r,o,i){1==t.multiple?obj.items[r].classList.contains("jdropdown-selected")?n.options[r].setAttribute("selected","selected"):n.options[r].removeAttribute("selected"):n.value=i});var i=document.createElement("div");return e.parentNode.insertBefore(i,e),e.style.display="none",{el:e=i,options:t}},t}();function j(e,t){if(e.picker)return e.picker.setOptions(t,!0);var r={type:"picker",options:{}},o=null,i=null,a=function(e){return e instanceof Element||e instanceof HTMLDocument};return r.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};for(var s in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(s)?r.options[s]=e[s]:void 0!==r.options[s]&&!0!==t||(r.options[s]=n[s]);return!1===r.options.header?o.style.display="none":o.style.display="",r.options.width?o.style.width=parseInt(r.options.width)+"px":o.style.width="",r.options.height?(i.style.maxHeight=r.options.height+"px",i.style.overflow="scroll"):i.style.overflow="",r.options.columns>0&&(r.options.grid?(i.classList.add("jpicker-grid"),i.style.gridTemplateColumns="repeat("+r.options.grid+", 1fr)"):(i.classList.add("jpicker-columns"),i.style.width=r.options.width?r.options.width:36*r.options.columns+"px")),isNaN(parseInt(r.options.value))&&(r.options.value=0),function(){i.innerHTML="";for(var e=Object.keys(r.options.data),t=0;t<e.length;t++){var n=document.createElement("div");n.classList.add("jpicker-item"),n.setAttribute("role","option"),n.k=e[t],n.v=r.options.data[e[t]];var o=r.getLabel(e[t],n);a(o)?n.appendChild(o):n.innerHTML=o,i.appendChild(n)}}(),r.setValue(r.options.value),r},r.getValue=function(){return r.options.value},r.setValue=function(t,n){if(r.setLabel(t),r.options.value=String(t),e.value!=r.options.value&&(e.value=r.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),i.children[t]&&"generic"!==i.children[t].getAttribute("type")&&r.close(),n&&"function"==typeof r.options.onchange){var o=r.options.data[t];r.options.onchange(e,r,o,o,t,n)}},r.getLabel=function(e,t){var n=r.options.data[e]||null;return"function"==typeof r.options.render&&(n=r.options.render(n,t)),n},r.setLabel=function(e){var t;t=r.options.content?'<i class="material-icons">'+r.options.content+"</i>":r.getLabel(e,null),a(t)?(o.innerHTML="",o.appendChild(t)):o.innerHTML=t},r.open=function(){if(!e.classList.contains("jpicker-focus")){n(r,!0),e.classList.add("jpicker-focus"),e.focus();var t,s=0;i.style.marginLeft="";var a=o.getBoundingClientRect(),l=i.getBoundingClientRect();t=window.innerHeight<a.bottom+l.height||r.options.bottom?-1*(l.height+4):a.height+4,!0===r.options.right&&(s=-1*l.width+a.width),l.left+s<0&&(s=s+l.left+10),l.left+l.width>window.innerWidth&&(s=-1*(10+l.left+l.width-window.innerWidth)),i.style.marginTop=parseInt(t)+"px",i.style.marginLeft=parseInt(s)+"px","function"==typeof r.options.onopen&&r.options.onopen(e,r)}},r.close=function(){e.classList.contains("jpicker-focus")&&(e.classList.remove("jpicker-focus"),n(r,!1),"function"==typeof r.options.onclose&&r.options.onclose(e,r))},function(){let n=s.guid();e.classList.add("jpicker"),e.setAttribute("role","combobox"),e.setAttribute("aria-haspopup","listbox"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-controls",n),e.setAttribute("tabindex","0"),e.onmousedown=function(t){e.classList.contains("jpicker-focus")||r.open()},(o=document.createElement("div")).classList.add("jpicker-header"),(i=document.createElement("div")).setAttribute("id",n),i.setAttribute("role","listbox"),i.classList.add("jpicker-content"),i.onclick=function(e){var t=s.findElement(e.target,"jpicker-item");t&&t.parentNode===i&&r.setValue(t.k,e)},e.appendChild(o),e.appendChild(i),e.value=t.value||0,r.setOptions(t),"function"==typeof r.options.onload&&r.options.onload(e,r),e.change=r.setValue,e.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},e.picker=r}(),r}function L(e,t){var r={type:"toolbar",options:{}},o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var i in o)t&&t.hasOwnProperty(i)?r.options[i]=t[i]:r.options[i]=o[i];!e&&t.app&&t.app.el&&(e=document.createElement("div"),t.app.el.appendChild(e));var a=document.createElement("div");a.classList.add("jtoolbar-item"),a.classList.add("jtoolbar-arrow");var l=document.createElement("div");l.classList.add("jtoolbar-floating"),a.appendChild(l),r.selectItem=function(e){for(var t=c.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},r.hide=function(){f.slideBottom(e,0,function(){e.style.display="none"})},r.show=function(){e.style.display="",f.slideBottom(e,1)},r.get=function(){return e},r.setBadge=function(e,t){c.children[e].children[1].firstChild.innerHTML=t},r.destroy=function(){toolbar.remove(),e.innerHTML=""},r.update=function(t,n){for(var o=0;o<c.children.length;o++)"function"==typeof(i=c.children[o]).updateState&&i.updateState(e,r,i,t,n);for(o=0;o<l.children.length;o++){var i;"function"==typeof(i=l.children[o]).updateState&&i.updateState(e,r,i,t,n)}},r.create=function(t){c.innerHTML="";for(var n=0;n<t.length;n++){var o=document.createElement("div");if(o.classList.add("jtoolbar-item"),t[n].width&&(o.style.width=parseInt(t[n].width)+"px"),t[n].k&&(o.k=t[n].k),t[n].tooltip&&(o.setAttribute("title",t[n].tooltip),o.setAttribute("aria-label",t[n].tooltip)),t[n].id&&o.setAttribute("id",t[n].id),t[n].updateState&&(o.updateState=t[n].updateState),t[n].active&&o.classList.add("jtoolbar-active"),t[n].disabled&&o.classList.add("jtoolbar-disabled"),"select"==t[n].type||"dropdown"==t[n].type)j(o,t[n]);else if("divisor"==t[n].type)o.classList.add("jtoolbar-divisor");else if("label"==t[n].type)o.classList.add("jtoolbar-label"),o.innerHTML=t[n].content;else{var i=document.createElement("i");if(void 0===t[n].class)i.classList.add("material-icons");else for(var s=t[n].class.split(" "),a=0;a<s.length;a++)i.classList.add(s[a]);if(i.innerHTML=t[n].content?t[n].content:"",o.setAttribute("role","button"),o.appendChild(i),1==r.options.badge){var l=document.createElement("div");l.classList.add("jbadge");var u=document.createElement("div");u.innerHTML=t[n].badge?t[n].badge:"",l.appendChild(u),o.appendChild(l)}if(t[n].title)if(1==r.options.title){var d=document.createElement("span");d.innerHTML=t[n].title,o.appendChild(d)}else o.setAttribute("title",t[n].title);r.options.app&&t[n].route&&(o.route=t[n].route,o.onclick=function(){r.options.app.pages(this.route)},r.options.app.pages(t[n].route,{toolbarItem:o,closed:!0})),"function"==typeof t[n].render&&t[n].render(o,t[n])}t[n].onclick&&(o.onclick=t[n].onclick.bind(t[n],e,r,o)),c.appendChild(o)}setTimeout(function(){r.refresh()},0)},r.open=function(){a.classList.add("jtoolbar-arrow-selected"),e.getBoundingClientRect(),l.getBoundingClientRect().bottom>window.innerHeight||r.options.bottom?l.style.bottom="0":l.style.removeProperty("bottom"),l.style.right="0",a.children[0].focus(),n(r,!0)},r.close=function(){a.classList.remove("jtoolbar-arrow-selected"),n(r,!1)},r.refresh=function(){if(1==r.options.responsive){var t=e.parentNode.getBoundingClientRect();r.options.maxWidth||(r.options.maxWidth=t.width);var n=parseInt(r.options.maxWidth);for(a.parentNode&&a.parentNode.removeChild(a);l.firstChild;)c.appendChild(l.firstChild);if(n<c.offsetWidth)for(n-=50;c.lastChild&&n<c.offsetWidth;)l.insertBefore(c.lastChild,l.firstChild);l.children.length>0&&c.appendChild(a)}},r.setReadonly=function(t){t=t?"add":"remove",e.classList[t]("jtoolbar-disabled")},e.onclick=function(e){var t=s.findElement(e.target,"jtoolbar-item");t&&r.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&r.open()},window.addEventListener("resize",function(){r.refresh()}),e.classList.add("jtoolbar"),e.innerHTML="",1==r.options.container&&e.classList.add("jtoolbar-container");var c=document.createElement("div");return e.appendChild(c),r.options.app&&e.classList.add("jtoolbar-mobile"),r.create(r.options.items),e.toolbar=r,r}var A=function(){var e=function(t,n){var r={type:"editor",options:{}},o={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];var a=null,l=null,c=[];r.el=t,"function"==typeof r.options.onclick&&(t.onclick=function(e){r.options.onclick(t,r,e)}),t.classList.add("jeditor-container");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var d=document.createElement("div");if(d.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)p({url:r.options.url,dataType:"html",success:function(t){r.editor.innerHTML=t,e.setCursor(r.editor,"initial"==r.options.focus)}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var f=0;f<t.children.length;f++)r.editor.appendChild(t.children[f]);t.innerHTML="";var h=function(e){"function"==typeof r.options.onchange&&r.options.onchange(t,r,e),r.options.value=r.getData(),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},m=function(){var e=null;if(e=u.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}};r.appendSnippet=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var o=document.createElement("div");if(o.className="jsnippet-"+t[n],o.setAttribute("data-k",t[n]),u.appendChild(o),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var i=0;i<e.image.length;i++){var s=document.createElement("img");s.src=e.image[i],o.appendChild(s)}}else o.innerHTML=e[t[n]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(u)},r.setData=function(t){r.editor.innerHTML="object"==typeof t?t.content:t,r.options.focus&&e.setCursor(r.editor,!0),c=[]},r.getFiles=function(){for(var e=r.editor.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)c[e[n].src]&&t.push(c[e[n].src]);return t},r.getText=function(){return r.editor.innerText},r.getData=function(e){if(e){if(d={content:""},u.innerHTML){d.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n){d.snippet.image||(d.snippet.image=[]);for(var o=0;o<u.children[t].children.length;o++)d.snippet.image.push(u.children[t].children[o].getAttribute("src"))}else d.snippet[n]=u.children[t].innerHTML}}var i=Object.keys(c);if(i.length)for(d.files=[],t=0;t<i.length;t++)d.files.push(c[i[t]]);var s=document.createElement("div");s.innerHTML=r.editor.innerHTML;var a=s.querySelector(".jsnippet");a&&a.remove();var l=s.innerHTML;l=(l=(l=l.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),d.content=l.trim(),S("getData",d)}else var d=r.editor.innerHTML;return d},r.reset=function(){r.editor.innerHTML="",u.innerHTML="",c=[]},r.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob(function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",c[n.src]={file:n.src,extension:"pdf",content:e.result},document.execCommand("insertHtml",!1,n.outerHTML)})}},r.addImage=function(e,t){if(r.options.acceptImages)if(e||(e=""),"data"==e.substr(0,4)||r.options.remoteParser){if("data"==e.substr(0,4))n=(n=(n=e.split(";"))[0].split("/"))[1];else{var n=e.substr(e.lastIndexOf(".")+1);e=r.options.remoteParser+e}var o=new Image;o.onload=function(){var e=document.createElement("canvas");e.width=o.width,e.height=o.height,e.getContext("2d").drawImage(o,0,0,e.width,e.height),e.toBlob(function(i){var s,a=document.createElement("img");a.src=window.URL.createObjectURL(i),a.classList.add("jfile"),a.setAttribute("tabindex","900"),a.setAttribute("width",o.width),a.setAttribute("height",o.height),c[a.src]={file:a.src,extension:n,content:e.toDataURL()},r.options.dropAsSnippet||t?(s=a,u.innerHTML||r.appendSnippet({}),u.children[0].appendChild(s),m(),c[a.src].snippet=!0):document.execCommand("insertHtml",!1,a.outerHTML),h()})},o.src=e}else console.error("remoteParser not defined in your initialization")},r.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>r.options.maxFileSize)alert("The file is too big");else{var o=e[n].type.split("/");(o="image"==o[0]?1:"pdf"==o[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=o,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",function(e){2==e.target.type?1==r.options.acceptFiles&&r.addPdf(e.target):r.addImage(e.target.result)},!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",N),r.editor.removeEventListener("mousedown",D),r.editor.removeEventListener("mousemove",O),r.editor.removeEventListener("keyup",T),r.editor.removeEventListener("keydown",_),r.editor.removeEventListener("dragstart",x),r.editor.removeEventListener("dragenter",E),r.editor.removeEventListener("dragover",j),r.editor.removeEventListener("drop",A),r.editor.removeEventListener("paste",C),r.editor.removeEventListener("blur",M),r.editor.removeEventListener("focus",I),t.editor=null,t.classList.remove("jeditor-container"),d.remove(),u.remove(),r.editor.remove()},r.upload=function(){s.click(r.file)};const g=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],v=["width","height","align","border","src","tabindex"],y=["color","font-weight","font-size","background","background-color","margin"],b=function(e){if(e.tagName&&-1===g.indexOf(e.tagName.toLowerCase())&&e.innerText&&(e.innerHTML=e.innerText),e.attributes&&e.attributes.length){let t=null,n=e.getAttribute("style");if(n){t=[];let e=n.split(";");for(let n=0;n<e.length;n++){let r=e[n].trim().split(":");if(y.indexOf(r[0].trim())>=0){let e=r.shift();r=r.join(":"),t.push(e+":"+r)}}}"IMG"===e.tagName.toUpperCase()&&(r.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),r.addImage(e.src)):e.parentNode.removeChild(e));let o=[];for(let t=0;t<e.attributes.length;t++)o.push(e.attributes[t].name);o.length&&o.forEach(function(t){-1===v.indexOf(t)?e.removeAttribute(t):e.attributes&&e.attributes[f]&&-1!==e.attributes[f].value.indexOf("<")&&e.attributes[f].value.replace("<","&#60;")}),e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(let t=e.children.length;t>0;t--)b(e.children[t-1])};var w=function(e){var t=window.getSelection(),n=document.createRange();n.selectNode(e),t.addRange(n)},C=function(e){if(1==r.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),o=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),o=window.clipboardData.files);if(o.length)r.addFile(o);else if(t){var i=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");b(t);var n=document.createElement("div");return n.innerHTML=t.firstChild.innerHTML,n}(t);document.execCommand("insertHtml",!1,i.innerHTML)}else t=n.split("\r\n"),e.target.innerText?(t=t.map(function(e){return"<div>"+e+"</div>"}),document.execCommand("insertText",!1,t.join(""))):t.map(function(e){var t=document.createElement("div");t.innerText=e,r.editor.appendChild(t)});e.preventDefault()}},x=function(e){l&&l.e&&e.preventDefault()},E=function(e){l||0==r.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},j=function(e){l||0==r.options.dropZone||(a&&clearTimeout(a),a=setTimeout(function(){t.classList.remove("jeditor-dragging")},100),e.preventDefault())},A=function(e){if(l||0==r.options.dropZone);else{var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var o=window.getSelection();o.removeAllRanges(),o.addRange(n),o.anchorNode.parentNode.focus();var i=(e.originalEvent||e).dataTransfer.getData("text/html"),s=(e.originalEvent||e).dataTransfer.getData("text/plain"),a=(e.originalEvent||e).dataTransfer.files;a.length?r.addFile(a):s&&function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("img");if(n.length)for(var o=0;o<n.length;o++)r.addImage(n[o].src)}(i),t.classList.remove("jeditor-dragging"),e.preventDefault()}},M=function(e){S("onevent",e),h(e),"function"==typeof r.options.onblur&&r.options.onblur(t,r,e)},I=function(e){"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,e)},T=function(e){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),"function"==typeof r.options.onkeyup&&r.options.onkeyup(t,r,e)},_=function(e){if(S("onevent",e),"Delete"==e.key&&"IMG"==e.target.tagName){var n=e.target.parentNode;w(e.target),n.classList.contains("jsnippet-image")&&m()}"function"==typeof r.options.onkeydown&&r.options.onkeydown(t,r,e)},N=function(e){if(l&&l.e&&(l.e.classList.remove("resizing"),1==l.e.changed)){var t=l.e.cloneNode();t.width=parseInt(l.e.style.width)||l.e.getAttribute("width"),t.height=parseInt(l.e.style.height)||l.e.getAttribute("height"),l.e.style.width="",l.e.style.height="",w(l.e),document.execCommand("insertHtml",!1,t.outerHTML)}l=!1},D=function(e){var t=function(t){var n=t.getBoundingClientRect();n.width-(e.clientX-n.left)<40&&e.clientY-n.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var n=e.target.getBoundingClientRect();l={e:e.target,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:e.target.style.cursor},e.target.getAttribute("width")||e.target.setAttribute("width",n.width),e.target.getAttribute("height")||e.target.setAttribute("height",n.height);var r=window.getSelection();if(r.rangeCount)for(var o=0;o<r.rangeCount;o++)r.removeRange(r.getRangeAt(o));e.target.classList.add("resizing")}else l=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),l=!0},O=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==r.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&l&&l.d){if("e-resize"==l.d||"ne-resize"==l.d||"se-resize"==l.d)if(l.e.style.width=l.w+(e.clientX-l.x),e.shiftKey){var n=(e.clientX-l.x)*(l.h/l.w);l.e.style.height=l.h+n}else n=null;n||"s-resize"!=l.d&&"se-resize"!=l.d&&"sw-resize"!=l.d||e.shiftKey||(l.e.style.height=l.h+(e.clientY-l.y)),l.e.changed=!0}},S=function(e,t){if(r.options.extensions){var n=Object.keys(r.options.extensions);if(n.length)for(var o=0;o<n.length;o++)r.options.extensions[n[o]]&&"function"==typeof r.options.extensions[n[o]][e]&&r.options.extensions[n[o]][e].call(r,t)}};if(document.addEventListener("mouseup",N),document.addEventListener("mousemove",O),r.editor.addEventListener("mousedown",D),r.editor.addEventListener("keyup",T),r.editor.addEventListener("keydown",_),r.editor.addEventListener("dragstart",x),r.editor.addEventListener("dragenter",E),r.editor.addEventListener("dragover",j),r.editor.addEventListener("drop",A),r.editor.addEventListener("paste",C),r.editor.addEventListener("focus",I),r.editor.addEventListener("blur",M),t.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var k={container:!0,responsive:!0,items:r.options.toolbar};else k=!0===r.options.toolbar?{container:!0,responsive:!0,items:[]}:r.options.toolbar;k.items&&k.items.length||(k.items=e.getDefaultToolbar(r)),r.options.toolbarOnTop?(t.classList.add("toolbar-on-top"),t.insertBefore(d,t.firstChild)):(r.editor.style.padding="15px",t.appendChild(d)),L(d,k),d.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},t.appendChild(r.file),r.options.focus&&e.setCursor(r.editor,"initial"==r.options.focus),t.change=r.setData,t.val=function(e){if(void 0===e){var n="true"!==t.getAttribute("data-html");return r.getData(n)}r.setData(e)},function(){if(r.options.extensions){var e=Object.keys(r.options.extensions);if(e.length)for(var n=0;n<e.length;n++)r.options.extensions[e[n]]&&"function"==typeof r.options.extensions[e[n]]&&(r.options.extensions[e[n]]=r.options.extensions[e[n]](t,r))}}(),t.editor=r,"function"==typeof r.options.onload&&r.options.onload(t,r,r.editor),r};return e.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),r=n.getRangeAt(0);if(1==t)var o=r.startContainer,i=0;else i=(o=r.endContainer).length;r.setStart(o,i),r.setEnd(o,i),n.removeAllRanges(),n.addRange(r)},e.getDefaultToolbar=function(e){var t=function(e,t,n){n.color||(w(n,{onchange:function(e,t){"color"===n.k?document.execCommand("foreColor",!1,t):document.execCommand("backColor",!1,t)}}),n.color.open())},n=[];return n.push({content:"undo",onclick:function(){document.execCommand("undo")}}),n.push({content:"redo",onclick:function(){document.execCommand("redo")}}),n.push({type:"divisor"}),e.options.toolbarOnTop&&(n.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,n,r,o){document.execCommand("fontName",!1,r)}}),n.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,n,r,o){document.execCommand("fontSize",!1,parseInt(o)+1)}}),n.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(e){return'<i class="material-icons">'+e+"</i>"},onchange:function(e,t,n,r,o){document.execCommand(["JustifyLeft","justifyCenter","justifyRight","justifyFull"][o])}}),n.push({type:"divisor"}),n.push({content:"format_color_text",k:"color",onclick:t}),n.push({content:"format_color_fill",k:"background-color",onclick:t})),n.push({content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({type:"divisor"}),n.push({content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),e.options.toolbarOnTop&&(n.push({type:"divisor"}),n.push({content:"photo",onclick:function(){e.upload()}}),n.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(e,t){t&&(t.onmouseover=this.onmouseover,e=e.split("x"),t.setAttribute("data-x",e[0]),t.setAttribute("data-y",e[1]));var n=document.createElement("div");return t.style.margin="1px",t.style.border="1px solid #ddd",n},onmouseover:function(e){for(var t=parseInt(e.target.getAttribute("data-x")),n=parseInt(e.target.getAttribute("data-y")),r=0;r<e.target.parentNode.children.length;r++){var o=e.target.parentNode.children[r],i=parseInt(o.getAttribute("data-x")),s=parseInt(o.getAttribute("data-y"));i<=t&&s<=n?(o.style.backgroundColor="#cae1fc",o.style.borderColor="#2977ff"):(o.style.backgroundColor="",o.style.borderColor="#ddd")}},onchange:function(e,t,n){n=n.split("x");for(var r=document.createElement("table"),o=document.createElement("tbody"),i=0;i<=n[1];i++){for(var s=document.createElement("tr"),a=0;a<=n[0];a++){var l=document.createElement("td");l.innerHTML="",s.appendChild(l)}o.appendChild(s)}r.appendChild(o),r.setAttribute("width","100%"),r.setAttribute("cellpadding","6"),r.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,r.outerHTML)}})),n},e}();var M=function(){var e=function(t,n){var r={options:{}},o={type:"big",title:"Untitled",width:510,height:472};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(e.elements.indexOf(r.container),1),r.updatePosition(),t.remove()},r.updatePosition=function(){for(var t=0;t<e.elements.length;t++){var n=e.elements[t],r=e.elements[t-1];n.style.right=t*(r?r.offsetWidth:n.offsetWidth)*1.01+"px"}},r.init=function(){(function(){for(var e=document.createElement("div");t.children[0];)e.appendChild(t.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=t.innerHTML;e.children[0];)r.content.appendChild(e.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),t.innerHTML="",t.appendChild(r.container)})(),r.container&&r.container.addEventListener("click",function(e){var t=e.target.getBoundingClientRect();if(e.target.classList.contains("jfloating")){if(e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;else n=e.clientX,o=e.clientY;t.width-(n-t.left)<50&&o-t.top<50?setTimeout(function(){r.close()},100):r.setState()}}),r.container.classList.add("jfloating-"+r.options.type),e.elements.push(r.container),r.updatePosition(),t.floating=r},r.init(),r};return e.elements=[],e}();var I=function(){const e=function(e){return!isNaN(e)&&null!==e&&("string"!=typeof e||""!==e.trim())},t={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},n={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},r={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},o=function(e,t){return"function"==typeof o[t.type]?!(!t.allowBlank||void 0!==e&&""!==e&&null!==e)||o[t.type].call(this,e,t):null};o.url=function(e){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)},o.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},o.required=function(e){return!(!e||!e.trim())},o.empty=function(e){return null==e||"string"==typeof e&&!e.toString().trim()},o["not exist"]=o.empty,o.notEmpty=function(e){return!o.empty(e)},o.exist=o.notEmpty,o.number=function(n,r){if(!e(n))return!1;if(!r||!r.criteria)return!0;if(!t[r.criteria])return!1;let o=r.value.map(function(e){return parseFloat(e)});return t[r.criteria](n,o)},o.login=function(e){let t=new RegExp(/^[a-zA-Z0-9._-]+$/);return!(!e||!t.test(e))},o.list=function(e,t){let n,r=typeof e;return("string"===r||"number"===r)&&(n="string"==typeof t.value[0]?t.source?t.source:t.value[0].split(","):t.value[0],!!Array.isArray(n)&&n.findIndex(function(t){return t==e})>-1)};const i=function(){let e=new Date;return e.setHours(0,0,0,0),e},s={"one year ago":function(){let e=i();return e.setFullYear(e.getFullYear()-1),e},"one month ago":function(){let e=i();return e.setMonth(e.getMonth()-1),e},"one week ago":function(){let e=i();return e.setDate(e.getDate()-7),e},yesterday:function(){let e=i();return e.setDate(e.getDate()-1),e},today:i,tomorrow:function(){let e=i();return e.setDate(e.getDate()+1),e}};return o.date=function(t,r){if(e(t)&&t>0&&t<1e6&&(t=h.numToDate(t)),"Invalid Date"==new Date(t))return!1;if(!r||!r.criteria)return!0;if(!n[r.criteria])return!1;let o=r.value.map(function(e){return"string"==typeof e&&s[e]?s[e]().getTime():new Date(e).getTime()});return n[r.criteria](new Date(t).getTime(),o)},o.text=function(e,t){if(null==e)e="";else if("string"!=typeof e)return!1;return!t||!t.criteria||!!r[t.criteria]&&r[t.criteria](e,t.value)},o.textLength=function(e,t){let n;return n="string"==typeof e?e.length:null!=e&&"function"==typeof e.toString?e.toString().length:0,o.number(n,t)},o.time=function(n,r){if(!e(n))return!1;if(!r||!r.criteria)return!0;if(!t[r.criteria])return!1;let o=r.value.map(function(e){return parseInt(parseFloat(e)*10**17)/10**17});return t[r.criteria](parseInt(parseFloat(n)*10**17)/10**17,o)},o}();var T=function(){var e=function(t,n){var r={options:{}},o={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){alert(t)}};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=t.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=I.email),r.options.validations.length||(r.options.validations.length=I.length),r.options.validations.required||(r.options.validations.required=I.required),r.setUrl=function(e){r.options.url=e},r.load=function(){p({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof r.options.onbeforeload){var o=r.options.onbeforeload(t,n);o&&(n=o)}e.setElements(t,n),"function"==typeof r.options.onload&&r.options.onload(t,n)}})},r.save=function(){var n=r.validate();if(n)r.options.onerror(t,n);else{var o=e.getElements(t,!0);if("function"==typeof r.options.onbeforesave&&!1===(o=r.options.onbeforesave(t,o)))return;p({url:r.options.url,method:"POST",dataType:"json",data:o,success:function(e){"function"==typeof r.options.onsave&&r.options.onsave(t,o,e)}})}},r.remove=function(){if("function"==typeof r.options.onbeforeremove&&!1===r.options.onbeforeremove(t,r))return!1;p({url:r.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof r.options.onremove&&r.options.onremove(t,r,e),r.reset()}})};return r.validateElement=function(n){var o=!1,i=e.getValue(n),s=n.getAttribute("data-validation");return"function"!=typeof r.options.validations[s]||r.options.validations[s](i,n)?n.classList.contains("error")&&function(e){var n=!1;e.classList.remove("error"),e.removeAttribute("title");for(var o=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++)o[i].getAttribute("data-validation")&&o[i].classList.contains("error")&&(n=!0);r.options.submitButton&&(n?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))}(n):o=function(e){e.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(n),o},r.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},r.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),o=0;o<n.length;o++)if(n[o].getAttribute("data-validation")){var i=r.validateElement(n[o]);i&&e.push(i)}return e.length>0&&e.join("<br>")},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(e.getElements(t))},r.getHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},r.isChanged=function(){var e=r.setHash();return r.options.currentHash!=e},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(e){r.options.ignore=!!e},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),t.addEventListener("keyup",function(e){e.target.getAttribute("data-validation")&&r.validateElement(e.target)}),e.hasEvents||(window.addEventListener("beforeunload",function(e){if(r.isChanged()&&0==r.options.ignore){var t=r.options.message?r.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}}),e.hasEvents=!0),t.form=r,r};return e.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var n=e.querySelectorAll("options[selected]"),r=0;r<n.length;r++)t.push(n[r].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.getElements=function(t,n){for(var r={},o=null,i=t.querySelectorAll("input, select, textarea, div[name]"),s=0;s<i.length;s++)(o=i[s].getAttribute("name"))&&(r[o]=e.getValue(i[s])||"");return 1==n?r:JSON.stringify(r)},e.setElements=function(e,t){for(var n=null,r=null,o=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<o.length;i++){var s=o[i].getAttribute("type");if(n=o[i].getAttribute("name")){if(r=null,(n=n.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var a=l.call(t,n)||"";void 0!==a&&(r=a)}else void 0!==t[n]&&(r=t[n]);null!==r&&("checkbox"==s||"radio"==s?o[i].checked=!!r:"file"==s||("function"==typeof o[i].val?o[i].val(r):o[i].value=r))}}},e}();var _=function(){var e=function(){var e=null;document.addEventListener("keydown",function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()}),document.addEventListener("mouseup",function(t){let n=t.composedPath();var r=s.findElement(n[0],"jmodal");if(r){var o=r.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else i=t.clientX,a=t.clientY;o.width-(i-o.left)<50&&a-o.top<50&&r.parentNode.modal.close()}e&&(e.element.style.cursor="auto",e=null)}),document.addEventListener("mousedown",function(t){let n=t.composedPath();var r=s.findElement(n[0],"jmodal");if(r){var o=r.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else i=t.clientX,a=t.clientY;o.width-(i-o.left)<50&&a-o.top<50||a-o.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e={left:o.left,top:o.top,x:t.clientX,y:t.clientY,width:o.width,height:o.height,element:r})}}),document.addEventListener("mousemove",function(t){if(e){if((t=t||window.event).buttons)var n=t.buttons;else n=t.button?t.button:t.which;n?(e.element.style.top=e.top+(t.clientY-e.y)+e.height/2+"px",e.element.style.left=e.left+(t.clientX-e.x)+e.width/2+"px",e.element.style.cursor="move"):e.element.style.cursor="auto"}})};return function(t,n){var r={options:{}},o={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];!r.options.title&&t.getAttribute("title")&&(r.options.title=t.getAttribute("title"));for(var a=document.createElement("div");t.children[0];)a.appendChild(t.children[0]);for(r.title=document.createElement("div"),r.title.className="jmodal_title",r.options.icon&&r.title.setAttribute("data-icon",r.options.icon),r.content=document.createElement("div"),r.content.className="jmodal_content",r.content.innerHTML=t.innerHTML;a.children[0];)r.content.appendChild(a.children[0]);if(r.container=document.createElement("div"),r.container.className="jmodal",r.container.appendChild(r.title),r.container.appendChild(r.content),r.options.padding&&(r.content.style.padding=r.options.padding),r.options.width&&(r.container.style.width=r.options.width),r.options.height&&(r.container.style.height=r.options.height),r.options.title){var l=document.createElement("h4");l.innerText=r.options.title,r.title.appendChild(l)}if(t.innerHTML="",t.style.display="none",t.appendChild(r.container),r.options.backdrop){var c=document.createElement("div");c.className="jmodal_backdrop",c.onclick=function(){r.close()},t.appendChild(c)}return r.open=function(){t.style.display="block";var e=r.container.getBoundingClientRect();s.getWindowWidth()<e.width?(r.container.style.top="",r.container.style.left="",r.container.classList.add("jmodal_fullscreen"),f.slideBottom(r.container,1)):r.options.backdrop&&(c.style.display="block"),"function"==typeof r.options.onopen&&r.options.onopen(t,r)},r.resetPosition=function(){r.container.style.top="",r.container.style.left=""},r.isOpen=function(){return"none"!=t.style.display},r.close=function(){r.isOpen()&&(t.style.display="none",r.options.backdrop&&(c.style.display=""),r.container.classList.remove("jmodal_fullscreen"),"function"==typeof r.options.onclose&&r.options.onclose(t,r))},r.options.url?p({url:r.options.url,method:"GET",dataType:"text/html",success:function(e){r.content.innerHTML=e,r.options.closed||r.open(),"function"==typeof r.options.onload&&r.options.onload(r)}}):(r.options.closed||r.open(),"function"==typeof r.options.onload&&r.options.onload(r)),t.modal=r,e(),e=function(){},r}}();var N=function(){var e=function(e){var t={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var r in n)e&&e.hasOwnProperty(r)?t.options[r]=e[r]:t.options[r]=n[r];var o=document.createElement("div");o.className="jnotification",t.options.error&&o.classList.add("jnotification-error");var i=document.createElement("div");i.className="jnotification-container",o.appendChild(i);var a=document.createElement("div");a.className="jnotification-header",i.appendChild(a);var l=document.createElement("div");if(l.className="jnotification-image",a.appendChild(l),t.options.icon){var c=document.createElement("img");c.src=t.options.icon,l.appendChild(c)}var u=document.createElement("div");if(u.className="jnotification-name",u.innerHTML=t.options.name,a.appendChild(u),1==t.options.closeable){var d=document.createElement("div");d.className="jnotification-close",d.onclick=function(){t.hide()},a.appendChild(d)}var p=document.createElement("div");p.className="jnotification-date",a.appendChild(p);var h=document.createElement("div");if(h.className="jnotification-content",i.appendChild(h),t.options.title){var m=document.createElement("div");m.className="jnotification-title",m.innerHTML=t.options.title,h.appendChild(m)}var g=document.createElement("div");if(g.className="jnotification-message",g.innerHTML=t.options.message,h.appendChild(g),t.show=function(){document.body.appendChild(o),s.getWindowWidth()>800?f.fadeIn(o):f.slideTop(o,1)},t.hide=function(){s.getWindowWidth()>800?f.fadeOut(o,function(){o.parentNode&&(o.parentNode.removeChild(o),v&&clearTimeout(v))}):f.slideTop(o,0,function(){o.parentNode&&(o.parentNode.removeChild(o),v&&clearTimeout(v))})},t.show(),1==t.options.autoHide)var v=setTimeout(function(){t.hide()},t.options.timeout);return s.getWindowWidth()<800&&o.addEventListener("swipeup",function(e){t.hide(),e.preventDefault(),e.stopPropagation()}),t};return e.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e}();function D(e,t){if(e.search)return e.search;var n=null,r=function(t){if("function"==typeof a.options.onsearch){var n=a.options.onsearch(a,t);n&&(t=n)}if(l.innerHTML="",t.length){e.style.display="block";for(var r=t.length<11?t.length:10,o=0;o<r;o++){if("string"==typeof t[o])var i=t[o],s=t[o];else!(i=t[o].text)&&t[o].name&&(i=t[o].name),!(s=t[o].value)&&t[o].id&&(s=t[o].id);var c=document.createElement("div");c.setAttribute("data-value",s),c.setAttribute("data-text",i),c.className="jsearch_item",t[o].id&&c.setAttribute("id",t[o].id),a.options.forceSelect&&0==o&&c.classList.add("selected");var u=document.createElement("img");t[o].image?u.src=t[o].image:u.style.display="none",c.appendChild(u);var d=document.createElement("div");d.innerHTML=i,c.appendChild(d),l.appendChild(c)}}else e.style.display=""},o=function(e){if(e!=a.terms)if(a.terms=e,n=a.options.forceSelect?0:null,Array.isArray(a.options.data)){var t=a.options.data.filter(function(t){return function(t){if("string"==typeof t){if((""+t).toLowerCase().search(e.toLowerCase())>=0)return!0}else for(var n in t)if((""+t[n]).toLowerCase().search(e.toLowerCase())>=0)return!0;return!1}(t)});r(t)}else p({url:a.options.data+e,method:"GET",dataType:"json",success:function(e){r(e)}})},i=null,a=function(e){i&&clearTimeout(i),i=setTimeout(function(){o(e)},500)};null===t.forceSelect&&(t.forceSelect=!0),a.options={data:t.data||null,input:t.input||null,searchByNode:t.searchByNode||null,onselect:t.onselect||null,forceSelect:t.forceSelect,onsearch:t.onsearch||null,onbeforesearch:t.onbeforesearch||null},a.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),r=e.getAttribute("data-value"),o=e.children[0].src||"";"function"==typeof a.options.onselect&&a.options.onselect(a,n,r,t,o),a.close()},a.open=function(){e.style.display="block"},a.close=function(){i&&clearTimeout(i),a.terms="",l.innerHTML="",e.style.display=""},a.isOpened=function(){return!!e.style.display},a.keydown=function(e){a.isOpened()&&("Enter"==e.key?null!==n&&l.children[n]?(a.selectIndex(l.children[n]),e.preventDefault()):a.close():"ArrowUp"===e.key?(null!==n&&l.children[0]&&(l.children[n].classList.remove("selected"),a.options.forceSelect||0!==n?(n=Math.max(0,n-1),l.children[n].classList.add("selected")):n=null),e.preventDefault()):"ArrowDown"===e.key&&(null==n?n=-1:l.children[n].classList.remove("selected"),n<9&&l.children[n+1]&&n++,l.children[n].classList.add("selected"),e.preventDefault()))},a.keyup=function(e){if(!a.options.searchByNode&&a.options.input)if("DIV"===a.options.input.tagName)var t=a.options.input.innerText;else t=a.options.input.value;else{var n=s.getNode();n&&(t=n.innerText)}if("function"==typeof a.options.onbeforesearch){var r=a.options.onbeforesearch(a,t);if(r)t=r;else if(!1===r)return}a(t)},a.blur=function(e){a.close()},a.options.input&&(a.options.input.addEventListener("keyup",a.keyup),a.options.input.addEventListener("keydown",a.keydown),a.options.input.addEventListener("blur",a.blur));var l=document.createElement("div");return l.classList.add("jsearch_container"),l.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;a.selectIndex(t),e.preventDefault()},e.appendChild(l),e.classList.add("jsearch"),e.search=a,a}function O(t,n){var r={options:{}},o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var i in o)n&&n.hasOwnProperty(i)?r.options[i]=n[i]:r.options[i]=o[i];1==r.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==r.options.input&&t.classList.add("input"),r.add=function(e){if(0==r.options.multiple&&(t.content=[],t.innerText=""),"image"==r.options.type){var n=document.createElement("img");n.setAttribute("src",e.file),n.setAttribute("tabindex",-1),t.getAttribute("name")||(n.className="jfile",n.content=e),t.appendChild(n)}else{if(e.name)var o=e.name;else o=e.file;var i=document.createElement("div");i.innerText=o||r.options.type,i.classList.add("jupload-item"),i.setAttribute("tabindex",-1),t.appendChild(i)}e.content&&(e.file=s.guid()),t.content.push(e),"function"==typeof r.options.onchange&&r.options.onchange(t,e)},r.addFromFile=function(t){if(t.type.split("/")[0]==r.options.type){var n=new FileReader;n.addEventListener("load",function(e){var n={file:e.srcElement.result,extension:t.name.substr(t.name.lastIndexOf(".")+1),name:t.name,size:t.size,lastmodified:t.lastModified,content:e.srcElement.result};r.add(n)}),n.readAsDataURL(t)}else alert(e.translate("This extension is not allowed"))},r.addFromUrl=function(e){if("data"==e.substr(0,4)||r.options.remoteParser)if("data"==e.substr(0,4))if((n=(n=e.split(";"))[0].split("/"))[0].replace("data:","")==r.options.type){var t={file:e,name:"",extension:n[1],content:e};r.add(t)}else alert(r.options.text.extensionNotAllowed);else{var n=e.substr(e.lastIndexOf(".")+1);e=r.options.remoteParser+e,p({url:e,type:"GET",dataType:"blob",success:function(e){}})}else console.error("remoteParser not defined in your initialization")};var a=r.options.type+"/"+r.options.extension,l=document.createElement("input");l.type="file",l.setAttribute("accept",a),l.onchange=function(){for(var e=0;e<this.files.length;e++)r.addFromFile(this.files[e])},1==r.options.multiple&&l.setAttribute("multiple",!0);var c=null;return t.addEventListener("click",function(e){c=null,t.children.length&&e.target!==t?e.target.parentNode==t&&(c=e.target):s.click(l)}),t.addEventListener("dblclick",function(e){s.click(l)}),t.addEventListener("dragenter",function(e){t.style.border="1px dashed #000"}),t.addEventListener("dragleave",function(e){t.style.border="1px solid #eee"}),t.addEventListener("dragstop",function(e){t.style.border="1px solid #eee"}),t.addEventListener("dragover",function(e){e.preventDefault()}),t.addEventListener("keydown",function(e){if(c&&46==e.which){var n=Array.prototype.indexOf.call(t.children,c);n>=0&&(t.content.splice(n,1),c.remove(),c=null)}}),t.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var n=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var o=0;o<e.dataTransfer.files.length;o++)r.addFromFile(e.dataTransfer.files[o]);else if(n){0==r.options.multiple&&(t.innerText="");var i=document.createElement("div");i.innerHTML=n;var s=i.querySelectorAll("img");if(s.length)for(o=0;o<s.length;o++)r.addFromUrl(s[o].src)}return t.style.border="1px solid #eee",!1}),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var n=0;n<e.length;n++)"string"==typeof e[n]?r.add({file:e[n]}):r.add(e[n]);else"string"==typeof e&&r.add({file:e})},t.upload=t.image=r,r}var S=r(195),k=r.n(S),R={...e,...s,version:"5.12.0",setExtensions:function(e){if("object"==typeof e)for(var t=Object.keys(e),n=0;n<t.length;n++)R[t[n]]=e[t[n]]},tracking:n,path:l,sorting:c,lazyLoading:u,ajax:p,animation:f,calendar:g,color:w,contextmenu:C,dropdown:E,editor:A,floating:M,form:T,mask:m,modal:_,notification:N,palette:v,picker:j,progressbar:function(e,t){var n={options:{}},r={value:0,onchange:null,width:null};for(var o in r)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=r[o];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",n.options.value);var i=document.createElement("div");i.style.width=n.options.value+"%",i.style.color="#fff",e.appendChild(i),n.options.width&&(e.style.width=n.options.width),n.setValue=function(t){t=parseInt(t),n.options.value=t,i.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},n.getValue=function(){return n.options.value};var s=function(t){if(t.which){var r=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var o=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else o=t.clientX,t.clientY;n.setValue(Math.round((o-r.left)/r.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",s),e.addEventListener("touchend",s)):(e.addEventListener("mousedown",s),e.addEventListener("mousemove",s)),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.progressbar=n,n},rating:function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,r){var o={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var i in o)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:void 0!==n.options[i]&&!0!==r||(n.options[i]=o[i]);e.innerHTML="";for(var s=0;s<n.options.number;s++){var a=document.createElement("div");a.setAttribute("data-index",s+1),a.setAttribute("title",n.options.tooltip[s]),e.appendChild(a)}if(n.options.value)for(s=0;s<n.options.number;s++)s<n.options.value&&e.children[s].classList.add("jrating-selected");return n},setValue:function(t){for(var r=0;r<n.options.number;r++)r<t?e.children[r].classList.add("jrating-selected"):(e.children[r].classList.remove("jrating-over"),e.children[r].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==n.options.value?n.setValue(0):n.setValue(t))}),e.addEventListener("mouseover",function(t){for(var r=t.target.getAttribute("data-index"),o=0;o<n.options.number;o++)o<r?e.children[o].classList.add("jrating-over"):e.children[o].classList.remove("jrating-over")}),e.addEventListener("mouseout",function(t){for(var r=0;r<n.options.number;r++)e.children[r].classList.remove("jrating-over")}),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},search:D,slider:function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=parseInt(n.options.height)+"px"),n.options.width&&(e.style.width=parseInt(n.options.width)+"px"),n.options.grid){e.classList.add("jslider-grid");var r=e.children.length;r>4&&e.setAttribute("data-total",r-4),e.setAttribute("data-number",r>4?4:r)}var o=document.createElement("div");if(o.classList.add("jslider-counter"),e.children.length>0)for(var i=0;i<e.children.length;i++){n.options.items.push(e.children[i]);var s=document.createElement("div");s.onclick=function(){var e=Array.prototype.slice.call(o.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},o.appendChild(s)}var a=document.createElement("div");a.className="jslider-caption";var l=document.createElement("div"),c=document.createElement("div");c.className="jslider-close",c.innerHTML="",c.onclick=function(){n.close()},l.appendChild(a),l.appendChild(c)}n.updateCounter=function(e){for(var t=0;t<o.children.length;t++)if(o.children[t].classList.contains("jslider-counter-focus")){o.children[t].classList.remove("jslider-counter-focus");break}o.children[e].classList.add("jslider-counter-focus")},n.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(l),e.appendChild(o);var r=n.options.items.indexOf(t);n.updateCounter(r);for(var i=0;i<e.children.length;i++)e.children[i].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),l.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";o.remove(),l.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)};var u=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?n.next():t<40&&n.prev()}};return"ontouchend"in document.documentElement==1?e.addEventListener("touchend",u):e.addEventListener("mouseup",u),e.addEventListener("swipeleft",function(e){n.next(),e.preventDefault(),e.stopPropagation()}),e.addEventListener("swiperight",function(e){n.prev(),e.preventDefault(),e.stopPropagation()}),e.addEventListener("keydown",function(e){27==e.which&&n.close()}),e.slider=n,n},tabs:b,tags:function(t,n){if(t.tags)return t.tags.setOptions(n,!0);var r={type:"tags",options:{}},o=function(){return!!(r.options.limit&&t.children.length>=r.options.limit)},i=null,a=null;r.setOptions=function(e,n){var o={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var s in o)e&&e.hasOwnProperty(s)?r.options[s]=e[s]:void 0!==r.options[s]&&!0!==n||(r.options[s]=o[s]);return r.options.placeholder?t.setAttribute("data-placeholder",r.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=r.options.placeholder,r.setValue(r.options.value),d(),r.options.search?a||(a=document.createElement("div"),t.parentNode.insertBefore(a,t.nextSibling),i=D(a,{data:r.options.search,onselect:function(e,t,n){r.selectIndex(t,n)}})):a&&(i=null,a.remove(),a=null),r},r.add=function(n,a){if("function"==typeof r.options.onbeforechange){var d=r.options.onbeforechange(t,r,r.options.value,n);if(!1===d)return!1;null!=d&&(n=d)}if(i&&i.close(),o())"function"==typeof r.options.onlimit?r.options.onlimit(r,r.options.limit):alert(e.translate("You reach the limit number of entries")+" "+r.options.limit);else{var p=s.getNode();if(!(p&&p.parentNode&&p.parentNode.classList.contains("jtags")&&p.nextSibling)||p.nextSibling.innerText&&p.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),n&&"string"!=typeof n){for(var f=0;f<=n.length;f++)if(!o()){if(n[f]&&"string"!=typeof n[f])h=n[f].text,m=n[f].value;else var h=n[f]||"",m=null;g=c(h,m)}}else var g=c(n,n,p);u()}else g=p.nextSibling;a&&l(g)}},r.setLimit=function(e){for(r.options.limit=e,t.children.length;t.children.length>e;)t.removeChild(t.lastChild)},r.remove=function(e){e.parentNode.removeChild(e),t.children.length?u():r.add("",!0),"function"==typeof r.options.onremoveitem&&r.options.onremoveitem(t,r,e)},r.getData=function(){for(var e=[],n=0;n<t.children.length;n++){var r=t.children[n].innerText.replace("\n",""),o=t.children[n].getAttribute("data-value");o||(o=r),(r||o)&&e.push({text:r,value:o})}return e},r.getValue=function(e){var n=null;if(null!=e)(n=t.children[e].getAttribute("data-value"))||(n=t.children[e].innerText.replace("\n",""));else{for(var o=[],i=0;i<t.children.length;i++)(n=t.children[i].innerText.replace("\n",""))&&o.push(r.getValue(i));n=o.join(",")}return n},r.setValue=function(e){if(e){if(t.value!=e)if(Array.isArray(e))r.add(e);else{var n=(""+e).trim(),o=f(n);t.innerHTML="",r.add(o)}}else r.reset()},r.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",u()},r.isValid=function(){for(var e=0,n=0;n<t.children.length;n++)t.children[n].classList.contains("jtags_error")&&e++;return 0==e},r.selectIndex=function(e,t){var n=s.getNode();n&&(n.innerText=e,t&&n.setAttribute("data-value",t),n.classList.remove("jtags_error"),o()||r.add("",!0))},r.search=function(e){e.innerText},r.destroy=function(){t.removeEventListener("mouseup",y),t.removeEventListener("keydown",m),t.removeEventListener("keyup",g),t.removeEventListener("paste",v),t.removeEventListener("focus",b),t.removeEventListener("blur",w),t.parentNode.removeChild(t)};var l=function(e){if(t.children.length){var n=document.createRange(),r=window.getSelection();e||(e=t.childNodes[t.childNodes.length-1]),n.setStart(e,e.length),n.collapse(!0),r.removeAllRanges(),r.addRange(n),t.scrollLeft=t.scrollWidth}},c=function(e,n,r){var o=document.createElement("div");return o.textContent=e||"",n&&o.setAttribute("data-value",n),r&&r.parentNode.classList.contains("jtags")?t.insertBefore(o,r.nextSibling):t.appendChild(o),o},u=function(){var e=r.getValue();e!=r.options.value&&(r.options.value=e,"function"==typeof r.options.onchange&&r.options.onchange(t,r,r.options.value),t.value!=r.options.value&&(t.value=r.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))),d()},d=function(){for(var e=0;e<t.children.length;e++)"DIV"===t.children[e].tagName&&(r.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof r.options.validation&&r.getValue(e)?r.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label"));p()},p=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):t.children.length&&"BR"!==t.children[0].tagName||(t.innerHTML="",l(c()))},f=function(e){var t=[],n="";if(e=e.trim()){for(var r=0;r<e.length;r++)","==e[r]||";"==e[r]||"\n"==e[r]?n&&(t.push(n.trim()),n=""):n+=e[r];n&&t.push(n)}return t},h=0,m=function(e){h=window.getSelection().anchorOffset,p(),"Tab"===e.key||";"===e.key||","===e.key?(window.getSelection().anchorOffset>1&&(o()?"function"==typeof r.options.onlimit&&r.options.onlimit(r,r.options.limit):r.add("",!0)),e.preventDefault()):"Enter"==e.key?i&&i.isOpened()||(window.getSelection().anchorOffset>1&&(o()||r.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),i&&i.keydown(e),p()},g=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==h&&r.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():i&&i.keyup(e);d()},v=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var n=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(n=window.clipboardData.getData("Text"));var o=f(n);if("function"==typeof r.options.onbeforepaste){var i=r.options.onbeforepaste(t,r,o);if(!1===i)return e.preventDefault(),!1;i&&(o=i)}o.length>1?(r.add(o,!0),e.preventDefault()):o[0]&&(document.execCommand("insertText",!1,o[0]),e.preventDefault())},y=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var n=e.target.getBoundingClientRect();n.width-(e.clientX-n.left)<16&&r.remove(e.target)}e.target==t&&l()},b=function(){t.classList.contains("jtags-focus")||(t.children.length&&!r.getValue(t.children.length-1)||o()||c(""),"function"==typeof r.options.onfocus&&r.options.onfocus(t,r,r.getValue()),t.classList.add("jtags-focus"))},w=function(){if(t.classList.contains("jtags-focus")){i&&i.close();for(var e=0;e<t.children.length-1;e++)r.getValue(e)||t.removeChild(t.children[e]);u(),t.classList.remove("jtags-focus"),"function"==typeof r.options.onblur&&r.options.onblur(t,r,r.getValue())}};return"touchend"in document.documentElement==1?t.addEventListener("touchend",y):t.addEventListener("mouseup",y),t.addEventListener("keydown",m),t.addEventListener("keyup",g),t.addEventListener("paste",v),t.addEventListener("focus",b),t.addEventListener("blur",w),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),r.setOptions(n),"function"==typeof r.options.onload&&r.options.onload(t,r),t.change=r.setValue,t.val=function(e){if(void 0===e)return r.getValue();r.setValue(e)},t.tags=r,r},toolbar:L,upload:O,validations:I};R.image=O,R.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},R.tracker=T,R.loading=f.loading,R.sha512=k();"undefined"!=typeof document&&function(){if(void 0!==window.jSuitesStateControl)return;window.jSuitesStateControl=[];const e=function(t,n){return!(!t[n.type]||t[n.type]!=n)||!(!t.component||t.component!=n)||!!t.parentNode&&e(t.parentNode,n)};let t=15,n=!1,r={x:null,y:null},o=document.createElement("div");o.classList.add("jtooltip");const i=function(e){return e&&(e.shadowRoot||e.tagName&&e.tagName.includes("-"))},s=function(e){let t,n,r=e.path||e.composedPath&&e.composedPath();return r?(n=r[0],n&&i(n)&&!n.shadowRoot&&e.toElement&&(n=e.toElement)):(t=e.target&&i(e.target)?e.target.shadowRoot:document,n=t.elementFromPoint(x,y)),n};let a,l=["n","ne","e","se","s","sw","w","nw","rotate"];l.forEach(function(e,t){l[t]=document.createElement("div"),l[t].classList.add("jpanel-action"),"rotate"===e?l[t].setAttribute("data-action","rotate"):(l[t].setAttribute("data-action","resize"),l[t].setAttribute("data-position",e+"-resize"))});const c=function(e){let t=s(e),n=R.findElement(t,"jpanel");n&&!n.classList.contains("readonly")&&n.classList.contains("jpanel-controls")?(n.append(...l),n.classList.contains("jpanel-rotate")||l[l.length-1].remove(),a=n):u(e)},u=function(e){a&&(l.forEach(function(e){e.remove()}),a=null)};document.addEventListener("focusin",c),document.addEventListener("mouseup",function(e){n&&n.e&&("function"==typeof n.e.refresh&&r.actioned&&n.e.refresh(),n.e.style.cursor=""),r={x:null,y:null},n=!1}),document.addEventListener("mousedown",function(t){if(t.changedTouches&&t.changedTouches[0])var r=t.changedTouches[0].clientX,o=t.changedTouches[0].clientY;else r=t.clientX,o=t.clientY;let i=s(t),a=i&&"DIV"===i.tagName&&i.getAttribute("contentEditable"),l=R.findElement(i,"jpanel");if(!l||l.classList.contains("readonly")||a)n=!1;else{let e=l.getBoundingClientRect(),t=0;l.style.rotate&&(t=parseFloat(l.style.rotate));let s="move";i.getAttribute("data-action")?s=i.getAttribute("data-action"):l.style.cursor?s="resize":l.style.cursor="move",n={action:s,a:t,e:l,x:r,y:o,l:e.left,t:e.top,b:e.bottom,r:e.right,w:e.width,h:e.height,d:l.style.cursor,actioned:!1},l.style.width||(l.style.width=e.width+"px"),l.style.height||(l.style.height=e.height+"px")}(function(t){let n=window.jSuitesStateControl;if(n&&n.length>0)for(let r=0;r<n.length;r++)n[r]&&!e(t,n[r])&&n[r].close()})(i),c(t)}),document.addEventListener("mousemove",function(e){if(n){let t=e.clientX||e.pageX,s=e.clientY||e.pageY;if(null==r.x&&null==r.y&&(r.x=t,r.y=s),"move"===n.action){var o=t-r.x,i=s-r.y,a=n.e.offsetTop+i,l=n.e.offsetLeft+o;n.e.style.top=a+"px",n.e.style.left=l+"px","function"==typeof n.e.refresh&&(r.actioned=!0,n.e.refresh("position",a,l))}else if("rotate"===n.action){let e=function(e,t,n,r,o,i){const s=n-e,a=r-t,l=o-e,c=i-t;let u=Math.atan2(a,s),d=Math.atan2(c,l)-u;return d*=180/Math.PI,d<0&&(d+=360),d}(n.l+n.w/2,n.t+n.h/2,n.x,n.y,t,s);e+=n.a%360,e=2*Math.round(e/2),n.e.style.rotate=`${e}deg`,"function"==typeof n.e.refresh&&(r.actioned=!0,n.e.refresh("rotate",e))}else if("resize"===n.action){let o=null,i=null,a=null,l=null;"e-resize"==n.d||"ne-resize"==n.d||"se-resize"==n.d?(a=n.e.offsetWidth+(t-r.x),e.shiftKey&&(l=n.e.offsetHeight+(t-r.x)*(n.e.offsetHeight/n.e.offsetWidth))):"w-resize"!==n.d&&"nw-resize"!=n.d&&"sw-resize"!=n.d||(i=n.e.offsetLeft+(t-r.x),a=n.e.offsetLeft+n.e.offsetWidth-i,e.shiftKey&&(l=n.e.offsetHeight-(t-r.x)*(n.e.offsetHeight/n.e.offsetWidth))),"s-resize"==n.d||"se-resize"==n.d||"sw-resize"==n.d?l||(l=n.e.offsetHeight+(s-r.y)):"n-resize"!==n.d&&"ne-resize"!=n.d&&"nw-resize"!=n.d||(o=n.e.offsetTop+(s-r.y),l=n.e.offsetTop+n.e.offsetHeight-o),o&&(n.e.style.top=o+"px"),i&&(n.e.style.left=i+"px"),a&&(n.e.style.width=a+"px"),l&&(n.e.style.height=l+"px"),"function"==typeof n.e.refresh&&(r.actioned=!0,n.e.refresh("dimensions",a,l))}r.x=t,r.y=s}else{let n=s(e),r=R.findElement(n,"jpanel");if(r)if(r.classList.contains("jpanel-controls")){let e=n.getAttribute("data-position");r.style.cursor=e||""}else if(r.getAttribute("tabindex")){let n=r.getBoundingClientRect();e.clientY-n.top<t?n.width-(e.clientX-n.left)<t?r.style.cursor="ne-resize":e.clientX-n.left<t?r.style.cursor="nw-resize":r.style.cursor="n-resize":n.height-(e.clientY-n.top)<t?n.width-(e.clientX-n.left)<t?r.style.cursor="se-resize":e.clientX-n.left<t?r.style.cursor="sw-resize":r.style.cursor="s-resize":n.width-(e.clientX-n.left)<t?r.style.cursor="e-resize":e.clientX-n.left<t?r.style.cursor="w-resize":r.style.cursor=""}}}),document.addEventListener("mouseover",function(e){var t=s(e).getAttribute("data-tooltip");if(t){if(o.innerText=t,e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY;else n=e.clientX,r=e.clientY;o.style.top=r+"px",o.style.left=n+"px",document.body.appendChild(o)}else o.innerText&&(o.innerText="",document.body.removeChild(o))}),document.addEventListener("keydown",function(e){let t=document.activeElement;t&&"Delete"===e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation());let n=window.jSuitesStateControl;n&&n.length>0&&(t=n[n.length-1],t&&"Escape"===e.key&&"function"==typeof t.isOpened&&"function"==typeof t.close&&t.isOpened()&&(t.close(),e.preventDefault(),e.stopImmediatePropagation()))}),document.addEventListener("contextmenu",function(e){var t=document.activeElement;if(t&&"function"==typeof t.contextmenu)t.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation();else if(t=R.findElement(e.target,function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")}),t){var n=document.querySelector("#"+t);n?(n.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+t)}}),document.addEventListener("input",function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&R.mask(e)})}();var H=R}(),t=o.default}(),t)},655:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{$O:function(){return getWorksheetActive},$x:function(){return parseValue},C6:function(){return showIndex},Em:function(){return executeFormula},P9:function(){return createCell},Rs:function(){return updateScroll},TI:function(){return hideIndex},Xr:function(){return getCellFromCoords},Y5:function(){return fullscreen},am:function(){return updateTable},dw:function(){return isFormula},eN:function(){return getWorksheetInstance},hG:function(){return updateResult},ju:function(){return createNestedHeader},k9:function(){return updateCell},o8:function(){return updateTableReferences},p9:function(){return getLabel},rS:function(){return getMask},tT:function(){return getCell},xF:function(){return updateFormulaChain},yB:function(){return updateFormula}});var jsuites__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(587),jsuites__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jsuites__WEBPACK_IMPORTED_MODULE_0__),_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(834),_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1__),_dispatch__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(988),_selection__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(106),_helpers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9),_meta__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(211),_freeze__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(881),_pagination__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(986),_footer__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(685),_internalHelpers__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(898),updateTable=function(){var e=this;if(e.options.minSpareRows>0){for(var t=0,n=e.rows.length-1;n>=0;n--){for(var r=!1,o=0;o<e.headers.length;o++)e.options.data[n][o]&&(r=!0);if(r)break;t++}e.options.minSpareRows-t>0&&e.insertRow(e.options.minSpareRows-t)}if(e.options.minSpareCols>0){var i=0;for(o=e.headers.length-1;o>=0;o--){var s=!1;for(n=0;n<e.rows.length;n++)e.options.data[n][o]&&(s=!0);if(s)break;i++}e.options.minSpareCols-i>0&&e.insertColumn(e.options.minSpareCols-i)}e.options.footers&&_footer__WEBPACK_IMPORTED_MODULE_8__.e.call(e),setTimeout(function(){_selection__WEBPACK_IMPORTED_MODULE_3__.Aq.call(e)},0)},parseNumber=function(e,t){var n=t&&this.options.columns[t].decimal?this.options.columns[t].decimal:".",r=(""+e).split(n),o=r[0].match(/[+-]?[0-9]/g),i=o?o.join(""):"",s="";if(r[1]){var a=r[1].match(/[0-9]*/g);s=a?a.join(""):""}return i&&Number.isInteger(Number(i))?Number(s?i+"."+s:i+".00"):null},executeFormula=function(expression,x,y){var obj=this,formulaResults=[],formulaLoopProtection={},execute=function(expression,x,y){var parentId=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([x,y]);if(formulaLoopProtection.hasOwnProperty(parentId))return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var n=[],r=e[t].split(":"),o=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(r[0],!0),i=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(r[1],!0),s=void 0,a=void 0;o[0]<=i[0]?(s=o[0],a=i[0]):(s=i[0],a=o[0]);var l=void 0,c=void 0;o[1]<=i[1]?(l=o[1],c=i[1]):(l=i[1],c=o[1]);for(var u=l;u<=c;u++)for(var d=s;d<=a;d++)n.push((0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([d,u]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(tokens[i],!0),value=void 0;if(value=void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]]?obj.options.data[position[1]][position[0]]:"","="==(""+value).substr(0,1)&&(void 0!==formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&0!=obj.parent.config.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=parseNumber.call(obj,value,position[0]);0!=obj.parent.config.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}var ret=_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(obj,"onbeforeformula",obj,expression,x,y);if(!1===ret)return expression;ret&&(expression=ret);var res=void 0;try{res=_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1___default()(expression.substr(1),formulaExpressions,x,y,obj),"function"==typeof res&&(res="#ERROR")}catch(e){res="#ERROR",!0===obj.parent.config.debugFormulas&&console.log(expression.substr(1),formulaExpressions,e)}return res};return execute(expression,x,y)},parseValue=function(e,t,n,r){var o=this;"="==(""+n).substr(0,1)&&0!=o.parent.config.parseFormulas&&(n=executeFormula.call(o,n,e,t));var i=o.options.columns&&o.options.columns[e];if(i&&!isFormula(n)){var s=null;if(s=getMask(i)){n&&n==Number(n)&&(n=Number(n));var a=jsuites__WEBPACK_IMPORTED_MODULE_0___default().mask.render(n,s,!0);if(r&&s.mask){var l=s.mask.split(";");l[1]&&(l[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?r.classList.add("red"):r.classList.remove("red")),l[1].match(new RegExp("\\(","gi"))&&n<0&&(a="("+a+")"))}a&&(n=a)}}return n},getDropDownValue=function(e,t){var n=this,r=[];if(n.options.columns&&n.options.columns[e]&&n.options.columns[e].source){for(var o=[],i=n.options.columns[e].source,s=0;s<i.length;s++)"object"==typeof i[s]?o[i[s].id]=i[s].name:o[i[s]]=i[s];var a=Array.isArray(t)?t:(""+t).split(";");for(s=0;s<a.length;s++)"object"==typeof a[s]?r.push(o[a[s].id]):o[a[s]]&&r.push(o[a[s]])}else console.error("Invalid column");return r.length>0?r.join("; "):""},validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])},stripScript=function(e){var t=new Option;t.innerHTML=e;var n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML},createCell=function(e,t,n){var r=this,o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"none"===r.headers[e].style.display&&(o.style.display="none"),"="==(""+n).substr(0,1)&&1==r.options.secureFormulas){var i=secureFormula(n);i!=n&&(n=i)}if(r.options.columns&&r.options.columns[e]&&"object"==typeof r.options.columns[e].type)!0===r.parent.config.parseHTML?o.innerHTML=n:o.textContent=n,"function"==typeof r.options.columns[e].type.createCell&&r.options.columns[e].type.createCell(o,n,parseInt(e),parseInt(t),r,r.options.columns[e]);else if(r.options.columns&&r.options.columns[e]&&"hidden"==r.options.columns[e].type)o.style.display="none",o.textContent=n;else if(r.options.columns&&r.options.columns[e]&&("checkbox"==r.options.columns[e].type||"radio"==r.options.columns[e].type)){var s=document.createElement("input");s.type=r.options.columns[e].type,s.name="c"+e,s.checked=1==n||1==n||"true"==n,s.onclick=function(){r.setValue(o,this.checked)},1!=r.options.columns[e].readOnly&&0!=r.options.editable||s.setAttribute("disabled","disabled"),o.appendChild(s),r.options.data[t][e]=s.checked}else if(r.options.columns&&r.options.columns[e]&&"calendar"==r.options.columns[e].type){var a=null;if(!validDate(n)){var l=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.extractDateFromString(n,r.options.columns[e].options&&r.options.columns[e].options.format||"YYYY-MM-DD");l&&(a=l)}o.textContent=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.getDateString(a||n,r.options.columns[e].options&&r.options.columns[e].options.format)}else if(r.options.columns&&r.options.columns[e]&&"dropdown"==r.options.columns[e].type)o.classList.add("jss_dropdown"),o.textContent=getDropDownValue.call(r,e,n);else if(r.options.columns&&r.options.columns[e]&&"color"==r.options.columns[e].type)if("square"==r.options.columns[e].render){var c=document.createElement("div");c.className="color",c.style.backgroundColor=n,o.appendChild(c)}else o.style.color=n,o.textContent=n;else if(r.options.columns&&r.options.columns[e]&&"image"==r.options.columns[e].type){if(n&&"data:image"==n.substr(0,10)){var u=document.createElement("img");u.src=n,o.appendChild(u)}}else r.options.columns&&r.options.columns[e]&&"html"==r.options.columns[e].type||!0===r.parent.config.parseHTML?o.innerHTML=stripScript(parseValue.call(this,e,t,n,o)):o.textContent=parseValue.call(this,e,t,n,o);r.options.columns&&r.options.columns[e]&&1==r.options.columns[e].readOnly&&(o.className="readonly");var d=r.options.columns&&r.options.columns[e]&&r.options.columns[e].align||r.options.defaultColAlign||"center";return o.style.textAlign=d,r.options.columns&&r.options.columns[e]&&0==r.options.columns[e].wordWrap||!(1==r.options.wordWrap||r.options.columns&&r.options.columns[e]&&1==r.options.columns[e].wordWrap||o.innerHTML.length>200)||(o.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(n||o.innerHTML?r.records[t][e-1].element.style.overflow="hidden":e==r.options.columns.length-1&&(o.style.overflow="hidden")),_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(r,"oncreatecell",r,o,e,t,n),o},updateCell=function(e,t,n,r){var o,i=this;if(1!=i.records[t][e].element.classList.contains("readonly")||r){if("="==(""+n).substr(0,1)&&1==i.options.secureFormulas){var s=secureFormula(n);s!=n&&(n=s)}var a=_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(i,"onbeforechange",i,i.records[t][e].element,e,t,n);if(null!=a&&(n=a),i.options.columns&&i.options.columns[e]&&"object"==typeof i.options.columns[e].type&&"function"==typeof i.options.columns[e].type.updateCell){var l=i.options.columns[e].type.updateCell(i.records[t][e].element,n,""+e,""+t,i,i.options.columns[e]);void 0!==l&&(n=l)}o={x:e,y:t,col:e,row:t,value:n,oldValue:i.options.data[t][e]};var c=i.options.columns&&i.options.columns[e]&&"object"==typeof i.options.columns[e].type?i.options.columns[e].type:null;if(c)i.options.data[t][e]=n,"function"==typeof c.setValue&&c.setValue(i.records[t][e].element,n);else if(i.options.columns&&i.options.columns[e]&&("checkbox"==i.options.columns[e].type||"radio"==i.options.columns[e].type)){if("radio"==i.options.columns[e].type)for(var u=0;u<i.options.data.length;u++)i.options.data[u][e]=!1;i.records[t][e].element.children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,i.options.data[t][e]=i.records[t][e].element.children[0].checked}else if(i.options.columns&&i.options.columns[e]&&"dropdown"==i.options.columns[e].type)i.options.data[t][e]=n,i.records[t][e].element.textContent=getDropDownValue.call(i,e,n);else if(i.options.columns&&i.options.columns[e]&&"calendar"==i.options.columns[e].type){var d=null;if(!validDate(n)){var p=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.extractDateFromString(n,i.options.columns[e].options&&i.options.columns[e].options.format||"YYYY-MM-DD");p&&(d=p)}i.options.data[t][e]=n,i.records[t][e].element.textContent=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.getDateString(d||n,i.options.columns[e].options&&i.options.columns[e].options.format)}else if(i.options.columns&&i.options.columns[e]&&"color"==i.options.columns[e].type)if(i.options.data[t][e]=n,"square"==i.options.columns[e].render){var f=document.createElement("div");f.className="color",f.style.backgroundColor=n,i.records[t][e].element.textContent="",i.records[t][e].element.appendChild(f)}else i.records[t][e].element.style.color=n,i.records[t][e].element.textContent=n;else if(i.options.columns&&i.options.columns[e]&&"image"==i.options.columns[e].type){if(n=""+n,i.options.data[t][e]=n,i.records[t][e].element.innerHTML="",n&&"data:image"==n.substr(0,10)){var h=document.createElement("img");h.src=n,i.records[t][e].element.appendChild(h)}}else i.options.data[t][e]=n,i.options.columns&&i.options.columns[e]&&"html"==i.options.columns[e].type||!0===i.parent.config.parseHTML?i.records[t][e].element.innerHTML=stripScript(parseValue.call(i,e,t,n,i.records[t][e].element)):i.records[t][e].element.textContent=parseValue.call(i,e,t,n,i.records[t][e].element),i.options.columns&&i.options.columns[e]&&0==i.options.columns[e].wordWrap||!(1==i.options.wordWrap||i.options.columns&&i.options.columns[e]&&1==i.options.columns[e].wordWrap||i.records[t][e].element.innerHTML.length>200)?i.records[t][e].element.style.whiteSpace="":i.records[t][e].element.style.whiteSpace="pre-wrap";e>0&&(i.records[t][e-1].element.style.overflow=n?"hidden":""),i.options.columns&&i.options.columns[e]&&"function"==typeof i.options.columns[e].render&&i.options.columns[e].render(i.records[t]&&i.records[t][e]?i.records[t][e].element:null,n,""+e,""+t,i,i.options.columns[e]),_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(i,"onchange",i,i.records[t]&&i.records[t][e]?i.records[t][e].element:null,e,t,n,o.oldValue)}else o={x:e,y:t,col:e,row:t};return o},isFormula=function(e){var t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},secureFormula=function(e){for(var t="",n=0,r=0;r<e.length;r++)'"'==e[r]&&(n=0==n?1:0),t+=1==n?e[r]:e[r].toUpperCase();return t},chainLoopProtection={},updateFormulaChain=function(e,t,n){var r=this,o=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([e,t]);if(r.formula[o]&&r.formula[o].length>0)if(chainLoopProtection.hasOwnProperty(o))r.records[t][e].element.innerHTML="#ERROR",r.formula[o]="";else{chainLoopProtection[o]=!0;for(var i=0;i<r.formula[o].length;i++){var s=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(r.formula[o][i],!0),a=""+r.options.data[s[1]][s[0]];"="==a.substr(0,1)?n.push(updateCell.call(r,s[0],s[1],a,!0)):delete r.formula[Object.keys(r.formula)[i]],updateFormulaChain.call(r,s[0],s[1],n)}}chainLoopProtection={}},updateFormula=function(e,t){for(var n=/[A-Z]/,r=/[0-9]/,o="",i=null,s=null,a="",l=0;l<e.length;l++)n.exec(e[l])?(i=1,s=0,a+=e[l]):r.exec(e[l])?(s=i?1:0,a+=e[l]):(i&&s&&(a=t[a]?t[a]:a),o+=a,o+=e[l],i=0,s=0,a="");return a&&(i&&s&&(a=t[a]?t[a]:a),o+=a),o},updateFormulas=function(e){for(var t=this,n=0;n<t.options.data.length;n++)for(var r=0;r<t.options.data[0].length;r++)if("="==(l=""+t.options.data[n][r]).substr(0,1)){var o=updateFormula(l,e);o!=l&&(t.options.data[n][r]=o)}var i={},s=Object.keys(t.formula);for(n=0;n<s.length;n++){var a=s[n],l=t.formula[a];for(e[a]&&(a=e[a]),i[a]=[],r=0;r<l.length;r++){var c=l[r];e[c]&&(c=e[c]),i[a].push(c)}}t.formula=i},updateTableReferences=function(){var e=this;if(!e.skipUpdateTableReferences){for(var t=0;t<e.headers.length;t++)(s=e.headers[t].getAttribute("data-x"))!=t&&(e.headers[t].setAttribute("data-x",t),e.headers[t].getAttribute("title")||(e.headers[t].innerHTML=(0,_helpers__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(t)));for(var n=0;n<e.rows.length;n++)e.rows[n]&&(a=e.rows[n].element.getAttribute("data-y"))!=n&&(e.rows[n].element.setAttribute("data-y",n),e.rows[n].element.children[0].setAttribute("data-y",n),e.rows[n].element.children[0].innerHTML=n+1);var r={},o={},i=function(t,n,o,i){if(t!=o&&e.records[i][o].element.setAttribute("data-x",o),n!=i&&e.records[i][o].element.setAttribute("data-y",i),t!=o||n!=i){var s=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([t,n]),a=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([o,i]);r[s]=a}};for(n=0;n<e.records.length;n++)for(t=0;t<e.records[0].length;t++)if(e.records[n][t]){var s=e.records[n][t].element.getAttribute("data-x"),a=e.records[n][t].element.getAttribute("data-y");if(e.records[n][t].element.getAttribute("data-merged")){var l=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([s,a]),c=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([t,n]);if(null==o[l])if(l==c)o[l]=!1;else{var u=t-s,d=n-a;o[l]=[c,u,d]}}else i(s,a,t,n)}var p=Object.keys(o);if(p.length)for(t=0;t<p.length;t++)if(o[p[t]]){var f=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(p[t],!0);for(i(s=f[0],a=f[1],s+o[p[t]][1],a+o[p[t]][2]),l=p[t],c=o[p[t]][0],n=0;n<e.options.mergeCells[l][2].length;n++)s=parseInt(e.options.mergeCells[l][2][n].getAttribute("data-x")),a=parseInt(e.options.mergeCells[l][2][n].getAttribute("data-y")),e.options.mergeCells[l][2][n].setAttribute("data-x",s+o[p[t]][1]),e.options.mergeCells[l][2][n].setAttribute("data-y",a+o[p[t]][2]);e.options.mergeCells[c]=e.options.mergeCells[l],delete e.options.mergeCells[l]}updateFormulas.call(e,r),_meta__WEBPACK_IMPORTED_MODULE_5__.hs.call(e,r),_selection__WEBPACK_IMPORTED_MODULE_3__.G9.call(e),updateTable.call(e)}},updateScroll=function(e){var t,n,r=this,o=r.content.getBoundingClientRect(),i=o.left,s=o.top,a=o.width,l=o.height,c=r.records[r.selectedCell[3]][r.selectedCell[2]].element.getBoundingClientRect(),u=c.left,d=c.top,p=c.width,f=c.height;0==e||1==e?(t=u-i+r.content.scrollLeft,n=d-s+r.content.scrollTop-2):(t=u-i+r.content.scrollLeft+p,n=d-s+r.content.scrollTop+f),n>r.content.scrollTop+30&&n<r.content.scrollTop+l||(n<r.content.scrollTop+30?r.content.scrollTop=n-f:r.content.scrollTop=n-(l-2));var h=_freeze__WEBPACK_IMPORTED_MODULE_6__.w.call(r);t>r.content.scrollLeft+h&&t<r.content.scrollLeft+a||(t<r.content.scrollLeft+30?(r.content.scrollLeft=t,r.content.scrollLeft<50&&(r.content.scrollLeft=0)):t<r.content.scrollLeft+h?r.content.scrollLeft=t-h-1:r.content.scrollLeft=t-(a-20))},updateResult=function(){var e,t=this,n=0;for(e=1==t.options.lazyLoading?100:t.options.pagination>0?t.options.pagination:t.results?t.results.length:t.rows.length;t.tbody.firstChild;)t.tbody.removeChild(t.tbody.firstChild);for(var r=0;r<t.rows.length;r++)!t.results||t.results.indexOf(r)>-1?(n<e&&(t.tbody.appendChild(t.rows[r].element),n++),t.rows[r].element.style.display=""):t.rows[r].element.style.display="none";return t.options.pagination>0&&_pagination__WEBPACK_IMPORTED_MODULE_7__.IV.call(t),_selection__WEBPACK_IMPORTED_MODULE_3__.Aq.call(t),e},getCell=function(e,t){if("string"==typeof e){var n=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(e,!0);e=n[0],t=n[1]}return this.records[t][e].element},getCellFromCoords=function(e,t){return this.records[t][e].element},getLabel=function(e,t){if("string"==typeof e){var n=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(e,!0);e=n[0],t=n[1]}return this.records[t][e].element.innerHTML},fullscreen=function(e){var t=this;null==e&&(e=!t.config.fullscreen),t.config.fullscreen!=e&&(t.config.fullscreen=e,1==e?t.element.classList.add("fullscreen"):t.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jss_nested");var n=document.createElement("td");n.classList.add("jss_selectall"),t.appendChild(n),e.element=t;for(var r=0,o=0;o<e.length;o++){e[o].colspan||(e[o].colspan=1),e[o].title||(e[o].title=""),e[o].id||(e[o].id="");for(var i=e[o].colspan,s=[],a=0;a<i;a++)this.options.columns[r]&&"hidden"==this.options.columns[r].type&&i++,s.push(r),r++;var l=document.createElement("td");l.setAttribute("data-column",s.join(",")),l.setAttribute("colspan",e[o].colspan),l.setAttribute("align",e[o].align||"center"),l.setAttribute("id",e[o].id),l.textContent=e[o].title,t.appendChild(l)}return t},getWorksheetActive=function(){var e=this.parent?this.parent:this;return e.element.tabs?e.element.tabs.getActive():0},getWorksheetInstance=function(e){var t=void 0!==e?e:getWorksheetActive.call(this);return this.worksheets[t]}},685:function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var r=n(655),o=function(e){var t=this;if(e&&(t.options.footers=e),t.options.footers){t.tfoot||(t.tfoot=document.createElement("tfoot"),t.table.appendChild(t.tfoot));for(var n=0;n<t.options.footers.length;n++){var o=void 0;if(t.tfoot.children[n])o=t.tfoot.children[n];else{o=document.createElement("tr");var i=document.createElement("td");o.appendChild(i),t.tfoot.appendChild(o)}for(var s=0;s<t.headers.length;s++){if(t.options.footers[n][s]||(t.options.footers[n][s]=""),i=void 0,t.tfoot.children[n].children[s+1])i=t.tfoot.children[n].children[s+1];else{i=document.createElement("td"),o.appendChild(i);var a=t.options.columns[s].align||t.options.defaultColAlign||"center";i.style.textAlign=a}i.textContent=r.$x.call(t,+t.records.length+s,n,t.options.footers[n][s],i),i.style.display=t.cols[s].colElement.style.display}}}}},745:function(e,t,n){"use strict";n.d(t,{My:function(){return p},Th:function(){return u},iY:function(){return d}});var r=n(587),o=n.n(r),i=n(32),s=n(988),a=n(655),l=n(894),c=n(752),u=function(e,t){for(var n=this,r=0;r<n.headers.length;r++)n.headers[r].classList.remove("arrow-up"),n.headers[r].classList.remove("arrow-down");t?n.headers[e].classList.add("arrow-up"):n.headers[e].classList.add("arrow-down")},d=function(e){for(var t=this,n=[],r=0;r<e.length;r++)n[r]=t.options.data[e[r]];for(t.options.data=n,n=[],r=0;r<e.length;r++){n[r]=t.records[e[r]];for(var o=0;o<n[r].length;o++)n[r][o].y=r}for(t.records=n,n=[],r=0;r<e.length;r++)n[r]=t.rows[e[r]],n[r].y=r;if(t.rows=n,a.o8.call(t),t.results&&t.results.length)t.searchInput.value?t.search(t.searchInput.value):c.F8.call(t);else if(t.results=null,t.pageNumber=0,t.options.pagination>0)t.page(0);else if(1==t.options.lazyLoading)l.wu.call(t,0);else for(r=0;r<t.rows.length;r++)t.tbody.appendChild(t.rows[r].element)},p=function(e,t){var n=this;if(e>=0){if(n.options.mergeCells&&Object.keys(n.options.mergeCells).length>0){if(!confirm(o().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;n.destroyMerge()}t=null==t?n.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var r=[];if(n.options.columns&&n.options.columns[e]&&("number"==n.options.columns[e].type||"numeric"==n.options.columns[e].type||"percentage"==n.options.columns[e].type||"autonumber"==n.options.columns[e].type||"color"==n.options.columns[e].type))for(var a=0;a<n.options.data.length;a++)r[a]=[a,Number(n.options.data[a][e])];else if(n.options.columns&&n.options.columns[e]&&("calendar"==n.options.columns[e].type||"checkbox"==n.options.columns[e].type||"radio"==n.options.columns[e].type))for(a=0;a<n.options.data.length;a++)r[a]=[a,n.options.data[a][e]];else for(a=0;a<n.options.data.length;a++)r[a]=[a,n.records[a][e].element.textContent.toLowerCase()];"function"!=typeof n.parent.config.sorting&&(n.parent.config.sorting=function(e){return function(t,n){var r=t[1],o=n[1];return e?""===r&&""!==o?1:""!==r&&""===o||r>o?-1:r<o?1:0:""===r&&""!==o?1:""!==r&&""===o?-1:r>o?1:r<o?-1:0}}),r=r.sort(n.parent.config.sorting(t));var l=[];for(a=0;a<r.length;a++)l[a]=r[a][0];return i.Dh.call(n,{action:"orderBy",rows:l,column:e,order:t}),u.call(n,e,t),d.call(n,l),s.A.call(n,"onsort",n,e,t,l.map(function(e){return e})),!0}return!1}},752:function(e,t,n){"use strict";n.d(t,{F8:function(){return l},N$:function(){return a},dr:function(){return c}});var r=n(587),o=n.n(r),i=n(655),s=n(106),a=function(e){var t=this;if(t.options.filters){var n=parseInt(e);t.resetSelection();var r=[];if("checkbox"==t.options.columns[n].type)r.push({id:"true",name:"True"}),r.push({id:"false",name:"False"});else{for(var i={},a=!1,u=0;u<t.options.data.length;u++){var d=t.options.data[u][n],p=t.records[u][n].element.innerHTML;d&&p?i[d]=p:a=!0}var f=Object.keys(i);for(r=[],u=0;u<f.length;u++)r.push({id:f[u],name:i[f[u]]});a&&r.push({value:"",id:"",name:"(Blanks)"})}var h=document.createElement("div");t.filter.children[n+1].innerHTML="",t.filter.children[n+1].appendChild(h),t.filter.children[n+1].style.paddingLeft="0px",t.filter.children[n+1].style.paddingRight="0px",t.filter.children[n+1].style.overflow="initial";var m={data:r,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==t.filters[e]?t.filters[e]:null,width:"100%",position:1==t.options.tableOverflow||1==t.parent.config.fullscreen,onclose:function(e){c.call(t),t.filters[n]=e.dropdown.getValue(!0),t.filter.children[n+1].innerHTML=e.dropdown.getText(),t.filter.children[n+1].style.paddingLeft="",t.filter.children[n+1].style.paddingRight="",t.filter.children[n+1].style.overflow="",l.call(t,n),s.G9.call(t)}};o().dropdown(h,m)}else console.log("Jspreadsheet: filters not enabled.")},l=function(e){var t=this;if(!e)for(var n=0;n<t.filter.children.length;n++)t.filters[n]&&(e=n);var r=function(e,n,r){for(var o=0;o<e.length;o++){var i=""+t.options.data[r][n],s=""+t.records[r][n].element.innerHTML;if(e[o]==i||e[o]==s)return!0}return!1},o=t.filters[e];t.results=[];for(var s=0;s<t.options.data.length;s++)r(o,e,s)&&t.results.push(s);t.results.length||(t.results=null),i.hG.call(t)},c=function(){var e=this;if(e.options.filters)for(var t=0;t<e.filter.children.length;t++)e.filter.children[t].innerHTML="&nbsp;",e.filters[t]=null;e.results=null,i.hG.call(e)}},834:function(e){var t;e.exports=(function(){var e={765:function(e,t){var n;n=function(e){e.version="1.0.2";var t=Math;function n(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function r(e,t,n,r,o){if(0===t)return n;if(1===t)return r;for(var i=2/e,s=r,a=1;a<t;++a)s=r*a*i+o*n,n=r,r=s;return s}function o(e,t,n,o,i){return function(n,s){if(o){if(0===n)return 1==o?-1/0:1/0;if(n<0)return NaN}return 0===s?e(n):1===s?t(n):s<0?NaN:r(n,s|=0,e(n),t(n),i)}}var i,s,a,l,c,u,d,p,f,h,m,g,v,y=function(){var e=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(r){var l=0,c=0,u=0,d=r*r;if(r<8)l=(c=n(o,d))/(u=n(i,d));else{var p=r-.785398164;c=n(s,d=64/d),u=n(a,d),l=t.sqrt(e/r)*(t.cos(p)*c-t.sin(p)*u*8/r)}return l}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function f(r){var o=0,i=0,s=0,a=r*r,l=t.abs(r)-2.356194491;return Math.abs(r)<8?o=(i=r*n(c,a))/(s=n(u,a)):(i=n(d,a=64/a),s=n(p,a),o=t.sqrt(e/t.abs(r))*(t.cos(l)*i-t.sin(l)*s*8/t.abs(r)),r<0&&(o=-o)),o}return function e(n,o){if(o=Math.round(o),!isFinite(n))return isNaN(n)?n:0;if(o<0)return(o%2?-1:1)*e(n,-o);if(n<0)return(o%2?-1:1)*e(-n,o);if(0===o)return l(n);if(1===o)return f(n);if(0===n)return 0;var i=0;if(n>o)i=r(n,o,l(n),f(n),-1);else{for(var s=!1,a=0,c=0,u=1,d=0,p=2/n,h=2*t.floor((o+t.floor(t.sqrt(40*o)))/2);h>0;h--)d=h*p*u-a,a=u,u=d,t.abs(u)>1e10&&(u*=1e-10,a*=1e-10,i*=1e-10,c*=1e-10),s&&(c+=u),s=!s,h==o&&(i=a);i/=c=2*c-u}return i}}(),b=(i=.636619772,s=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),a=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),u=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),d=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),f=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o(function(e){var r=0,o=0,u=0,d=e*e,p=e-.785398164;return e<8?r=(o=n(s,d))/(u=n(a,d))+i*y(e,0)*t.log(e):(o=n(l,d=64/d),u=n(c,d),r=t.sqrt(i/e)*(t.sin(p)*o+t.cos(p)*u*8/e)),r},function(e){var r=0,o=0,s=0,a=e*e,l=e-2.356194491;return e<8?r=(o=e*n(u,a))/(s=n(d,a))+i*(y(e,1)*t.log(e)-1/e):(o=n(p,a=64/a),s=n(f,a),r=t.sqrt(i/e)*(t.sin(l)*o+t.cos(l)*s*8/e)),r},0,1,-1)),w=(h=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),m=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),g=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(r,o){if(0===(o=Math.round(o)))return function(e){return e<=3.75?n(h,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(m,3.75/t.abs(e))}(r);if(1===o)return function(e){return e<3.75?e*n(g,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(v,3.75/t.abs(e))}(r);if(o<0)return NaN;if(0===t.abs(r))return 0;if(r==1/0)return 1/0;var i,s=0,a=2/t.abs(r),l=0,c=1,u=0;for(i=2*t.round((o+t.round(t.sqrt(40*o)))/2);i>0;i--)u=i*a*c+l,l=c,c=u,t.abs(c)>1e10&&(c*=1e-10,l*=1e-10,s*=1e-10),i==o&&(s=l);return s*=e(r,0)/c,r<0&&o%2?-s:s}),C=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o(function(o){return o<=2?-t.log(o/2)*w(o,0)+n(e,o*o/4):t.exp(-o)/t.sqrt(o)*n(r,2/o)},function(e){return e<=2?t.log(e/2)*w(e,1)+1/e*n(i,e*e/4):t.exp(-e)/t.sqrt(e)*n(s,2/e)},0,2,1)}();e.besselj=y,e.bessely=b,e.besseli=w,e.besselk=C},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},162:function(e){var t;e.exports=(t=function(e,t){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function i(t,n){var r=t>n?t:n;return e.pow(10,17-~~(e.log(r>0?r:-r)*e.LOG10E))}var s=Array.isArray||function(e){return"[object Array]"===o.call(e)};function a(e){return"[object Function]"===o.call(e)}function l(e){return"number"==typeof e&&e-e==0}function c(){return new c._init(arguments)}function u(){return 0}function d(){return 1}function p(e,t){return e===t?1:0}c.fn=c.prototype,c._init=function(e){if(s(e[0]))if(s(e[0][0])){a(e[1])&&(e[0]=c.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=a(e[1])?c.map(e[0],e[1]):e[0],this.length=1;else if(l(e[0]))this[0]=c.seq.apply(null,e),this.length=1;else{if(e[0]instanceof c)return c(e[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:i,isArray:s,isFunction:a,isNumber:l,toVector:function(e){return n.apply([],e)}},c._random_fn=e.random,c.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");c._random_fn=e},c.extend=function(e){var t,n;if(1===arguments.length){for(n in e)c[n]=e[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},c.rows=function(e){return e.length||1},c.cols=function(e){return e[0].length||1},c.dimensions=function(e){return{rows:c.rows(e),cols:c.cols(e)}},c.row=function(e,t){return s(t)?t.map(function(t){return c.row(e,t)}):e[t]},c.rowa=function(e,t){return c.row(e,t)},c.col=function(e,t){if(s(t)){var n=c.arange(e.length).map(function(){return new Array(t.length)});return t.forEach(function(t,r){c.arange(e.length).forEach(function(o){n[o][r]=e[o][t]})}),n}for(var r=new Array(e.length),o=0;o<e.length;o++)r[o]=[e[o][t]];return r},c.cola=function(e,t){return c.col(e,t).map(function(e){return e[0]})},c.diag=function(e){for(var t=c.rows(e),n=new Array(t),r=0;r<t;r++)n[r]=[e[r][r]];return n},c.antidiag=function(e){for(var t=c.rows(e)-1,n=new Array(t),r=0;t>=0;t--,r++)n[r]=[e[r][t]];return n},c.transpose=function(e){var t,n,r,o,i,a=[];for(s(e[0])||(e=[e]),n=e.length,r=e[0].length,i=0;i<r;i++){for(t=new Array(n),o=0;o<n;o++)t[o]=e[o][i];a.push(t)}return 1===a.length?a[0]:a},c.map=function(e,t,n){var r,o,i,a,l;for(s(e[0])||(e=[e]),o=e.length,i=e[0].length,a=n?e:new Array(o),r=0;r<o;r++)for(a[r]||(a[r]=new Array(i)),l=0;l<i;l++)a[r][l]=t(e[r][l],r,l);return 1===a.length?a[0]:a},c.cumreduce=function(e,t,n){var r,o,i,a,l;for(s(e[0])||(e=[e]),o=e.length,i=e[0].length,a=n?e:new Array(o),r=0;r<o;r++)for(a[r]||(a[r]=new Array(i)),i>0&&(a[r][0]=e[r][0]),l=1;l<i;l++)a[r][l]=t(a[r][l-1],e[r][l]);return 1===a.length?a[0]:a},c.alter=function(e,t){return c.map(e,t,!0)},c.create=function(e,t,n){var r,o,i=new Array(e);for(a(t)&&(n=t,t=e),r=0;r<e;r++)for(i[r]=new Array(t),o=0;o<t;o++)i[r][o]=n(r,o);return i},c.zeros=function(e,t){return l(t)||(t=e),c.create(e,t,u)},c.ones=function(e,t){return l(t)||(t=e),c.create(e,t,d)},c.rand=function(e,t){return l(t)||(t=e),c.create(e,t,c._random_fn)},c.identity=function(e,t){return l(t)||(t=e),c.create(e,t,p)},c.symmetric=function(e){var t,n,r=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<r;t++)for(n=0;n<r;n++)if(e[n][t]!==e[t][n])return!1;return!0},c.clear=function(e){return c.alter(e,u)},c.seq=function(e,t,n,r){a(r)||(r=!1);var o,s=[],l=i(e,t),c=(t*l-e*l)/((n-1)*l),u=e;for(o=0;u<=t&&o<n;u=(e*l+c*l*++o)/l)s.push(r?r(u,o):u);return s},c.arange=function(e,n,r){var o,i=[];if(r=r||1,n===t&&(n=e,e=0),e===n||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(o=e;o<n;o+=r)i.push(o);else for(o=e;o>n;o+=r)i.push(o);return i},c.slice=function(){function e(e,n,r,o){var i,s=[],a=e.length;if(n===t&&r===t&&o===t)return c.copy(e);if(o=o||1,(n=(n=n||0)>=0?n:a+n)===(r=(r=r||e.length)>=0?r:a+r)||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(i=n;i<r;i+=o)s.push(e[i]);else for(i=n;i>r;i+=o)s.push(e[i]);return s}return function(t,n){var r,o;return l((n=n||{}).row)?l(n.col)?t[n.row][n.col]:e(c.rowa(t,n.row),(r=n.col||{}).start,r.end,r.step):l(n.col)?e(c.cola(t,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},r=n.col||{},e(t,o.start,o.end,o.step).map(function(t){return e(t,r.start,r.end,r.step)}))}}(),c.sliceAssign=function(n,r,o){var i,s;if(l(r.row)){if(l(r.col))return n[r.row][r.col]=o;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,i=c.arange(r.col.start,e.min(n.length,r.col.end),r.col.step);var a=r.row;return i.forEach(function(e,t){n[a][e]=o[t]}),n}if(l(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,s=c.arange(r.row.start,e.min(n[0].length,r.row.end),r.row.step);var u=r.col;return s.forEach(function(e,t){n[e][u]=o[t]}),n}return o[0].length===t&&(o=[o]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,s=c.arange(r.row.start,e.min(n.length,r.row.end),r.row.step),i=c.arange(r.col.start,e.min(n[0].length,r.col.end),r.col.step),s.forEach(function(e,t){i.forEach(function(r,i){n[e][r]=o[t][i]})}),n},c.diagonal=function(e){var t=c.zeros(e.length,e.length);return e.forEach(function(e,n){t[n][n]=e}),t},c.copy=function(e){return e.map(function(e){return l(e)?e:e.map(function(e){return e})})};var f=c.prototype;return f.length=0,f.push=Array.prototype.push,f.sort=Array.prototype.sort,f.splice=Array.prototype.splice,f.slice=Array.prototype.slice,f.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},f.map=function(e,t){return c(c.map(this,e,t))},f.cumreduce=function(e,t){return c(c.cumreduce(this,e,t))},f.alter=function(e){return c.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){f[e]=function(t){var n,r=this;return t?(setTimeout(function(){t.call(r,f[e].call(r))}),this):(n=c[e](this),s(n)?c(n):n)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){f[e]=function(t,n){var r=this;return n?(setTimeout(function(){n.call(r,f[e].call(r,t))}),this):c(c[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){f[e]=function(){return c(c[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),c}(Math),function(e,t){var n=e.utils.isFunction;function r(e,t){return e-t}function o(e,n,r){return t.max(n,t.min(e,r))}e.sum=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,r=e.mean(t),o=0,i=t.length;--i>=0;)o+=(n=t[i]-r)*n;return o},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){var r=n.map(t.log),o=e.mean(r);return t.exp(o)},e.median=function(e){var t=e.length,n=e.slice().sort(r);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(e,t){return e+t})},e.cumprod=function(t){return e.cumreduce(t,function(e,t){return e*t})},e.diff=function(e){var t,n=[],r=e.length;for(t=1;t<r;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){var t,n=[],o={};for(t=0;t<e.length;t++)o[l=e[t]]?o[l]++:(o[l]=1,n.push(l));var i=n.sort(r),s={},a=1;for(t=0;t<i.length;t++){var l,c=o[l=i[t]],u=(a+(a+c-1))/2;s[l]=u,a+=c}return e.map(function(e){return s[e]})},e.mode=function(e){var t,n=e.length,o=e.slice().sort(r),i=1,s=0,a=0,l=[];for(t=0;t<n;t++)o[t]===o[t+1]?i++:(i>s?(l=[o[t]],s=i,a=0):i===s&&(l.push(o[t]),a++),i=1);return 0===a?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.pooledvariance=function(t){return t.reduce(function(t,n){return t+e.sumsqerr(n)},0)/(t.reduce(function(e,t){return e+t.length},0)-t.length)},e.deviation=function(t){for(var n=e.mean(t),r=t.length,o=new Array(r),i=0;i<r;i++)o[i]=t[i]-n;return o},e.stdev=function(n,r){return t.sqrt(e.variance(n,r))},e.pooledstdev=function(n){return t.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var r=e.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(t.abs(n[i]-r));return e.mean(o)},e.meddev=function(n){for(var r=e.median(n),o=[],i=n.length-1;i>=0;i--)o.push(t.abs(n[i]-r));return e.median(o)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var n=e.length,o=e.slice().sort(r);return[o[t.round(n/4)-1],o[t.round(n/2)-1],o[t.round(3*n/4)-1]]},e.quantiles=function(e,n,i,s){var a,l,c,u,d,p=e.slice().sort(r),f=[n.length],h=e.length;for(void 0===i&&(i=3/8),void 0===s&&(s=3/8),a=0;a<n.length;a++)c=h*(l=n[a])+(i+l*(1-i-s)),u=t.floor(o(c,1,h-1)),d=o(c-u,0,1),f[a]=(1-d)*p[u-1]+d*p[u];return f},e.percentile=function(e,t,n){var o=e.slice().sort(r),i=t*(o.length+(n?1:-1))+(n?0:1),s=parseInt(i),a=i-s;return s+1<o.length?o[s-1]+a*(o[s]-o[s-1]):o[s-1]},e.percentileOfScore=function(e,t,n){var r,o,i=0,s=e.length,a=!1;for("strict"===n&&(a=!0),o=0;o<s;o++)r=e[o],(a&&r<t||!a&&r<=t)&&i++;return i/s},e.histogram=function(n,r){r=r||4;var o,i=e.min(n),s=(e.max(n)-i)/r,a=n.length,l=[];for(o=0;o<r;o++)l[o]=0;for(o=0;o<a;o++)l[t.min(t.floor((n[o]-i)/s),r-1)]+=1;return l},e.covariance=function(t,n){var r,o=e.mean(t),i=e.mean(n),s=t.length,a=new Array(s);for(r=0;r<s;r++)a[r]=(t[r]-o)*(n[r]-i);return e.sum(a)/(s-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(t,n){return t=e.rank(t),n=e.rank(n),e.corrcoeff(t,n)},e.stanMoment=function(n,r){for(var o=e.mean(n),i=e.stdev(n),s=n.length,a=0,l=0;l<s;l++)a+=t.pow((n[l]-o)/i,r);return a/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(r,o){var s=[],a=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout(function(){o.call(l,i[t].call(l,r))}),this;if(this.length>1){for(l=!0===r?this:this.transpose();a<l.length;a++)s[a]=e[t](l[a]);return s}return e[t](this[0],r)}}(t[r])}("cumsum cumprod".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(r,o){var s=[],a=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout(function(){o.call(l,i[t].call(l,r))}),this;if(this.length>1){for("sumrow"!==t&&(l=!0===r?this:this.transpose());a<l.length;a++)s[a]=e[t](l[a]);return!0===r?e[t](e.utils.toVector(s)):s}return e[t](this[0],r)}}(t[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(){var r,o=[],s=0,a=this,l=Array.prototype.slice.call(arguments);if(n(l[l.length-1])){r=l[l.length-1];var c=l.slice(0,l.length-1);return setTimeout(function(){r.call(a,i[t].apply(a,c))}),this}r=void 0;var u=function(n){return e[t].apply(a,[n].concat(l))};if(this.length>1){for(a=a.transpose();s<a.length;s++)o[s]=u(a[s]);return o}return u(this[0])}}(t[r])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,t){e.gammaln=function(e){var n,r,o,i=0,s=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(o=(r=n=e)+5.5,o-=(n+.5)*t.log(o);i<6;i++)a+=s[i]/++r;return t.log(2.5066282746310007*a/n)-o},e.loggam=function(e){var n,r,o,i,s,a,l,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=e,l=0,1==e||2==e)return 0;for(e<=7&&(n=e+(l=t.floor(7-e))),r=1/(n*n),o=2*t.PI,s=c[9],a=8;a>=0;a--)s*=r,s+=c[a];if(i=s/n+.5*t.log(o)+(n-.5)*t.log(n)-n,e<=7)for(a=1;a<=l;a++)i-=t.log(n-1),n-=1;return i},e.gammafn=function(e){var n,r,o,i,s=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,c=0,u=0,d=0,p=e;if(e>171.6243769536076)return 1/0;if(p<=0){if(!(i=p%1+36e-17))return 1/0;l=(1&p?-1:1)*t.PI/t.sin(t.PI*i),p=1-p}for(o=p,r=p<1?p++:(p-=c=(0|p)-1)-1,n=0;n<8;++n)d=(d+s[n])*r,u=u*r+a[n];if(i=d/u+1,o<p)i/=o;else if(o>p)for(n=0;n<c;++n)i*=p,p++;return l&&(i=l/i),i},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,r){var o,i=e.gammaln(n),s=n,a=1/n,l=a,c=r+1-n,u=1/1e-30,d=1/c,p=d,f=1,h=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;f<=h;f++)a+=l*=r/++s;return a*t.exp(-r+n*t.log(r)-i)}for(;f<=h;f++)p*=(d=1/(d=(o=-f*(f-n))*d+(c+=2)))*(u=c+o/u);return 1-p*t.exp(-r+n*t.log(r)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,r){return n>170||r>170?t.exp(e.combinationln(n,r)):e.factorial(n)/e.factorial(r)/e.factorial(n-r)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?t.exp(e.betaln(n,r)):e.gammafn(n)*e.gammafn(r)/e.gammafn(n+r)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,r){var o,i,s,a,l=1e-30,c=1,u=n+r,d=n+1,p=n-1,f=1,h=1-u*e/d;for(t.abs(h)<l&&(h=l),a=h=1/h;c<=100&&(h=1+(i=c*(r-c)*e/((p+(o=2*c))*(n+o)))*h,t.abs(h)<l&&(h=l),f=1+i/f,t.abs(f)<l&&(f=l),a*=(h=1/h)*f,h=1+(i=-(n+c)*(u+c)*e/((n+o)*(d+o)))*h,t.abs(h)<l&&(h=l),f=1+i/f,t.abs(f)<l&&(f=l),a*=s=(h=1/h)*f,!(t.abs(s-1)<3e-7));c++);return a},e.gammapinv=function(n,r){var o,i,s,a,l,c,u=0,d=r-1,p=e.gammaln(r);if(n>=1)return t.max(100,r+100*t.sqrt(r));if(n<=0)return 0;for(r>1?(l=t.log(d),c=t.exp(d*(l-1)-p),a=n<.5?n:1-n,o=(2.30753+.27061*(i=t.sqrt(-2*t.log(a))))/(1+i*(.99229+.04481*i))-i,n<.5&&(o=-o),o=t.max(.001,r*t.pow(1-1/(9*r)-o/(3*t.sqrt(r)),3))):o=n<(i=1-r*(.253+.12*r))?t.pow(n/i,1/r):1-t.log(1-(n-i)/(1-i));u<12;u++){if(o<=0)return 0;if((o-=i=(s=(e.lowRegGamma(r,o)-n)/(i=r>1?c*t.exp(-(o-d)+d*(t.log(o)-l)):t.exp(-o+d*t.log(o)-p)))/(1-.5*t.min(1,s*((r-1)/o-1))))<=0&&(o=.5*(o+i)),t.abs(i)<1e-8*o)break}return o},e.erf=function(e){var n,r,o,i,s=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=s.length-1,l=!1,c=0,u=0;for(e<0&&(e=-e,l=!0),r=4*(n=2/(2+e))-2;a>0;a--)o=c,c=r*c-u+s[a],u=o;return i=n*t.exp(-e*e+.5*(s[0]+r*c)-u),l?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var r,o,i,s,a=0;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,r=-.70711*((2.30753+.27061*(i=t.sqrt(-2*t.log(s/2))))/(1+i*(.99229+.04481*i))-i);a<2;a++)r+=(o=e.erfc(r)-s)/(1.1283791670955126*t.exp(-r*r)-r*o);return n<1?r:-r},e.ibetainv=function(n,r,o){var i,s,a,l,c,u,d,p,f,h,m=r-1,g=o-1,v=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(a=n<.5?n:1-n,u=(2.30753+.27061*(l=t.sqrt(-2*t.log(a))))/(1+l*(.99229+.04481*l))-l,n<.5&&(u=-u),d=(u*u-3)/6,p=2/(1/(2*r-1)+1/(2*o-1)),f=u*t.sqrt(d+p)/p-(1/(2*o-1)-1/(2*r-1))*(d+5/6-2/(3*p)),u=r/(r+o*t.exp(2*f))):(i=t.log(r/(r+o)),s=t.log(o/(r+o)),u=n<(l=t.exp(r*i)/r)/(f=l+(c=t.exp(o*s)/o))?t.pow(r*f*n,1/r):1-t.pow(o*f*(1-n),1/o)),h=-e.gammaln(r)-e.gammaln(o)+e.gammaln(r+o);v<10;v++){if(0===u||1===u)return u;if((u-=l=(c=(e.ibeta(u,r,o)-n)/(l=t.exp(m*t.log(u)+g*t.log(1-u)+h)))/(1-.5*t.min(1,c*(m/u-g/(1-u)))))<=0&&(u=.5*(u+l)),u>=1&&(u=.5*(u+l+1)),t.abs(l)<1e-8*u&&v>0)break}return u},e.ibeta=function(n,r,o){var i=0===n||1===n?0:t.exp(e.gammaln(r+o)-e.gammaln(r)-e.gammaln(o)+r*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*e.betacf(n,r,o)/r:1-i*e.betacf(1-n,o,r)/o)},e.randn=function(n,r){var o,i,s,a,l;if(r||(r=n),n)return e.create(n,r,function(){return e.randn()});do{o=e._random_fn(),i=1.7156*(e._random_fn()-.5),l=(s=o-.449871)*s+(a=t.abs(i)+.386595)*(.196*a-.25472*s)}while(l>.27597&&(l>.27846||i*i>-4*t.log(o)*o*o));return i/o},e.randg=function(n,r,o){var i,s,a,l,c,u,d=n;if(o||(o=r),n||(n=1),r)return(u=e.zeros(r,o)).alter(function(){return e.randg(n)}),u;n<1&&(n+=1),i=n-1/3,s=1/t.sqrt(9*i);do{do{l=1+s*(c=e.randn())}while(l<=0);l*=l*l,a=e._random_fn()}while(a>1-.331*t.pow(c,4)&&t.log(a)>.5*c*c+i*(1-l+t.log(l)));if(n==d)return i*l;do{a=e._random_fn()}while(0===a);return t.pow(a,1/d)*i*l},function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e.map(this,function(n){return e[t](n)}))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(t,Math),function(e,t){function n(e,n,r,o){for(var i,s=0,a=1,l=1,c=1,u=0,d=0;t.abs((l-d)/l)>o;)d=l,a=c+(i=-(n+u)*(n+r+u)*e/(n+2*u)/(n+2*u+1))*a,l=(s=l+i*s)+(i=(u+=1)*(r-u)*e/(n+2*u-1)/(n+2*u))*l,s/=c=a+i*c,a/=c,l/=c,c=1;return l/n}function r(n,r,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],s=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],a=.5*n;if(a>=8)return 1;var l,c=2*e.normal.cdf(a,0,1,1,0)-1;c=c>=t.exp(-50/o)?t.pow(c,o):0;for(var u=a,d=(8-a)/(l=n>3?2:3),p=u+d,f=0,h=o-1,m=1;m<=l;m++){for(var g=0,v=.5*(p+u),y=.5*(p-u),b=1;b<=12;b++){var w,C=v+y*(6<b?i[(w=12-b+1)-1]:-i[(w=b)-1]),x=C*C;if(x>60)break;var E=2*e.normal.cdf(C,0,1,1,0)*.5-2*e.normal.cdf(C,n,1,1,0)*.5;E>=t.exp(-30/h)&&(g+=E=s[w-1]*t.exp(-.5*x)*t.pow(E,h))}f+=g*=2*y*o/t.sqrt(2*t.PI),u=p,p+=d}return(c+=f)<=t.exp(-30/r)?0:(c=t.pow(c,r))>=1?1:c}!function(t){for(var n=0;n<t.length;n++)!function(t){e[t]=function e(t,n,r){return this instanceof e?(this._a=t,this._b=n,this._c=r,this):new e(t,n,r)},e.fn[t]=function(n,r,o){var i=e[t](n,r,o);return i.data=this,i},e[t].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?e.alter(n,function(){return e[t].sample(r,o,i)}):e[t].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(r){var o=this._a,i=this._b,s=this._c;return r||0===r||(r=this.data),"number"!=typeof r?e.fn.map.call(r,function(r){return e[t][n](r,o,i,s)}):e[t][n](r,o,i,s)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?t.pow(n,r-1)*t.pow(1-n,o-1)/e.betafn(r,o):t.exp((r-1)*t.log(n)+(o-1)*t.log(1-n)-e.betaln(r,o))},cdf:function(t,n,r){return t>1||t<0?1*(t>1):e.ibeta(t,n,r)},inv:function(t,n,r){return e.ibetainv(t,n,r)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var r=e.randg(t);return r/(r+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,r,o){var i;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/e.betafn(r/2,o/2)*t.pow(r/o,r/2)*t.pow(n,r/2-1)*t.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),r*(o/(o+n*r))/2*e.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(t,n,r){return t<0?0:e.ibeta(n*t/(n*t+r),n/2,r/2)},inv:function(t,n,r){return r/(n*(1/e.ibetainv(t,n/2,r/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){return 2*e.randg(t/2)/t/(2*e.randg(n/2)/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,r){return r<0?0:r/(t.pow(e-n,2)+t.pow(r,2))/t.PI},cdf:function(e,n,r){return t.atan((e-n)/r)/t.PI+.5},inv:function(e,n,r){return n+r*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(n,r){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*r+n}}),e.extend(e.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:t.exp((r/2-1)*t.log(n)-n/2-r/2*t.log(2)-e.gammaln(r/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:t.exp((r-1)*t.log(n)-n/o-e.gammaln(r)-r*t.log(o))},cdf:function(t,n,r){return t<0?0:e.lowRegGamma(n,t/r)},inv:function(t,n,r){return e.gammapinv(t,n)*r},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,r,o){return n<=0?0:t.exp(-(r+1)*t.log(n)-o/n-e.gammaln(r)+r*t.log(o))},cdf:function(t,n,r){return t<=0?0:1-e.lowRegGamma(n,r/t)},inv:function(t,n,r){return r/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,r){return 0===e&&1===n?r:1===e&&1===r?n:t.exp(t.log(n)+t.log(r)+(n-1)*t.log(e)+(r-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,r){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),r)},inv:function(e,n,r){return t.pow(1-t.pow(1-e,1/r),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,r){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(e)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*e.erf((t.log(n)-r)/t.sqrt(2*o*o))},inv:function(n,r,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*n)+r)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,r){return t.exp(e.randn()*r+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,r,o){return t.abs(o)<1e-14?e.studentt.pdf(n,r):t.abs(n)<1e-14?t.exp(e.gammaln((r+1)/2)-o*o/2-.5*t.log(t.PI*r)-e.gammaln(r/2)):r/n*(e.noncentralt.cdf(n*t.sqrt(1+2/r),r+2,o)-e.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){var i=1e-14;if(t.abs(o)<i)return e.studentt.cdf(n,r);var s=!1;n<0&&(s=!0,o=-o);for(var a=e.normal.cdf(-o,0,1),l=i+1,c=l,u=n*n/(n*n+r),d=0,p=t.exp(-o*o/2),f=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;d<200||c>i||l>i;)c=l,d>0&&(p*=o*o/(2*d),f*=o*o/(2*(d+.5))),a+=.5*(l=p*e.beta.cdf(u,d+.5,r/2)+f*e.beta.cdf(u,d+1,r/2)),d++;return s?1-a:a}}),e.extend(e.normal,{pdf:function(e,n,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(e-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+e.erf((n-r)/t.sqrt(2*o*o)))},inv:function(t,n,r){return-1.4142135623730951*r*e.erfcinv(2*t)+n},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,r){return e<n?0:r*t.pow(n,r)/t.pow(e,r+1)},cdf:function(e,n,r){return e<n?0:1-t.pow(n/e,r)},inv:function(e,n,r){return n/t.pow(1-e,1/r)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(t.sqrt(r)*e.betafn(.5,r/2))*t.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return e.ibeta((n+t.sqrt(n*n+r))/(2*t.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=e.ibetainv(2*t.min(n,1-n),.5*r,.5);return o=t.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,r){return e<0||n<0||r<0?0:r/n*t.pow(e/n,r-1)*t.exp(-t.pow(e/n,r))},cdf:function(e,n,r){return e<0?0:1-t.exp(-t.pow(e/n,r))},inv:function(e,n,r){return n*t.pow(-t.log(1-e),1/r)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(n,r){return n*t.pow(-t.log(e._random_fn()),1/r)},variance:function(n,r){return n*n*e.gammafn(1+2/r)-t.pow(e.weibull.mean(n,r),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*e._random_fn()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:e.combination(r,n)*t.pow(o,n)*t.pow(1-o,r-n)},cdf:function(r,o,i){var s,a=1e-10;if(r<0)return 0;if(r>=o)return 1;if(i<0||i>1||o<=0)return NaN;var l=i,c=(r=t.floor(r))+1,u=o-r,d=c+u,p=t.exp(e.gammaln(d)-e.gammaln(u)-e.gammaln(c)+c*t.log(l)+u*t.log(1-l));return s=l<(c+1)/(d+2)?p*n(l,c,u,a):1-p*n(1-l,u,c,a),t.round(1/a*(1-s))/(1/a)}}),e.extend(e.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:e.combination(n+r-1,r-1)*t.pow(1-o,n)*t.pow(o,r))},cdf:function(t,n,r){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++)o+=e.negbin.pdf(i,n,r);return o}}),e.extend(e.hypgeom,{pdf:function(n,r,o,i){if(n!=n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?e.hypgeom.pdf(r-o-i+n,r,r-o,r-i):e.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return e.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return e.hypgeom.pdf(n,r,i,o);for(var s=1,a=0,l=0;l<n;l++){for(;s>1&&a<i;)s*=1-o/(r-a),a++;s*=(i-l)*(o-l)/((l+1)*(r-o-i+l+1))}for(;a<i;a++)s*=1-o/(r-a);return t.min(1,t.max(0,s))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?e.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-e.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-e.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return e.hypgeom.cdf(n,r,i,o);for(var s=1,a=1,l=0,c=0;c<n;c++){for(;s>1&&l<i;){var u=1-o/(r-l);a*=u,s*=u,l++}s+=a*=(i-c)*(o-c)/((c+1)*(r-o-i+c+1))}for(;l<i;l++)s*=1-o/(r-l);return t.min(1,t.max(0,s))}}),e.extend(e.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:t.pow(r,n)*t.exp(-r)/e.factorial(n)},cdf:function(t,n){var r=[],o=0;if(t<0)return 0;for(;o<=t;o++)r.push(e.poisson.pdf(o,n));return e.sum(r)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(n){var r=1,o=0,i=t.exp(-n);do{o++,r*=e._random_fn()}while(r>i);return o-1},sampleLarge:function(n){var r,o,i,s,a,l,c,u,d,p,f=n;for(s=t.sqrt(f),a=t.log(f),l=.02483*(c=.931+2.53*s)-.059,u=1.1239+1.1328/(c-3.4),d=.9277-3.6224/(c-2);;){if(o=t.random()-.5,i=t.random(),p=.5-t.abs(o),r=t.floor((2*l/p+c)*o+f+.43),p>=.07&&i<=d)return r;if(!(r<0||p<.013&&i>p)&&t.log(i)+t.log(u)-t.log(l/(p*p)+c)<=r*a-f-e.loggam(r+1))return r}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,n,r){return n<=t||r<t||r>n?NaN:e<t||e>n?0:e<r?2*(e-t)/((n-t)*(r-t)):e===r?2/(n-t):2*(n-e)/((n-t)*(n-r))},cdf:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=n?0:e>=r?1:e<=o?t.pow(e-n,2)/((r-n)*(o-n)):1-t.pow(r-e,2)/((r-n)*(r-o))},inv:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=(o-n)/(r-n)?n+(r-n)*t.sqrt(e*((o-n)/(r-n))):n+(r-n)*(1-t.sqrt((1-e)*(1-(o-n)/(r-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,r){return r<=(e+n)/2?n-t.sqrt((n-e)*(n-r))/t.sqrt(2):r>(e+n)/2?e+t.sqrt((n-e)*(r-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(n,r,o){var i=e._random_fn();return i<(o-n)/(r-n)?n+t.sqrt(i*(r-n)*(o-n)):r-t.sqrt((1-i)*(r-n)*(r-o))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.arcsine,{pdf:function(e,n,r){return r<=n?NaN:e<=n||e>=r?0:2/t.PI*t.pow(t.pow(r-n,2)-t.pow(2*e-n-r,2),-.5)},cdf:function(e,n,r){return e<n?0:e<r?2/t.PI*t.asin(t.sqrt((e-n)/(r-n))):1},inv:function(e,n,r){return n+(.5-.5*t.cos(t.PI*e))*(r-n)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,n){return n<=e?NaN:t.pow(n-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,n,r){return r<=0?0:t.exp(-t.abs(e-n)/r)/(2*r)},cdf:function(e,n,r){return r<=0?0:e<n?.5*t.exp((e-n)/r):1-.5*t.exp(-(e-n)/r)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(n,r){var o,i=e._random_fn()-.5;return n-r*((o=i)/t.abs(o))*t.log(1-2*t.abs(i))}}),e.extend(e.tukey,{cdf:function(n,o,i){var s=o,a=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||s<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return r(n,1,s);var c,u=.5*i,d=u*t.log(i)-i*t.log(2)-e.gammaln(u),p=u-1,f=.25*i;c=i<=100?1:i<=800?.5:i<=5e3?.25:.125,d+=t.log(c);for(var h=0,m=1;m<=50;m++){for(var g=0,v=(2*m-1)*c,y=1;y<=16;y++){var b,w;8<y?(b=y-8-1,w=d+p*t.log(v+a[b]*c)-(a[b]*c+v)*f):(b=y-1,w=d+p*t.log(v-a[b]*c)+(a[b]*c-v)*f),w>=-30&&(g+=r(8<y?n*t.sqrt(.5*(a[b]*c+v)):n*t.sqrt(.5*(-a[b]*c+v)),1,s)*l[b]*t.exp(w))}if(m*c>=1&&g<=1e-14)break;h+=g}if(g>1e-14)throw new Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(n,r,o){if(o<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,s=function(e,n,r){var o=.5-.5*e,i=t.sqrt(t.log(1/(o*o))),s=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);r<120&&(s+=(s*s*s+s)/r/4);var a=.8832-.2368*s;return r<120&&(a+=-1.214/r+1.208*s/r),s*(a*t.log(n-1)+1.4142)}(n,r,o),a=e.tukey.cdf(s,r,o)-n;i=a>0?t.max(0,s-1):s+1;for(var l,c=e.tukey.cdf(i,r,o)-n,u=1;u<50;u++)if(l=i-c*(i-s)/(c-a),a=c,s=i,l<0&&(l=0,c=-n),c=e.tukey.cdf(l,r,o)-n,i=l,t.abs(i-s)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var n,r,o=Array.prototype.push,i=e.utils.isArray;function s(t){return i(t)||t instanceof e}e.extend({add:function(t,n){return s(n)?(s(n[0])||(n=[n]),e.map(t,function(e,t,r){return e+n[t][r]})):e.map(t,function(e){return e+n})},subtract:function(t,n){return s(n)?(s(n[0])||(n=[n]),e.map(t,function(e,t,r){return e-n[t][r]||0})):e.map(t,function(e){return e-n})},divide:function(t,n){return s(n)?(s(n[0])||(n=[n]),e.multiply(t,e.inv(n))):e.map(t,function(e){return e/n})},multiply:function(t,n){var r,o,i,a,l,c,u,d;if(void 0===t.length&&void 0===n.length)return t*n;if(l=t.length,c=t[0].length,u=e.zeros(l,i=s(n)?n[0].length:c),d=0,s(n)){for(;d<i;d++)for(r=0;r<l;r++){for(a=0,o=0;o<c;o++)a+=t[r][o]*n[o][d];u[r][d]=a}return 1===l&&1===d?u[0][0]:u}return e.map(t,function(e){return e*n})},outer:function(t,n){return e.multiply(t.map(function(e){return[e]}),[n])},dot:function(t,n){s(t[0])||(t=[t]),s(n[0])||(n=[n]);for(var r,o,i=1===t[0].length&&1!==t.length?e.transpose(t):t,a=1===n[0].length&&1!==n.length?e.transpose(n):n,l=[],c=0,u=i.length,d=i[0].length;c<u;c++){for(l[c]=[],r=0,o=0;o<d;o++)r+=i[c][o]*a[c][o];l[c]=r}return 1===l.length?l[0]:l},pow:function(n,r){return e.map(n,function(e){return t.pow(e,r)})},exp:function(n){return e.map(n,function(e){return t.exp(e)})},log:function(n){return e.map(n,function(e){return t.log(e)})},abs:function(n){return e.map(n,function(e){return t.abs(e)})},norm:function(e,n){var r=0,o=0;for(isNaN(n)&&(n=2),s(e[0])&&(e=e[0]);o<e.length;o++)r+=t.pow(t.abs(e[o]),n);return t.pow(r,1/n)},angle:function(n,r){return t.acos(e.dot(n,r)/(e.norm(n)*e.norm(r)))},aug:function(e,t){var n,r=[];for(n=0;n<e.length;n++)r.push(e[n].slice());for(n=0;n<r.length;n++)o.apply(r[n],t[n]);return r},inv:function(t){for(var n,r=t.length,o=t[0].length,i=e.identity(r,o),s=e.gauss_jordan(t,i),a=[],l=0;l<r;l++)for(a[l]=[],n=o;n<s[0].length;n++)a[l][n-o]=s[l][n];return a},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,r=0;r<t.length;r++){for(var o=[],i=1;i<t.length;i++){o[i-1]=[];for(var s=0;s<t.length;s++)s<r?o[i-1][s]=t[i][s]:s>r&&(o[i-1][s-1]=t[i][s])}var a=r%2?-1:1;n+=e(o)*t[0][r]*a}return n},gauss_elimination:function(n,r){var o,i,s,a,l=0,c=0,u=n.length,d=n[0].length,p=1,f=0,h=[];for(o=(n=e.aug(n,r))[0].length,l=0;l<u;l++){for(i=n[l][l],c=l,a=l+1;a<d;a++)i<t.abs(n[a][l])&&(i=n[a][l],c=a);if(c!=l)for(a=0;a<o;a++)s=n[l][a],n[l][a]=n[c][a],n[c][a]=s;for(c=l+1;c<u;c++)for(p=n[c][l]/n[l][l],a=l;a<o;a++)n[c][a]=n[c][a]-p*n[l][a]}for(l=u-1;l>=0;l--){for(f=0,c=l+1;c<=u-1;c++)f+=h[c]*n[l][c];h[l]=(n[l][o-1]-f)/n[l][l]}return h},gauss_jordan:function(n,r){var o,i,s,a=e.aug(n,r),l=a.length,c=a[0].length,u=0;for(i=0;i<l;i++){var d=i;for(s=i+1;s<l;s++)t.abs(a[s][i])>t.abs(a[d][i])&&(d=s);var p=a[i];for(a[i]=a[d],a[d]=p,s=i+1;s<l;s++)for(u=a[s][i]/a[i][i],o=i;o<c;o++)a[s][o]-=a[i][o]*u}for(i=l-1;i>=0;i--){for(u=a[i][i],s=0;s<i;s++)for(o=c-1;o>i-1;o--)a[s][o]-=a[i][o]*a[s][i]/u;for(a[i][i]/=u,o=l;o<c;o++)a[i][o]/=u}return a},triaUpSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],s=!1;return null!=n[0].length&&(n=n.map(function(e){return e[0]}),s=!0),e.arange(o-1,-1,-1).forEach(function(s){r=e.arange(s+1,o).map(function(e){return i[e]*t[s][e]}),i[s]=(n[s]-e.sum(r))/t[s][s]}),s?i.map(function(e){return[e]}):i},triaLowSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],s=!1;return null!=n[0].length&&(n=n.map(function(e){return e[0]}),s=!0),e.arange(o).forEach(function(o){r=e.arange(o).map(function(e){return t[o][e]*i[e]}),i[o]=(n[o]-e.sum(r))/t[o][o]}),s?i.map(function(e){return[e]}):i},lu:function(t){var n,r=t.length,o=e.identity(r),i=e.zeros(t.length,t[0].length);return e.arange(r).forEach(function(e){i[0][e]=t[0][e]}),e.arange(1,r).forEach(function(s){e.arange(s).forEach(function(r){n=e.arange(r).map(function(e){return o[s][e]*i[e][r]}),o[s][r]=(t[s][r]-e.sum(n))/i[r][r]}),e.arange(s,r).forEach(function(r){n=e.arange(s).map(function(e){return o[s][e]*i[e][r]}),i[s][r]=t[n.length][r]-e.sum(n)})}),[o,i]},cholesky:function(n){var r,o=n.length,i=e.zeros(n.length,n[0].length);return e.arange(o).forEach(function(s){r=e.arange(s).map(function(e){return t.pow(i[s][e],2)}),i[s][s]=t.sqrt(n[s][s]-e.sum(r)),e.arange(s+1,o).forEach(function(t){r=e.arange(s).map(function(e){return i[s][e]*i[t][e]}),i[t][s]=(n[s][t]-e.sum(r))/i[s][s]})}),i},gauss_jacobi:function(n,r,o,i){for(var s,a,l,c,u=0,d=0,p=n.length,f=[],h=[],m=[];u<p;u++)for(f[u]=[],h[u]=[],m[u]=[],d=0;d<p;d++)u>d?(f[u][d]=n[u][d],h[u][d]=m[u][d]=0):u<d?(h[u][d]=n[u][d],f[u][d]=m[u][d]=0):(m[u][d]=n[u][d],f[u][d]=h[u][d]=0);for(l=e.multiply(e.multiply(e.inv(m),e.add(f,h)),-1),a=e.multiply(e.inv(m),r),s=o,c=e.add(e.multiply(l,o),a),u=2;t.abs(e.norm(e.subtract(c,s)))>i;)s=c,c=e.add(e.multiply(l,s),a),u++;return c},gauss_seidel:function(n,r,o,i){for(var s,a,l,c,u,d=0,p=n.length,f=[],h=[],m=[];d<p;d++)for(f[d]=[],h[d]=[],m[d]=[],s=0;s<p;s++)d>s?(f[d][s]=n[d][s],h[d][s]=m[d][s]=0):d<s?(h[d][s]=n[d][s],f[d][s]=m[d][s]=0):(m[d][s]=n[d][s],f[d][s]=h[d][s]=0);for(c=e.multiply(e.multiply(e.inv(e.add(m,f)),h),-1),l=e.multiply(e.inv(e.add(m,f)),r),a=o,u=e.add(e.multiply(c,o),l),d=2;t.abs(e.norm(e.subtract(u,a)))>i;)a=u,u=e.add(e.multiply(c,a),l),d+=1;return u},SOR:function(n,r,o,i,s){for(var a,l,c,u,d,p=0,f=n.length,h=[],m=[],g=[];p<f;p++)for(h[p]=[],m[p]=[],g[p]=[],a=0;a<f;a++)p>a?(h[p][a]=n[p][a],m[p][a]=g[p][a]=0):p<a?(m[p][a]=n[p][a],h[p][a]=g[p][a]=0):(g[p][a]=n[p][a],h[p][a]=m[p][a]=0);for(u=e.multiply(e.inv(e.add(g,e.multiply(h,s))),e.subtract(e.multiply(g,1-s),e.multiply(m,s))),c=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(h,s))),r),s),l=o,d=e.add(e.multiply(u,o),c),p=2;t.abs(e.norm(e.subtract(d,l)))>i;)l=d,d=e.add(e.multiply(u,l),c),p++;return d},householder:function(n){for(var r,o,i,s,a=n.length,l=n[0].length,c=0,u=[],d=[];c<a-1;c++){for(r=0,s=c+1;s<l;s++)r+=n[s][c]*n[s][c];for(r=(n[c+1][c]>0?-1:1)*t.sqrt(r),o=t.sqrt((r*r-n[c+1][c]*r)/2),(u=e.zeros(a,1))[c+1][0]=(n[c+1][c]-r)/(2*o),i=c+2;i<a;i++)u[i][0]=n[i][c]/(2*o);d=e.subtract(e.identity(a,l),e.multiply(e.multiply(u,e.transpose(u)),2)),n=e.multiply(d,e.multiply(n,d))}return n},QR:(n=e.sum,r=e.arange,function(o){var i,s,a,l=o.length,c=o[0].length,u=e.zeros(c,c);for(o=e.copy(o),s=0;s<c;s++){for(u[s][s]=t.sqrt(n(r(l).map(function(e){return o[e][s]*o[e][s]}))),i=0;i<l;i++)o[i][s]=o[i][s]/u[s][s];for(a=s+1;a<c;a++)for(u[s][a]=n(r(l).map(function(e){return o[e][s]*o[e][a]})),i=0;i<l;i++)o[i][a]=o[i][a]-o[i][s]*u[s][a]}return[o,u]}),lstsq:function(t,n){var r=!1;void 0===n[0].length&&(n=n.map(function(e){return[e]}),r=!0);var o=e.QR(t),i=o[0],s=o[1],a=t[0].length,l=e.slice(i,{col:{end:a}}),c=function(t){var n=(t=e.copy(t)).length,r=e.identity(n);return e.arange(n-1,-1,-1).forEach(function(n){e.sliceAssign(r,{row:n},e.divide(e.slice(r,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach(function(o){var i=e.multiply(t[o][n],-1),s=e.slice(t,{row:o}),a=e.multiply(e.slice(t,{row:n}),i);e.sliceAssign(t,{row:o},e.add(s,a));var l=e.slice(r,{row:o}),c=e.multiply(e.slice(r,{row:n}),i);e.sliceAssign(r,{row:o},e.add(l,c))})}),r}(e.slice(s,{row:{end:a}})),u=e.transpose(l);void 0===u[0].length&&(u=[u]);var d=e.multiply(e.multiply(c,u),n);return void 0===d.length&&(d=[[d]]),r?d.map(function(e){return e[0]}):d},jacobi:function(n){for(var r,o,i,s,a,l,c,u=1,d=n.length,p=e.identity(d,d),f=[];1===u;){for(a=n[0][1],i=0,s=1,r=0;r<d;r++)for(o=0;o<d;o++)r!=o&&a<t.abs(n[r][o])&&(a=t.abs(n[r][o]),i=r,s=o);for(l=n[i][i]===n[s][s]?n[i][s]>0?t.PI/4:-t.PI/4:t.atan(2*n[i][s]/(n[i][i]-n[s][s]))/2,(c=e.identity(d,d))[i][i]=t.cos(l),c[i][s]=-t.sin(l),c[s][i]=t.sin(l),c[s][s]=t.cos(l),p=e.multiply(p,c),n=e.multiply(e.multiply(e.inv(c),n),c),u=0,r=1;r<d;r++)for(o=1;o<d;o++)r!=o&&t.abs(n[r][o])>.001&&(u=1)}for(r=0;r<d;r++)f.push(n[r][r]);return[p,f]},rungekutta:function(e,t,n,r,o,i){var s,a,l;if(2===i)for(;r<=n;)o+=((s=t*e(r,o))+(a=t*e(r+t,o+s)))/2,r+=t;if(4===i)for(;r<=n;)o+=((s=t*e(r,o))+2*(a=t*e(r+t/2,o+s/2))+2*(l=t*e(r+t/2,o+a/2))+t*e(r+t,o+l))/6,r+=t;return o},romberg:function(e,n,r,o){for(var i,s,a,l,c,u=0,d=(r-n)/2,p=[],f=[],h=[];u<o/2;){for(c=e(n),a=n,l=0;a<=r;a+=d,l++)p[l]=a;for(i=p.length,a=1;a<i-1;a++)c+=(a%2!=0?4:2)*e(p[a]);c=d/3*(c+e(r)),h[u]=c,d/=2,u++}for(s=h.length,i=1;1!==s;){for(a=0;a<s-1;a++)f[a]=(t.pow(4,i)*h[a+1]-h[a])/(t.pow(4,i)-1);s=f.length,h=f,f=[],i++}return h},richardson:function(e,n,r,o){function i(e,t){for(var n,r=0,o=e.length;r<o;r++)e[r]===t&&(n=r);return n}for(var s,a,l,c,u,d=t.abs(r-e[i(e,r)+1]),p=0,f=[],h=[];o>=d;)s=i(e,r+o),a=i(e,r),f[p]=(n[s]-2*n[a]+n[2*a-s])/(o*o),o/=2,p++;for(c=f.length,l=1;1!=c;){for(u=0;u<c-1;u++)h[u]=(t.pow(4,l)*f[u+1]-f[u])/(t.pow(4,l)-1);c=h.length,f=h,h=[],l++}return f},simpson:function(e,t,n,r){for(var o,i=(n-t)/r,s=e(t),a=[],l=t,c=0,u=1;l<=n;l+=i,c++)a[c]=l;for(o=a.length;u<o-1;u++)s+=(u%2!=0?4:2)*e(a[u]);return i/3*(s+e(n))},hermite:function(e,t,n,r){for(var o,i=e.length,s=0,a=0,l=[],c=[],u=[],d=[];a<i;a++){for(l[a]=1,o=0;o<i;o++)a!=o&&(l[a]*=(r-e[o])/(e[a]-e[o]));for(c[a]=0,o=0;o<i;o++)a!=o&&(c[a]+=1/(e[a]-e[o]));u[a]=(1-2*(r-e[a])*c[a])*(l[a]*l[a]),d[a]=(r-e[a])*(l[a]*l[a]),s+=u[a]*t[a]+d[a]*n[a]}return s},lagrange:function(e,t,n){for(var r,o,i=0,s=0,a=e.length;s<a;s++){for(o=t[s],r=0;r<a;r++)s!=r&&(o*=(n-e[r])/(e[s]-e[r]));i+=o}return i},cubic_spline:function(t,n,r){for(var o,i,s=t.length,a=0,l=[],c=[],u=[],d=[],p=[],f=[];a<s-1;a++)d[a]=t[a+1]-t[a];for(u[0]=0,a=1;a<s-1;a++)u[a]=3/d[a]*(n[a+1]-n[a])-3/d[a-1]*(n[a]-n[a-1]);for(a=1;a<s-1;a++)l[a]=[],c[a]=[],l[a][a-1]=d[a-1],l[a][a]=2*(d[a-1]+d[a]),l[a][a+1]=d[a],c[a][0]=u[a];for(i=e.multiply(e.inv(l),c),o=0;o<s-1;o++)p[o]=(n[o+1]-n[o])/d[o]-d[o]*(i[o+1][0]+2*i[o][0])/3,f[o]=(i[o+1][0]-i[o][0])/(3*d[o]);for(o=0;o<s&&!(t[o]>r);o++);return n[o-=1]+(r-t[o])*p[o]+e.sq(r-t[o])*i[o]+(r-t[o])*e.sq(r-t[o])*f[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,r,o,i,s,a=t.length,l=t[0].length,c=0,u=[],d=[],p=[],f=[],h=[],m=[],g=[];for(c=0;c<a;c++)u[c]=e.sum(t[c])/l;for(c=0;c<l;c++)for(h[c]=[],n=0;n<a;n++)h[c][n]=t[n][c]-u[n];for(h=e.transpose(h),c=0;c<a;c++)for(m[c]=[],n=0;n<a;n++)m[c][n]=e.dot([h[c]],[h[n]])/(l-1);for(s=(o=e.jacobi(m))[0],d=o[1],g=e.transpose(s),c=0;c<d.length;c++)for(n=c;n<d.length;n++)d[c]<d[n]&&(r=d[c],d[c]=d[n],d[n]=r,p=g[c],g[c]=g[n],g[n]=p);for(i=e.transpose(h),c=0;c<a;c++)for(f[c]=[],n=0;n<i.length;n++)f[c][n]=e.dot([g[c]],[i[n]]);return[t,d,g,f]}}),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(n,r){var o=this;return r?(setTimeout(function(){r.call(o,e.fn[t].call(o,n))},15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var n=[].slice,r=e.utils.isNumber,o=e.utils.isArray;function i(e,n,r,o){if(e>1||r>1||e<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*n+r*o)/(n+o);return(e-r)/t.sqrt(i*(1-i)*(1/n+1/o))}e.extend({zscore:function(){var t=n.call(arguments);return r(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var r,i=n.call(arguments);return o(i[1])?(r=e.zscore(i[0],i[1],i[3]),1===i[2]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)):i.length>2?(r=e.zscore(i[0],i[1],i[2]),1===i[3]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)):(r=i[0],1===i[1]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,r,o){var i=t.abs(this.zscore(n,o));return 1===r?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-e.mean(r[1]))/(e.stdev(r[1],!0)/t.sqrt(r[1].length))},ttest:function(){var o,i=n.call(arguments);return 5===i.length?(o=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-o,i[3]-1):2*e.studentt.cdf(-o,i[3]-1)):r(i[1])?(o=t.abs(i[0]),1==i[2]?e.studentt.cdf(-o,i[1]-1):2*e.studentt.cdf(-o,i[1]-1)):(o=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-o,i[1].length-1):2*e.studentt.cdf(-o,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var r,o,i,s,a,l,c,u,d=n.call(arguments);if(1===d.length){for(a=new Array(d[0].length),c=0;c<d[0].length;c++)a[c]=d[0][c];d=a}for(o=new Array,c=0;c<d.length;c++)o=o.concat(d[c]);for(i=e.mean(o),r=0,c=0;c<d.length;c++)r+=d[c].length*t.pow(e.mean(d[c])-i,2);for(r/=d.length-1,l=0,c=0;c<d.length;c++)for(s=e.mean(d[c]),u=0;u<d[c].length;u++)l+=t.pow(d[c][u]-s,2);return r/(l/(o.length-d.length))},anovaftest:function(){var t,o,i,s,a=n.call(arguments);if(r(a[0]))return 1-e.centralF.cdf(a[0],a[1],a[2]);var l=e.anovafscore(a);for(t=a.length-1,i=0,s=0;s<a.length;s++)i+=a[s].length;return o=i-t-1,1-e.centralF.cdf(l,t,o)},ftest:function(t,n,r){return 1-e.centralF.cdf(t,n,r)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var o,i,s,a,l,c=n.call(arguments);return r(c[0])?(o=c[0],i=c[1],s=c[2],a=c[3],l=c[4]):(o=e.mean(c[0]),i=e.mean(c[1]),s=c[0].length,a=c[1].length,l=c[2]),t.abs(o-i)/(l*t.sqrt((1/s+1/a)/2))},qtest:function(){var t,r=n.call(arguments);3===r.length?(t=r[0],r=r.slice(1)):7===r.length?(t=e.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(t=e.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],i=r[1];return 1-e.tukey.cdf(t,i,o-i)},tukeyhsd:function(t){for(var n=e.pooledstdev(t),r=t.map(function(t){return e.mean(t)}),o=t.reduce(function(e,t){return e+t.length},0),i=[],s=0;s<t.length;++s)for(var a=s+1;a<t.length;++a){var l=e.qtest(r[s],r[a],t[s].length,t[a].length,n,o,t.length);i.push([[s,a],l])}return i}}),e.extend({normalci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?t.abs(e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},tci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?t.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,n,r,o){var s=i(t,n,r,o);return e.ztest(s,1)},twoSidedDifferenceOfProportions:function(t,n,r,o){var s=i(t,n,r,o);return e.ztest(s,2)}})}(t,Math),t.models=function(){function e(e,n){var r=e.length,o=n[0].length-1,i=r-o-1,s=t.lstsq(n,e),a=t.multiply(n,s.map(function(e){return[e]})).map(function(e){return e[0]}),l=t.subtract(e,a),c=t.mean(e),u=t.sum(a.map(function(e){return Math.pow(e-c,2)})),d=t.sum(e.map(function(e,t){return Math.pow(e-a[t],2)})),p=u+d;return{exog:n,endog:e,nobs:r,df_model:o,df_resid:i,coef:s,predict:a,resid:l,ybar:c,SST:p,SSE:u,SSR:d,R2:u/p}}return{ols:function(n,r){var o=e(n,r),i=function(n){var r,o,i=(r=n.exog,o=r[0].length,t.arange(o).map(function(n){var i=t.arange(o).filter(function(e){return e!==n});return e(t.col(r,n).map(function(e){return e[0]}),t.col(r,i))})),s=Math.sqrt(n.SSR/n.df_resid),a=i.map(function(e){var t=e.SST,n=e.R2;return s/Math.sqrt(t*(1-n))}),l=n.coef.map(function(e,t){return(e-0)/a[t]}),c=l.map(function(e){var r=t.studentt.cdf(e,n.df_resid);return 2*(r>.5?1-r:r)}),u=t.studentt.inv(.975,n.df_resid),d=n.coef.map(function(e,t){var n=u*a[t];return[e-n,e+n]});return{se:a,t:l,p:c,sigmaHat:s,interval95:d}}(o),s=function(e){var n,r,o,i=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:i,pvalue:1-(n=i,r=e.df_model,o=e.df_resid,t.beta.cdf(n/(o/r+n),r/2,o/2))}}(o),a=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=i,o.f=s,o.adjust_R2=a,o}}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=[1].concat(arguments[n]);return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),n=0;n<arguments[0].length;n++)e[n]=[1].concat(arguments[0][n]);return t(e)},buildjxmatrix:function(e){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=e[r];return t.builddxmatrix(n)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,n){var r,o,i,s,a;if(e.cols()==n.rows()){if(n.rows()>1){for(s=[],r=0;r<e.rows();r++)for(s[r]=[],o=0;o<n.cols();o++){for(a=0,i=0;i<e.cols();i++)a+=e.toArray()[r][i]*n.toArray()[i][o];s[r][o]=a}return t(s)}for(s=[],r=0;r<e.rows();r++)for(s[r]=[],o=0;o<n.cols();o++){for(a=0,i=0;i<e.cols();i++)a+=e.toArray()[r][i]*n.toArray()[o];s[r][o]=a}return t(s)}},regress:function(e,n){var r=t.xtranspxinv(e),o=e.transpose(),i=t.matrixmult(t(r),o);return t.matrixmult(i,n)},regresst:function(e,n,r){var o=t.regress(e,n),i={anova:{}},s=t.jMatYBar(e,o);i.yBar=s;var a=n.mean();i.anova.residuals=t.residuals(n,s),i.anova.ssr=t.ssr(s,a),i.anova.msr=i.anova.ssr/(e[0].length-1),i.anova.sse=t.sse(n,s),i.anova.mse=i.anova.sse/(n.length-(e[0].length-1)-1),i.anova.sst=t.sst(n,a),i.anova.mst=i.anova.sst/(n.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=t.anovaftest(i.anova.fratio,e[0].length-1,n.length-(e[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(e[0].length);for(var l,c,u,d=t.xtranspxinv(e),p=0;p<o.length;p++)l=Math.sqrt(i.anova.mse*Math.abs(d[p][p])),c=Math.abs(o[p]/l),u=t.ttest(c,n.length-e[0].length-1,r),i.stats[p]=[o[p],l,c,u];return i.regress=o,i},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var n=t.matrixmult(e.transpose(),e);return t.inv(n)},jMatYBar:function(e,n){var r=t.matrixmult(e,n);return new t(r)},residuals:function(e,n){return t.matrixsubtract(e,n)},ssr:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},sse:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},sst:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},matrixsubtract:function(e,n){for(var r=new Array(e.length),o=0;o<e.length;o++){r[o]=new Array(e[o].length);for(var i=0;i<e[o].length;i++)r[o][i]=e[o][i]-n[o][i]}return t(r)}}),t.jStat=t,t)},960:function(e,t,n){const r=n(592);e.exports=function(e){function t(e,t){const n=t.split(".");let r=e;for(const e of n){if(null==r)return;r=r[e]}return r}for(let n=0;n<Object.keys(r).length;n++){let o,i=Object.keys(r)[n],s=[];if("object"==typeof r[i]){s=Object.keys(r[i]),o=Object.values(r[i]);for(let e=0;e<o.length;e++)if("object"==typeof o[e]){let t=s[e];r[i][t]&&(s=[...s,...Object.keys(r[i][t]).map(e=>t+"."+e)],s.splice(s.indexOf(t),1))}}if(s.length<1)e[i]=r[i];else for(let n=0;n<s.length;n++)"function"==typeof t(r[i],s[n])&&(e[i]=t(r[i],s[n]))}let n=function(e){return"number"==typeof e&&(e=parseInt(e)),e},o=null,i=null,s=null;e.TABLE=function(){return s},e.COLUMN=e.COL=function(){return s.tracking&&s.tracking.push(c.getColumnNameFromCoords(n(o),n(i))),n(o)+1},e.ROW=function(){return s.tracking&&s.tracking.push(c.getColumnNameFromCoords(n(o),n(i))),n(i)+1},e.CELL=function(){return c.getColumnNameFromCoords(o,i)},e.VALUE=function(e,t,r){return s.getValueFromCoords(n(e)-1,n(t)-1,r)},e.THISROWCELL=function(e){return s.getValueFromCoords(n(e)-1,n(i))};const a=function(e,t){for(let n=0;n<e.length;n++){let r=c.getTokensFromRange(e[n]);t=t.replace(e[n],"["+r.join(",")+"]")}return t},l=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},c=function(e,t,n,r,c){s=c,o=n,i=r;let u="",d={};if(t)if(t.size){let e,n=null;t.forEach(function(t,n){e=n.replace(/!/g,"."),-1!==e.indexOf(".")&&(e=e.split("."),d[e[0]]=!0)}),e=Object.keys(d);for(let t=0;t<e.length;t++)u+="var "+e[t]+" = {};";t.forEach(function(r,o){e=o.replace(/!/g,"."),null===r||l(r)||(n=r.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),n&&n.length&&(r=updateRanges(n,r))),e.indexOf(".")>0?u+=e+" = "+t.get(o)+";\n":u+="var "+e+" = "+r+";\n"})}else{let e=Object.keys(t);if(e.length){let n,r={};for(let t=0;t<e.length;t++)if(n=e[t].replace(/\!/g,"."),n.indexOf(".")>0){let e=e.split(".");r[e[0]]={}}n=Object.keys(r);for(let e=0;e<n.length;e++)u+="var "+n[e]+" = {};";for(let r=0;r<e.length;r++){if(n=e[r].replace(/!/g,"."),null!==t[e[r]]&&!l(t[e[r]])){let n=t[e[r]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);n&&n.length&&(t[e[r]]=a(n,t[e[r]]))}n.indexOf(".")>0?u+=n+" = "+t[e[r]]+";\n":u+="var "+n+" = "+t[e[r]]+";\n"}}}let p=(e=function(e){let t="",n=0,r=["=","!",">","<"];for(let o=0;o<e.length;o++)'"'===e[o]&&(n=0===n?1:0),1===n?t+=e[o]:(t+=e[o].toUpperCase(),o>0&&"="===e[o]&&-1===r.indexOf(e[o-1])&&-1===r.indexOf(e[o+1])&&(t+="="));return t=t.replace(/\^/g,"**"),t=t.replace(/<>/g,"!="),t=t.replace(/&/g,"+"),t=t.replace(/\$/g,""),t}(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);p&&p.length&&(e=a(p,e));let f=new Function(u+"; return "+e)();return null===f&&(f=0),f};return c.getColumnNameFromCoords=function(e,t){return r="",(n=parseInt(e))>701?(r+=String.fromCharCode(64+parseInt(n/676)),r+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(r+=String.fromCharCode(64+parseInt(n/26))),r+String.fromCharCode(65+n%26)+(parseInt(t)+1);var n,r},c.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(t[0].charCodeAt(r)-64)*Math.pow(26,t[0].length-1-r);--n<0&&(n=0);var o=parseInt(/[0-9]+$/.exec(e))||null;return o>0&&o--,[n,o]}},c.getRangeFromTokens=function(e){e=e.filter(function(e){return"#REF!"!=e});for(var t="",n="",r=0;r<e.length;r++)e[r].indexOf(".")>=0?t=".":e[r].indexOf("!")>=0&&(t="!"),t&&(n=e[r].split(t),e[r]=n[1],n=n[0]+t);return e.sort(function(e,t){var n=Helpers.getCoordsFromColumnName(e),r=Helpers.getCoordsFromColumnName(t);return n[1]>r[1]?1:n[1]<r[1]?-1:n[0]>r[0]?1:n[0]<r[0]?-1:0}),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},c.getTokensFromRange=function(e){if(e.indexOf(".")>0){var t=e.split(".");e=t[1],t=t[0]+"."}else e.indexOf("!")>0?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=c.getCoordsFromColumnName(e[0]),r=c.getCoordsFromColumnName(e[1]);if(n[0]<=r[0])var o=n[0],i=r[0];else o=r[0],i=n[0];if(null===n[1]&&null==r[1])for(var s=null,a=null,l=Object.keys(vars),u=0;u<l.length;u++){var d=c.getCoordsFromColumnName(l[u]);d[0]===n[0]&&(null===s||d[1]<s)&&(s=d[1]),d[0]===r[0]&&(null===a||d[1]>a)&&(a=d[1])}else n[1]<=r[1]?(s=n[1],a=r[1]):(s=r[1],a=n[1]);for(var p=[],f=s;f<=a;f++){var h=[];for(u=o;u<=i;u++)h.push(t+c.getColumnNameFromCoords(u,f));p.push(h)}return p},c.setFormula=function(t){let n=Object.keys(t);for(let r=0;r<n.length;r++)"function"==typeof t[n[r]]&&(e[n[r]]=t[n[r]])},c.basic=!0,c}("undefined"==typeof window?n.g:window)},592:function(e,t,n){"use strict";var r=n(162),o=n(765);const i=new Error("#NULL!"),s=new Error("#DIV/0!"),a=new Error("#VALUE!"),l=new Error("#REF!"),c=new Error("#NAME?"),u=new Error("#NUM!"),d=new Error("#N/A"),p=new Error("#ERROR!"),f=new Error("#GETTING_DATA");var h=Object.freeze({__proto__:null,data:f,div0:s,error:p,na:d,name:c,nil:i,num:u,ref:l,value:a});function m(e){const t=[];return g(e,e=>{t.push(e)}),t}function g(e,t){let n=-1;const r=e.length;for(;++n<r&&!1!==t(e[n],n,e););return e}function v(e){let t,n=e.length;for(;n--;)if(t=e[n],"number"!=typeof t)if(!0!==t)if(!1!==t){if("string"==typeof t){const r=D(t);e[n]=r instanceof Error?0:r}}else e[n]=0;else e[n]=1;return e}function y(e,t){if(!e)return a;e.every(e=>Array.isArray(e))&&0!==e.length||(e=[[...e]]),e.map((t,n)=>{t.map((t,r)=>{t||(e[n][r]=0)})});const n=e.reduce((t,n,r)=>n.length>e[t].length?r:t,0),r=e[n].length;return e.map(e=>[...e,...Array(r-e.length).fill(t||0)])}function b(){let e;if(1===arguments.length){const n=arguments[0];e=null!=(t=n)&&"number"==typeof t.length&&"string"!=typeof t?m.apply(null,arguments):[n]}else e=Array.from(arguments);for(var t;!C(e);)e=w(e);return e}function w(e){return e&&e.reduce?e.reduce((e,t)=>{const n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]}):[e]}function C(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function x(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function E(e){return e?e[0].map((t,n)=>e.map(e=>e[n])):a}function j(e,t){let n=null;return g(e,(e,r)=>{if(e[0]===t)return n=r,!1}),null==n?a:n}function L(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function A(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function M(e){const t=1e14;return Math.round(e*t)/t}function I(){return b.apply(null,arguments).filter(e=>"number"==typeof e)}function T(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||a}function _(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?u:function(e){e<60&&(e+=1);const t=Math.floor(e-25569),n=new Date(86400*t*1e3),r=e-Math.floor(e)+1e-7;let o=Math.floor(86400*r);const i=o%60;o-=i;const s=Math.floor(o/3600),a=Math.floor(o/60)%60;let l=n.getUTCDate(),c=n.getUTCMonth();return e>=60&&e<61&&(l=29,c=1),new Date(n.getUTCFullYear(),c,l,s,a,i)}(t)}return"string"!=typeof e||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?a:e}function N(e){let t,n=e.length;for(;n--;){if(t=_(e[n]),t===a)return t;e[n]=t}return e}function D(e){return e instanceof Error?e:null==e?0:("boolean"==typeof e&&(e=+e),isNaN(e)||""===e?a:parseFloat(e))}function O(e){let t,n;if(!e||0===(t=e.length))return a;for(;t--;){if(e[t]instanceof Error)return e[t];if(n=D(e[t]),n instanceof Error)return n;e[t]=n}return e}function S(e){return e instanceof Error?e:null==e?"":e.toString()}function k(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return!0;return!1}function R(e){return null!=e}const H=[">",">=","<","<=","=","<>"],P="operator",F="literal",V=[P,F],q=P,B=F;function U(e,t){if(-1===V.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function Y(e){return function(e){let t="";const n=[];for(let r=0;r<e.length;r++){const o=e[r];0===r&&H.indexOf(o)>=0?n.push(U(o,q)):t+=o}return t.length>0&&n.push(U(function(e){return"string"!=typeof e||/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e}(t),B)),n.length>0&&n[0].type!==q&&n.unshift(U("=",q)),n}(function(e){const t=e.length,n=[];let r=0,o="",i="";for(;r<t;){const t=e.charAt(r);switch(t){case">":case"<":case"=":i+=t,o.length>0&&(n.push(o),o="");break;default:i.length>0&&(n.push(i),i=""),o+=t}r++}return o.length>0&&n.push(o),i.length>0&&n.push(i),n}(e))}const W=function(e){const t=[];let n;for(let r=0;r<e.length;r++){const o=e[r];switch(o.type){case q:n=o.value;break;case B:t.push(o.value)}}return function(e,t){let n=!1;switch(t){case">":n=e[0]>e[1];break;case">=":n=e[0]>=e[1];break;case"<":n=e[0]<e[1];break;case"<=":n=e[0]<=e[1];break;case"=":n=e[0]==e[1];break;case"<>":n=e[0]!=e[1]}return n}(t,n)},z={};function X(e){return[a,l,s,u,c,i].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function G(e){return X(e)||e===d}function K(e){return!0===e||!1===e}function $(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function Z(e){return"string"==typeof e}function J(){const e=[];for(let t=0;t<arguments.length;++t){let n=!1;const r=arguments[t];for(let t=0;t<e.length&&(n=e[t]===r,!n);++t);n||e.push(r)}return e}function Q(e,t,n,r){if(!t||!n)return d;r=!(0===r||!1===r);let o=d;const i="number"==typeof e;let s=!1;for(let a=0;a<t.length;a++){const c=t[a];if(c[0]===e){o=n<c.length+1?c[n-1]:l;break}!s&&(i&&r&&c[0]<=e||r&&"string"==typeof c[0]&&c[0].localeCompare(e)<0)&&(o=n<c.length+1?c[n-1]:l),i&&c[0]>e&&(s=!0)}return o}function ee(){const e=b(arguments).filter(R);if(0===e.length)return s;const t=L.apply(void 0,e);if(t)return t;const n=I(e),r=n.length;let o,i=0,a=0;for(let e=0;e<r;e++)i+=n[e],a+=1;return o=i/a,isNaN(o)&&(o=u),o}function te(){const e=b(arguments).filter(R);if(0===e.length)return s;const t=L.apply(void 0,e);if(t)return t;const n=e,r=n.length;let o,i=0,a=0;for(let e=0;e<r;e++){const t=n[e];"number"==typeof t&&(i+=t),!0===t&&i++,null!==t&&a++}return o=i/a,isNaN(o)&&(o=u),o}z.TYPE=e=>{switch(e){case i:return 1;case s:return 2;case a:return 3;case l:return 4;case c:return 5;case u:return 6;case d:return 7;case f:return 8}return d};const ne={DIST:function(e,t,n,o,i,s){return arguments.length<4?a:(i=void 0===i?0:i,s=void 0===s?1:s,A(e=D(e),t=D(t),n=D(n),i=D(i),s=D(s))?a:(e=(e-i)/(s-i),o?r.beta.cdf(e,t,n):r.beta.pdf(e,t,n)))},INV:(e,t,n,o,i)=>(o=void 0===o?0:o,i=void 0===i?1:i,A(e=D(e),t=D(t),n=D(n),o=D(o),i=D(i))?a:r.beta.inv(e,t,n)*(i-o)+o)},re={DIST:(e,t,n,o)=>A(e=D(e),t=D(t),n=D(n),o=D(o))?a:o?r.binomial.cdf(e,t,n):r.binomial.pdf(e,t,n)};re.DIST.RANGE=(e,t,n,r)=>{if(r=void 0===r?n:r,A(e=D(e),t=D(t),n=D(n),r=D(r)))return a;let o=0;for(let i=n;i<=r;i++)o+=qe(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return o},re.INV=(e,t,n)=>{if(A(e=D(e),t=D(t),n=D(n)))return a;let o=0;for(;o<=e;){if(r.binomial.cdf(o,e,t)>=n)return o;o++}};const oe={DIST:(e,t,n)=>A(e=D(e),t=D(t))?a:n?r.chisquare.cdf(e,t):r.chisquare.pdf(e,t)};oe.DIST.RT=(e,t)=>!e|!t?d:e<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?a:1-r.chisquare.cdf(e,t),oe.INV=(e,t)=>A(e=D(e),t=D(t))?a:r.chisquare.inv(e,t),oe.INV.RT=(e,t)=>!e|!t?d:e<0||e>1||t<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?a:r.chisquare.inv(1-e,t),oe.TEST=function(e,t){if(2!==arguments.length)return d;if(!(e instanceof Array&&t instanceof Array))return a;if(e.length!==t.length)return a;if(e[0]&&t[0]&&e[0].length!==t[0].length)return a;const n=e.length;let r,o,i;for(o=0;o<n;o++)e[o]instanceof Array||(r=e[o],e[o]=[],e[o].push(r)),t[o]instanceof Array||(r=t[o],t[o]=[],t[o].push(r));const s=e[0].length,l=1===s?n-1:(n-1)*(s-1);let c=0;const u=Math.PI;for(o=0;o<n;o++)for(i=0;i<s;i++)c+=Math.pow(e[o][i]-t[o][i],2)/t[o][i];return Math.round(1e6*function(e,t){let n=Math.exp(-.5*e);t%2==1&&(n*=Math.sqrt(2*e/u));let r=t;for(;r>=2;)n=n*e/r,r-=2;let o=n,i=t;for(;o>1e-10*n;)i+=2,o=o*e/i,n+=o;return 1-n}(c,l))/1e6};const ie={};function se(){return I(b(arguments)).length}function ae(){const e=b(arguments);return e.length-le(e)}function le(){const e=b(arguments);let t,n=0;for(let r=0;r<e.length;r++)t=e[r],null!=t&&""!==t||n++;return n}ie.NORM=(e,t,n)=>A(e=D(e),t=D(t),n=D(n))?a:r.normalci(1,e,t,n)[1]-1,ie.T=(e,t,n)=>A(e=D(e),t=D(t),n=D(n))?a:r.tci(1,e,t,n)[1]-1;const ce={P:(e,t)=>{if(A(e=O(b(e)),t=O(b(t))))return a;const n=r.mean(e),o=r.mean(t);let i=0;const s=e.length;for(let r=0;r<s;r++)i+=(e[r]-n)*(t[r]-o);return i/s},S:(e,t)=>A(e=O(b(e)),t=O(b(t)))?a:r.covariance(e,t)},ue={DIST:(e,t,n)=>A(e=D(e),t=D(t))?a:n?r.exponential.cdf(e,t):r.exponential.pdf(e,t)},de={};function pe(e,t,n){if(A(e=D(e),t=O(b(t)),n=O(b(n))))return a;const o=r.mean(n),i=r.mean(t),s=n.length;let l=0,c=0;for(let e=0;e<s;e++)l+=(n[e]-o)*(t[e]-i),c+=Math.pow(n[e]-o,2);const u=l/c;return i-u*o+u*e}function fe(e){return(e=D(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?u:r.gammafn(e)}function he(e){return(e=D(e))instanceof Error?e:r.gammaln(e)}de.DIST=(e,t,n,o)=>A(e=D(e),t=D(t),n=D(n))?a:o?r.centralF.cdf(e,t,n):r.centralF.pdf(e,t,n),de.DIST.RT=function(e,t,n){return 3!==arguments.length?d:e<0||t<1||n<1?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:1-r.centralF.cdf(e,t,n)},de.INV=(e,t,n)=>A(e=D(e),t=D(t),n=D(n))?a:e<=0||e>1?u:r.centralF.inv(e,t,n),de.INV.RT=function(e,t,n){return 3!==arguments.length?d:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:r.centralF.inv(1-e,t,n)},de.TEST=(e,t)=>{if(!e||!t)return d;if(!(e instanceof Array&&t instanceof Array))return d;if(e.length<2||t.length<2)return s;const n=(e,t)=>{let n=0;for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},r=Ke(e)/e.length,o=Ke(t)/t.length;return n(e,r)/(e.length-1)/(n(t,o)/(t.length-1))},fe.DIST=function(e,t,n,o){return 4!==arguments.length?d:e<0||t<=0||n<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:o?r.gamma.cdf(e,t,n,!0):r.gamma.pdf(e,t,n,!1)},fe.INV=function(e,t,n){return 3!==arguments.length?d:e<0||e>1||t<=0||n<=0?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:r.gamma.inv(e,t,n)},he.PRECISE=function(e){return 1!==arguments.length?d:e<=0?u:"number"!=typeof e?a:r.gammaln(e)};const me={};function ge(e,t){return A(e=O(b(e)),t=D(t))?e:t<0||e.length<t?a:e.sort((e,t)=>t-e)[t-1]}function ve(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;const n=r.mean(e),o=r.mean(t),i=t.length;let s=0,l=0;for(let r=0;r<i;r++)s+=(t[r]-o)*(e[r]-n),l+=Math.pow(t[r]-o,2);const c=s/l;return[c,n-c*o]}me.DIST=(e,t,n,r,o)=>{if(A(e=D(e),t=D(t),n=D(n),r=D(r)))return a;function i(e,t,n,r){return qe(n,e)*qe(r-n,t-e)/qe(r,t)}return o?function(e,t,n,r){let o=0;for(let s=0;s<=e;s++)o+=i(s,t,n,r);return o}(e,t,n,r):i(e,t,n,r)};const ye={};function be(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;const n=I(e);return 0===n.length?0:Math.max.apply(Math,n)}function we(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;const n=v(e);let o=r.median(n);return isNaN(o)&&(o=u),o}function Ce(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;const n=I(e);return 0===n.length?0:Math.min.apply(Math,n)}ye.DIST=(e,t,n,o)=>A(e=D(e),t=D(t),n=D(n))?a:o?r.lognormal.cdf(e,t,n):r.lognormal.pdf(e,t,n),ye.INV=(e,t,n)=>A(e=D(e),t=D(t),n=D(n))?a:r.lognormal.inv(e,t,n);const xe={MULT:function(){const e=O(b(arguments));if(e instanceof Error)return e;const t=e.length,n={};let r,o=[],i=0;for(let s=0;s<t;s++)r=e[s],n[r]=n[r]?n[r]+1:1,n[r]>i&&(i=n[r],o=[]),n[r]===i&&(o[o.length]=r);return o},SNGL:function(){const e=O(b(arguments));return e instanceof Error?e:xe.MULT(e).sort((e,t)=>e-t)[0]}},Ee={DIST:(e,t,n,o)=>A(e=D(e),t=D(t),n=D(n))?a:o?r.negbin.cdf(e,t,n):r.negbin.pdf(e,t,n)},je={};function Le(e,t){if(A(t=O(b(t)),e=O(b(e))))return a;const n=r.mean(e),o=r.mean(t),i=e.length;let s=0,l=0,c=0;for(let r=0;r<i;r++)s+=(e[r]-n)*(t[r]-o),l+=Math.pow(e[r]-n,2),c+=Math.pow(t[r]-o,2);return s/Math.sqrt(l*c)}je.DIST=(e,t,n,o)=>A(e=D(e),t=D(t),n=D(n))?a:n<=0?u:o?r.normal.cdf(e,t,n):r.normal.pdf(e,t,n),je.INV=(e,t,n)=>A(e=D(e),t=D(t),n=D(n))?a:r.normal.inv(e,t,n),je.S={},je.S.DIST=(e,t)=>(e=D(e))instanceof Error?a:t?r.normal.cdf(e,0,1):r.normal.pdf(e,0,1),je.S.INV=e=>(e=D(e))instanceof Error?a:r.normal.inv(e,0,1);const Ae={EXC:(e,t)=>{if(A(e=O(b(e)),t=D(t)))return a;const n=(e=e.sort((e,t)=>e-t)).length;if(t<1/(n+1)||t>1-1/(n+1))return u;const r=t*(n+1)-1,o=Math.floor(r);return M(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},INC:(e,t)=>{if(A(e=O(b(e)),t=D(t)))return a;const n=t*((e=e.sort((e,t)=>e-t)).length-1),r=Math.floor(n);return M(n===r?e[n]:e[r]+(n-r)*(e[r+1]-e[r]))}},Me={EXC:(e,t,n)=>{if(n=void 0===n?3:n,A(e=O(b(e)),t=D(t),n=D(n)))return a;e=e.sort((e,t)=>e-t);const r=J.apply(null,e),o=e.length,i=r.length,s=Math.pow(10,n);let l=0,c=!1,u=0;for(;!c&&u<i;)t===r[u]?(l=(e.indexOf(r[u])+1)/(o+1),c=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(l=(e.indexOf(r[u])+1+(t-r[u])/(r[u+1]-r[u]))/(o+1),c=!0),u++;return Math.floor(l*s)/s},INC:(e,t,n)=>{if(n=void 0===n?3:n,A(e=O(b(e)),t=D(t),n=D(n)))return a;e=e.sort((e,t)=>e-t);const r=J.apply(null,e),o=e.length,i=r.length,s=Math.pow(10,n);let l=0,c=!1,u=0;for(;!c&&u<i;)t===r[u]?(l=e.indexOf(r[u])/(o-1),c=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(l=(e.indexOf(r[u])+(t-r[u])/(r[u+1]-r[u]))/(o-1),c=!0),u++;return Math.floor(l*s)/s}},Ie={DIST:(e,t,n)=>A(e=D(e),t=D(t))?a:n?r.poisson.cdf(e,t):r.poisson.pdf(e,t)},Te={EXC:(e,t)=>{if(A(e=O(b(e)),t=D(t)))return a;switch(t){case 1:return Ae.EXC(e,.25);case 2:return Ae.EXC(e,.5);case 3:return Ae.EXC(e,.75);default:return u}},INC:(e,t)=>{if(A(e=O(b(e)),t=D(t)))return a;switch(t){case 1:return Ae.INC(e,.25);case 2:return Ae.INC(e,.5);case 3:return Ae.INC(e,.75);default:return u}}},_e={};function Ne(){const e=O(b(arguments));if(e instanceof Error)return e;const t=r.mean(e),n=e.length;let o=0;for(let r=0;r<n;r++)o+=Math.pow(e[r]-t,3);return n*o/((n-1)*(n-2)*Math.pow(r.stdev(e,!0),3))}function De(e,t){return A(e=O(b(e)),t=D(t))?e:e.sort((e,t)=>e-t)[t-1]}_e.AVG=(e,t,n)=>{if(A(e=D(e),t=O(b(t))))return a;const r=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e,o=(t=(t=b(t)).sort(r)).length;let i=0;for(let n=0;n<o;n++)t[n]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},_e.EQ=(e,t,n)=>{if(A(e=D(e),t=O(b(t))))return a;const r=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e;return(t=t.sort(r)).indexOf(e)+1},Ne.P=function(){const e=O(b(arguments));if(e instanceof Error)return e;const t=r.mean(e),n=e.length;let o=0,i=0;for(let r=0;r<n;r++)i+=Math.pow(e[r]-t,3),o+=Math.pow(e[r]-t,2);return i/=n,o/=n,i/Math.pow(o,1.5)};const Oe={P:function(){const e=ke.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},S:function(){const e=ke.S.apply(this,arguments);return Math.sqrt(e)}},Se={DIST:(e,t,n)=>1!==n&&2!==n?u:1===n?Se.DIST.RT(e,t):Se.DIST["2T"](e,t)};Se.DIST["2T"]=function(e,t){return 2!==arguments.length?d:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?a:2*(1-r.studentt.cdf(e,t))},Se.DIST.RT=function(e,t){return 2!==arguments.length?d:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?a:1-r.studentt.cdf(e,t)},Se.INV=(e,t)=>A(e=D(e),t=D(t))?a:r.studentt.inv(e,t),Se.INV["2T"]=(e,t)=>(e=D(e),t=D(t),e<=0||e>1||t<1?u:A(e,t)?a:Math.abs(r.studentt.inv(e/2,t))),Se.TEST=(e,t)=>{if(A(e=O(b(e)),t=O(b(t))))return a;const n=r.mean(e),o=r.mean(t);let i,s=0,l=0;for(i=0;i<e.length;i++)s+=Math.pow(e[i]-n,2);for(i=0;i<t.length;i++)l+=Math.pow(t[i]-o,2);s/=e.length-1,l/=t.length-1;const c=Math.abs(n-o)/Math.sqrt(s/e.length+l/t.length);return Se.DIST["2T"](c,e.length+t.length-2)};const ke={};function Re(){const e=b(arguments),t=e.length;let n=0,r=0;const o=te(e);for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-o,2):!0===t?Math.pow(1-o,2):Math.pow(0-o,2),null!==t&&r++}return n/(r-1)}function He(){const e=b(arguments),t=e.length;let n=0,r=0;const o=te(e);let i;for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-o,2):!0===t?Math.pow(1-o,2):Math.pow(0-o,2),null!==t&&r++}return i=n/r,isNaN(i)&&(i=u),i}ke.P=function(){const e=I(b(arguments)),t=e.length;let n=0;const r=ee(e);let o;for(let o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return o=n/t,isNaN(o)&&(o=u),o},ke.S=function(){const e=I(b(arguments)),t=e.length;let n=0;const r=ee(e);for(let o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/(t-1)};const Pe={DIST:(e,t,n,r)=>A(e=D(e),t=D(t),n=D(n))?a:r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},Fe={};function Ve(e,t,n){const r=L(e=D(e),t=D(t),n=D(n));if(r)return r;if(0===t)return 0;t=Math.abs(t);const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.ceil(e/t)*t,o):0===n?-Ge(Math.floor(Math.abs(e)/t)*t,o):-Ge(Math.ceil(Math.abs(e)/t)*t,o)}function qe(e,t){return L(e=D(e),t=D(t))||(e<t?u:Ue(e)/(Ue(t)*Ue(e-t)))}Fe.TEST=(e,t,n)=>{if(A(e=O(b(e)),t=D(t)))return a;n=n||Oe.S(e);const r=e.length;return 1-je.S.DIST((ee(e)-t)/(n/Math.sqrt(r)),!0)},Ve.MATH=Ve,Ve.PRECISE=Ve;const Be=[];function Ue(e){if((e=D(e))instanceof Error)return e;const t=Math.floor(e);return 0===t||1===t?1:(Be[t]>0||(Be[t]=Ue(t-1)*t),Be[t])}function Ye(e,t){const n=L(e=D(e),t=D(t));if(n)return n;if(0===t)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return u;t=Math.abs(t);const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,r):-Ge(Math.ceil(Math.abs(e)/t),r)}Ye.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=void 0===t?0:t;const r=L(e=D(e),t=D(t),n=D(n));if(r)return r;if(0===t)return 0;t=t?Math.abs(t):1;const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,o):0===n||void 0===n?-Ge(Math.ceil(Math.abs(e)/t)*t,o):-Ge(Math.floor(Math.abs(e)/t)*t,o)},Ye.PRECISE=Ye.MATH;const We={CEILING:Ve};function ze(e,t){const n=L(e=D(e),t=D(t));if(n)return n;if(0===e&&0===t)return u;const r=Math.pow(e,t);return isNaN(r)?u:r}function Xe(){const e=b(arguments).filter(e=>null!=e);if(0===e.length)return 0;const t=O(e);if(t instanceof Error)return t;let n=1;for(let e=0;e<t.length;e++)n*=t[e];return n}function Ge(e,t){return L(e=D(e),t=D(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function Ke(){let e=0;return g(m(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if("number"==typeof t)e+=t;else if("string"==typeof t){const n=parseFloat(t);!isNaN(n)&&(e+=n)}else if(Array.isArray(t)){const n=Ke.apply(null,t);n instanceof Error?e=n:e+=n}}),e}var $e=Object.freeze({__proto__:null,ADD:function(e,t){return 2!==arguments.length?d:L(e=D(e),t=D(t))||e+t},DIVIDE:function(e,t){return 2!==arguments.length?d:L(e=D(e),t=D(t))||(0===t?s:e/t)},EQ:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e===t)},GT:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(k(e,t)?(e=S(e),t=S(t)):(e=D(e),t=D(t)),L(e,t)||e>t)},GTE:function(e,t){return 2!==arguments.length?d:(k(e,t)?(e=S(e),t=S(t)):(e=D(e),t=D(t)),L(e,t)||e>=t)},LT:function(e,t){return 2!==arguments.length?d:(k(e,t)?(e=S(e),t=S(t)):(e=D(e),t=D(t)),L(e,t)||e<t)},LTE:function(e,t){return 2!==arguments.length?d:(k(e,t)?(e=S(e),t=S(t)):(e=D(e),t=D(t)),L(e,t)||e<=t)},MINUS:function(e,t){return 2!==arguments.length?d:L(e=D(e),t=D(t))||e-t},MULTIPLY:function(e,t){return 2!==arguments.length?d:L(e=D(e),t=D(t))||e*t},NE:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e!==t)},POW:function(e,t){return 2!==arguments.length?d:ze(e,t)}});const Ze=new Date(Date.UTC(1900,0,1)),Je=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Qe=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],et=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function tt(e,t,n){n=n.toUpperCase(),e=_(e),t=_(t);const r=e.getFullYear(),o=e.getMonth(),i=e.getDate(),s=t.getFullYear(),a=t.getMonth(),l=t.getDate();let c;switch(n){case"Y":c=Math.floor(ut(e,t));break;case"D":c=rt(t,e);break;case"M":c=a-o+12*(s-r),l<i&&c--;break;case"MD":i<=l?c=l-i:(0===a?(e.setFullYear(s-1),e.setMonth(12)):(e.setFullYear(s),e.setMonth(a-1)),c=rt(t,e));break;case"YM":c=a-o+12*(s-r),l<i&&c--,c%=12;break;case"YD":a>o||a===o&&l<i?e.setFullYear(s):e.setFullYear(s-1),c=rt(t,e)}return c}function nt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function rt(e,t){return e=_(e),t=_(t),e instanceof Error?e:t instanceof Error?t:dt(nt(e))-dt(nt(t))}function ot(e,t,n){if(n=T(n||"false"),e=_(e),t=_(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;const r=e.getMonth();let o,i,s=t.getMonth();if(n)o=31===e.getDate()?30:e.getDate(),i=31===t.getDate()?30:t.getDate();else{const n=new Date(e.getFullYear(),r+1,0).getDate(),a=new Date(t.getFullYear(),s+1,0).getDate();o=e.getDate()===n?30:e.getDate(),t.getDate()===a?o<30?(s++,i=1):i=30:i=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(s-r)+(i-o)}function it(e){if((e=_(e))instanceof Error)return e;(e=nt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function st(e,t,n){return st.INTL(e,t,1,n)}function at(e,t,n){return at.INTL(e,t,1,n)}function lt(e){return 1===new Date(e,1,29).getMonth()}function ct(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function ut(e,t,n){if((e=_(e))instanceof Error)return e;if((t=_(t))instanceof Error)return t;n=n||0;let r=e.getDate();const o=e.getMonth()+1,i=e.getFullYear();let s=t.getDate();const a=t.getMonth()+1,l=t.getFullYear();switch(n){case 0:return 31===r&&31===s?(r=30,s=30):31===r?r=30:30===r&&31===s&&(s=30),(s+30*a+360*l-(r+30*o+360*i))/360;case 1:{const n=(e,t)=>{const n=e.getFullYear(),r=new Date(n,2,1);if(lt(n)&&e<r&&t>=r)return!0;const o=t.getFullYear(),i=new Date(o,2,1);return lt(o)&&t>=i&&e<i};let c=365;if(i===l||i+1===l&&(o>a||o===a&&r>=s))return(i===l&&lt(i)||n(e,t)||1===a&&29===s)&&(c=366),ct(e,t)/c;const u=l-i+1,d=(new Date(l+1,0,1)-new Date(i,0,1))/1e3/60/60/24/u;return ct(e,t)/d}case 2:return ct(e,t)/360;case 3:return ct(e,t)/365;case 4:return(s+30*a+360*l-(r+30*o+360*i))/360}}function dt(e){const t=e>-22038912e5?2:1;return Math.ceil((e-Ze)/864e5)+t}function pt(e){return 0===(e=D(e))?a:e instanceof Error?e:String.fromCharCode(e)}function ft(e){if(A(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=a),t}function ht(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;let n=0;for(;(n=e.indexOf(!0))>-1;)e[n]="TRUE";let r=0;for(;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")}st.INTL=(e,t,n,r)=>{if((e=_(e))instanceof Error)return e;if((t=_(t))instanceof Error)return t;let o=!1;const i=[],s=[1,2,3,4,5,6,0],l=new RegExp("^[0|1]{7}$");if(void 0===n)n=et[1];else if("string"==typeof n&&l.test(n)){o=!0,n=n.split("");for(let e=0;e<n.length;e++)"1"===n[e]&&i.push(s[e])}else n=et[n];if(!(n instanceof Array))return a;void 0===r?r=[]:r instanceof Array||(r=[r]);for(let e=0;e<r.length;e++){const t=_(r[e]);if(t instanceof Error)return t;r[e]=t}const c=Math.round((t-e)/864e5)+1;let u=c;const d=e;for(let e=0;e<c;e++){const e=(new Date).getTimezoneOffset()>0?d.getUTCDay():d.getDay();let t=o?i.includes(e):e===n[0]||e===n[1];for(let e=0;e<r.length;e++){const n=r[e];if(n.getDate()===d.getDate()&&n.getMonth()===d.getMonth()&&n.getFullYear()===d.getFullYear()){t=!0;break}}t&&u--,d.setDate(d.getDate()+1)}return u},at.INTL=(e,t,n,r)=>{if((e=_(e))instanceof Error)return e;if((t=D(t))instanceof Error)return t;if(t<0)return u;if(!((n=void 0===n?et[1]:et[n])instanceof Array))return a;void 0===r?r=[]:r instanceof Array||(r=[r]);for(let e=0;e<r.length;e++){const t=_(r[e]);if(t instanceof Error)return t;r[e]=t}let o=0;for(;o<t;){e.setDate(e.getDate()+1);const t=e.getDay();if(t!==n[0]&&t!==n[1]){for(let t=0;t<r.length;t++){const n=r[t];if(n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()){o--;break}}o++}}return e};const mt=ht;function gt(e,t=2,n=!1){if(e=D(e),isNaN(e))return a;if(t=D(t),isNaN(t))return a;if(t<0){const n=Math.pow(10,-t);e=Math.round(e/n)*n}else e=e.toFixed(t);if(n)e=e.toString().replace(/,/g,"");else{const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),e=t.join(".")}return e}function vt(e,t){return L(e,t)||(e=S(e),(t=D(t))instanceof Error?t:new Array(t+1).join(e))}const yt=pt,bt=ft;function wt(e){return/^[01]{1,10}$/.test(e)}function Ct(e,t,n){if(A(e=D(e),t=D(t)))return e;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return a;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();{const r=t>0?"+":"";return e.toString()+r+(1===t?n:t.toString()+n)}}function xt(e,t){return t=void 0===t?0:t,A(e=D(e),t=D(t))?a:r.erf(e)}function Et(e){return isNaN(e)?a:r.erfc(e)}function jt(e){const t=_t(e),n=Lt(e);return A(t,n)?a:Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}function Lt(e){if(void 0===e||!0===e||!1===e)return a;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:-Number(e.substring(n+1,e.length-1)):u:o?isNaN(e.substring(0,e.length-1))?u:e.substring(0,e.length-1):isNaN(e)?u:0}function At(e){const t=_t(e),n=Lt(e);return A(t,n)?a:0===t&&0===n?s:0===t&&n>0?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&t>0?0:0===n&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI}function Mt(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function It(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function Tt(e,t){const n=_t(e),r=Lt(e),o=_t(t),i=Lt(t);if(A(n,r,o,i))return a;const s=e.substring(e.length-1),l=t.substring(t.length-1);let c="i";if(("j"===s||"j"===l)&&(c="j"),0===o&&0===i)return u;const d=o*o+i*i;return Ct((n*o+r*i)/d,(r*o-n*i)/d,c)}function _t(e){if(void 0===e||!0===e||!1===e)return a;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:Number(e.substring(0,n)):u:o?isNaN(e.substring(0,e.length-1))?u:0:isNaN(e)?u:e}function Nt(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function Dt(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,r)}xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Et.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Ot=ne.DIST,St=ne.INV,kt=re.DIST,Rt=Ve.MATH,Ht=Ve.PRECISE,Pt=oe.DIST,Ft=oe.DIST.RT,Vt=oe.INV,qt=oe.INV.RT,Bt=oe.TEST,Ut=ce.P,Yt=ce.P,Wt=ce.S,zt=re.INV,Xt=Et.PRECISE,Gt=xt.PRECISE,Kt=ue.DIST,$t=de.DIST,Zt=de.DIST.RT,Jt=de.INV,Qt=de.INV.RT,en=Ye.MATH,tn=Ye.PRECISE,nn=de.TEST,rn=fe.DIST,on=fe.INV,sn=he.PRECISE,an=me.DIST,ln=ye.INV,cn=ye.DIST,un=ye.INV,dn=xe.MULT,pn=xe.SNGL,fn=Ee.DIST,hn=st.INTL,mn=je.DIST,gn=je.INV,vn=je.S.DIST,yn=je.S.INV,bn=Ae.EXC,wn=Ae.INC,Cn=Me.EXC,xn=Me.INC,En=Ie.DIST,jn=Te.EXC,Ln=Te.INC,An=_e.AVG,Mn=_e.EQ,In=Ne.P,Tn=Oe.P,_n=Oe.S,Nn=Se.DIST,Dn=Se.DIST.RT,On=Se.INV,Sn=Se.TEST,kn=ke.P,Rn=ke.S,Hn=Pe.DIST,Pn=at.INTL,Fn=Fe.TEST;function Vn(e){const t=[];return g(e,e=>{e&&t.push(e)}),t}function qn(e,t){const n={};for(let t=1;t<e[0].length;++t)n[t]=!0;let r=t[0].length;for(let e=1;e<t.length;++e)t[e].length>r&&(r=t[e].length);for(let o=1;o<e.length;++o)for(let i=1;i<e[o].length;++i){let s=!1,a=!1;for(let n=0;n<t.length;++n){const l=t[n];if(l.length<r)continue;const c=l[0];if(e[o][0]===c){a=!0;for(let t=1;t<l.length;++t)if(!s)if(void 0===l[t]||"*"===l[t])s=!0;else{const n=Y(l[t]+""),r=[U(e[o][i],B)].concat(n);s=W(r)}}}a&&(n[i]=n[i]&&s)}const o=[];for(let t=0;t<e[0].length;++t)n[t]&&o.push(t-1);return o}function Bn(e){return e&&e.getTime&&!isNaN(e.getTime())}function Un(e){return e instanceof Date?e:new Date(e)}function Yn(e,t,n,r,o){if(r=r||0,o=o||0,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o)))return a;let i;if(0===e)i=r+n*t;else{const s=Math.pow(1+e,t);i=1===o?r*s+n*(1+e)*(s-1)/e:r*s+n*(s-1)/e}return-i}function Wn(e,t,n,r,o,i){if(o=o||0,i=i||0,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o),i=D(i)))return a;const s=Xn(e,n,r,o,i);return(1===t?1===i?0:-r:1===i?Yn(e,t-2,s,r,1)-s:Yn(e,t-1,s,r,0))*e}function zn(){const e=O(b(arguments));if(e instanceof Error)return e;const t=e[0];let n=0;for(let r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n}function Xn(e,t,n,r,o){if(r=r||0,o=o||0,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o)))return a;let i;if(0===e)i=(n+r)/t;else{const s=Math.pow(1+e,t);i=1===o?(r*e/(s-1)+n*e/(1-1/s))/(1+e):r*e/(s-1)+n*e/(1-1/s)}return-i}const Gn={errors:h,symbols:$e};t.ABS=function(e){return(e=D(e))instanceof Error?e:Math.abs(e)},t.ACCRINT=function(e,t,n,r,o,i,s){return e=Un(e),t=Un(t),n=Un(n),Bn(e)&&Bn(t)&&Bn(n)?r<=0||o<=0||-1===[1,2,4].indexOf(i)||-1===[0,1,2,3,4].indexOf(s)||n<=e?u:(o=o||0)*r*ut(e,n,s=s||0):a},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.ACOS=function(e){if((e=D(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=u),t},t.ACOSH=function(e){if((e=D(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=u),t},t.ACOT=function(e){return(e=D(e))instanceof Error?e:Math.atan(1/e)},t.ACOTH=function(e){if((e=D(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=u),t},t.AGGREGATE=function(e,t,n,r){if(A(e=D(e),D(e)))return a;switch(e){case 1:return ee(n);case 2:return se(n);case 3:return ae(n);case 4:return be(n);case 5:return Ce(n);case 6:return Xe(n);case 7:return Oe.S(n);case 8:return Oe.P(n);case 9:return Ke(n);case 10:return ke.S(n);case 11:return ke.P(n);case 12:return we(n);case 13:return xe.SNGL(n);case 14:return ge(n,r);case 15:return De(n,r);case 16:return Ae.INC(n,r);case 17:return Te.INC(n,r);case 18:return Ae.EXC(n,r);case 19:return Te.EXC(n,r)}},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.AND=function(){const e=b(arguments);let t=a;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===a&&(t=!0),e[n]||(t=!1))}return t},t.ARABIC=function(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return a;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},t.ASC=function(){throw new Error("ASC is not implemented")},t.ASIN=function(e){if((e=D(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=u),t},t.ASINH=function(e){return(e=D(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},t.ATAN=function(e){return(e=D(e))instanceof Error?e:Math.atan(e)},t.ATAN2=function(e,t){return L(e=D(e),t=D(t))||Math.atan2(e,t)},t.ATANH=function(e){if((e=D(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=u),t},t.AVEDEV=function(){const e=b(arguments).filter(R);if(0===e.length)return u;const t=O(e);return t instanceof Error?t:r.sum(r(t).subtract(r.mean(t)).abs()[0])/t.length},t.AVERAGE=ee,t.AVERAGEA=te,t.AVERAGEIF=function(e,t,n){if(arguments.length<=1)return d;if(n=O(b(n=n||e).filter(R)),e=b(e),n instanceof Error)return n;let r=0,o=0;const i=void 0===t||"*"===t,s=i?null:Y(t+"");for(let t=0;t<e.length;t++){const a=e[t];if(i)o+=n[t],r++;else{const e=[U(a,B)].concat(s);W(e)&&(o+=n[t],r++)}}return o/r},t.AVERAGEIFS=function(){const e=m(arguments),t=(e.length-1)/2,n=b(e[0]);let r=0,o=0;for(let i=0;i<n.length;i++){let s=!1;for(let n=0;n<t;n++){const t=e[2*n+1][i],r=e[2*n+2];let o=!1;if(void 0===r||"*"===r)o=!0;else{const e=Y(r+""),n=[U(t,B)].concat(e);o=W(n)}if(!o){s=!1;break}s=!0}s&&(o+=n[i],r++)}const i=o/r;return isNaN(i)?0:i},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.BASE=function(e,t,n){const r=L(e=D(e),t=D(t),n=D(n));if(r)return r;if(0===t)return u;const o=e.toString(t);return new Array(Math.max(n+1-o.length,0)).join("0")+o},t.BESSELI=function(e,t){return A(e=D(e),t=D(t))?a:o.besseli(e,t)},t.BESSELJ=function(e,t){return A(e=D(e),t=D(t))?a:o.besselj(e,t)},t.BESSELK=function(e,t){return A(e=D(e),t=D(t))?a:o.besselk(e,t)},t.BESSELY=function(e,t){return A(e=D(e),t=D(t))?a:o.bessely(e,t)},t.BETA=ne,t.BETADIST=Ot,t.BETAINV=St,t.BIN2DEC=function(e){if(!wt(e))return u;const t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!wt(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);const r=parseInt(e,2).toString(16);return void 0===t?r:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:u},t.BIN2OCT=function(e,t){if(!wt(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);const r=parseInt(e,2).toString(8);return void 0===t?r:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:u},t.BINOM=re,t.BINOMDIST=kt,t.BITAND=function(e,t){return A(e=D(e),t=D(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e&t},t.BITLSHIFT=function(e,t){return A(e=D(e),t=D(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return A(e=D(e),t=D(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e|t},t.BITRSHIFT=function(e,t){return A(e=D(e),t=D(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return A(e=D(e),t=D(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e^t},t.CEILING=Ve,t.CEILINGMATH=Rt,t.CEILINGPRECISE=Ht,t.CELL=function(){throw new Error("CELL is not implemented")},t.CHAR=pt,t.CHIDIST=Pt,t.CHIDISTRT=Ft,t.CHIINV=Vt,t.CHIINVRT=qt,t.CHISQ=oe,t.CHITEST=Bt,t.CHOOSE=function(){if(arguments.length<2)return d;const e=arguments[0];return e<1||e>254||arguments.length<e+1?a:arguments[e]},t.CLEAN=function(e){return A(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},t.CODE=ft,t.COLUMN=function(e,t){return 2!==arguments.length?d:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?r.col(e,t):void 0:a},t.COLUMNS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:r.cols(e):a},t.COMBIN=qe,t.COMBINA=function(e,t){return L(e=D(e),t=D(t))||(e<t?u:0===e&&0===t?1:qe(e+t-1,e-1))},t.COMPLEX=Ct,t.CONCAT=mt,t.CONCATENATE=ht,t.CONFIDENCE=ie,t.CONVERT=function(e,t,n){if((e=D(e))instanceof Error)return e;const r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let s,a=null,l=null,c=t,u=n,p=1,f=1;for(let e=0;e<r.length;e++)s=null===r[e][2]?[]:r[e][2],(r[e][1]===c||s.indexOf(c)>=0)&&(a=r[e]),(r[e][1]===u||s.indexOf(u)>=0)&&(l=r[e]);if(null===a){const e=o[t.substring(0,2)];let n=i[t.substring(0,1)];"da"===t.substring(0,2)&&(n=["dekao",10,"da"]),e?(p=e[2],c=t.substring(2)):n&&(p=n[1],c=t.substring(n[2].length));for(let e=0;e<r.length;e++)s=null===r[e][2]?[]:r[e][2],(r[e][1]===c||s.indexOf(c)>=0)&&(a=r[e])}if(null===l){const e=o[n.substring(0,2)];let t=i[n.substring(0,1)];"da"===n.substring(0,2)&&(t=["dekao",10,"da"]),e?(f=e[2],u=n.substring(2)):t&&(f=t[1],u=n.substring(t[2].length));for(let e=0;e<r.length;e++)s=null===r[e][2]?[]:r[e][2],(r[e][1]===u||s.indexOf(u)>=0)&&(l=r[e])}return null===a||null===l||a[3]!==l[3]?d:e*a[6]*p/(l[6]*f)},t.CORREL=function(e,t){return A(e=O(b(e)),t=O(b(t)))?a:r.corrcoeff(e,t)},t.COS=function(e){return(e=D(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=D(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=D(e))instanceof Error?e:0===e?s:1/Math.tan(e)},t.COTH=function(e){if((e=D(e))instanceof Error)return e;if(0===e)return s;const t=Math.exp(2*e);return(t+1)/(t-1)},t.COUNT=se,t.COUNTA=ae,t.COUNTBLANK=le,t.COUNTIF=function(e,t){if(e=b(e),void 0===t||"*"===t)return e.length;let n=0;const r=Y(t+"");for(let t=0;t<e.length;t++){const o=[U(e[t],B)].concat(r);W(o)&&n++}return n},t.COUNTIFS=function(){const e=m(arguments),t=new Array(b(e[0]).length);for(let e=0;e<t.length;e++)t[e]=!0;for(let n=0;n<e.length;n+=2){const r=b(e[n]),o=e[n+1];if(void 0!==o&&"*"!==o){const e=Y(o+"");for(let n=0;n<r.length;n++){const o=[U(r[n],B)].concat(e);t[n]=t[n]&&W(o)}}}let n=0;for(let e=0;e<t.length;e++)t[e]&&n++;return n},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.COVAR=Ut,t.COVARIANCE=ce,t.COVARIANCEP=Yt,t.COVARIANCES=Wt,t.CRITBINOM=zt,t.CSC=function(e){return(e=D(e))instanceof Error?e:0===e?s:1/Math.sin(e)},t.CSCH=function(e){return(e=D(e))instanceof Error?e:0===e?s:2/(Math.exp(e)-Math.exp(-e))},t.CUMIPMT=function(e,t,n,r,o,i){if(A(e=D(e),t=D(t),n=D(n)))return a;if(e<=0||t<=0||n<=0)return u;if(r<1||o<1||r>o)return u;if(0!==i&&1!==i)return u;const s=Xn(e,t,n,0,i);let l=0;1===r&&(0===i&&(l=-n),r++);for(let t=r;t<=o;t++)l+=1===i?Yn(e,t-2,s,n,1)-s:Yn(e,t-1,s,n,0);return l*=e,l},t.CUMPRINC=function(e,t,n,r,o,i){if(A(e=D(e),t=D(t),n=D(n)))return a;if(e<=0||t<=0||n<=0)return u;if(r<1||o<1||r>o)return u;if(0!==i&&1!==i)return u;const s=Xn(e,t,n,0,i);let l=0;1===r&&(l=0===i?s+n*e:s,r++);for(let t=r;t<=o;t++)l+=i>0?s-(Yn(e,t-2,s,n,1)-s)*e:s-Yn(e,t-1,s,n,0)*e;return l},t.DATE=function(e,t,n){let r;return A(e=D(e),t=D(t),n=D(n))?r=a:(r=new Date(e,t-1,n),r.getFullYear()<0&&(r=u)),r},t.DATEDIF=tt,t.DATEVALUE=function(e){if("string"!=typeof e)return a;const t=Date.parse(e);return isNaN(t)?a:new Date(e)},t.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);let i=0;return g(r,e=>{i+=o[e]}),0===r.length?s:i/r.length},t.DAY=function(e){const t=_(e);return t instanceof Error?t:t.getDate()},t.DAYS=rt,t.DAYS360=ot,t.DB=function(e,t,n,r,o){if(o=void 0===o?12:o,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o)))return a;if(e<0||t<0||n<0||r<0)return u;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return u;if(r>n)return u;if(t>=e)return 0;const i=(1-Math.pow(t/e,1/n)).toFixed(3),s=e*i*o/12;let l=s,c=0;const d=r===n?n-1:r;for(let t=2;t<=d;t++)c=(e-l)*i,l+=c;return 1===r?s:r===n?(e-l)*i:c},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);const i=[];return g(r,e=>{i.push(o[e])}),se(i)},t.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);const i=[];return g(r,e=>{i.push(o[e])}),ae(i)},t.DDB=function(e,t,n,r,o){if(o=void 0===o?2:o,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o)))return a;if(e<0||t<0||n<0||r<0||o<=0)return u;if(r>n)return u;if(t>=e)return 0;let i=0,s=0;for(let a=1;a<=r;a++)s=Math.min(o/n*(e-i),e-t-i),i+=s;return s},t.DEC2BIN=function(e,t){if((e=D(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return u;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:u},t.DEC2HEX=function(e,t){if((e=D(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return u;if(e<0)return(1099511627776+e).toString(16);const n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:u},t.DEC2OCT=function(e,t){if((e=D(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return u;if(e<0)return(1073741824+e).toString(8);const n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:u},t.DECIMAL=function(e,t){return arguments.length<1?a:L(e=D(e),t=D(t))||(0===t?u:parseInt(e,t))},t.DEGREES=function(e){return(e=D(e))instanceof Error?e:180*e/Math.PI},t.DELTA=function(e,t){return t=void 0===t?0:t,A(e=D(e),t=D(t))?a:e===t?1:0},t.DEVSQ=function(){const e=O(b(arguments));if(e instanceof Error)return e;const t=r.mean(e);let n=0;for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},t.DGET=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];return o=x("string"==typeof t?e[j(e,t)]:e[t]),0===r.length?a:r.length>1?u:o[r[0]]},t.DISC=function(e,t,n,r,o){if(A(e=_(e),t=_(t),n=D(n),r=D(r),o=(o=D(o))||0))return a;if(n<=0||r<=0)return u;if(e>=t)return a;let i,s;switch(o){case 0:i=360,s=ot(e,t,!1);break;case 1:case 3:i=365,s=tt(e,t,"D");break;case 2:i=360,s=tt(e,t,"D");break;case 4:i=360,s=ot(e,t,!0);break;default:return u}return(r-n)/r*i/s},t.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);let i=o[r[0]];return g(r,e=>{i<o[e]&&(i=o[e])}),i},t.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);let i=o[r[0]];return g(r,e=>{i>o[e]&&(i=o[e])}),i},t.DOLLAR=function(e,t=2){if(e=D(e),isNaN(e))return a;const n={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},r=(e=Ge(e,t)).toLocaleString("en-US",n);return e<0?"$("+r.slice(2)+")":r},t.DOLLARDE=function(e,t){if(A(e=D(e),t=D(t)))return a;if(t<0)return u;if(t>=0&&t<1)return s;t=parseInt(t,10);let n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*r)/r,n},t.DOLLARFR=function(e,t){if(A(e=D(e),t=D(t)))return a;if(t<0)return u;if(t>=0&&t<1)return s;t=parseInt(t,10);let n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,n},t.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);let i=[];g(r,e=>{i.push(o[e])}),i=Vn(i);let s=1;return g(i,e=>{s*=e}),s},t.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);let i=[];return g(r,e=>{i.push(o[e])}),i=Vn(i),Oe.S(i)},t.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);let i=[];return g(r,e=>{i.push(o[e])}),i=Vn(i),Oe.P(i)},t.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);const i=[];return g(r,e=>{i.push(o[e])}),Ke(i)},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);const i=[];return g(r,e=>{i.push(o[e])}),ke.S(i)},t.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const r=qn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=x(e[n])}else o=x(e[t]);const i=[];return g(r,e=>{i.push(o[e])}),ke.P(i)},t.EDATE=function(e,t){return(e=_(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},t.EFFECT=function(e,t){return A(e=D(e),t=D(t))?a:e<=0||t<1?u:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.EOMONTH=function(e,t){return(e=_(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},t.ERF=xt,t.ERFC=Et,t.ERFCPRECISE=Xt,t.ERFPRECISE=Gt,t.ERROR=z,t.EVEN=function(e){return(e=D(e))instanceof Error?e:Ve(e,-2,-1)},t.EXACT=function(e,t){return 2!==arguments.length?d:L(e,t)||(e=S(e))===S(t)},t.EXP=function(e){return arguments.length<1?d:arguments.length>1?p:(e=D(e))instanceof Error?e:e=Math.exp(e)},t.EXPON=ue,t.EXPONDIST=Kt,t.F=de,t.FACT=Ue,t.FACTDOUBLE=function e(t){if((t=D(t))instanceof Error)return t;const n=Math.floor(t);return n<=0?1:n*e(n-2)},t.FALSE=function(){return!1},t.FDIST=$t,t.FDISTRT=Zt,t.FIND=function(e,t,n){if(arguments.length<2)return d;e=S(e),n=void 0===n?0:n;const r=(t=S(t)).indexOf(e,n-1);return-1===r?a:r+1},t.FINV=Jt,t.FINVRT=Qt,t.FISHER=function(e){return(e=D(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=D(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.FIXED=gt,t.FLOOR=Ye,t.FLOORMATH=en,t.FLOORPRECISE=tn,t.FORECAST=pe,t.FREQUENCY=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;const n=e.length,r=t.length,o=[];for(let i=0;i<=r;i++){o[i]=0;for(let s=0;s<n;s++)0===i?e[s]<=t[0]&&(o[0]+=1):i<r?e[s]>t[i-1]&&e[s]<=t[i]&&(o[i]+=1):i===r&&e[s]>t[r-1]&&(o[r]+=1)}return o},t.FTEST=nn,t.FV=Yn,t.FVSCHEDULE=function(e,t){if(A(e=D(e),t=O(b(t))))return a;const n=t.length;let r=e;for(let e=0;e<n;e++)r*=1+t[e];return r},t.GAMMA=fe,t.GAMMADIST=rn,t.GAMMAINV=on,t.GAMMALN=he,t.GAMMALNPRECISE=sn,t.GAUSS=function(e){return(e=D(e))instanceof Error?e:r.normal.cdf(e,0,1)-.5},t.GCD=function(){const e=O(b(arguments));if(e instanceof Error)return e;const t=e.length,n=e[0];let r=n<0?-n:n;for(let n=1;n<t;n++){const t=e[n];let o=t<0?-t:t;for(;r&&o;)r>o?r%=o:o%=r;r+=o}return r},t.GEOMEAN=function(){const e=O(b(arguments));return e instanceof Error?e:r.geomean(e)},t.GESTEP=function(e,t){return A(t=t||0,e=D(e))?e:e>=t?1:0},t.GROWTH=function(e,t,n,r){if((e=O(e))instanceof Error)return e;let o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===n)for(n=[],o=1;o<=e.length;o++)n.push(o);if(A(t=O(t),n=O(n)))return a;void 0===r&&(r=!0);const i=e.length;let s,l,c=0,u=0,d=0,p=0;for(o=0;o<i;o++){const n=t[o],r=Math.log(e[o]);c+=n,u+=r,d+=n*r,p+=n*n}c/=i,u/=i,d/=i,p/=i,r?(s=(d-c*u)/(p-c*c),l=u-s*c):(s=d/p,l=0);const f=[];for(o=0;o<n.length;o++)f.push(Math.exp(l+s*n[o]));return f},t.HARMEAN=function(){const e=O(b(arguments));if(e instanceof Error)return e;const t=e.length;let n=0;for(let r=0;r<t;r++)n+=1/e[r];return t/n},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()),r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return u;if(n)return"1"+vt("0",9-(512+r).toString(2).length)+(512+r).toString(2);const o=r.toString(2);return void 0===t?o:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:u},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return u;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);const r=n.toString(8);return void 0===t?r:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:u},t.HLOOKUP=function(e,t,n,r){return Q(e,E(t),n,r)},t.HOUR=function(e){return(e=_(e))instanceof Error?e:e.getHours()},t.HYPGEOM=me,t.HYPGEOMDIST=an,t.IF=function(e,t,n){return e instanceof Error?e:(null==(t=!(arguments.length>=2)||t)&&(t=0),null==(n=3===arguments.length&&n)&&(n=0),e?t:n)},t.IFERROR=function(e,t){return G(e)?t:e},t.IFNA=function(e,t){return e===d?t:e},t.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return d},t.IMABS=jt,t.IMAGINARY=Lt,t.IMARGUMENT=At,t.IMCONJUGATE=function(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",0!==n?Ct(t,-n,r):e},t.IMCOS=Mt,t.IMCOSH=It,t.IMCOT=function(e){return A(_t(e),Lt(e))?a:Tt(Mt(e),Nt(e))},t.IMCSC=function(e){return!0===e||!1===e?a:A(_t(e),Lt(e))?u:Tt("1",Nt(e))},t.IMCSCH=function(e){return!0===e||!1===e?a:A(_t(e),Lt(e))?u:Tt("1",Dt(e))},t.IMDIV=Tt,t.IMEXP=function(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);r="i"===r||"j"===r?r:"i";const o=Math.exp(t);return Ct(o*Math.cos(n),o*Math.sin(n),r)},t.IMLN=function(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),r)},t.IMLOG10=function(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),r)},t.IMLOG2=function(e){const t=_t(e),n=Lt(e);if(A(t,n))return a;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",Ct(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),r)},t.IMPOWER=function(e,t){if(A(t=D(t),_t(e),Lt(e)))return a;let n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";const r=Math.pow(jt(e),t),o=At(e);return Ct(r*Math.cos(t*o),r*Math.sin(t*o),n)},t.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return a;for(let t=1;t<arguments.length;t++){const n=_t(e),r=Lt(e),o=_t(arguments[t]),i=Lt(arguments[t]);if(A(n,r,o,i))return a;e=Ct(n*o-r*i,n*i+r*o)}return e},t.IMREAL=_t,t.IMSEC=function(e){return!0===e||!1===e||A(_t(e),Lt(e))?a:Tt("1",Mt(e))},t.IMSECH=function(e){return A(_t(e),Lt(e))?a:Tt("1",It(e))},t.IMSIN=Nt,t.IMSINH=Dt,t.IMSQRT=function(e){if(A(_t(e),Lt(e)))return a;let t=e.substring(e.length-1);t="i"===t||"j"===t?t:"i";const n=Math.sqrt(jt(e)),r=At(e);return Ct(n*Math.cos(r/2),n*Math.sin(r/2),t)},t.IMSUB=function(e,t){const n=_t(e),r=Lt(e),o=_t(t),i=Lt(t);if(A(n,r,o,i))return a;const s=e.substring(e.length-1),l=t.substring(t.length-1);let c="i";return("j"===s||"j"===l)&&(c="j"),Ct(n-o,r-i,c)},t.IMSUM=function(){if(!arguments.length)return a;const e=b(arguments);let t=e[0];for(let n=1;n<e.length;n++){const r=_t(t),o=Lt(t),i=_t(e[n]),s=Lt(e[n]);if(A(r,o,i,s))return a;t=Ct(r+i,o+s)}return t},t.IMTAN=function(e){return!0===e||!1===e||A(_t(e),Lt(e))?a:Tt(Nt(e),Mt(e))},t.INDEX=function(e,t,n){const r=L(e,t,n);if(r)return r;if(!Array.isArray(e))return a;const o=e.length>0&&!Array.isArray(e[0]);return o&&!n?(n=t,t=1):(n=n||1,t=t||1),n<0||t<0?a:o&&1===t&&n<=e.length?e[n-1]:t<=e.length&&n<=e[t-1].length?e[t-1][n-1]:l},t.INFO=function(){throw new Error("INFO is not implemented")},t.INT=function(e){return(e=D(e))instanceof Error?e:Math.floor(e)},t.INTERCEPT=function(e,t){return A(e=O(e),t=O(t))?a:e.length!==t.length?d:pe(0,e,t)},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=Wn,t.IRR=function(e,t){if(t=t||0,A(e=O(b(e)),t=D(t)))return a;const n=(e,t,n)=>{const r=n+1;let o=e[0];for(let n=1;n<e.length;n++)o+=e[n]/Math.pow(r,(t[n]-t[0])/365);return o},r=(e,t,n)=>{const r=n+1;let o=0;for(let n=1;n<e.length;n++){const i=(t[n]-t[0])/365;o-=i*e[n]/Math.pow(r,i+1)}return o},o=[];let i=!1,s=!1;for(let t=0;t<e.length;t++)o[t]=0===t?0:o[t-1]+365,e[t]>0&&(i=!0),e[t]<0&&(s=!0);if(!i||!s)return u;let l,c,d,p=t=void 0===t?.1:t,f=!0;do{d=n(e,o,p),l=p-d/r(e,o,p),c=Math.abs(l-p),p=l,f=c>1e-10&&Math.abs(d)>1e-10}while(f);return p},t.ISBLANK=function(e){return null===e},t.ISERR=X,t.ISERROR=G,t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=K,t.ISNA=function(e){return e===d},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=$,t.ISO=We,t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISOWEEKNUM=it,t.ISPMT=function(e,t,n,r){return A(e=D(e),t=D(t),n=D(n),r=D(r))?a:r*e*(t/n-1)},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=Z,t.KURT=function(){const e=O(b(arguments));if(e instanceof Error)return e;const t=r.mean(e),n=e.length;let o=0;for(let r=0;r<n;r++)o+=Math.pow(e[r]-t,4);return o/=Math.pow(r.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*o-3*(n-1)*(n-1)/((n-2)*(n-3))},t.LARGE=ge,t.LCM=function(){const e=O(b(arguments));if(e instanceof Error)return e;for(var t,n,r,o,i=1;void 0!==(r=e.pop());){if(0===r)return 0;for(;r>1;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);o=t<=n?t:r}else o=2;for(r/=o,i*=o,t=e.length;t;e[--t]%o==0&&1==(e[t]/=o)&&e.splice(t,1));}}return i},t.LEFT=function(e,t){return L(e,t)||(e=S(e),(t=D(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?a:e.substring(0,t))},t.LEN=function(e){return 0===arguments.length?p:e instanceof Error?e:Array.isArray(e)?a:S(e).length},t.LINEST=ve,t.LN=function(e){return(e=D(e))instanceof Error?e:0===e?u:Math.log(e)},t.LOG=function(e,t){return L(e=D(e),t=D(t))||(0===e||0===t?u:Math.log(e)/Math.log(t))},t.LOG10=function(e){return(e=D(e))instanceof Error?e:0===e?u:Math.log(e)/Math.log(10)},t.LOGEST=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;if(e.length!==t.length)return a;for(let t=0;t<e.length;t++)e[t]=Math.log(e[t]);const n=ve(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n},t.LOGINV=ln,t.LOGNORM=ye,t.LOGNORMDIST=cn,t.LOGNORMINV=un,t.LOOKUP=function(e,t,n){t=b(t),n=n?b(n):t;const r="number"==typeof e;let o=d;for(let i=0;i<t.length;i++){if(t[i]===e)return n[i];if(r&&t[i]<=e||"string"==typeof t[i]&&t[i].localeCompare(e)<0)o=n[i];else if(r&&t[i]>e)return o}return o},t.LOWER=function(e){return 1!==arguments.length?a:A(e=S(e))?e:e.toLowerCase()},t.MATCH=function(e,t,n){if(!e||!t)return d;if(2===arguments.length&&(n=1),!((t=b(t))instanceof Array))return d;if(-1!==n&&0!==n&&1!==n)return d;let r,o;for(let i=0;i<t.length;i++)if(1===n){if(t[i]===e)return i+1;t[i]<e&&(o?t[i]>o&&(r=i+1,o=t[i]):(r=i+1,o=t[i]))}else if(0===n){if("string"==typeof e&&"string"==typeof t[i]){const n=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+n+"$").test(t[i].toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===n){if(t[i]===e)return i+1;t[i]>e&&(o?t[i]<o&&(r=i+1,o=t[i]):(r=i+1,o=t[i]))}return r||d},t.MAX=be,t.MAXA=function(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;let n=v(e);return n=n.map(e=>null==e?0:e),0===n.length?0:Math.max.apply(Math,n)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MEDIAN=we,t.MID=function(e,t,n){if(null==t)return a;if(A(t=D(t),n=D(n))||"string"!=typeof e)return n;const r=t-1,o=r+n;return e.substring(r,o)},t.MIN=Ce,t.MINA=function(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;let n=v(e);return n=n.map(e=>null==e?0:e),0===n.length?0:Math.min.apply(Math,n)},t.MINUTE=function(e){return(e=_(e))instanceof Error?e:e.getMinutes()},t.MIRR=function(e,t,n){if(A(e=O(b(e)),t=D(t),n=D(n)))return a;const r=e.length,o=[],i=[];for(let t=0;t<r;t++)e[t]<0?o.push(e[t]):i.push(e[t]);const s=-zn(n,i)*Math.pow(1+n,r-1),l=zn(t,o)*(1+t);return Math.pow(s/l,1/(r-1))-1},t.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(e=>!e.length)||t.some(e=>!e.length)||w(e).some(e=>"number"!=typeof e)||w(t).some(e=>"number"!=typeof e)||e[0].length!==t.length?a:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((n,r)=>n.map((n,o)=>e[r].reduce((e,n,r)=>e+n*t[r][o],0)))},t.MOD=function(e,t){const n=L(e=D(e),t=D(t));if(n)return n;if(0===t)return s;let r=Math.abs(e%t);return r=e<0?t-r:r,t>0?r:-r},t.MODE=xe,t.MODEMULT=dn,t.MODESNGL=pn,t.MONTH=function(e){return(e=_(e))instanceof Error?e:e.getMonth()+1},t.MROUND=function(e,t){return L(e=D(e),t=D(t))||(e*t==0?0:e*t<0?u:Math.round(e/t)*t)},t.MULTINOMIAL=function(){const e=O(b(arguments));if(e instanceof Error)return e;let t=0,n=1;for(let r=0;r<e.length;r++)t+=e[r],n*=Ue(e[r]);return Ue(t)/n},t.MUNIT=function(e){return arguments.length>1?d:!(e=parseInt(e))||e<=0?a:Array(e).fill(0).map(()=>Array(e).fill(0)).map((e,t)=>(e[t]=1,e))},t.N=function(e){return $(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:G(e)?e:0},t.NA=function(){return d},t.NEGBINOM=Ee,t.NEGBINOMDIST=fn,t.NETWORKDAYS=st,t.NETWORKDAYSINTL=hn,t.NOMINAL=function(e,t){return A(e=D(e),t=D(t))?a:e<=0||t<1?u:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NORM=je,t.NORMDIST=mn,t.NORMINV=gn,t.NORMSDIST=vn,t.NORMSINV=yn,t.NOT=function(e){return"string"==typeof e?a:e instanceof Error?e:!e},t.NOW=function(){return new Date},t.NPER=function(e,t,n,r,o){if(o=void 0===o?0:o,r=void 0===r?0:r,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o)))return a;if(0===e)return-(n+r)/t;{const i=t*(1+e*o)-r*e,s=n*e+t*(1+e*o);return Math.log(i/s)/Math.log(1+e)}},t.NPV=zn,t.NUMBERVALUE=function(e,t,n){return"number"==typeof(e=R(e)?e:"")?e:"string"!=typeof e?d:(t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,"")))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=!(10!==e.length||"7"!==e.substring(0,1)),r=n?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return u;if(n)return"1"+vt("0",9-(512+r).toString(2).length)+(512+r).toString(2);const o=r.toString(2);return void 0===t?o:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:u},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return u;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);const r=n.toString(16);return void 0===t?r:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:u},t.ODD=function(e){if((e=D(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.OR=function(){const e=b(arguments);let t=a;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===a&&(t=!1),e[n]&&(t=!0))}return t},t.PDURATION=function(e,t,n){return A(e=D(e),t=D(t),n=D(n))?a:e<=0?u:(Math.log(n)-Math.log(t))/Math.log(1+e)},t.PEARSON=Le,t.PERCENTILE=Ae,t.PERCENTILEEXC=bn,t.PERCENTILEINC=wn,t.PERCENTRANK=Me,t.PERCENTRANKEXC=Cn,t.PERCENTRANKINC=xn,t.PERMUT=function(e,t){return A(e=D(e),t=D(t))?a:Ue(e)/Ue(e-t)},t.PERMUTATIONA=function(e,t){return A(e=D(e),t=D(t))?a:Math.pow(e,t)},t.PHI=function(e){return(e=D(e))instanceof Error?a:Math.exp(-.5*e*e)/2.5066282746310002},t.PI=function(){return Math.PI},t.PMT=Xn,t.POISSON=Ie,t.POISSONDIST=En,t.POWER=ze,t.PPMT=function(e,t,n,r,o,i){return o=o||0,i=i||0,A(e=D(e),n=D(n),r=D(r),o=D(o),i=D(i))?a:Xn(e,n,r,o,i)-Wn(e,t,n,r,o,i)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(e,t,n,r,o){if(A(e=_(e),t=_(t),n=D(n),r=D(r),o=(o=D(o))||0))return a;if(n<=0||r<=0)return u;if(e>=t)return a;let i,s;switch(o){case 0:i=360,s=ot(e,t,!1);break;case 1:case 3:i=365,s=tt(e,t,"D");break;case 2:i=360,s=tt(e,t,"D");break;case 4:i=360,s=ot(e,t,!0);break;default:return u}return r-n*r*s/i},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PROB=function(e,t,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,A(e=O(b(e)),t=O(b(t)),n=D(n),r=D(r)))return a;if(n===r)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;const o=e.sort((e,t)=>e-t),i=o.length;let s=0;for(let a=0;a<i;a++)o[a]>=n&&o[a]<=r&&(s+=t[e.indexOf(o[a])]);return s},t.PRODUCT=Xe,t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return A(e)?e:isNaN(e)&&"number"==typeof e?a:(e=S(e)).replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())},t.PV=function(e,t,n,r,o){return r=r||0,o=o||0,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o))?a:0===e?-n*t-r:((1-Math.pow(1+e,t))/e*n*(1+e*o)-r)/Math.pow(1+e,t)},t.QUARTILE=Te,t.QUARTILEEXC=jn,t.QUARTILEINC=Ln,t.QUOTIENT=function(e,t){return L(e=D(e),t=D(t))||parseInt(e/t,10)},t.RADIANS=function(e){return(e=D(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return L(e=D(e),t=D(t))||e+Math.ceil((t-e+1)*Math.random())-1},t.RANK=_e,t.RANKAVG=An,t.RANKEQ=Mn,t.RATE=function(e,t,n,r,o,i){if(i=void 0===i?.01:i,r=void 0===r?0:r,o=void 0===o?0:o,A(e=D(e),t=D(t),n=D(n),r=D(r),o=D(o),i=D(i)))return a;const s=1e-10;let l=i;o=o?1:0;for(let i=0;i<20;i++){if(l<=-1)return u;let i,a,c;if(Math.abs(l)<s?i=n*(1+e*l)+t*(1+l*o)*e+r:(a=Math.pow(1+l,e),i=n*a+t*(1/l+o)*(a-1)+r),Math.abs(i)<s)return l;if(Math.abs(l)<s)c=n*e+t*o*e;else{a=Math.pow(1+l,e);const r=e*Math.pow(1+l,e-1);c=n*r+t*(1/l+o)*r+t*(-1/(l*l))*(a-1)}l-=i/c}return l},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.REPLACE=function(e,t,n,r){return A(t=D(t),n=D(n))||"string"!=typeof e||"string"!=typeof r?a:e.substr(0,t-1)+r+e.substr(t-1+n)},t.REPT=vt,t.RIGHT=function(e,t){return L(e,t)||(e=S(e),(t=D(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))},t.ROMAN=function(e){if((e=D(e))instanceof Error)return e;const t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",o=3;for(;o--;)r=(n[+t.pop()+10*o]||"")+r;return new Array(+t.join("")+1).join("M")+r},t.ROUND=Ge,t.ROUNDDOWN=function(e,t){return L(e=D(e),t=D(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return L(e=D(e),t=D(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROW=function(e,t){return 2!==arguments.length?d:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?r.row(e,t):void 0:a},t.ROWS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:r.rows(e):a},t.RRI=function(e,t,n){return A(e=D(e),t=D(t),n=D(n))?a:0===e||0===t?u:Math.pow(n/t,1/e)-1},t.RSQ=function(e,t){return A(e=O(b(e)),t=O(b(t)))?a:Math.pow(Le(e,t),2)},t.SEARCH=function(e,t,n){let r;return"string"!=typeof e||"string"!=typeof t?a:(n=void 0===n?0:n,r=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===r?a:r)},t.SEC=function(e){return(e=D(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=D(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SECOND=function(e){return(e=_(e))instanceof Error?e:e.getSeconds()},t.SERIESSUM=function(e,t,n,r){if(A(e=D(e),t=D(t),n=D(n),r=O(r)))return a;let o=r[0]*Math.pow(e,t);for(let i=1;i<r.length;i++)o+=r[i]*Math.pow(e,t+i*n);return o},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.SIGN=function(e){return(e=D(e))instanceof Error?e:e<0?-1:0===e?0:1},t.SIN=function(e){return(e=D(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=D(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SKEW=Ne,t.SKEWP=In,t.SLN=function(e,t,n){return A(e=D(e),t=D(t),n=D(n))?a:0===n?u:(e-t)/n},t.SLOPE=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;const n=r.mean(t),o=r.mean(e),i=t.length;let s=0,l=0;for(let r=0;r<i;r++)s+=(t[r]-n)*(e[r]-o),l+=Math.pow(t[r]-n,2);return s/l},t.SMALL=De,t.SORT=function(e,t=1,n=1,r=!1){if(!e||!Array.isArray(e))return d;if(0===e.length)return 0;if(!(t=D(t))||t<1)return a;if(1!==(n=D(n))&&-1!==n)return a;if("boolean"!=typeof(r=T(r)))return c;const o=e=>e.sort((e,r)=>(e=S(e[t-1]),r=S(r[t-1]),1===n?e<r?-1*n:n:e>r?n:-1*n)),i=y(e),s=r?E(i):i;return t>=1&&t<=s[0].length?r?E(o(s)):o(s):a},t.SQRT=function(e){return(e=D(e))instanceof Error?e:e<0?u:Math.sqrt(e)},t.SQRTPI=function(e){return(e=D(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.STANDARDIZE=function(e,t,n){return A(e=D(e),t=D(t),n=D(n))?a:(e-t)/n},t.STDEV=Oe,t.STDEVA=function(){const e=Re.apply(this,arguments);return Math.sqrt(e)},t.STDEVP=Tn,t.STDEVPA=function(){const e=He.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},t.STDEVS=_n,t.STEYX=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;const n=r.mean(t),o=r.mean(e),i=t.length;let s=0,l=0,c=0;for(let r=0;r<i;r++)s+=Math.pow(e[r]-o,2),l+=(t[r]-n)*(e[r]-o),c+=Math.pow(t[r]-n,2);return Math.sqrt((s-l*l/c)/(i-2))},t.SUBSTITUTE=function(e,t,n,r){if(arguments.length<3)return d;if(e&&t){if(void 0===r)return e.split(t).join(n);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return a;let o=0,i=0;for(;o>-1&&e.indexOf(t,o)>-1;)if(o=e.indexOf(t,o+1),i++,o>-1&&i===r)return e.substring(0,o)+n+e.substring(o+t.length);return e}}return e},t.SUBTOTAL=function(e,t){if((e=D(e))instanceof Error)return e;switch(e){case 1:case 101:return ee(t);case 2:case 102:return se(t);case 3:case 103:return ae(t);case 4:case 104:return be(t);case 5:case 105:return Ce(t);case 6:case 106:return Xe(t);case 7:case 107:return Oe.S(t);case 8:case 108:return Oe.P(t);case 9:case 109:return Ke(t);case 10:case 110:return ke.S(t);case 11:case 111:return ke.P(t)}},t.SUM=Ke,t.SUMIF=function(e,t,n){if(e=b(e),n=n?b(n):e,e instanceof Error)return e;if(null==t||t instanceof Error)return 0;let r=0;const o="*"===t,i=o?null:Y(t+"");for(let t=0;t<e.length;t++){const s=e[t],a=n[t];if(o)r+=s;else{const e=[U(s,B)].concat(i);r+=W(e)?a:0}}return r},t.SUMIFS=function(){const e=m(arguments),t=O(b(e.shift()));if(t instanceof Error)return t;const n=e,r=n.length/2;for(let e=0;e<r;e++)n[2*e]=b(n[2*e]);let o=0;for(let e=0;e<t.length;e++){let i=!1;for(let t=0;t<r;t++){const r=n[2*t][e],o=n[2*t+1];let s=!1;if(void 0===o||"*"===o)s=!0;else{const e=Y(o+""),t=[U(r,B)].concat(e);s=W(t)}if(!s){i=!1;break}i=!0}i&&(o+=t[e])}return o},t.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return a;const e=arguments.length+1;let t,n,r,o,i=0;for(let s=0;s<arguments[0].length;s++)if(arguments[0][s]instanceof Array)for(let r=0;r<arguments[0][s].length;r++){for(t=1,n=1;n<e;n++){const e=arguments[n-1][s][r];if(e instanceof Error)return e;if(o=D(e),o instanceof Error)return o;t*=o}i+=t}else{for(t=1,n=1;n<e;n++){const e=arguments[n-1][s];if(e instanceof Error)return e;if(r=D(e),r instanceof Error)return r;t*=r}i+=t}return i},t.SUMSQ=function(){const e=O(b(arguments));if(e instanceof Error)return e;let t=0;const n=e.length;for(let r=0;r<n;r++)t+=$(e[r])?e[r]*e[r]:0;return t},t.SUMX2MY2=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;let n=0;for(let r=0;r<e.length;r++)n+=e[r]*e[r]-t[r]*t[r];return n},t.SUMX2PY2=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;let n=0;e=O(b(e)),t=O(b(t));for(let r=0;r<e.length;r++)n+=e[r]*e[r]+t[r]*t[r];return n},t.SUMXMY2=function(e,t){if(A(e=O(b(e)),t=O(b(t))))return a;let n=0;e=b(e),t=b(t);for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},t.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],n=arguments.length-1,r=Math.floor(n/2);let o=!1;const i=n%2!=0,s=n%2==0?null:arguments[arguments.length-1];if(r)for(let n=0;n<r;n++)if(t===arguments[2*n+1]){e=arguments[2*n+2],o=!0;break}o||(e=i?s:d)}else e=a;return e},t.SYD=function(e,t,n,r){return A(e=D(e),t=D(t),n=D(n),r=D(r))?a:0===n||r<1||r>n?u:(e-t)*(n-(r=parseInt(r,10))+1)*2/(n*(n+1))},t.T=function(e){return e instanceof Error||"string"==typeof e?e:""},t.TAN=function(e){return(e=D(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){if((e=D(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.TBILLEQ=function(e,t,n){return A(e=_(e),t=_(t),n=D(n))?a:n<=0||e>t||t-e>31536e6?u:365*n/(360-n*ot(e,t,!1))},t.TBILLPRICE=function(e,t,n){return A(e=_(e),t=_(t),n=D(n))?a:n<=0||e>t||t-e>31536e6?u:100*(1-n*ot(e,t,!1)/360)},t.TBILLYIELD=function(e,t,n){return A(e=_(e),t=_(t),n=D(n))?a:n<=0||e>t||t-e>31536e6?u:360*(100-n)/(n*ot(e,t,!1))},t.TDIST=Nn,t.TDISTRT=Dn,t.TEXT=function(e,t){if(void 0===e||e instanceof Error||t instanceof Error)return d;if(null==t)return"";if("number"==typeof t)return String(t);if("string"!=typeof t)return a;const n=t.startsWith("$")?"$":"",r=t.endsWith("%");return r&&(e*=100),e=(e=gt(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+n+(e=e.replace("-","")):n+e,r&&(e+="%"),e},t.TEXTJOIN=function(e,t,...n){if("boolean"!=typeof t&&(t=T(t)),arguments.length<3)return d;e=null!=e?e:"";let r=b(n),o=t?r.filter(e=>e):r;if(Array.isArray(e)){e=b(e);let t=o.map(e=>[e]),n=0;for(let r=0;r<t.length-1;r++)t[r].push(e[n]),n++,n===e.length&&(n=0);return o=b(t),o.join("")}return o.join(e)},t.TIME=function(e,t,n){return A(e=D(e),t=D(t),n=D(n))?a:e<0||t<0||n<0?u:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return(e=_(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TINV=On,t.TODAY=function(){return nt(new Date)},t.TRANSPOSE=function(e){return e?E(y(e)):d},t.TREND=function(e,t,n){if(A(e=O(b(e)),t=O(b(t)),n=O(b(n))))return a;const r=ve(e,t),o=r[0],i=r[1],s=[];return n.forEach(e=>{s.push(o*e+i)}),s},t.TRIM=function(e){return(e=S(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},t.TRIMMEAN=function(e,t){if(A(e=O(b(e)),t=D(t)))return a;const n=Ye(e.length*t,2)/2;return r.mean((i=(i=n)||1,(o=x(e.sort((e,t)=>e-t),n))&&"function"==typeof o.slice?o.slice(0,o.length-i):o));var o,i},t.TRUE=function(){return!0},t.TRUNC=function(e,t){return L(e=D(e),t=D(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.TTEST=Sn,t.TYPE=function(e){return $(e)?1:Z(e)?2:K(e)?4:G(e)?16:Array.isArray(e)?64:void 0},t.UNICHAR=yt,t.UNICODE=bt,t.UNIQUE=J,t.UPPER=function(e){return(e=S(e))instanceof Error?e:e.toUpperCase()},t.VALUE=function(e){const t=L(e);if(t)return t;if("number"==typeof e)return e;if(R(e)||(e=""),"string"!=typeof e)return a;const n=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return 0;let r=Number(e);return isNaN(r)?a:(r=r||0,n&&(r*=.01),r)},t.VAR=ke,t.VARA=Re,t.VARP=kn,t.VARPA=He,t.VARS=Rn,t.VDB=function(){throw new Error("VDB is not implemented")},t.VLOOKUP=Q,t.WEEKDAY=function(e,t){if((e=_(e))instanceof Error)return e;void 0===t&&(t=1);const n=e.getDay();return Qe[t][n]},t.WEEKNUM=function(e,t){if((e=_(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return it(e);const n=Je[t];let r=new Date(e.getFullYear(),0,1);const o=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((e-r)/864e5/7+1)+o},t.WEIBULL=Pe,t.WEIBULLDIST=Hn,t.WORKDAY=at,t.WORKDAYINTL=Pn,t.XIRR=function(e,t,n){if(A(e=O(b(e)),t=N(b(t)),n=D(n)))return a;const r=(e,t,n)=>{const r=n+1;let o=e[0];for(let n=1;n<e.length;n++)o+=e[n]/Math.pow(r,rt(t[n],t[0])/365);return o},o=(e,t,n)=>{const r=n+1;let o=0;for(let n=1;n<e.length;n++){const i=rt(t[n],t[0])/365;o-=i*e[n]/Math.pow(r,i+1)}return o};let i=!1,s=!1;for(let t=0;t<e.length;t++)e[t]>0&&(i=!0),e[t]<0&&(s=!0);if(!i||!s)return u;let l,c,d,p=n=n||.1,f=!0;do{d=r(e,t,p),l=p-d/o(e,t,p),c=Math.abs(l-p),p=l,f=c>1e-10&&Math.abs(d)>1e-10}while(f);return p},t.XNPV=function(e,t,n){if(A(e=D(e),t=O(b(t)),n=N(b(n))))return a;let r=0;for(let o=0;o<t.length;o++)r+=t[o]/Math.pow(1+e,rt(n[o],n[0])/365);return r},t.XOR=function(){const e=b(arguments);let t=a;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===a&&(t=0),e[n]&&t++)}return t===a?t:!!(1&Math.floor(Math.abs(t)))},t.YEAR=function(e){return(e=_(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=ut,t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},t.Z=Fe,t.ZTEST=Fn,t.utils=Gn}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,r),i.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var o=r(960);t=o}(),t)},881:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var r=function(){var e=this,t=0;if(e.options.freezeColumns>0)for(var n=0;n<e.options.freezeColumns;n++)t+=e.options.columns&&e.options.columns[n]&&void 0!==e.options.columns[n].width?parseInt(e.options.columns[n].width):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth):100;return t}},894:function(e,t,n){"use strict";n.d(t,{AG:function(){return o},G_:function(){return i},p6:function(){return s},wu:function(){return r}});var r=function(e){var t,n=this;t=1!=n.options.search&&1!=n.options.filters||!n.results?n.rows:n.results;var r=100;null!=e&&-1!=e||(e=Math.ceil(t.length/r)-1);var o=e*r,i=e*r+r;i>t.length&&(i=t.length),(o=i-100)<0&&(o=0);for(var s=o;s<i;s++)1!=n.options.search&&1!=n.options.filters||!n.results?n.tbody.appendChild(n.rows[s].element):n.tbody.appendChild(n.rows[t[s]].element),n.tbody.children.length>r&&n.tbody.removeChild(n.tbody.firstChild)},o=function(){var e=this;if(e.selectedCell){var t=e.tbody.firstChild.getAttribute("data-y"),n=t?parseInt(t)/100:0,r=Math.floor(parseInt(e.selectedCell[3])/100),o=Math.floor(e.rows.length/100);if(n!=r&&r<=o&&!Array.prototype.indexOf.call(e.tbody.children,e.rows[e.selectedCell[3]].element))return e.loadPage(r),!0}return!1},i=function(){var e,t=this,n=0;if((e=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results).length>100){var r=t.tbody.firstChild.getAttribute("data-y"),o=r?parseInt(r):0;if(1!=t.options.search&&1!=t.options.filters||!t.results||(o=e.indexOf(o)),o>0)for(var i=0;i<30;i++)(o-=1)>-1&&(1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.insertBefore(t.rows[o].element,t.tbody.firstChild):t.tbody.insertBefore(t.rows[e[o]].element,t.tbody.firstChild),t.tbody.children.length>100&&(t.tbody.removeChild(t.tbody.lastChild),n=1))}return n},s=function(){var e,t=this,n=0;if((e=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results).length>100){var r=t.tbody.lastChild.getAttribute("data-y"),o=r?parseInt(r):0;if(1!=t.options.search&&1!=t.options.filters||!t.results||(o=e.indexOf(o)),o<t.rows.length-1)for(var i=0;i<=30;i++)o<e.length&&(1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.appendChild(t.rows[o].element):t.tbody.appendChild(t.rows[e[o]].element),t.tbody.children.length>100&&(t.tbody.removeChild(t.tbody.firstChild),n=1)),o+=1}return n}},898:function(e,t,n){"use strict";n.d(t,{Hh:function(){return o},t3:function(){return s},vu:function(){return i}});var r=n(9),o=function(e,t,n){if(t<=e.length)return e.slice(0,t).concat(n).concat(e.slice(t));for(var r=e.slice(0,e.length);t>r.length;)r.push(void 0);return r.concat(n)},i=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var r=0,o=0;o<n[0].length;o++)r+=parseInt(String(n[0].charCodeAt(o)-64))*Math.pow(26,n[0].length-1-o);--r<0&&(r=0);var i=/[0-9]+$/.exec(e),s=i?parseInt(i[0]):0;return s>0&&s--,1==t?[r,s]:r+"-"+s}return e},s=function(e){if(!Array.isArray(e)){var t=e.split("-");return(0,r.getColumnName)(parseInt(String(t[0])))+(parseInt(String(t[1]))+1)}return(0,r.getColumnName)(parseInt(String(e[0])))+(parseInt(String(e[1]))+1)}},986:function(e,t,n){"use strict";n.d(t,{$f:function(){return u},IV:function(){return l},MY:function(){return c},ho:function(){return a}});var r=n(587),o=n.n(r),i=n(988),s=n(106),a=function(e){var t=this;return 1!=t.options.search&&1!=t.options.filters||!t.results||(e=t.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(t.options.pagination))-1},l=function(){var e=this;if(e.pagination.children[0].innerHTML="",e.pagination.children[1].innerHTML="",e.options.pagination){var t;if(t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows.length:e.results.length){var n=Math.ceil(t/e.options.pagination),r=void 0,i=void 0;e.pageNumber<6?(r=1,i=n<10?n:10):n-e.pageNumber<5?(i=n,(r=n-9)<1&&(r=1)):(r=e.pageNumber-4,i=e.pageNumber+5),r>1&&((a=document.createElement("div")).className="jss_page",a.innerHTML="<",a.title="1",e.pagination.children[1].appendChild(a));for(var s=r;s<=i;s++){var a;(a=document.createElement("div")).className="jss_page",a.innerHTML=s.toString(),e.pagination.children[1].appendChild(a),e.pageNumber==s-1&&a.classList.add("jss_page_selected")}i<n&&((a=document.createElement("div")).className="jss_page",a.innerHTML=">",a.title=n.toString(),e.pagination.children[1].appendChild(a)),e.pagination.children[0].innerHTML=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,function(e,n){return void 0!==t[n]?t[n]:e})}(o().translate("Showing page {0} of {1} entries"),(e.pageNumber+1).toString(),n.toString())}else e.pagination.children[0].innerHTML=o().translate("No records found")}},c=function(e){var t,n=this,r=n.pageNumber;t=1!=n.options.search&&1!=n.options.filters||!n.results?n.rows:n.results;var o=parseInt(n.options.pagination);null!=e&&-1!=e||(e=Math.ceil(t.length/o)-1),n.pageNumber=e;var a=e*o,c=e*o+o;for(c>t.length&&(c=t.length),a<0&&(a=0);n.tbody.firstChild;)n.tbody.removeChild(n.tbody.firstChild);for(var u=a;u<c;u++)1!=n.options.search&&1!=n.options.filters||!n.results?n.tbody.appendChild(n.rows[u].element):n.tbody.appendChild(n.rows[t[u]].element);n.options.pagination>0&&l.call(n),s.Aq.call(n),i.A.call(n,"onchangepage",n,e,r,n.options.pagination)},u=function(){var e,t=this;return e=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows.length:t.results.length,Math.ceil(e/t.options.pagination)}},988:function(e,t,n){"use strict";var r=n(587),o=n.n(r),i=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].x,o=e[n].y,i=this.options.columns[r].name?this.options.columns[r].name:r;t[o]||(t[o]={row:o,data:{}}),t[o]&&t[o].data&&(t[o].data[i]=e[n].value)}return t.filter(function(e){return null!=e})},s=function(e,t){var n=this,r=a.call(n.parent,"onbeforesave",n.parent,n,t);return r?(t=r,o().ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){a.call(n,"onsave",n.parent,n,t)}}),!0):!1!==r&&void 0},a=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this,o=null,a=r.parent?r.parent:r;if(!a.ignoreEvents&&("function"==typeof a.config.onevent&&(o=a.config.onevent.apply(this,function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([e],t,!0))),"function"==typeof a.config[e]&&(o=a.config[e].apply(this,t)),"object"==typeof a.plugins))for(var l=Object.keys(a.plugins),c=0;c<l.length;c++){var u=l[c],d=a.plugins[u];"function"==typeof d.onevent&&(o=d.onevent.apply(this,arguments))}if("onafterchanges"==e){var p=arguments;if("object"==typeof a.plugins&&Object.entries(a.plugins).forEach(function(e){var t=e[1];"function"==typeof t.persistence&&t.persistence(r,"setValue",{data:p[2]})}),r.options.persistence){var f=1==r.options.persistence?r.options.url:r.options.persistence,h=i.call(r,arguments[2]);s.call(r,f,h)}}return o};t.A=a}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};!function(){"use strict";__webpack_require__.d(__webpack_exports__,{default:function(){return Ie}});var e=__webpack_require__(587),t=__webpack_require__.n(e),n={jspreadsheet:{}},r=__webpack_require__(988),o=__webpack_require__(655),i=__webpack_require__(32),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},a=function(e,n,i){var a=this,c=e.getAttribute("data-y"),u=e.getAttribute("data-x"),d=u?parseInt(u):0,p=c?parseInt(c):0;r.A.call(a,"oneditionstart",a,e,d,p),d>0&&p>=0&&(a.records[p][d-1].element.style.overflow="hidden");var f=function(t){var n=e.getBoundingClientRect(),r=document.createElement(t);return r.style.width=n.width+"px",r.style.height=n.height-2+"px",r.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(r),r};if(1==e.classList.contains("readonly"));else if(a.edition=[a.records[p][d].element,a.records[p][d].element.innerHTML,u,c],a.options.columns&&a.options.columns[parseInt(u||"0")]&&"object"==typeof a.options.columns[d].type)a.options.columns[d].type.openEditor(e,a.options.data[p][d],d,p,a,a.options.columns[d],i),r.A.call(a,"oncreateeditor",a,e,d,p,null,a.options.columns[parseInt(u||"0")]);else if(a.options.columns&&a.options.columns[parseInt(u||"0")]&&"hidden"==a.options.columns[parseInt(u||"0")].type);else if(a.options.columns&&a.options.columns[parseInt(u||"0")]&&("checkbox"==a.options.columns[parseInt(u||"0")].type||"radio"==a.options.columns[parseInt(u||"0")].type)){var h=!e.children[0]||!e.children[0].checked;a.setValue(e,h),a.edition=null}else if(a.options.columns&&u&&a.options.columns[d]&&"dropdown"==a.options.columns[d].type&&c){h=a.options.data[p][d],a.options.columns[d].multiple&&!Array.isArray(h)&&(h=h.split(";"));var m,g=[];if(m="function"==typeof a.options.columns[d].filter?a.options.columns[d].filter(a.element,e,u,c,a.options.columns[d].source):a.options.columns[d].source)for(var v=0;v<m.length;v++)g.push(m[v]);var y=f("div");r.A.call(a,"oncreateeditor",a,e,parseInt(u||"0"),parseInt(c||"0"),null,u?a.options.columns[d]:null);var b={data:g,multiple:!(!u||!a.options.columns[d].multiple),autocomplete:!(!u||!a.options.columns[d].autocomplete),opened:!0,value:h,width:"100%",height:y.style.minHeight,position:1==a.options.tableOverflow||1==a.parent.config.fullscreen,onclose:function(){l.call(a,e,!0)}};a.options.columns[d].options&&a.options.columns[d].options.type&&(b.type=a.options.columns[d].options.type),t().dropdown(y,b)}else if(a.options.columns&&a.options.columns[d]&&("calendar"==a.options.columns[d].type||"color"==a.options.columns[d].type)){if(h=a.options.data[p][d],y=f("input"),r.A.call(a,"oncreateeditor",a,e,parseInt(u||"0"),parseInt(c||"0"),null,u?a.options.columns[d]:null),y.value=h,b=u&&a.options.columns[d].options?s({},a.options.columns[d].options):{},1!=a.options.tableOverflow&&1!=a.parent.config.fullscreen||(b.position=!0),b.value=a.options.data[p][d],b.opened=!0,b.onclose=function(t,n){l.call(a,e,!0)},"color"==a.options.columns[d].type){t().color(y,b);var w=e.getBoundingClientRect();if(b.position&&y.nextSibling&&"children"in y.nextSibling){var C=y.nextSibling;if(C.children&&C.children[1]){var x=C.children[1];x.style.top=w.top+w.height+"px",x.style.left=w.left+"px"}}}else b.format||(b.format="YYYY-MM-DD"),t().calendar(y,b);y.focus()}else if(a.options.columns&&a.options.columns[d]&&"html"==a.options.columns[d].type){h=u&&c?a.options.data[p][d]:"",y=f("div"),r.A.call(a,"oncreateeditor",a,e,parseInt(u||"0"),parseInt(c||"0"),null,u?a.options.columns[d]:null),y.style.position="relative",(j=document.createElement("div")).classList.add("jss_richtext"),y.appendChild(j),t().editor(j,{focus:!0,value:h}),w=e.getBoundingClientRect();var E=j.getBoundingClientRect();window.innerHeight<w.bottom+E.height?j.style.top=w.bottom-(E.height+2)+"px":j.style.top=w.top+"px",window.innerWidth<w.left+E.width?j.style.left=w.right-(E.width+2)+"px":j.style.left=w.left+"px"}else if(a.options.columns&&a.options.columns[d]&&"image"==a.options.columns[d].type){var j,L=e.children[0];y=f("div"),r.A.call(a,"oncreateeditor",a,e,parseInt(u||"0"),parseInt(c||"0"),null,u?a.options.columns[d]:null),y.style.position="relative",(j=document.createElement("div")).classList.add("jclose"),L&&L.src&&j.appendChild(L),y.appendChild(j),t().image(j,a.options.columns[d]),w=e.getBoundingClientRect(),E=j.getBoundingClientRect(),window.innerHeight<w.bottom+E.height?j.style.top=w.top-(E.height+2)+"px":j.style.top=w.top+"px",j.style.left=w.left+"px"}else{if(h=1==n?"":a.options.data[p][d],y=void 0,y=a.options.columns&&a.options.columns[d]&&0==a.options.columns[d].wordWrap||!(1==a.options.wordWrap||a.options.columns&&a.options.columns[d]&&1==a.options.columns[d].wordWrap)?f("input"):f("textarea"),r.A.call(a,"oncreateeditor",a,e,parseInt(u||"0"),parseInt(c||"0"),null,u?a.options.columns[d]:null),y.focus(),y.value=h,b=a.options.columns&&a.options.columns[d],!(0,o.dw)(h)&&b){var A=(0,o.rS)(b);if(A){if(!b.disabledMaskOnEdition)if(b.mask){var M=b.mask.split(";");y.setAttribute("data-mask",M[0])}else b.locale&&y.setAttribute("data-locale",b.locale);A.input=y,y.mask=A,t().mask.render(h,A,!1)}}y.onblur=function(){l.call(a,e,!0)},y.scrollLeft=y.scrollWidth}},l=function(e,n){var i,s,a,l,c,u,d,p,f=this,h=e.getAttribute("data-x"),m=e.getAttribute("data-y"),g=h?parseInt(h):0,v=m?parseInt(m):0;if(1==n){if(f.options.columns&&f.options.columns[g]&&"object"==typeof f.options.columns[g].type)p=f.options.columns[g].type.closeEditor(e,n,g,v,f,f.options.columns[g]);else if(f.options.columns&&f.options.columns[g]&&("checkbox"==f.options.columns[g].type||"radio"==f.options.columns[g].type||"hidden"==f.options.columns[g].type));else if(f.options.columns&&f.options.columns[g]&&"dropdown"==f.options.columns[g].type)p=null===(i=e.children[0].dropdown)||void 0===i?void 0:i.close(!0);else if(f.options.columns&&f.options.columns[g]&&"calendar"==f.options.columns[g].type)p=null===(s=e.children[0].calendar)||void 0===s?void 0:s.close(!0);else if(f.options.columns&&f.options.columns[g]&&"color"==f.options.columns[g].type)p=null===(a=e.children[0].color)||void 0===a?void 0:a.close(!0);else if(f.options.columns&&f.options.columns[g]&&"html"==f.options.columns[g].type)p=null===(l=e.children[0].children[0].editor)||void 0===l?void 0:l.getData();else if(f.options.columns&&f.options.columns[g]&&"image"==f.options.columns[g].type){var y=e.children[0].children[0].children[0];p=y&&"IMG"==y.tagName?y.src:""}else if(f.options.columns&&f.options.columns[g]&&"numeric"==f.options.columns[g].type)"="!=(""+(p=e.children[0].value)).substr(0,1)&&""==p&&(p=f.options.columns[g].allowEmpty?"":0),e.children[0].onblur=null;else{p=e.children[0].value,e.children[0].onblur=null;var b=f.options.columns&&f.options.columns[g];if(b){var w=(0,o.rS)(b);if(w&&""!==p&&!(0,o.dw)(p)&&"number"!=typeof p){var C=t().mask.extract(p,w,!0);C&&""!==C.value&&(p=C.value)}}}f.options.data[v][g]==p?e.innerHTML=f.edition[1]:f.setValue(e,p)}else f.options.columns&&f.options.columns[g]&&"object"==typeof f.options.columns[g].type?f.options.columns[g].type.closeEditor(e,n,g,v,f,f.options.columns[g]):f.options.columns&&f.options.columns[g]&&"dropdown"==f.options.columns[g].type?null===(c=e.children[0].dropdown)||void 0===c||c.close(!0):f.options.columns&&f.options.columns[g]&&"calendar"==f.options.columns[g].type?null===(u=e.children[0].calendar)||void 0===u||u.close(!0):f.options.columns&&f.options.columns[g]&&"color"==f.options.columns[g].type?null===(d=e.children[0].color)||void 0===d||d.close(!0):e.children[0].onblur=null,e.innerHTML=f.edition&&f.edition[1]?f.edition[1]:"";r.A.call(f,"oneditionend",f,e,g,v,p,n),e.classList.remove("editor"),f.edition=null},c=function(){for(var e=this,t=[],n=Object.keys(e.highlighted),s=0;s<n.length;s++){var a=e.highlighted[s].element.getAttribute("data-x"),l=e.highlighted[s].element.getAttribute("data-y");"checkbox"!=e.options.columns[parseInt(a||"0")].type&&"radio"!=e.options.columns[parseInt(a||"0")].type||t.push(o.k9.call(e,a,l,!e.options.data[l][a]))}if(t.length){i.Dh.call(e,{action:"setValue",records:t,selection:e.selectedCell});var c=t.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});r.A.call(e,"onafterchanges",e,c)}},u=__webpack_require__(894),d=function(e,t){var n=this;e=parseInt(e);for(var r=(t=parseInt(t))-1;r>=0;r--)if("none"!=n.records[r][e].element.style.display&&"none"!=n.rows[r].element.style.display){if(n.records[r][e].element.getAttribute("data-merged")&&n.records[r][e].element==n.records[t][e].element)continue;t=r;break}return t},p=function(e,t){var n,r,o=this;if(0==e?(n=parseInt(o.selectedCell[0]),r=parseInt(o.selectedCell[1])):(n=parseInt(o.selectedCell[2]),r=parseInt(o.selectedCell[3])),0==t){for(var i=0;i<r;i++)if("none"!=o.records[i][n].element.style.display&&"none"!=o.rows[i].element.style.display){r=i;break}}else r=d.call(o,n,r);0==e?(o.selectedCell[0]=n,o.selectedCell[1]=r):(o.selectedCell[2]=n,o.selectedCell[3]=r)},f=function(e,t){var n=this;if(e?n.selectedCell[3]>0&&p.call(n,1,t?0:1):(n.selectedCell[1]>0&&p.call(n,0,t?0:1),n.selectedCell[2]=n.selectedCell[0],n.selectedCell[3]=n.selectedCell[1]),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]),1==n.options.lazyLoading)if(0==n.selectedCell[1]||0==n.selectedCell[3])u.wu.call(n,0),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]);else if(u.AG.call(n))n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]);else{var r=parseInt(n.tbody.firstChild.getAttribute("data-y"));n.selectedCell[1]-r<30&&(u.G_.call(n),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]))}else if(n.options.pagination>0){var i=n.whichPage(n.selectedCell[3]);i!=n.pageNumber&&n.page(i)}o.Rs.call(n,1)},h=function(e,t){var n=this;e=parseInt(e),t=parseInt(t);for(var r=e+1;r<n.headers.length;r++)if("none"!=n.records[t][r].element.style.display){if(n.records[t][r].element.getAttribute("data-merged")&&n.records[t][r].element==n.records[t][e].element)continue;e=r;break}return e},m=function(e,t){var n,r,o=this;if(0==e?(n=parseInt(o.selectedCell[0]),r=parseInt(o.selectedCell[1])):(n=parseInt(o.selectedCell[2]),r=parseInt(o.selectedCell[3])),0==t){for(var i=o.headers.length-1;i>n;i--)if("none"!=o.records[r][i].element.style.display){n=i;break}}else n=h.call(o,n,r);0==e?(o.selectedCell[0]=n,o.selectedCell[1]=r):(o.selectedCell[2]=n,o.selectedCell[3]=r)},g=function(e,t){var n=this;e?n.selectedCell[2]<n.headers.length-1&&m.call(n,1,t?0:1):(n.selectedCell[0]<n.headers.length-1&&m.call(n,0,t?0:1),n.selectedCell[2]=n.selectedCell[0],n.selectedCell[3]=n.selectedCell[1]),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]),o.Rs.call(n,2)},v=function(e,t){var n=this;e=parseInt(e);for(var r=(t=parseInt(t))+1;r<n.rows.length;r++)if("none"!=n.records[r][e].element.style.display&&"none"!=n.rows[r].element.style.display){if(n.records[r][e].element.getAttribute("data-merged")&&n.records[r][e].element==n.records[t][e].element)continue;t=r;break}return t},y=function(e,t){var n,r,o=this;if(0==e?(n=parseInt(o.selectedCell[0]),r=parseInt(o.selectedCell[1])):(n=parseInt(o.selectedCell[2]),r=parseInt(o.selectedCell[3])),0==t){for(var i=o.rows.length-1;i>r;i--)if("none"!=o.records[i][n].element.style.display&&"none"!=o.rows[i].element.style.display){r=i;break}}else r=v.call(o,n,r);0==e?(o.selectedCell[0]=n,o.selectedCell[1]=r):(o.selectedCell[2]=n,o.selectedCell[3]=r)},b=function(e,t){var n=this;if(e?n.selectedCell[3]<n.records.length-1&&y.call(n,1,t?0:1):(n.selectedCell[1]<n.records.length-1&&y.call(n,0,t?0:1),n.selectedCell[2]=n.selectedCell[0],n.selectedCell[3]=n.selectedCell[1]),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]),1==n.options.lazyLoading)n.selectedCell[1]==n.records.length-1||n.selectedCell[3]==n.records.length-1?(u.wu.call(n,-1),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3])):u.AG.call(n)?n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]):parseInt(n.tbody.lastChild.getAttribute("data-y"))-n.selectedCell[3]<30&&(u.p6.call(n),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]));else if(n.options.pagination>0){var r=n.whichPage(n.selectedCell[3]);r!=n.pageNumber&&n.page(r)}o.Rs.call(n,3)},w=function(e,t){var n=this;e=parseInt(e),t=parseInt(t);for(var r=e-1;r>=0;r--)if("none"!=n.records[t][r].element.style.display){if(n.records[t][r].element.getAttribute("data-merged")&&n.records[t][r].element==n.records[t][e].element)continue;e=r;break}return e},C=function(e,t){var n,r,o=this;if(0==e?(n=parseInt(o.selectedCell[0]),r=parseInt(o.selectedCell[1])):(n=parseInt(o.selectedCell[2]),r=parseInt(o.selectedCell[3])),0==t){for(var i=0;i<n;i++)if("none"!=o.records[r][i].element.style.display){n=i;break}}else n=w.call(o,n,r);0==e?(o.selectedCell[0]=n,o.selectedCell[1]=r):(o.selectedCell[2]=n,o.selectedCell[3]=r)},x=function(e,t){var n=this;e?n.selectedCell[2]>0&&C.call(n,1,t?0:1):(n.selectedCell[0]>0&&C.call(n,0,t?0:1),n.selectedCell[2]=n.selectedCell[0],n.selectedCell[3]=n.selectedCell[1]),n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]),o.Rs.call(n,0)},E=function(e,t){var n=this;if(e?t?n.selectedCell[3]=0:C.call(n,1,0):(t?n.selectedCell[1]=0:C.call(n,0,0),n.selectedCell[2]=n.selectedCell[0],n.selectedCell[3]=n.selectedCell[1]),1!=n.options.lazyLoading||0!=n.selectedCell[1]&&0!=n.selectedCell[3]){if(n.options.pagination>0){var r=n.whichPage(n.selectedCell[3]);r!=n.pageNumber&&n.page(r)}}else u.wu.call(n,0);n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]),o.Rs.call(n,1)},j=function(e,t){var n=this;if(e?t?n.selectedCell[3]=n.records.length-1:m.call(n,1,0):(t?n.selectedCell[1]=n.records.length-1:m.call(n,0,0),n.selectedCell[2]=n.selectedCell[0],n.selectedCell[3]=n.selectedCell[1]),1!=n.options.lazyLoading||n.selectedCell[1]!=n.records.length-1&&n.selectedCell[3]!=n.records.length-1){if(n.options.pagination>0){var r=n.whichPage(n.selectedCell[3]);r!=n.pageNumber&&n.page(r)}}else u.wu.call(n,-1);n.updateSelectionFromCoords(n.selectedCell[0],n.selectedCell[1],n.selectedCell[2],n.selectedCell[3]),o.Rs.call(n,3)},L=__webpack_require__(195),A=__webpack_require__(106),M=__webpack_require__(9),I=__webpack_require__(898),T=function(e,t,n,o,i,s,a){var l=this;t||(t="\t");for(var c=new RegExp(t,"ig"),u=[],d=[],p=[],f=[],h=[],m=l.options.data[0].length,g=l.options.data.length,v="",y=!1,b="",w="",C=0,x=0,E=0,j=0,L=0;L<g;L++)for(var M=0;M<m;M++)e&&!l.records[L][M].element.classList.contains("highlight")||(E<=M&&(E=M),j<=L&&(j=L));if(i&&(1==l.parent.config.includeHeadersOnDownload||o)){if(l.options.nestedHeaders&&l.options.nestedHeaders.length>0)for(v=l.options.nestedHeaders,L=0;L<v.length;L++){var I=[];for(M=0;M<v[L].length;M++){var T=parseInt(v[L][M].colspan);I.push(v[L][M].title);for(var _=0;_<T-1;_++)I.push("")}w+=I.join(t)+"\r\n"}y=!0}for(l.style=[],L=0;L<g;L++){for(d=[],p=[],M=0;M<m;M++)if(!e||l.records[L][M].element.classList.contains("highlight")){1==y&&u.push(l.headers[M].textContent);var N=l.options.data[L][M];N.match&&(N.match(c)||N.match(/,/g)||N.match(/\n/)||N.match(/\"/))&&(N='"'+(N=N.replace(new RegExp('"',"g"),'""'))+'"'),d.push(N);var D=void 0;l.options.columns&&l.options.columns[M]&&("checkbox"==l.options.columns[M].type||"radio"==l.options.columns[M].type)?D=N:(D=l.records[L][M].element.innerHTML).match&&(D.match(c)||D.match(/,/g)||D.match(/\n/)||D.match(/\"/))&&(D='"'+(D=D.replace(new RegExp('"',"g"),'""'))+'"'),p.push(D),v=(v=l.records[L][M].element.getAttribute("style")).replace("display: none;",""),l.style.push(v||"")}d.length&&(y&&(C=d.length,f.push(u.join(t))),f.push(d.join(t))),p.length&&(x++,y&&(h.push(u.join(t)),y=!1),h.push(p.join(t)))}m==C&&g==x&&(b=w);var O=b+f.join("\r\n"),S=b+h.join("\r\n");if(!n){var k=[Math.min(l.selectedCell[0],l.selectedCell[2]),Math.min(l.selectedCell[1],l.selectedCell[3]),Math.max(l.selectedCell[0],l.selectedCell[2]),Math.max(l.selectedCell[1],l.selectedCell[3])],R=r.A.call(l,"oncopy",l,k,S,s);if(R)S=R;else if(!1===R)return!1;l.textarea.value=S,l.textarea.select(),document.execCommand("copy")}if(l.data=1==a?S:O,l.hashString=A.tW.call(l,l.data),!n&&(A.kA.call(l),l.highlighted))for(M=0;M<l.highlighted.length;M++)l.highlighted[M].element.classList.add("copying"),l.highlighted[M].element.classList.contains("highlight-left")&&l.highlighted[M].element.classList.add("copying-left"),l.highlighted[M].element.classList.contains("highlight-right")&&l.highlighted[M].element.classList.add("copying-right"),l.highlighted[M].element.classList.contains("highlight-top")&&l.highlighted[M].element.classList.add("copying-top"),l.highlighted[M].element.classList.contains("highlight-bottom")&&l.highlighted[M].element.classList.add("copying-bottom");return l.data},_=function(e,n,s){var a=this,l=(0,A.tW)(s),c=l==a.hashString?a.style:null;l==a.hashString&&(s=a.data),s=(0,M.parseCSV)(s,"\t");var u=a.selectedCell[2]-e+1,d=a.selectedCell[3]-n+1,p=s[0].length;if(u>1&&Number.isInteger(u/p)){var f=u/p;if(c){for(var m=[],g=0;g<c.length;g+=p)for(var y=c.slice(g,g+p),b=0;b<f;b++)m.push.apply(m,y);c=m}var w=s.map(function(e,t){var n=Array.from({length:f*e.length},function(t,n){return e[n%e.length]});return n});s=w}var C=s.length;if(d>1&&Number.isInteger(d/C)){var x=d/C;if(c){for(m=[],b=0;b<x;b++)m.push.apply(m,c);c=m}w=Array.from({length:x*C},function(e,t){return s[t%C]}),s=w}var E=r.A.call(a,"onbeforepaste",a,s.map(function(e){return e.map(function(e){return{value:e}})}),e,n);if(!1===E)return!1;if(E&&(s=E),null!=e&&null!=n&&s){g=0,b=0;var j=[],L=(m={},{}),T=0,_=e,N=n,D=null,O=a.headers.slice(_).filter(function(e){return"none"===e.style.display}).length,S=_+O+s[0].length,k=a.headers.length;S>k&&(a.skipUpdateTableReferences=!0,a.insertColumn(S-k));var R=a.rows.slice(N).filter(function(e){return"none"===e.element.style.display}).length,H=N+R+s.length,P=a.rows.length;for(H>P&&(a.skipUpdateTableReferences=!0,a.insertRow(H-P)),a.skipUpdateTableReferences&&(a.skipUpdateTableReferences=!1,o.o8.call(a));D=s[b];){for(g=0,_=e;null!=D[g];){var F=D[g];a.options.columns&&a.options.columns[g]&&"calendar"==a.options.columns[g].type&&(F=t().calendar.extractDateFromString(F,a.options.columns[g].options&&a.options.columns[g].options.format||"YYYY-MM-DD"));var V=o.k9.call(a,_,N,F);if(j.push(V),o.xF.call(a,_,N,j),c&&c[T]){var q=(0,I.t3)([_,N]);m[q]=c[T],L[q]=a.getStyle(q),a.records[N][_].element.setAttribute("style",c[T]),T++}if(null!=D[++g]){if(_>=a.headers.length-1){if(0==a.options.allowInsertColumn)break;a.insertColumn()}_=h.call(a,_,N)}}if(b++,s[b]){if(N>=a.rows.length-1){if(0==a.options.allowInsertRow)break;a.insertRow()}N=v.call(a,e,N)}}A.AH.call(a,e,n,_,N),i.Dh.call(a,{action:"setValue",records:j,selection:a.selectedCell,newStyle:m,oldStyle:L}),o.am.call(a);for(var B=[],U=0;U<s.length;U++)for(var Y=0;Y<s[U].length;Y++)B.push({x:Y+e,y:U+n,value:s[U][Y]});r.A.call(a,"onpaste",a,B);var W=j.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});r.A.call(a,"onafterchanges",a,W)}return(0,A.kA)(),!0},N=__webpack_require__(752),D=__webpack_require__(685),O=function(){var e=this,t=e.options.columns&&e.options.columns.length||0;if(e.options.data&&void 0!==e.options.data[0]){var n=Object.keys(e.options.data[0]);n.length>t&&(t=n.length)}return e.options.minDimensions&&e.options.minDimensions[0]>t&&(t=e.options.minDimensions[0]),t},S=function(e){var t=this,n=t.options.columns&&t.options.columns[e]&&t.options.columns[e].width||t.options.defaultColWidth||100,r=t.options.columns&&t.options.columns[e]&&t.options.columns[e].align||t.options.defaultColAlign||"center";t.headers[e]=document.createElement("td"),t.headers[e].textContent=t.options.columns&&t.options.columns[e]&&t.options.columns[e].title||(0,M.getColumnName)(e),t.headers[e].setAttribute("data-x",e),t.headers[e].style.textAlign=r,t.options.columns&&t.options.columns[e]&&t.options.columns[e].title&&t.headers[e].setAttribute("title",t.headers[e].innerText),t.options.columns&&t.options.columns[e]&&t.options.columns[e].id&&t.headers[e].setAttribute("id",t.options.columns[e].id);var o=document.createElement("col");o.setAttribute("width",n),t.cols[e]={colElement:o,x:e},t.options.columns&&t.options.columns[e]&&"hidden"==t.options.columns[e].type&&(t.headers[e].style.display="none",o.style.display="none")},k=function(e,t,n){var o=this;if(t){if(Array.isArray(e)){n||(n=[]);for(var s=0;s<e.length;s++){n[s]||(n[s]=parseInt(o.cols[e[s]].colElement.getAttribute("width")));var a=Array.isArray(t)&&t[s]?t[s]:t;o.cols[e[s]].colElement.setAttribute("width",a),o.options.columns||(o.options.columns=[]),o.options.columns[e[s]]||(o.options.columns[e[s]]={}),o.options.columns[e[s]].width=a}}else n||(n=parseInt(o.cols[e].colElement.getAttribute("width"))),o.cols[e].colElement.setAttribute("width",t),o.options.columns||(o.options.columns=[]),o.options.columns[e]||(o.options.columns[e]={}),o.options.columns[e].width=t;i.Dh.call(o,{action:"setWidth",column:e,oldValue:n,newValue:t}),r.A.call(o,"onresizecolumn",o,e,t,n),A.Aq.call(o)}},R=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},H=function(e,t){var n=this;n.records[e]||(n.records[e]=[]),t||(t=n.options.data[e]);var r={element:document.createElement("tr"),y:e};n.rows[e]=r,r.element.setAttribute("data-y",e.toString());var i=null;n.options.defaultRowHeight&&(r.element.style.height=n.options.defaultRowHeight+"px"),n.options.rows&&n.options.rows[e]&&(n.options.rows[e].height&&(r.element.style.height=n.options.rows[e].height),n.options.rows[e].title&&(i=n.options.rows[e].title)),i||(i=e+1);var s=document.createElement("td");s.innerHTML=i.toString(),s.setAttribute("data-y",e.toString()),s.className="jss_row",r.element.appendChild(s);for(var a=O.call(n),l=0;l<a;l++)n.records[e][l]={element:o.P9.call(this,l,e,t?t[l]:void 0),x:l,y:e},r.element.appendChild(n.records[e][l].element),n.options.columns&&n.options.columns[l]&&"function"==typeof n.options.columns[l].render&&n.options.columns[l].render(n.records[e][l].element,t?t[l]:void 0,""+l,""+e,n,n.options.columns[l]);return r},P=function(e,n,s){var a=this;if(a.options.mergeCells&&Object.keys(a.options.mergeCells).length>0){var l;if(l=e>n?1:0,L.D0.call(a,e,void 0).length||L.D0.call(a,n,l).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;a.destroyMerge()}}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(t().translate("This action will clear your search results. Are you sure?")))return!1;a.resetSearch()}a.results=null}s||(Array.prototype.indexOf.call(a.tbody.children,a.rows[n].element)>=0?e>n?a.tbody.insertBefore(a.rows[e].element,a.rows[n].element):a.tbody.insertBefore(a.rows[e].element,a.rows[n].element.nextSibling):a.tbody.removeChild(a.rows[e].element)),a.rows.splice(n,0,a.rows.splice(e,1)[0]),a.records.splice(n,0,a.records.splice(e,1)[0]),a.options.data.splice(n,0,a.options.data.splice(e,1)[0]);for(var c=Math.min(e,n),u=Math.max(e,n),d=c;d<=u;d++)a.rows[d].y=d;for(d=c;d<=u;d++)for(var p=0;p<a.records[d].length;p++)a.records[d][p].y=d;a.options.pagination>0&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber),i.Dh.call(a,{action:"moveRow",oldValue:e,newValue:n}),o.o8.call(a),r.A.call(a,"onmoverow",a,parseInt(e),parseInt(n),1)},F=function(e,t,n){var o=this;t>0&&(n||(n=o.rows[e].element.getAttribute("height"))||(n=o.rows[e].element.getBoundingClientRect().height),t=parseInt(t),o.rows[e].element.style.height=t+"px",o.options.rows||(o.options.rows=[]),o.options.rows[e]||(o.options.rows[e]={}),o.options.rows[e].height=t,i.Dh.call(o,{action:"setHeight",row:e,oldValue:n,newValue:t}),r.A.call(o,"onresizerow",o,e,t,n),A.Aq.call(o))},V={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license]]}},q=function(e){var t=0,n=null;return function e(r){r.className&&(r.classList.contains("jss_container")&&(n=r),r.classList.contains("jss_spreadsheet")&&(n=r.querySelector(":scope > .jtabs-content > .jtabs-selected"))),"THEAD"==r.tagName?t=1:"TBODY"==r.tagName&&(t=2),r.parentNode&&(n||e(r.parentNode))}(e),[n,t]},B=function(e){if(n.jspreadsheet.current)if(n.jspreadsheet.current.resizing){if(n.jspreadsheet.current.resizing.column){var t=parseInt(n.jspreadsheet.current.cols[n.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),r=n.jspreadsheet.current.getSelectedColumns();if(r.length>1){for(var o=[],i=0;i<r.length;i++)o.push(parseInt(n.jspreadsheet.current.cols[r[i]].colElement.getAttribute("width")));o[r.indexOf(parseInt(n.jspreadsheet.current.resizing.column))]=n.jspreadsheet.current.resizing.width,k.call(n.jspreadsheet.current,r,t,o)}else k.call(n.jspreadsheet.current,parseInt(n.jspreadsheet.current.resizing.column),t,n.jspreadsheet.current.resizing.width);n.jspreadsheet.current.headers[n.jspreadsheet.current.resizing.column].classList.remove("resizing");for(var s=0;s<n.jspreadsheet.current.records.length;s++)n.jspreadsheet.current.records[s][n.jspreadsheet.current.resizing.column]&&n.jspreadsheet.current.records[s][n.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{n.jspreadsheet.current.rows[n.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");var a=n.jspreadsheet.current.rows[n.jspreadsheet.current.resizing.row].element.getAttribute("height");F.call(n.jspreadsheet.current,n.jspreadsheet.current.resizing.row,a,n.jspreadsheet.current.resizing.height),n.jspreadsheet.current.resizing.element.classList.remove("resizing")}n.jspreadsheet.current.resizing=null}else if(n.jspreadsheet.current.dragging){if(n.jspreadsheet.current.dragging){if(n.jspreadsheet.current.dragging.column){var l=e.target.getAttribute("data-x");for(n.jspreadsheet.current.headers[n.jspreadsheet.current.dragging.column].classList.remove("dragging"),s=0;s<n.jspreadsheet.current.rows.length;s++)n.jspreadsheet.current.records[s][n.jspreadsheet.current.dragging.column]&&n.jspreadsheet.current.records[s][n.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(i=0;i<n.jspreadsheet.current.headers.length;i++)n.jspreadsheet.current.headers[i].classList.remove("dragging-left"),n.jspreadsheet.current.headers[i].classList.remove("dragging-right");l&&n.jspreadsheet.current.dragging.column!=n.jspreadsheet.current.dragging.destination&&n.jspreadsheet.current.moveColumn(n.jspreadsheet.current.dragging.column,n.jspreadsheet.current.dragging.destination)}else{var c=void 0;n.jspreadsheet.current.dragging.element.nextSibling?(c=parseInt(n.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),n.jspreadsheet.current.dragging.row<c&&(c-=1)):c=parseInt(n.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),n.jspreadsheet.current.dragging.row!=n.jspreadsheet.current.dragging.destination&&P.call(n.jspreadsheet.current,n.jspreadsheet.current.dragging.row,c,!0),n.jspreadsheet.current.dragging.element.classList.remove("dragging")}n.jspreadsheet.current.dragging=null}}else n.jspreadsheet.current.selectedCorner&&(n.jspreadsheet.current.selectedCorner=!1,n.jspreadsheet.current.selection.length>0&&(A.kF.call(n.jspreadsheet.current,n.jspreadsheet.current.selection[0],n.jspreadsheet.current.selection[n.jspreadsheet.current.selection.length-1]),A.gG.call(n.jspreadsheet.current)));n.jspreadsheet.timeControl&&(clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=null),n.jspreadsheet.isMouseAction=!1},U=function(e){var t;t=(e=e||window.event).buttons?e.buttons:e.button?e.button:e.which;var r=q(e.target);if(r[0]?n.jspreadsheet.current!=r[0].jssWorksheet&&(n.jspreadsheet.current&&(n.jspreadsheet.current.edition&&l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!0),n.jspreadsheet.current.resetSelection()),n.jspreadsheet.current=r[0].jssWorksheet):n.jspreadsheet.current&&(n.jspreadsheet.current.edition&&l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!0),e.target.classList.contains("jss_object")||(A.gE.call(n.jspreadsheet.current,!0),n.jspreadsheet.current=null)),n.jspreadsheet.current&&1==t){if(e.target.classList.contains("jss_selectall"))n.jspreadsheet.current&&A.Ub.call(n.jspreadsheet.current);else if(e.target.classList.contains("jss_corner"))0!=n.jspreadsheet.current.options.editable&&(n.jspreadsheet.current.selectedCorner=!0);else{if(1==r[1]){var o=e.target.getAttribute("data-x");if(o){var i=e.target.getBoundingClientRect();if(0!=n.jspreadsheet.current.options.columnResize&&i.width-e.offsetX<6){n.jspreadsheet.current.resizing={mousePosition:e.pageX,column:o,width:i.width},n.jspreadsheet.current.headers[o].classList.add("resizing");for(var s=0;s<n.jspreadsheet.current.records.length;s++)n.jspreadsheet.current.records[s][o]&&n.jspreadsheet.current.records[s][o].element.classList.add("resizing")}else if(0!=n.jspreadsheet.current.options.columnDrag&&i.height-e.offsetY<6)if(L.Lt.call(n.jspreadsheet.current,o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(n.jspreadsheet.current.resetSelection(),n.jspreadsheet.current.dragging={element:e.target,column:o,destination:o},n.jspreadsheet.current.headers[o].classList.add("dragging"),s=0;s<n.jspreadsheet.current.records.length;s++)n.jspreadsheet.current.records[s][o]&&n.jspreadsheet.current.records[s][o].element.classList.add("dragging");else{var a=void 0,c=void 0;n.jspreadsheet.current.selectedHeader&&(e.shiftKey||e.ctrlKey)?(a=n.jspreadsheet.current.selectedHeader,c=o):(n.jspreadsheet.current.selectedHeader==o&&0!=n.jspreadsheet.current.options.allowRenameColumn&&(n.jspreadsheet.timeControl=setTimeout(function(){n.jspreadsheet.current.setHeader(o)},800)),n.jspreadsheet.current.selectedHeader=o,a=o,c=o),A.AH.call(n.jspreadsheet.current,a,0,c,n.jspreadsheet.current.options.data.length-1,e)}}else if(e.target.parentNode.classList.contains("jss_nested")){var u=void 0,d=void 0;if(e.target.getAttribute("data-column")){var p=e.target.getAttribute("data-column").split(",");u=parseInt(p[0]),d=parseInt(p[p.length-1])}else u=0,d=n.jspreadsheet.current.options.columns.length-1;A.AH.call(n.jspreadsheet.current,u,0,d,n.jspreadsheet.current.options.data.length-1,e)}}else n.jspreadsheet.current.selectedHeader=!1;if(2==r[1]){var f=parseInt(e.target.getAttribute("data-y"));if(e.target.classList.contains("jss_row"))i=e.target.getBoundingClientRect(),0!=n.jspreadsheet.current.options.rowResize&&i.height-e.offsetY<6?(n.jspreadsheet.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:f,height:i.height},e.target.parentNode.classList.add("resizing")):0!=n.jspreadsheet.current.options.rowDrag&&i.width-e.offsetX<6?L.D0.call(n.jspreadsheet.current,f,!1).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==n.jspreadsheet.current.options.search&&n.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(n.jspreadsheet.current.resetSelection(),n.jspreadsheet.current.dragging={element:e.target.parentNode,row:f,destination:f},e.target.parentNode.classList.add("dragging")):(a=void 0,c=void 0,null!=n.jspreadsheet.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(a=n.jspreadsheet.current.selectedRow,c=f):(n.jspreadsheet.current.selectedRow=f,a=f,c=f),A.AH.call(n.jspreadsheet.current,0,a,n.jspreadsheet.current.options.data[0].length-1,c,e));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!0);else{var h=function(e){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?[t,n]:e.parentNode?h(e.parentNode):void 0},m=h(e.target);if(m){var g=parseInt(m[0]),v=parseInt(m[1]);n.jspreadsheet.current.edition&&(n.jspreadsheet.current.edition[2]==g&&n.jspreadsheet.current.edition[3]==v||l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!0)),n.jspreadsheet.current.edition||(e.shiftKey&&n.jspreadsheet.current.selectedCell?A.AH.call(n.jspreadsheet.current,n.jspreadsheet.current.selectedCell[0],n.jspreadsheet.current.selectedCell[1],g,v,e):A.AH.call(n.jspreadsheet.current,g,v,g,v,e)),n.jspreadsheet.current.selectedHeader=null,n.jspreadsheet.current.selectedRow=null}}}else n.jspreadsheet.current.selectedRow=!1;e.target.classList.contains("jss_page")&&("<"==e.target.textContent?n.jspreadsheet.current.page(0):">"==e.target.textContent?n.jspreadsheet.current.page(e.target.getAttribute("title")-1):n.jspreadsheet.current.page(e.target.textContent-1))}n.jspreadsheet.current.edition?n.jspreadsheet.isMouseAction=!1:n.jspreadsheet.isMouseAction=!0}else n.jspreadsheet.isMouseAction=!1},Y=function(e){if(((e=e||window.event).buttons?e.buttons:e.button?e.button:e.which)||(n.jspreadsheet.isMouseAction=!1),n.jspreadsheet.current)if(1==n.jspreadsheet.isMouseAction){if(n.jspreadsheet.current.resizing)if(n.jspreadsheet.current.resizing.column){var t=e.pageX-n.jspreadsheet.current.resizing.mousePosition;if(n.jspreadsheet.current.resizing.width+t>0){var r=n.jspreadsheet.current.resizing.width+t;n.jspreadsheet.current.cols[n.jspreadsheet.current.resizing.column].colElement.setAttribute("width",r),A.Aq.call(n.jspreadsheet.current)}}else{var o=e.pageY-n.jspreadsheet.current.resizing.mousePosition;if(n.jspreadsheet.current.resizing.height+o>0){var i=n.jspreadsheet.current.resizing.height+o;n.jspreadsheet.current.rows[n.jspreadsheet.current.resizing.row].element.setAttribute("height",i),A.Aq.call(n.jspreadsheet.current)}}else if(n.jspreadsheet.current.dragging)if(n.jspreadsheet.current.dragging.column){var s=e.target.getAttribute("data-x");if(s)if(L.Lt.call(n.jspreadsheet.current,s).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var a=0;a<n.jspreadsheet.current.headers.length;a++)n.jspreadsheet.current.headers[a].classList.remove("dragging-left"),n.jspreadsheet.current.headers[a].classList.remove("dragging-right");n.jspreadsheet.current.dragging.column==s?n.jspreadsheet.current.dragging.destination=parseInt(s):e.target.clientWidth/2>e.offsetX?(n.jspreadsheet.current.dragging.column<s?n.jspreadsheet.current.dragging.destination=parseInt(s)-1:n.jspreadsheet.current.dragging.destination=parseInt(s),n.jspreadsheet.current.headers[s].classList.add("dragging-left")):(n.jspreadsheet.current.dragging.column<s?n.jspreadsheet.current.dragging.destination=parseInt(s):n.jspreadsheet.current.dragging.destination=parseInt(s)+1,n.jspreadsheet.current.headers[s].classList.add("dragging-right"))}}else{var l=e.target.getAttribute("data-y");if(l)if(L.D0.call(n.jspreadsheet.current,l,!1).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var c=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;n.jspreadsheet.current.dragging.element!=c&&(e.target.parentNode.parentNode.insertBefore(n.jspreadsheet.current.dragging.element,c),n.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(n.jspreadsheet.current.dragging.element.parentNode.children,n.jspreadsheet.current.dragging.element))}}}else{var u=e.target.getAttribute("data-x"),d=e.target.getAttribute("data-y"),p=e.target.getBoundingClientRect();n.jspreadsheet.current.cursor&&(n.jspreadsheet.current.cursor.style.cursor="",n.jspreadsheet.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&u&&!d&&p.width-(e.clientX-p.left)<6?(n.jspreadsheet.current.cursor=e.target,n.jspreadsheet.current.cursor.style.cursor="col-resize"):e.target&&!u&&d&&p.height-(e.clientY-p.top)<6&&(n.jspreadsheet.current.cursor=e.target,n.jspreadsheet.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!u&&d&&p.width-(e.clientX-p.left)<6||e.target&&u&&!d&&p.height-(e.clientY-p.top)<6)&&(n.jspreadsheet.current.cursor=e.target,n.jspreadsheet.current.cursor.style.cursor="move"))}},W=function(e,t){var n=this;A.gG.call(n);var r=n.selectedContainer[0],o=n.selectedContainer[1],i=n.selectedContainer[2],s=n.selectedContainer[3];if(null!=e&&null!=t){var a=void 0,l=void 0;e-i>0?(a=i+1,l=e):(a=e,l=r-1);var c=void 0,u=void 0;t-s>0?(c=s+1,u=t):(c=t,u=o-1),l-a<=u-c?(a=parseInt(r),l=parseInt(i)):(c=parseInt(o),u=parseInt(s));for(var d=c;d<=u;d++)for(var p=a;p<=l;p++)n.records[d][p]&&"none"!=n.rows[d].element.style.display&&"none"!=n.records[d][p].element.style.display&&(n.records[d][p].element.classList.add("selection"),n.records[c][p].element.classList.add("selection-top"),n.records[u][p].element.classList.add("selection-bottom"),n.records[d][a].element.classList.add("selection-left"),n.records[d][l].element.classList.add("selection-right"),n.selection.push(n.records[d][p].element))}},z=function(e){if(((e=e||window.event).buttons?e.buttons:e.button?e.button:e.which)||(n.jspreadsheet.isMouseAction=!1),n.jspreadsheet.current&&1==n.jspreadsheet.isMouseAction){var t=q(e.target);if(t[0]){if(n.jspreadsheet.current!=t[0].jssWorksheet&&n.jspreadsheet.current)return!1;var r=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");if(n.jspreadsheet.current.resizing||n.jspreadsheet.current.dragging);else{if(1==t[1]&&n.jspreadsheet.current.selectedHeader){r=e.target.getAttribute("data-x");var i=n.jspreadsheet.current.selectedHeader,s=r;A.AH.call(n.jspreadsheet.current,i,0,s,n.jspreadsheet.current.options.data.length-1,e)}2==t[1]&&(e.target.classList.contains("jss_row")?null!=n.jspreadsheet.current.selectedRow&&(i=n.jspreadsheet.current.selectedRow,s=o,A.AH.call(n.jspreadsheet.current,0,i,n.jspreadsheet.current.options.data[0].length-1,s,e)):n.jspreadsheet.current.edition||r&&o&&(n.jspreadsheet.current.selectedCorner?W.call(n.jspreadsheet.current,r,o):n.jspreadsheet.current.selectedCell&&A.AH.call(n.jspreadsheet.current,n.jspreadsheet.current.selectedCell[0],n.jspreadsheet.current.selectedCell[1],r,o,e)))}}}n.jspreadsheet.timeControl&&(clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=null)},X=function(e){if(n.jspreadsheet.current)if(e.target.classList.contains("jss_corner")){if(n.jspreadsheet.current.highlighted.length>0){var t=n.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),r=parseInt(n.jspreadsheet.current.highlighted[n.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,o=n.jspreadsheet.current.highlighted[n.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),i=n.jspreadsheet.current.records.length-1;A.kF.call(n.jspreadsheet.current,n.jspreadsheet.current.records[r][t].element,n.jspreadsheet.current.records[i][o].element)}}else if(e.target.classList.contains("jss_column_filter")){var s=e.target.getAttribute("data-x");N.N$.call(n.jspreadsheet.current,s)}else{var l=q(e.target);if(1==l[1]&&0!=n.jspreadsheet.current.options.columnSorting&&(s=e.target.getAttribute("data-x"))&&n.jspreadsheet.current.orderBy(parseInt(s)),2==l[1]&&0!=n.jspreadsheet.current.options.editable&&!n.jspreadsheet.current.edition){var c=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?e:c(e.parentNode)}},u=c(e.target);u&&u.classList.contains("highlight")&&a.call(n.jspreadsheet.current,u,!1,e)}}},G=function(e){n.jspreadsheet.current&&n.jspreadsheet.current.selectedCell&&(n.jspreadsheet.current.edition||0!=n.jspreadsheet.current.options.editable&&(e&&e.clipboardData?(_.call(n.jspreadsheet.current,n.jspreadsheet.current.selectedCell[0],n.jspreadsheet.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&_.call(n.jspreadsheet.current,n.jspreadsheet.current.selectedCell[0],n.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},K=function(e){var t,n=null===(t=e.parentElement)||void 0===t?void 0:t.children;if(!n)return-1;for(var r=0;r<n.length;r++)if(e===n[r])return r;return-1},$=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,n.jspreadsheet.current){var r=n.jspreadsheet.current.parent;if(n.jspreadsheet.current.edition)e.preventDefault();else if(r.contextMenu.contextmenu.close(),n.jspreadsheet.current){var o=function(e){if(e.classList.contains("jss_selectall"))return"select-all";if(e.classList.contains("jss_corner"))return"fill-handle";for(var t=e;t&&!t.classList.contains("jss_spreadsheet");){if(t.classList.contains("jss_row"))return"row";if(t.classList.contains("jss_nested"))return"nested";if(t.classList.contains("jtabs-headers"))return"tabs";if(t.classList.contains("jtoolbar"))return"toolbar";if(t.classList.contains("jss_pagination"))return"pagination";if("TBODY"===t.tagName)return"cell";if("TFOOT"===t.tagName)return 0===K(e)?"grid":"footer";if("THEAD"===t.tagName)return"header";t=t.parentElement}return"applications"}(e.target),i=null,s=null;if("cell"===o){for(var a=e.target;"TD"!==a.tagName;)a=a.parentNode;s=a.getAttribute("data-y"),i=a.getAttribute("data-x"),(!n.jspreadsheet.current.selectedCell||i<parseInt(n.jspreadsheet.current.selectedCell[0])||i>parseInt(n.jspreadsheet.current.selectedCell[2])||s<parseInt(n.jspreadsheet.current.selectedCell[1])||s>parseInt(n.jspreadsheet.current.selectedCell[3]))&&A.AH.call(n.jspreadsheet.current,i,s,i,s,e)}else if("row"===o||"header"===o)"row"===o?s=e.target.getAttribute("data-y"):i=e.target.getAttribute("data-x"),(!n.jspreadsheet.current.selectedCell||i<parseInt(n.jspreadsheet.current.selectedCell[0])||i>parseInt(n.jspreadsheet.current.selectedCell[2])||s<parseInt(n.jspreadsheet.current.selectedCell[1])||s>parseInt(n.jspreadsheet.current.selectedCell[3]))&&A.AH.call(n.jspreadsheet.current,i,s,i,s,e);else if("nested"===o){var l=e.target.getAttribute("data-column").split(",");i=K(e.target)-1,s=K(e.target.parentElement),n.jspreadsheet.current.selectedCell&&l[0]==parseInt(n.jspreadsheet.current.selectedCell[0])&&l[l.length-1]==parseInt(n.jspreadsheet.current.selectedCell[2])&&null==n.jspreadsheet.current.selectedCell[1]&&null==n.jspreadsheet.current.selectedCell[3]||A.AH.call(n.jspreadsheet.current,l[0],0,l[l.length-1],n.jspreadsheet.current.options.data.length-1,e)}else"select-all"===o?A.Ub.call(n.jspreadsheet.current):"tabs"===o?i=K(e.target):"footer"===o&&(i=K(e.target)-1,s=K(e.target.parentElement));var c=function(e,n,r,o){var i=[];if("header"===o&&(0!=e.options.allowInsertColumn&&i.push({title:t().translate("Insert a new column before"),onclick:function(){e.insertColumn(1,n,1)}}),0!=e.options.allowInsertColumn&&i.push({title:t().translate("Insert a new column after"),onclick:function(){e.insertColumn(1,n,0)}}),0!=e.options.allowDeleteColumn&&i.push({title:t().translate("Delete selected columns"),onclick:function(){e.deleteColumn(e.getSelectedColumns().length?void 0:n)}}),0!=e.options.allowRenameColumn&&i.push({title:t().translate("Rename this column"),onclick:function(){var r=e.getHeader(n),o=prompt(t().translate("Column name"),r);e.setHeader(n,o)}}),0!=e.options.columnSorting&&(i.push({type:"line"}),i.push({title:t().translate("Order ascending"),onclick:function(){e.orderBy(n,0)}}),i.push({title:t().translate("Order descending"),onclick:function(){e.orderBy(n,1)}}))),"row"!==o&&"cell"!==o||(0!=e.options.allowInsertRow&&(i.push({title:t().translate("Insert a new row before"),onclick:function(){e.insertRow(1,r,1)}}),i.push({title:t().translate("Insert a new row after"),onclick:function(){e.insertRow(1,r)}})),0!=e.options.allowDeleteRow&&i.push({title:t().translate("Delete selected rows"),onclick:function(){e.deleteRow(e.getSelectedRows().length?void 0:r)}})),"cell"===o&&0!=e.options.allowComments){i.push({type:"line"});var s=e.records[r][n].element.getAttribute("title")||"";i.push({title:t().translate(s?"Edit comments":"Add comments"),onclick:function(){var o=prompt(t().translate("Comments"),s);o&&e.setComments((0,M.getCellNameFromCoords)(n,r),o)}}),s&&i.push({title:t().translate("Clear comments"),onclick:function(){e.setComments((0,M.getCellNameFromCoords)(n,r),"")}})}return 0!==i.length&&i.push({type:"line"}),"header"!==o&&"row"!==o&&"cell"!==o||(i.push({title:t().translate("Copy")+"...",shortcut:"Ctrl + C",onclick:function(){T.call(e,!0)}}),navigator&&navigator.clipboard&&i.push({title:t().translate("Paste")+"...",shortcut:"Ctrl + V",onclick:function(){e.selectedCell&&navigator.clipboard.readText().then(function(t){t&&_.call(e,e.selectedCell[0],e.selectedCell[1],t)})}})),0!=e.parent.config.allowExport&&i.push({title:t().translate("Save as")+"...",shortcut:"Ctrl + S",onclick:function(){e.download()}}),0!=e.parent.config.about&&i.push({title:t().translate("About"),onclick:function(){void 0===e.parent.config.about||!0===e.parent.config.about?alert(V.print()):alert(e.parent.config.about)}}),i}(n.jspreadsheet.current,parseInt(i),parseInt(s),o);if("function"==typeof r.config.contextMenu){var u=r.config.contextMenu(n.jspreadsheet.current,i,s,e,c,o,i,s);if(u)c=u;else if(!1===u)return}"object"==typeof r.plugins&&Object.entries(r.plugins).forEach(function(t){var r=t[1];if("function"==typeof r.contextMenu){var a=r.contextMenu(n.jspreadsheet.current,null!==i?parseInt(i):null,null!==s?parseInt(s):null,e,c,o,null!==i?parseInt(i):null,null!==s?parseInt(s):null);a&&(c=a)}}),r.contextMenu.contextmenu.open(e,c),e.preventDefault()}}},Z=function(e){var t=q(e.target);if(t[0]?n.jspreadsheet.current!=t[0].jssWorksheet&&(n.jspreadsheet.current&&n.jspreadsheet.current.resetSelection(),n.jspreadsheet.current=t[0].jssWorksheet):n.jspreadsheet.current&&(n.jspreadsheet.current.resetSelection(),n.jspreadsheet.current=null),n.jspreadsheet.current&&!n.jspreadsheet.current.edition){var r=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");r&&o&&(A.AH.call(n.jspreadsheet.current,r,o,r,o,e),n.jspreadsheet.timeControl=setTimeout(function(){"color"==n.jspreadsheet.current.options.columns[r].type?n.jspreadsheet.tmpElement=null:n.jspreadsheet.tmpElement=e.target,a.call(n.jspreadsheet.current,e.target,!1,e)},500))}},J=function(e){n.jspreadsheet.timeControl&&(clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=null,n.jspreadsheet.tmpElement&&"INPUT"==n.jspreadsheet.tmpElement.children[0].tagName&&n.jspreadsheet.tmpElement.children[0].focus(),n.jspreadsheet.tmpElement=null)},Q=function(e){n.jspreadsheet.current&&(n.jspreadsheet.current.edition||(T.call(n.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),0!=n.jspreadsheet.current.options.editable&&n.jspreadsheet.current.setValue(n.jspreadsheet.current.highlighted.map(function(e){return e.element}),"")))},ee=function(e){n.jspreadsheet.current&&(n.jspreadsheet.current.edition||T.call(n.jspreadsheet.current,!0))},te=function(e){if(n.jspreadsheet.current){if(n.jspreadsheet.current.edition)if(27==e.which)n.jspreadsheet.current.edition&&l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!1),e.preventDefault();else if(13==e.which)if(n.jspreadsheet.current.options.columns&&n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]]&&"calendar"==n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]].type)l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!0);else if(n.jspreadsheet.current.options.columns&&n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]]&&"dropdown"==n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]].type);else if((1==n.jspreadsheet.current.options.wordWrap||n.jspreadsheet.current.options.columns&&n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]]&&1==n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]].wordWrap||n.jspreadsheet.current.options.data[n.jspreadsheet.current.edition[3]][n.jspreadsheet.current.edition[2]]&&n.jspreadsheet.current.options.data[n.jspreadsheet.current.edition[3]][n.jspreadsheet.current.edition[2]].length>200)&&e.altKey){var r=n.jspreadsheet.current.edition[0].children[0],o=n.jspreadsheet.current.edition[0].children[0].value,i=r.selectionStart;o=o.slice(0,i)+"\n"+o.slice(i),r.value=o,r.focus(),r.selectionStart=i+1,r.selectionEnd=i+1}else n.jspreadsheet.current.edition[0].children[0].blur();else 9==e.which&&(n.jspreadsheet.current.options.columns&&n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(n.jspreadsheet.current.options.columns[n.jspreadsheet.current.edition[2]].type)?l.call(n.jspreadsheet.current,n.jspreadsheet.current.edition[0],!0):n.jspreadsheet.current.edition[0].children[0].blur());if(!n.jspreadsheet.current.edition&&n.jspreadsheet.current.selectedCell)if(37==e.which)x.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)g.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)f.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)b.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)E.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)j.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(46==e.which||8==e.which)0!=n.jspreadsheet.current.options.editable&&(null!=n.jspreadsheet.current.selectedRow?0!=n.jspreadsheet.current.options.allowDeleteRow&&confirm(t().translate("Are you sure to delete the selected rows?"))&&n.jspreadsheet.current.deleteRow():n.jspreadsheet.current.selectedHeader?0!=n.jspreadsheet.current.options.allowDeleteColumn&&confirm(t().translate("Are you sure to delete the selected columns?"))&&n.jspreadsheet.current.deleteColumn():n.jspreadsheet.current.setValue(n.jspreadsheet.current.highlighted.map(function(e){return e.element}),""));else if(13==e.which)e.shiftKey?f.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey):(0!=n.jspreadsheet.current.options.allowInsertRow&&0!=n.jspreadsheet.current.options.allowManualInsertRow&&n.jspreadsheet.current.selectedCell[1]==n.jspreadsheet.current.options.data.length-1&&n.jspreadsheet.current.insertRow(),b.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey)),e.preventDefault();else if(9==e.which)e.shiftKey?x.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey):(0!=n.jspreadsheet.current.options.allowInsertColumn&&0!=n.jspreadsheet.current.options.allowManualInsertColumn&&n.jspreadsheet.current.selectedCell[0]==n.jspreadsheet.current.options.data[0].length-1&&n.jspreadsheet.current.insertColumn(),g.call(n.jspreadsheet.current,e.shiftKey,e.ctrlKey)),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(n.jspreadsheet.current.selectedCell&&0!=n.jspreadsheet.current.options.editable){var s=n.jspreadsheet.current.selectedCell[1],u=n.jspreadsheet.current.selectedCell[0];32==e.keyCode?(e.preventDefault(),"checkbox"==n.jspreadsheet.current.options.columns[u].type||"radio"==n.jspreadsheet.current.options.columns[u].type?c.call(n.jspreadsheet.current):a.call(n.jspreadsheet.current,n.jspreadsheet.current.records[s][u].element,!0,e)):113==e.keyCode?a.call(n.jspreadsheet.current,n.jspreadsheet.current.records[s][u].element,!1,e):1!==e.key.length&&"Process"!==e.key||e.altKey||function(e){return navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey:e.ctrlKey}(e)||(a.call(n.jspreadsheet.current,n.jspreadsheet.current.records[s][u].element,!0,e),n.jspreadsheet.current.options.columns&&n.jspreadsheet.current.options.columns[u]&&"calendar"==n.jspreadsheet.current.options.columns[u].type&&e.preventDefault())}}else 65==e.which?(A.Ub.call(n.jspreadsheet.current),e.preventDefault()):83==e.which?(n.jspreadsheet.current.download(),e.preventDefault()):89==e.which?(n.jspreadsheet.current.redo(),e.preventDefault()):90==e.which?(n.jspreadsheet.current.undo(),e.preventDefault()):67==e.which?(T.call(n.jspreadsheet.current,!0),e.preventDefault()):88==e.which?(0!=n.jspreadsheet.current.options.editable?Q.call(n.jspreadsheet.current,e):ee.call(n.jspreadsheet.current,e),e.preventDefault()):86==e.which&&G.call(n.jspreadsheet.current,e);else e.target.classList.contains("jss_search")&&(n.jspreadsheet.timeControl&&clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=setTimeout(function(){n.jspreadsheet.current.search(e.target.value)},200))}},ne=function(e){var t=this;1==t.options.lazyLoading&&null==n.jspreadsheet.timeControlLoading&&(n.jspreadsheet.timeControlLoading=setTimeout(function(){t.content.scrollTop+t.content.clientHeight>=t.content.scrollHeight-10?u.p6.call(t)&&(t.content.scrollTop+t.content.clientHeight>t.content.scrollHeight-10&&(t.content.scrollTop=t.content.scrollTop-t.content.clientHeight),A.Aq.call(t)):t.content.scrollTop<=t.content.clientHeight&&u.G_.call(t)&&(t.content.scrollTop<10&&(t.content.scrollTop=t.content.scrollTop+t.content.clientHeight),A.Aq.call(t)),n.jspreadsheet.timeControlLoading=null},100))},re=0,oe=function(){var e=this,t=0;if((re=e.content.scrollLeft)>50)for(var n=0;n<e.options.freezeColumns;n++){!(n>0)||e.options.columns&&e.options.columns[n-1]&&"hidden"===e.options.columns[n-1].type||(t+=e.options.columns&&e.options.columns[n-1]&&void 0!==e.options.columns[n-1].width?parseInt(e.options.columns[n-1].width):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth):100),e.headers[n].classList.add("jss_freezed"),e.headers[n].style.left=t+"px";for(var r=0;r<e.rows.length;r++)if(e.rows[r]&&e.records[r][n]){var o=re+(n>0?e.records[r][n-1].element.style.width:0)-51+"px";e.records[r][n].element.classList.add("jss_freezed"),e.records[r][n].element.style.left=o}}else for(n=0;n<e.options.freezeColumns;n++)for(e.headers[n].classList.remove("jss_freezed"),e.headers[n].style.left="",r=0;r<e.rows.length;r++)e.records[r][n]&&(e.records[r][n].element.classList.remove("jss_freezed"),e.records[r][n].element.style.left="");A.Aq.call(e)},ie=function(e){var t=this;ne.call(t,e),t.options.freezeColumns>0&&t.content.scrollLeft!=re&&oe.call(t),1!=t.options.lazyLoading&&1!=t.options.tableOverflow||t.edition&&"jdropdown"!=e.target.className.substr(0,9)&&l.call(t,t.edition[0],!0)},se=function(e){ae(e),e.addEventListener("mouseup",B),e.addEventListener("mousedown",U),e.addEventListener("mousemove",Y),e.addEventListener("mouseover",z),e.addEventListener("dblclick",X),e.addEventListener("paste",G),e.addEventListener("contextmenu",$),e.addEventListener("touchstart",Z),e.addEventListener("touchend",J),e.addEventListener("touchcancel",J),e.addEventListener("touchmove",J),document.addEventListener("keydown",te)},ae=function(e){e.removeEventListener("mouseup",B),e.removeEventListener("mousedown",U),e.removeEventListener("mousemove",Y),e.removeEventListener("mouseover",z),e.removeEventListener("dblclick",X),e.removeEventListener("paste",G),e.removeEventListener("contextmenu",$),e.removeEventListener("touchstart",Z),e.removeEventListener("touchend",J),e.removeEventListener("touchcancel",J),document.removeEventListener("keydown",te)},le=__webpack_require__(87),ce=__webpack_require__(986),ue=function(e,t,n,o,s){var a=this,l={},c={},u=function(e,t,n){var r=(0,I.vu)(e,!0);if(a.records[r[1]]&&a.records[r[1]][r[0]]&&(0==a.records[r[1]][r[0]].element.classList.contains("readonly")||o)){var i=a.records[r[1]][r[0]].element.style[t];i!=n||o?a.records[r[1]][r[0]].element.style[t]=n:(n="",a.records[r[1]][r[0]].element.style[t]=""),c[e]||(c[e]=[]),l[e]||(l[e]=[]),c[e].push([t+":"+i]),l[e].push([t+":"+n])}};if(t&&n)"string"==typeof e&&u(e,t,n);else for(var d=Object.keys(e),p=0;p<d.length;p++){var f=e[d[p]];"string"==typeof f&&(f=f.split(";"));for(var h=0;h<f.length;h++)"string"==typeof f[h]&&(f[h]=f[h].split(":")),f[h][0].trim()&&u(d[p],f[h][0].trim(),f[h][1])}var m=Object.keys(c);for(p=0;p<m.length;p++)c[m[p]]=c[m[p]].join(";");for(m=Object.keys(l),p=0;p<m.length;p++)l[m[p]]=l[m[p]].join(";");s||i.Dh.call(a,{action:"setStyle",oldValue:c,newValue:l}),r.A.call(a,"onchangestyle",a,l)},de=function(e){var t=this,n=e;if(n){if("string"!=typeof n)return de.call(t);var r=(0,I.vu)(n,!0);return r&&"string"!=typeof r&&t.records[r[1]][r[0]].element.getAttribute("title")||""}for(var o={},i=0;i<t.options.data.length;i++)for(var s=0;s<t.options.columns.length;s++){var a=t.records[i][s].element.getAttribute("title");a&&(o[(0,I.t3)([s,i])]=a)}return o},pe=__webpack_require__(745),fe=function(){return this.config},he=function(e,t){var n,r=this,o=Object.keys(e);r.parent?n=r.parent:(t=!0,n=r),o.forEach(function(o){t?(n.config[o]=e[o],"toolbar"===o&&(!0===e[o]?n.showToolbar():!1===e[o]&&n.hideToolbar())):r.options[o]=e[o]})},me=__webpack_require__(211),ge=function(){var e=this;!function(e){for(var t=0;t<xe;t++){var n=Ce[t],r=n[0],o=n[1];e[r]=o.bind(e)}}(e),e.table=document.createElement("table"),e.thead=document.createElement("thead"),e.tbody=document.createElement("tbody"),e.headers=[],e.cols=[],e.content=document.createElement("div"),e.content.classList.add("jss_content"),e.content.onscroll=function(t){ie.call(e,t)},e.content.onwheel=function(t){ne.call(e,t)};var n=document.createElement("div"),r=document.createElement("label");r.innerHTML=t().translate("Search")+": ",n.appendChild(r),e.searchInput=document.createElement("input"),e.searchInput.classList.add("jss_search"),r.appendChild(e.searchInput),e.searchInput.onfocus=function(){e.resetSelection()};var i=document.createElement("div");if(e.options.pagination>0&&e.options.paginationOptions&&e.options.paginationOptions.length>0){e.paginationDropdown=document.createElement("select"),e.paginationDropdown.classList.add("jss_pagination_dropdown"),e.paginationDropdown.onchange=function(){e.options.pagination=parseInt(this.value),e.page(0)};for(var s=0;s<e.options.paginationOptions.length;s++){var a=document.createElement("option");a.value=e.options.paginationOptions[s],a.innerHTML=e.options.paginationOptions[s],e.paginationDropdown.appendChild(a)}e.paginationDropdown.value=e.options.pagination,i.appendChild(document.createTextNode(t().translate("Show "))),i.appendChild(e.paginationDropdown),i.appendChild(document.createTextNode(t().translate("entries")))}var l=document.createElement("div");l.classList.add("jss_filter"),l.appendChild(i),l.appendChild(n),e.colgroupContainer=document.createElement("colgroup");var c=document.createElement("col");if(c.setAttribute("width","50"),e.colgroupContainer.appendChild(c),e.options.nestedHeaders&&e.options.nestedHeaders.length>0&&e.options.nestedHeaders[0]&&e.options.nestedHeaders[0][0])for(var u=0;u<e.options.nestedHeaders.length;u++)e.thead.appendChild(o.ju.call(e,e.options.nestedHeaders[u]));e.headerContainer=document.createElement("tr");var d=document.createElement("td");d.classList.add("jss_selectall"),e.headerContainer.appendChild(d);var p=O.call(e);for(s=0;s<p;s++)S.call(e,s),e.headerContainer.appendChild(e.headers[s]),e.colgroupContainer.appendChild(e.cols[s].colElement);if(e.thead.appendChild(e.headerContainer),1==e.options.filters){e.filter=document.createElement("tr");var f=document.createElement("td");for(e.filter.appendChild(f),s=0;s<e.options.columns.length;s++){var h=document.createElement("td");h.innerHTML="&nbsp;",h.setAttribute("data-x",s.toString()),h.className="jss_column_filter","hidden"==e.options.columns[s].type&&(h.style.display="none"),e.filter.appendChild(h)}e.thead.appendChild(e.filter)}e.table=document.createElement("table"),e.table.classList.add("jss_worksheet"),e.table.setAttribute("cellpadding","0"),e.table.setAttribute("cellspacing","0"),e.table.setAttribute("unselectable","yes"),e.table.appendChild(e.colgroupContainer),e.table.appendChild(e.thead),e.table.appendChild(e.tbody),e.options.textOverflow||e.table.classList.add("jss_overflow"),e.corner=document.createElement("div"),e.corner.className="jss_corner",e.corner.setAttribute("unselectable","on"),e.corner.setAttribute("onselectstart","return false"),0==e.options.selectionCopy&&(e.corner.style.display="none"),e.textarea=document.createElement("textarea"),e.textarea.className="jss_textarea",e.textarea.id="jss_textarea",e.textarea.tabIndex="-1",e.textarea.ariaHidden="true";var m=document.createElement("a");m.setAttribute("href","https://bossanova.uk/jspreadsheet/"),e.ads=document.createElement("div"),e.ads.className="jss_about";var g=document.createElement("span");g.innerHTML="Jspreadsheet CE",m.appendChild(g),e.ads.appendChild(m),document.createElement("div").classList.add("jss_table"),e.pagination=document.createElement("div"),e.pagination.classList.add("jss_pagination");var v=document.createElement("div"),y=document.createElement("div");if(e.pagination.appendChild(v),e.pagination.appendChild(y),e.options.pagination||(e.pagination.style.display="none"),1==e.options.search&&e.element.appendChild(l),e.content.appendChild(e.table),e.content.appendChild(e.corner),e.content.appendChild(e.textarea),e.element.appendChild(e.content),e.element.appendChild(e.pagination),e.element.appendChild(e.ads),e.element.classList.add("jss_container"),e.element.jssWorksheet=e,e.element.jspreadsheet=e,1==e.options.tableOverflow&&(e.options.tableHeight&&(e.content.style["overflow-y"]="auto",e.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",e.content.style.maxHeight="string"==typeof e.options.tableHeight?e.options.tableHeight:e.options.tableHeight+"px"),e.options.tableWidth&&(e.content.style["overflow-x"]="auto",e.content.style.width="string"==typeof e.options.tableWidth?e.options.tableWidth:e.options.tableWidth+"px")),1!=e.options.tableOverflow&&e.parent.config.toolbar&&e.element.classList.add("with-toolbar"),0!=e.options.columnDrag&&e.thead.classList.add("draggable"),0!=e.options.columnResize&&e.thead.classList.add("resizable"),0!=e.options.rowDrag&&e.tbody.classList.add("draggable"),0!=e.options.rowResize&&e.tbody.classList.add("resizable"),e.setData.call(e,void 0),e.options.style&&(e.setStyle(e.options.style,null,null,1,1),delete e.options.style),Object.defineProperty(e.options,"style",{enumerable:!0,configurable:!0,get:function(){return e.getStyle()}}),e.options.comments&&e.setComments(e.options.comments),e.options.classes){var b=Object.keys(e.options.classes);for(s=0;s<b.length;s++){var w=(0,I.vu)(b[s],!0);e.records[w[1]][w[0]].element.classList.add(e.options.classes[b[s]])}}},ve=function(){var e=this;1==e.options.lazyLoading&&1!=e.options.tableOverflow&&1!=e.parent.config.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),e.options.lazyLoading=!1),e.options.columns||(e.options.columns=[]);var n,r=e.options.columns.length;if(e.options.data&&void 0!==e.options.data[0])if(Array.isArray(e.options.data[0])){var o=e.options.data[0].length;o>r&&(r=o)}else(n=Object.keys(e.options.data[0])).length>r&&(r=n.length);e.options.minDimensions||(e.options.minDimensions=[0,0]),e.options.minDimensions[0]>r&&(r=e.options.minDimensions[0]);for(var i=[],s=0;s<r;s++)e.options.columns[s]||(e.options.columns[s]={}),!e.options.columns[s].name&&n&&n[s]&&(e.options.columns[s].name=n[s]),"dropdown"==e.options.columns[s].type&&e.options.columns[s].url&&i.push({url:e.options.columns[s].url,index:s,method:"GET",dataType:"json",success:function(t){e.options.columns[this.index].source||(e.options.columns[this.index].source=[]);for(var n=0;n<t.length;n++)e.options.columns[this.index].source.push(t[n])}});i.length?t().ajax({url:i,success:function(){ge.call(e)}}):ge.call(e)},ye=function(e){var t=/^Sheet(\d+)$/,n=0;return e.worksheets.forEach(function(e){var r=t.exec(e.options.worksheetName);r&&(n=Math.max(n,parseInt(r[1])))}),"Sheet"+(n+1)},be=function(){return e=this,r=void 0,i=function(){var e,r,o,i;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,function(s){switch(s.label){case 0:return(e=this).element,"object"==typeof(r=e.parent).plugins&&Object.entries(r.plugins).forEach(function(t){var n=t[1];"function"==typeof n.beforeinit&&n.beforeinit(e)}),n.jspreadsheet.current=e,o=[],e.options.csv?(i=new Promise(function(n){t().ajax({url:e.options.csv,method:"GET",dataType:"text",success:function(t){var r=(0,M.parseCSV)(t,e.options.csvDelimiter);if(1==e.options.csvHeaders&&r.length>0){var o=r.shift();if(o&&o.length>0){e.options.columns||(e.options.columns=[]);for(var i=0;i<o.length;i++)e.options.columns[i]||(e.options.columns[i]={}),void 0===e.options.columns[i].title&&(e.options.columns[i].title=o[i])}}e.options.data=r,ve.call(e),n()}})}),o.push(i)):e.options.url?(i=new Promise(function(n){t().ajax({url:e.options.url,method:"GET",dataType:"json",success:function(t){e.options.data=t.data?t.data:t,ve.call(e),n()}})}),o.push(i)):ve.call(e),[4,Promise.all(o)];case 1:return s.sent(),"object"==typeof r.plugins&&Object.entries(r.plugins).forEach(function(t){var n=t[1];"function"==typeof n.init&&n.init(e)}),[2]}})},new((o=void 0)||(o=Promise))(function(t,n){function s(e){try{l(i.next(e))}catch(e){n(e)}}function a(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o(function(e){e(n)})).then(s,a)}l((i=i.apply(e,r||[])).next())});var e,r,o,i},we=function(e){var t=this.parent;e.worksheetName||(e.worksheetName=ye(this.parent));var n={parent:t,options:e,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return t.config.worksheets.push(n.options),t.worksheets.push(n),n},Ce=[["selectAll",A.Ub],["updateSelectionFromCoords",function(e,t,n,r){return A.AH.call(this,e,t,n,r)}],["resetSelection",function(){return A.gE.call(this,!1)}],["getSelection",A.Lo],["getSelected",A.ef],["getSelectedColumns",A.Jg],["getSelectedRows",A.R5],["getData",function(e,t,n,r){for(var o=this,i=[],s=0,a=0,l=Math.max.apply(Math,o.options.data.map(function(e){return e.length})),c=o.options.data.length,u=0;u<c;u++){s=0;for(var d=0;d<l;d++)e&&!o.records[u][d].element.classList.contains("highlight")||(i[a]||(i[a]=[]),i[a][s]=t?o.records[u][d].element.innerHTML:o.options.data[u][d],s++);s>0&&a++}return n?i.map(function(e){return e.join(n)}).join("\r\n")+"\r\n":r?i.map(function(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}):i}],["setData",function(e){var t=this;if(e&&(t.options.data=e),t.options.data||(t.options.data=[]),t.options.data&&t.options.data[0]&&!Array.isArray(t.options.data[0])){e=[];for(var n=0;n<t.options.data.length;n++){for(var r=[],i=0;i<t.options.columns.length;i++)r[i]=t.options.data[n][t.options.columns[i].name];e.push(r)}t.options.data=e}var s,a,l=0,c=0,u=t.options.columns&&t.options.columns.length||0,d=t.options.data.length,p=t.options.minDimensions[0],f=t.options.minDimensions[1],h=p>u?p:u,m=f>d?f:d;for(l=0;l<m;l++)for(c=0;c<h;c++)null==t.options.data[l]&&(t.options.data[l]=[]),null==t.options.data[l][c]&&(t.options.data[l][c]="");for(t.rows=[],t.results=null,t.records=[],t.history=[],t.historyIndex=-1,t.tbody.innerHTML="",1==t.options.lazyLoading?(s=0,a=t.options.data.length<100?t.options.data.length:100,t.options.pagination&&(t.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):t.options.pagination?(t.pageNumber||(t.pageNumber=0),t.options.pagination,s=t.options.pagination*t.pageNumber,a=t.options.pagination*t.pageNumber+t.options.pagination,t.options.data.length<a&&(a=t.options.data.length)):(s=0,a=t.options.data.length),l=0;l<t.options.data.length;l++)r=H.call(t,l,t.options.data[l]),l>=s&&l<a&&t.tbody.appendChild(r.element);if(1==t.options.lazyLoading||t.options.pagination&&ce.IV.call(t),t.options.mergeCells)for(var g=Object.keys(t.options.mergeCells),v=0;v<g.length;v++){var y=t.options.mergeCells[g[v]];L.FU.call(t,g[v],y[0],y[1],1)}o.am.call(t)}],["getValue",function(e,t){var n,r,o=this;if("string"!=typeof e)return null;n=(e=(0,I.vu)(e,!0))[0],r=e[1];var i=null;return null!=n&&null!=r&&(o.records[r]&&o.records[r][n]&&t?i=o.records[r][n].element.innerHTML:o.options.data[r]&&"undefined"!=o.options.data[r][n]&&(i=o.options.data[r][n])),i}],["getValueFromCoords",function(e,t,n){var r=this,o=null;return null!=e&&null!=t&&(r.records[t]&&r.records[t][e]&&n?o=r.records[t][e].element.innerHTML:r.options.data[t]&&"undefined"!=r.options.data[t][e]&&(o=r.options.data[t][e])),o}],["setValue",function(e,t,n){var s=this,a=[];if("string"==typeof e){var l=(0,I.vu)(e,!0);if(Array.isArray(l)&&l.length>=2){var c=l[0],u=l[1];a.push(o.k9.call(s,c,u,t,n)),o.xF.call(s,c,u,a)}}else if(c=null,u=null,e&&e.getAttribute&&(c=parseInt(e.getAttribute("data-x")||"",10),u=parseInt(e.getAttribute("data-y")||"",10)),null===c||null===u||isNaN(c)||isNaN(u)||(a.push(o.k9.call(s,c,u,t,n)),o.xF.call(s,c,u,a)),null!=c&&null!=u)a.push(o.k9.call(s,c,u,t,n)),o.xF.call(s,c,u,a);else{var d=Object.keys(e);if(d.length>0)for(var p=0;p<d.length;p++){var f=void 0,h=void 0;"string"==typeof e[p]?(f=(l=(0,I.vu)(e[p],!0))[0],h=l[1]):null!=e[p].x&&null!=e[p].y?(f=e[p].x,h=e[p].y,null!=e[p].value&&(t=e[p].value)):(f=e[p].getAttribute("data-x"),h=e[p].getAttribute("data-y")),null!=f&&null!=h&&(a.push(o.k9.call(s,f,h,t,n)),o.xF.call(s,f,h,a))}}i.Dh.call(s,{action:"setValue",records:a,selection:s.selectedCell}),o.am.call(s);var m=a.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});r.A.call(s,"onafterchanges",s,m)}],["setValueFromCoords",function(e,t,n,s){var a=this,l=[];l.push(o.k9.call(a,e,t,n,s)),o.xF.call(a,e,t,l),i.Dh.call(a,{action:"setValue",records:l,selection:a.selectedCell}),o.am.call(a);var c=l.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});r.A.call(a,"onafterchanges",a,c)}],["getWidth",function(e){var t,n=this;if(void 0===e){t=[];for(var r=0;r<n.headers.length;r++)t.push(n.options.columns&&n.options.columns[r]&&n.options.columns[r].width||n.options.defaultColWidth||100)}else t=parseInt(n.cols[e].colElement.getAttribute("width"));return t}],["setWidth",function(e,t){return k.call(this,e,t,void 0)}],["insertRow",function(e,n,s){var a=this;if(0!=a.options.allowInsertRow){var l=[],c=void 0;Array.isArray(e)?(c=1,e&&(l=e)):c=void 0!==e?e:1,s=!!s;var u=a.options.data.length-1;(null==n||n>=u||n<0)&&(n=u);for(var d=[],p=0;p<c;p++){for(var f=[],h=0;h<a.options.columns.length;h++)f[h]=l[h]?l[h]:"";d.push({row:p+n+(s?0:1),data:f})}if(!1===r.A.call(a,"onbeforeinsertrow",a,d))return!1;if(a.options.mergeCells&&Object.keys(a.options.mergeCells).length>0&&L.D0.call(a,n,s).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;a.destroyMerge()}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length){if(!confirm(t().translate("This action will clear your search results. Are you sure?")))return!1;a.resetSearch()}a.results=null}var m=s?n:n+1,g=a.records.splice(m),v=a.options.data.splice(m),y=a.rows.splice(m),b=[],w=[],C=[];for(p=m;p<c+m;p++){for(a.options.data[p]=[],h=0;h<a.options.columns.length;h++)a.options.data[p][h]=l[h]?l[h]:"";f=H.call(a,p,a.options.data[p]),y[0]?Array.prototype.indexOf.call(a.tbody.children,y[0].element)>=0&&a.tbody.insertBefore(f.element,y[0].element):Array.prototype.indexOf.call(a.tbody.children,a.rows[n].element)>=0&&a.tbody.appendChild(f.element),b.push(R([],a.records[p],!0)),w.push(R([],a.options.data[p],!0)),C.push(f)}Array.prototype.push.apply(a.records,g),Array.prototype.push.apply(a.options.data,v),Array.prototype.push.apply(a.rows,y);for(var x=m;x<a.rows.length;x++)a.rows[x].y=x;for(x=m;x<a.records.length;x++)for(var E=0;E<a.records[x].length;E++)a.records[x][E].y=x;a.options.pagination>0&&a.page(a.pageNumber),i.Dh.call(a,{action:"insertRow",rowNumber:n,numOfRows:c,insertBefore:s,rowRecords:b,rowData:w,rowNode:C}),o.o8.call(a),r.A.call(a,"oninsertrow",a,d)}return!0}],["moveRow",function(e,t){return P.call(this,e,t,void 0)}],["deleteRow",function(e,n){var s=this;if(0!=s.options.allowDeleteRow)if(1==s.options.allowDeletingAllRows||s.options.data.length>1){if(null==e){var a=A.R5.call(s,!1);0===a.length?(e=s.options.data.length-1,n=1):(e=a[0],n=a.length)}var l=s.options.data.length-1;(null==e||e>l||e<0)&&(e=l),n||(n=1),e+n>=s.options.data.length&&(n=s.options.data.length-e);for(var c=[],u=0;u<n;u++)c.push(u+e);if(!1===r.A.call(s,"onbeforedeleterow",s,c))return!1;if(parseInt(e)>-1){var d=!1;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0)for(var p=e;p<e+n;p++)L.D0.call(s,p,!1).length&&(d=!0);if(d){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}if(1==s.options.search){if(s.results&&s.results.length!=s.rows.length){if(!confirm(t().translate("This action will clear your search results. Are you sure?")))return!1;s.resetSearch()}s.results=null}for(1!=s.options.allowDeletingAllRows&&l+1===n&&(n--,console.error("Jspreadsheet: It is not possible to delete the last row")),p=e;p<e+n;p++)Array.prototype.indexOf.call(s.tbody.children,s.rows[p].element)>=0&&(s.rows[p].element.className="",s.rows[p].element.parentNode.removeChild(s.rows[p].element));for(var f=s.records.splice(e,n),h=s.options.data.splice(e,n),m=s.rows.splice(e,n),g=e;g<s.rows.length;g++)s.rows[g].y=g;for(g=e;g<s.records.length;g++)for(u=0;u<s.records[g].length;u++)s.records[g][u].y=g;s.options.pagination>0&&s.tbody.children.length!=s.options.pagination&&s.page(s.pageNumber),A.at.call(s,1,e,e+n-1),i.Dh.call(s,{action:"deleteRow",rowNumber:e,numOfRows:n,insertBefore:1,rowRecords:f,rowData:h,rowNode:m}),o.o8.call(s),r.A.call(s,"ondeleterow",s,c)}}else console.error("Jspreadsheet: It is not possible to delete the last row")}],["hideRow",function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach(function(e){t.rows[e].element.style.display="none"})}],["showRow",function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach(function(e){t.rows[e].element.style.display=""})}],["getRowData",function(e,t){return t?this.records[e].map(function(e){return e.element.innerHTML}):this.options.data[e]}],["setRowData",function(e,t,n){for(var r=0;r<this.headers.length;r++){var o=(0,I.t3)([r,e]);null!=t[r]&&this.setValue(o,t[r],n)}}],["getHeight",function(e){var t,n=this;if(void 0===e){t=[];for(var r=0;r<n.rows.length;r++){var o=n.rows[r].element.style.height;o&&(t[r]=o)}}else"object"==typeof e&&(e=window.$(e).getAttribute("data-y")),t=n.rows[e].element.style.height;return t}],["setHeight",function(e,t){return F.call(this,e,t,void 0)}],["getMerge",L.fd],["setMerge",function(e,t,n){return L.FU.call(this,e,t,n,void 0)}],["destroyMerge",function(){return L.VP.call(this,void 0)}],["removeMerge",function(e,t){return L.Zp.call(this,e,t,void 0)}],["search",function(e){var t=this;if(t.options.filters&&N.dr.call(t),t.resetSelection(),t.pageNumber=0,t.results=[],e){t.searchInput.value!==e&&(t.searchInput.value=e);var n=function(e){-1==t.results.indexOf(e)&&t.results.push(e)},r=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i=new RegExp(r,"i");t.options.data.forEach(function(e,r){if(function(e,n,r){for(var o=0;o<e.length;o++)if((""+e[o]).toLowerCase().search(n)>=0||(""+t.records[r][o].element.innerHTML).toLowerCase().search(n)>=0)return!0;return!1}(e,i,r)){var o=L.D0.call(t,r,void 0);if(o.length)for(var s=0;s<o.length;s++)for(var a=(0,I.vu)(o[s],!0),l=0;l<t.options.mergeCells[o[s]][1];l++)n(Number(a[1])+l);else n(r)}})}else t.results=null;o.hG.call(t)}],["resetSearch",function(){var e=this;e.searchInput.value="",e.search(""),e.results=null}],["getHeader",function(e){return this.headers[e].textContent}],["getHeaders",function(e){for(var t=this,n=[],r=0;r<t.headers.length;r++)n.push(t.getHeader(r));return e?n:n.join(t.options.csvDelimiter)}],["setHeader",function(e,t){var n=this;if(n.headers[e]){var o=n.headers[e].textContent,s=n.options.columns&&n.options.columns[e]&&n.options.columns[e].title||"";t||(t=(0,M.getColumnName)(e)),n.headers[e].textContent=t,n.headers[e].setAttribute("title",t),n.options.columns||(n.options.columns=[]),n.options.columns[e]||(n.options.columns[e]={}),n.options.columns[e].title=t,i.Dh.call(n,{action:"setHeader",column:e,oldValue:o,newValue:t}),r.A.call(n,"onchangeheader",n,parseInt(e),t,s)}}],["getStyle",function(e,t){var n=this;if(e)return e=(0,I.vu)(e,!0),t?n.records[e[1]][e[0]].element.style[t]:n.records[e[1]][e[0]].element.getAttribute("style");for(var r={},o=n.options.data[0].length,i=n.options.data.length,s=0;s<i;s++)for(var a=0;a<o;a++){var l=t?n.records[s][a].element.style[t]:n.records[s][a].element.getAttribute("style");l&&(r[(0,I.t3)([a,s])]=l)}return r}],["setStyle",function(e,t,n,r){return ue.call(this,e,t,n,r)}],["resetStyle",function(e,t){for(var n=this,r=Object.keys(e),o=0;o<r.length;o++){var i=(0,I.vu)(r[o],!0);n.records[i[1]]&&n.records[i[1]][i[0]]&&n.records[i[1]][i[0]].element.setAttribute("style","")}n.setStyle(e,null,null,null,t)}],["insertColumn",function(e,n,s,a){var l=this;if(0!=l.options.allowInsertColumn){var c=[],u=void 0;Array.isArray(e)?(u=1,e&&(c=e)):u="number"==typeof e?e:1,s=!!s;var d=Math.max.apply(Math,function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([l.options.columns.length],l.options.data.map(function(e){return e.length}),!1)),p=d-1;(null==n||n>=p||n<0)&&(n=p),a||(a=[]);for(var f=0;f<u;f++)a[f]||(a[f]={});var h=[];if(Array.isArray(e)){var m=[];for(f=0;f<l.options.data.length;f++)m.push(f<e.length?e[f]:"");g={column:n+(s?0:1),options:Object.assign({},a[0]),data:m},h.push(g)}else for(f=0;f<e;f++){var g={column:n+f+(s?0:1),options:Object.assign({},a[f])};h.push(g)}if(!1===r.A.call(l,"onbeforeinsertcolumn",l,h))return!1;if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0&&L.Lt.call(l,n,s).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}var v=s?n:n+1;l.options.columns=(0,I.Hh)(l.options.columns,v,a);for(var y=l.headers.splice(v),b=l.cols.splice(v),w=[],C=[],x=[],E=[],j=[],A=v;A<u+v;A++)S.call(l,A),l.headerContainer.insertBefore(l.headers[A],l.headerContainer.children[A+1]),l.colgroupContainer.insertBefore(l.cols[A].colElement,l.colgroupContainer.children[A+1]),w.push(l.headers[A]),C.push(l.cols[A]);if(l.options.footers)for(var M=0;M<l.options.footers.length;M++){for(j[M]=[],f=0;f<u;f++)j[M].push("");l.options.footers[M].splice(v,0,j[M])}for(var T=0;T<l.options.data.length;T++){var _=l.options.data[T].splice(v),N=l.records[T].splice(v);for(E[T]=[],x[T]=[],A=v;A<u+v;A++){var D=c[T]?c[T]:"";l.options.data[T][A]=D;var O=o.P9.call(l,A,T,l.options.data[T][A]);l.records[T][A]={element:O,y:T},l.rows[T]&&l.rows[T].element.insertBefore(O,l.rows[T].element.children[A+1]),l.options.columns&&l.options.columns[A]&&"function"==typeof l.options.columns[A].render&&l.options.columns[A].render(O,D,A,T,l,l.options.columns[A]),E[T].push(D),x[T].push({element:O,x:A,y:T})}Array.prototype.push.apply(l.options.data[T],_),Array.prototype.push.apply(l.records[T],N)}for(Array.prototype.push.apply(l.headers,y),Array.prototype.push.apply(l.cols,b),f=v;f<l.cols.length;f++)l.cols[f].x=f;for(M=0;M<l.records.length;M++)for(f=0;f<l.records[M].length;f++)l.records[M][f].x=f;if(l.options.nestedHeaders&&l.options.nestedHeaders.length>0&&l.options.nestedHeaders[0]&&l.options.nestedHeaders[0][0])for(M=0;M<l.options.nestedHeaders.length;M++){var k=parseInt(l.options.nestedHeaders[M][l.options.nestedHeaders[M].length-1].colspan)+u;l.options.nestedHeaders[M][l.options.nestedHeaders[M].length-1].colspan=k,l.thead.children[M].children[l.thead.children[M].children.length-1].setAttribute("colspan",k);var R=l.thead.children[M].children[l.thead.children[M].children.length-1].getAttribute("data-column");for(R=R.split(","),A=v;A<u+v;A++)R.push(A);l.thead.children[M].children[l.thead.children[M].children.length-1].setAttribute("data-column",R)}i.Dh.call(l,{action:"insertColumn",columnNumber:n,numOfColumns:u,insertBefore:s,columns:a,headers:w,cols:C,records:x,footers:j,data:E}),o.o8.call(l),r.A.call(l,"oninsertcolumn",l,h)}}],["moveColumn",function(e,n){var s=this;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0){var a;if(a=e>n?1:0,L.Lt.call(s,e).length||L.Lt.call(s,n,!!a).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}}if(e>n){s.headerContainer.insertBefore(s.headers[e],s.headers[n]),s.colgroupContainer.insertBefore(s.cols[e].colElement,s.cols[n].colElement);for(var l=0;l<s.rows.length;l++)s.rows[l].element.insertBefore(s.records[l][e].element,s.records[l][n].element)}else for(s.headerContainer.insertBefore(s.headers[e],s.headers[n].nextSibling),s.colgroupContainer.insertBefore(s.cols[e].colElement,s.cols[n].colElement.nextSibling),l=0;l<s.rows.length;l++)s.rows[l].element.insertBefore(s.records[l][e].element,s.records[l][n].element.nextSibling);s.options.columns.splice(n,0,s.options.columns.splice(e,1)[0]),s.headers.splice(n,0,s.headers.splice(e,1)[0]),s.cols.splice(n,0,s.cols.splice(e,1)[0]);var c=Math.min(e,n),u=Math.max(e,n);for(l=0;l<s.rows.length;l++)s.options.data[l].splice(n,0,s.options.data[l].splice(e,1)[0]),s.records[l].splice(n,0,s.records[l].splice(e,1)[0]);for(var d=c;d<=u;d++)s.cols[d].x=d;for(l=0;l<s.records.length;l++)for(d=c;d<=u;d++)s.records[l][d].x=d;if(s.options.footers)for(l=0;l<s.options.footers.length;l++)s.options.footers[l].splice(n,0,s.options.footers[l].splice(e,1)[0]);i.Dh.call(s,{action:"moveColumn",oldValue:e,newValue:n}),o.o8.call(s),r.A.call(s,"onmovecolumn",s,e,n,1)}],["deleteColumn",function(e,n){var s=this;if(0!=s.options.allowDeleteColumn)if(s.headers.length>1){if(null==e){var a=s.getSelectedColumns(!0);a.length?(e=parseInt(a[0]),n=parseInt(a.length)):(e=s.headers.length-1,n=1)}var l=s.options.data[0].length-1;(null==e||e>l||e<0)&&(e=l),n||(n=1),n>s.options.data[0].length-e&&(n=s.options.data[0].length-e);for(var c=[],u=0;u<n;u++)c.push(u+e);if(!1===r.A.call(s,"onbeforedeletecolumn",s,c))return!1;if(parseInt(e)>-1){var d=!1;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0)for(var p=e;p<e+n;p++)L.Lt.call(s,p,void 0).length&&(d=!0);if(d){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}var f=s.options.columns?s.options.columns.splice(e,n):void 0;for(p=e;p<e+n;p++)s.cols[p].colElement.className="",s.headers[p].className="",s.cols[p].colElement.parentNode.removeChild(s.cols[p].colElement),s.headers[p].parentNode.removeChild(s.headers[p]);for(var h=s.headers.splice(e,n),m=s.cols.splice(e,n),g=[],v=[],y=[],b=0;b<s.options.data.length;b++)for(p=e;p<e+n;p++)s.records[b][p].element.className="",s.records[b][p].element.parentNode.removeChild(s.records[b][p].element);for(b=0;b<s.options.data.length;b++)v[b]=s.options.data[b].splice(e,n),g[b]=s.records[b].splice(e,n);for(u=e;u<s.cols.length;u++)s.cols[u].x=u;for(var w=0;w<s.records.length;w++)for(u=e;u<s.records[w].length;u++)s.records[w][u].x=u;if(s.options.footers)for(b=0;b<s.options.footers.length;b++)y[b]=s.options.footers[b].splice(e,n);if(A.at.call(s,0,e,e+n-1),s.options.nestedHeaders&&s.options.nestedHeaders.length>0&&s.options.nestedHeaders[0]&&s.options.nestedHeaders[0][0])for(w=0;w<s.options.nestedHeaders.length;w++){var C=parseInt(s.options.nestedHeaders[w][s.options.nestedHeaders[w].length-1].colspan)-n;s.options.nestedHeaders[w][s.options.nestedHeaders[w].length-1].colspan=C,s.thead.children[w].children[s.thead.children[w].children.length-1].setAttribute("colspan",C)}i.Dh.call(s,{action:"deleteColumn",columnNumber:e,numOfColumns:n,insertBefore:1,columns:f,headers:h,cols:m,records:g,footers:y,data:v}),o.o8.call(s),r.A.call(s,"ondeletecolumn",s,c)}}else console.error("Jspreadsheet: It is not possible to delete the last column")}],["getColumnData",function(e,t){for(var n=this,r=[],o=0;o<n.options.data.length;o++)t?r.push(n.records[o][e].element.innerHTML):r.push(n.options.data[o][e]);return r}],["setColumnData",function(e,t,n){for(var r=0;r<this.rows.length;r++){var o=(0,I.t3)([e,r]);null!=t[r]&&this.setValue(o,t[r],n)}}],["whichPage",ce.ho],["page",ce.MY],["download",function(e,t){var n=this;if(0==n.parent.config.allowExport)console.error("Export not allowed");else{var r="";r+=T.call(n,!1,n.options.csvDelimiter,!0,e,!0,void 0,t);var o=new Blob(["\ufeff"+r],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,(n.options.csvFileName||n.options.worksheetName)+".csv");else{var i=document.createElement("a");i.setAttribute("target","_top");var s=URL.createObjectURL(o);i.href=s,i.setAttribute("download",(n.options.csvFileName||n.options.worksheetName)+".csv"),document.body.appendChild(i),i.click(),i.parentNode&&i.parentNode.removeChild(i)}}}],["getComments",de],["setComments",function(e,t){var n,o,s=this;"string"==typeof e?((n={})[e]=t,o=n):o=e;var a={};Object.entries(o).forEach(function(e){var t=e[0],n=e[1],r=(0,M.getCoordsFromCellName)(t);r[0]&&r[1]&&(a[t]=s.records[r[1]][r[0]].element.getAttribute("title"),s.records[r[1]][r[0]].element.setAttribute("title",n||""),n?(s.records[r[1]][r[0]].element.classList.add("jss_comments"),s.options.comments||(s.options.comments={}),s.options.comments[t]=n):(s.records[r[1]][r[0]].element.classList.remove("jss_comments"),s.options.comments&&s.options.comments[t]&&delete s.options.comments[t]))}),i.Dh.call(s,{action:"setComments",newValue:o,oldValue:a}),r.A.call(s,"oncomments",s,o,a)}],["orderBy",pe.My],["undo",i.tN],["redo",i.ZS],["getCell",o.tT],["getCellFromCoords",o.Xr],["getLabel",o.p9],["getConfig",function(){return this.options}],["setConfig",he],["getMeta",function(e){return me.IQ.call(this,e,void 0)}],["setMeta",me.iZ],["showColumn",function(e){var t=this;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var r=e[n];t.headers[r].style.display="",t.cols[r].colElement.style.display="",t.filter&&t.filter.children.length>r+1&&(t.filter.children[r+1].style.display="");for(var o=0;o<t.options.data.length;o++)t.records[o][r].element.style.display=""}t.options.footers&&D.e.call(t),t.resetSelection()}],["hideColumn",function(e){var t=this;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var r=e[n];t.headers[r].style.display="none",t.cols[r].colElement.style.display="none",t.filter&&t.filter.children.length>r+1&&(t.filter.children[r+1].style.display="none");for(var o=0;o<t.options.data.length;o++)t.records[o][r].element.style.display="none"}t.options.footers&&D.e.call(t),t.resetSelection()}],["showIndex",o.C6],["hideIndex",o.TI],["getWorksheetActive",o.$O],["openEditor",a],["closeEditor",l],["createWorksheet",function(e){var t=this.parent;t.creationThroughJss=!0,we.call(this,e),t.element.tabs.create(e.worksheetName)}],["openWorksheet",function(e){this.parent.element.tabs.open(e)}],["deleteWorksheet",function(e){var t=this;t.parent.element.tabs.remove(e);var n=t.parent.worksheets.splice(e,1)[0];r.A.call(t.parent,"ondeleteworksheet",n,e)}],["copy",function(e){e?Q.call(this,void 0):T.call(this,!0)}],["paste",_],["executeFormula",o.Em],["getDataFromRange",function(e,t){for(var n=(0,M.getCoordsFromRange)(e),r=[],o=n[1];o<=n[3];o++){r.push([]);for(var i=n[0];i<=n[2];i++)t?r[r.length-1].push(this.records[o][i].element.innerHTML):r[r.length-1].push(this.options.data[o][i])}return r}],["quantiyOfPages",ce.$f],["getRange",A.eO],["isSelected",A.sp],["setReadOnly",function(e,t){var n,r=this;if("string"==typeof e){var o=(0,M.getCoordsFromCellName)(e);if(null===o[0]||null===o[1])return;n=r.records[o[1]][o[0]]}else{var i=e.getAttribute("data-x"),s=e.getAttribute("data-y");if(null===i||null===s)return;var a=parseInt(i),l=parseInt(s);if(!r.records[l]||!r.records[l][a])return;n=r.records[l][a]}t?n.element.classList.add("readonly"):n.element.classList.remove("readonly")}],["isReadOnly",function(e,t){var n,r=this;if("string"==typeof e&&void 0===t){var o=(0,M.getCoordsFromCellName)(e);if(null===o[0]||null===o[1])return!1;e=(n=o)[0],t=n[1]}return!(void 0===t||!r.records[t]||!r.records[t][e])&&r.records[t][e].element.classList.contains("readonly")}],["getHighlighted",A.kV],["dispatch",r.A],["down",b],["first",E],["last",j],["left",x],["right",g],["up",f],["openFilter",N.N$],["resetFilters",N.dr]],xe=Ce.length,Ee=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})},je=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},Le=function(){},Ae=function(e,n,o){return Ee(this,void 0,void 0,function(){var i,s,a,l,c,u,d;return je(this,function(p){switch(p.label){case 0:if(!(i=n.worksheets))return[3,5];for(s={animation:!0,onbeforecreate:function(t,n){return n||ye(e)},oncreate:function(t,o){if(e.creationThroughJss)e.creationThroughJss=!1;else{var i=t.tabs.headers.children[t.tabs.headers.children.length-2].innerHTML;we.call(e.worksheets[0],{minDimensions:[10,15],worksheetName:i})}var s=e.worksheets[e.worksheets.length-1];s.element=o,be.call(s).then(function(){(0,le.nK)(s),r.A.call(s,"oncreateworksheet",s,n,e.worksheets.length-1)})},onchange:function(t,n,r){0!=e.worksheets.length&&e.worksheets[r]&&(0,le.nK)(e.worksheets[r])}},1==n.tabs?s.allowCreate=!0:s.hideHeaders=!0,s.data=[],a=1,d=0;d<i.length;d++)i[d].worksheetName||(i[d].worksheetName="Sheet"+a++),s.data.push({title:i[d].worksheetName,content:""});o.classList.add("jss_spreadsheet"),o.tabIndex=0,l=t().tabs(o,s),c=n.style,delete n.style,u=function(t){return je(this,function(n){switch(n.label){case 0:return i[t].style&&Object.entries(i[t].style).forEach(function(e){var n=e[0],r=e[1];"number"==typeof r&&(i[t].style[n]=c[r])}),e.worksheets.push({parent:e,element:l.content.children[t],options:i[t],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),[4,be.call(e.worksheets[t])];case 1:return n.sent(),[2]}})},d=0,p.label=1;case 1:return d<i.length?[5,u(d)]:[3,4];case 2:p.sent(),p.label=3;case 3:return d++,[3,1];case 4:return[3,6];case 5:throw new Error("JSS: worksheets are not defined");case 6:return[2]}})})};Le.spreadsheet=function(e,r,i){return Ee(this,void 0,void 0,function(){var s,a,l;return je(this,function(c){switch(c.label){case 0:return"TABLE"==e.tagName&&(r||(r={}),r.worksheets||(r.worksheets=[]),s=(0,M.createFromTable)(e,r.worksheets[0]),r.worksheets[0]=s,a=document.createElement("div"),e.parentNode.insertBefore(a,e),e.remove(),e=a),(l={worksheets:i,config:r,element:e,el:e}).contextMenu=document.createElement("div"),l.contextMenu.className="jss_contextmenu",l.getWorksheetActive=o.$O.bind(l),l.fullscreen=o.Y5.bind(l),l.showToolbar=le.ll.bind(l),l.hideToolbar=le.Ar.bind(l),l.getConfig=fe.bind(l),l.setConfig=he.bind(l),l.setPlugins=function(e){l.plugins||(l.plugins={}),"object"==typeof e&&Object.entries(e).forEach(function(e){var t=e[0],r=e[1];l.plugins[t]=r.call(n.jspreadsheet,l,{},l.config)})},l.setPlugins(r.plugins),[4,Ae(l,r,e)];case 1:return c.sent(),l.element.appendChild(l.contextMenu),t().contextmenu(l.contextMenu,{onclick:function(){l.contextMenu.contextmenu.close(!1)}}),1==l.config.fullscreen&&l.element.classList.add("fullscreen"),le.ll.call(l),r.root?se(r.root):se(document.body),e.spreadsheet=l,[2,l]}})})},Le.worksheet=function(e,t,n){var r={parent:e,options:{}};return void 0===n?e.worksheets.push(r):e.worksheets.splice(n,0,r),Object.assign(r.options,t),r};var Me=Le;n.jspreadsheet=function(e,t){try{var o=[];return Me.spreadsheet(e,t,o).then(function(e){n.jspreadsheet.spreadsheet.push(e),r.A.call(e,"onload")}),o}catch(e){return console.error(e),[]}},n.jspreadsheet.getWorksheetInstanceByName=function(e,t){var r=n.jspreadsheet.spreadsheet.find(function(e){return e.config.namespace===t});if(r)return{};if(null==e){var o=r.worksheets.map(function(e){return[e.options.worksheetName,e]});return Object.fromEntries(o)}return r.worksheets.find(function(t){return t.options.worksheetName===e})},n.jspreadsheet.setDictionary=function(e){t().setDictionary(e)},n.jspreadsheet.destroy=function(e,t){if(e.spreadsheet){var r=n.jspreadsheet.spreadsheet.indexOf(e.spreadsheet);n.jspreadsheet.spreadsheet.splice(r,1);var o=e.spreadsheet.config.root||document;e.spreadsheet=null,e.innerHTML="",t&&ae(o)}},n.jspreadsheet.destroyAll=function(){for(var e=0;e<n.jspreadsheet.spreadsheet.length;e++){var t=n.jspreadsheet.spreadsheet[e];n.jspreadsheet.destroy(t.element)}},n.jspreadsheet.current=null,n.jspreadsheet.spreadsheet=[],n.jspreadsheet.helpers={},n.jspreadsheet.version=function(){return V.version},Object.entries(M).forEach(function(e){var t=e[0],r=e[1];n.jspreadsheet.helpers[t]=r});var Ie=n.jspreadsheet}(),jspreadsheet=__webpack_exports__.default})();

    return jspreadsheet;
})));
/**
 * Jspreadsheet v4.9.0
 *
 * Website: https://bossanova.uk/jspreadsheet/
 * Description: Create amazing web based spreadsheets.
 *
 * This software is distribute under MIT License
 */
(function(T){"object"===typeof exports&&"undefined"!==typeof module?module.exports=T():"function"===typeof define&&define.amd?define([],T):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).jspreadsheet=T()})(function(){return function(){function T(S,U,r){function w(d,n){if(!U[d]){if(!S[d]){var q="function"==typeof require&&require;if(!n&&q)return q(d,!0);if(k)return k(d,!0);q=Error("Cannot find module '"+d+"'");throw q.code="MODULE_NOT_FOUND",
q;}q=U[d]={exports:{}};S[d][0].call(q.exports,function(y){return w(S[d][1][y]||y)},q,q.exports,T,S,U,r)}return U[d].exports}for(var k="function"==typeof require&&require,v=0;v<r.length;v++)w(r[v]);return w}return T}()({1:[function(T,S,U){(function(r,w){"object"===typeof U&&"undefined"!==typeof S?S.exports=w():r.formula=w()})(this,function(){return function(){var r=function(){var t={};t.nil=Error("#NULL!");t.div0=Error("#DIV/0!");t.value=Error("#VALUE!");t.ref=Error("#REF!");t.name=Error("#NAME?");
t.num=Error("#NUM!");t.na=Error("#N/A");t.error=Error("#ERROR!");t.data=Error("#GETTING_DATA");return t}(),w=function(){var t={flattenShallow:function(f){return f&&f.reduce?f.reduce(function(b,c){var e=Array.isArray(b),g=Array.isArray(c);return e&&g?b.concat(c):e?(b.push(c),b):g?[b].concat(c):[b,c]}):f},isFlat:function(f){if(!f)return!1;for(var b=0;b<f.length;++b)if(Array.isArray(f[b]))return!1;return!0},flatten:function(){for(var f=t.argsToArray.apply(null,arguments);!t.isFlat(f);)f=t.flattenShallow(f);
return f},argsToArray:function(f){var b=[];t.arrayEach(f,function(c){b.push(c)});return b},numbers:function(){return this.flatten.apply(null,arguments).filter(function(f){return"number"===typeof f})},cleanFloat:function(f){return Math.round(1E14*f)/1E14},parseBool:function(f){if("boolean"===typeof f||f instanceof Error)return f;if("number"===typeof f)return 0!==f;if("string"===typeof f){var b=f.toUpperCase();if("TRUE"===b)return!0;if("FALSE"===b)return!1}return f instanceof Date&&!isNaN(f)?!0:r.value},
parseNumber:function(f){return void 0===f||""===f?r.value:isNaN(f)?r.value:parseFloat(f)},parseNumberArray:function(f){var b;if(!f||0===(b=f.length))return r.value;for(var c;b--;){c=t.parseNumber(f[b]);if(c===r.value)return c;f[b]=c}return f},parseMatrix:function(f){if(!f||0===f.length)return r.value;for(var b,c=0;c<f.length;c++)if(b=t.parseNumberArray(f[c]),f[c]=b,b instanceof Error)return b;return f}},h=new Date(Date.UTC(1900,0,1));t.parseDate=function(f){if(!isNaN(f)){if(f instanceof Date)return new Date(f);
f=parseInt(f,10);return 0>f?r.num:60>=f?new Date(h.getTime()+864E5*(f-1)):new Date(h.getTime()+864E5*(f-2))}return"string"!==typeof f||(f=new Date(f),isNaN(f))?r.value:f};t.parseDateArray=function(f){for(var b=f.length,c;b--;){c=this.parseDate(f[b]);if(c===r.value)return c;f[b]=c}return f};t.anyIsError=function(){for(var f=arguments.length;f--;)if(arguments[f]instanceof Error)return!0;return!1};t.arrayValuesToNumbers=function(f){for(var b=f.length,c;b--;)c=f[b],"number"!==typeof c&&(!0===c?f[b]=1:
!1===c?f[b]=0:"string"===typeof c&&(c=this.parseNumber(c),f[b]=c instanceof Error?0:c));return f};t.rest=function(f,b){return f&&"function"===typeof f.slice?f.slice(b||1):f};t.initial=function(f,b){return f&&"function"===typeof f.slice?f.slice(0,f.length-(b||1)):f};t.arrayEach=function(f,b){for(var c=-1,e=f.length;++c<e&&!1!==b(f[c],c,f););return f};t.transpose=function(f){return f?f[0].map(function(b,c){return f.map(function(e){return e[c]})}):r.value};return t}(),k={};k.datetime=function(){function t(c){return(c-
f)/864E5+(-22038912E5<c?2:1)}var h={},f=new Date(1900,0,1),b=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];h.DATE=function(c,e,g){c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);return w.anyIsError(c,e,g)?r.value:0>c||0>e||0>g?r.num:new Date(c,e-1,g)};h.DATEVALUE=function(c){if("string"!==typeof c)return r.value;c=Date.parse(c);return isNaN(c)?r.value:
-22038912E5>=c?(c-f)/864E5+1:(c-f)/864E5+2};h.DAY=function(c){c=w.parseDate(c);return c instanceof Error?c:c.getDate()};h.DAYS=function(c,e){c=w.parseDate(c);e=w.parseDate(e);return c instanceof Error?c:e instanceof Error?e:t(c)-t(e)};h.DAYS360=function(c,e,g){};h.EDATE=function(c,e){c=w.parseDate(c);if(c instanceof Error)return c;if(isNaN(e))return r.value;e=parseInt(e,10);c.setMonth(c.getMonth()+e);return t(c)};h.EOMONTH=function(c,e){c=w.parseDate(c);if(c instanceof Error)return c;if(isNaN(e))return r.value;
e=parseInt(e,10);return t(new Date(c.getFullYear(),c.getMonth()+e+1,0))};h.HOUR=function(c){c=w.parseDate(c);return c instanceof Error?c:c.getHours()};h.INTERVAL=function(c){if("number"!==typeof c&&"string"!==typeof c)return r.value;c=parseInt(c,10);var e=Math.floor(c/94608E4);c%=94608E4;var g=Math.floor(c/2592E3);c%=2592E3;var l=Math.floor(c/86400);c%=86400;var p=Math.floor(c/3600);c%=3600;var u=Math.floor(c/60);c%=60;return"P"+(0<e?e+"Y":"")+(0<g?g+"M":"")+(0<l?l+"D":"")+"T"+(0<p?p+"H":"")+(0<u?
u+"M":"")+(0<c?c+"S":"")};h.ISOWEEKNUM=function(c){c=w.parseDate(c);if(c instanceof Error)return c;c.setHours(0,0,0);c.setDate(c.getDate()+4-(c.getDay()||7));var e=new Date(c.getFullYear(),0,1);return Math.ceil(((c-e)/864E5+1)/7)};h.MINUTE=function(c){c=w.parseDate(c);return c instanceof Error?c:c.getMinutes()};h.MONTH=function(c){c=w.parseDate(c);return c instanceof Error?c:c.getMonth()+1};h.NETWORKDAYS=function(c,e,g){};h.NETWORKDAYS.INTL=function(c,e,g,l){};h.NOW=function(){return new Date};h.SECOND=
function(c){c=w.parseDate(c);return c instanceof Error?c:c.getSeconds()};h.TIME=function(c,e,g){c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);return w.anyIsError(c,e,g)?r.value:0>c||0>e||0>g?r.num:(3600*c+60*e+g)/86400};h.TIMEVALUE=function(c){c=w.parseDate(c);return c instanceof Error?c:(3600*c.getHours()+60*c.getMinutes()+c.getSeconds())/86400};h.TODAY=function(){return new Date};h.WEEKDAY=function(c,e){c=w.parseDate(c);if(c instanceof Error)return c;void 0===e&&(e=1);var g=c.getDay();
return b[e][g]};h.WEEKNUM=function(c,e){};h.WORKDAY=function(c,e,g){};h.WORKDAY.INTL=function(c,e,g,l){};h.YEAR=function(c){c=w.parseDate(c);return c instanceof Error?c:c.getFullYear()};h.YEARFRAC=function(c,e,g){};return h}();k.database=function(){function t(f,b){for(var c={},e=1;e<f[0].length;++e)c[e]=!0;var g=b[0].length;for(e=1;e<b.length;++e)b[e].length>g&&(g=b[e].length);for(e=1;e<f.length;++e)for(var l=1;l<f[e].length;++l){for(var p=!1,u=!1,m=0;m<b.length;++m){var z=b[m];if(!(z.length<g)&&
f[e][0]===z[0]){u=!0;for(var D=1;D<z.length;++D)p=p||eval(f[e][l]+z[D])}}u&&(c[l]=c[l]&&p)}g=[];for(e=0;e<f[0].length;++e)c[e]&&g.push(e-1);return g}var h={FINDFIELD:function(f,b){for(var c=null,e=0;e<f.length;e++)if(f[e][0]===b){c=e;break}return null==c?r.value:c},DAVERAGE:function(f,b,c){if(isNaN(b)&&"string"!==typeof b)return r.value;c=t(f,c);"string"===typeof b?(b=h.FINDFIELD(f,b),f=w.rest(f[b])):f=w.rest(f[b]);for(var e=b=0;e<c.length;e++)b+=f[c[e]];return 0===c.length?r.div0:b/c.length},DCOUNT:function(f,
b,c){},DCOUNTA:function(f,b,c){},DGET:function(f,b,c){if(isNaN(b)&&"string"!==typeof b)return r.value;c=t(f,c);"string"===typeof b?(b=h.FINDFIELD(f,b),f=w.rest(f[b])):f=w.rest(f[b]);return 0===c.length?r.value:1<c.length?r.num:f[c[0]]},DMAX:function(f,b,c){if(isNaN(b)&&"string"!==typeof b)return r.value;c=t(f,c);"string"===typeof b?(b=h.FINDFIELD(f,b),f=w.rest(f[b])):f=w.rest(f[b]);b=f[c[0]];for(var e=1;e<c.length;e++)b<f[c[e]]&&(b=f[c[e]]);return b},DMIN:function(f,b,c){if(isNaN(b)&&"string"!==typeof b)return r.value;
c=t(f,c);"string"===typeof b?(b=h.FINDFIELD(f,b),f=w.rest(f[b])):f=w.rest(f[b]);b=f[c[0]];for(var e=1;e<c.length;e++)b>f[c[e]]&&(b=f[c[e]]);return b},DPRODUCT:function(f,b,c){if(isNaN(b)&&"string"!==typeof b)return r.value;c=t(f,c);if("string"===typeof b){b=h.FINDFIELD(f,b);var e=w.rest(f[b])}else e=w.rest(f[b]);f=[];for(b=0;b<c.length;b++)f[b]=e[c[b]];if(c=f)for(f=[],b=0;b<c.length;++b)c[b]&&f.push(c[b]);else f=c;c=1;for(b=0;b<f.length;b++)c*=f[b];return c},DSTDEV:function(f,b,c){},DSTDEVP:function(f,
b,c){},DSUM:function(f,b,c){},DVAR:function(f,b,c){},DVARP:function(f,b,c){},MATCH:function(f,b,c){if(!f&&!b)return r.na;2===arguments.length&&(c=1);if(!(b instanceof Array)||-1!==c&&0!==c&&1!==c)return r.na;for(var e,g,l=0;l<b.length;l++)if(1===c){if(b[l]===f)return l+1;b[l]<f&&(g?b[l]>g&&(e=l+1,g=b[l]):(e=l+1,g=b[l]))}else if(0===c)if("string"===typeof f){if(f=f.replace(/\?/g,"."),b[l].toLowerCase().match(f.toLowerCase()))return l+1}else{if(b[l]===f)return l+1}else if(-1===c){if(b[l]===f)return l+
1;b[l]>f&&(g?b[l]<g&&(e=l+1,g=b[l]):(e=l+1,g=b[l]))}return e?e:r.na}};return h}();k.engineering=function(){var t={BESSELI:function(h,f){},BESSELJ:function(h,f){},BESSELK:function(h,f){},BESSELY:function(h,f){},BIN2DEC:function(h){if(!/^[01]{1,10}$/.test(h))return r.num;var f=parseInt(h,2);h=h.toString();return 10===h.length&&"1"===h.substring(0,1)?parseInt(h.substring(1),2)-512:f},BIN2HEX:function(h,f){if(!/^[01]{1,10}$/.test(h))return r.num;var b=h.toString();if(10===b.length&&"1"===b.substring(0,
1))return(0xfffffffe00+parseInt(b.substring(1),2)).toString(16);b=parseInt(h,2).toString(16);if(void 0===f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num},BIN2OCT:function(h,f){if(!/^[01]{1,10}$/.test(h))return r.num;var b=h.toString();if(10===b.length&&"1"===b.substring(0,1))return(1073741312+parseInt(b.substring(1),2)).toString(8);b=parseInt(h,2).toString(8);if(void 0===f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;
f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num},BITAND:function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:0>h||0>f||Math.floor(h)!==h||Math.floor(f)!==f||0xffffffffffff<h||0xffffffffffff<f?r.num:h&f},BITLSHIFT:function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:0>h||Math.floor(h)!==h||0xffffffffffff<h||53<Math.abs(f)?r.num:0<=f?h<<f:h>>-f},BITOR:function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,
f)?r.value:0>h||0>f||Math.floor(h)!==h||Math.floor(f)!==f||0xffffffffffff<h||0xffffffffffff<f?r.num:h|f},BITRSHIFT:function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:0>h||Math.floor(h)!==h||0xffffffffffff<h||53<Math.abs(f)?r.num:0<=f?h>>f:h<<-f},BITXOR:function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:0>h||0>f||Math.floor(h)!==h||Math.floor(f)!==f||0xffffffffffff<h||0xffffffffffff<f?r.num:h^f},COMPLEX:function(h,f,b){h=w.parseNumber(h);
f=w.parseNumber(f);if(w.anyIsError(h,f))return h;b=void 0===b?"i":b;return"i"!==b&&"j"!==b?r.value:0===h&&0===f?0:0===h?1===f?b:f.toString()+b:0===f?h.toString():h.toString()+(0<f?"+":"")+(1===f?b:f.toString()+b)},CONVERT:function(h,f,b){h=w.parseNumber(h);if(h instanceof Error)return h;for(var c=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],
["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,
1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,
1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,
!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree","\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",
!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],
["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton",
"brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],
"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",
!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,
9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,
!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian",
"rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],
["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",
!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon","tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],
["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],e={Yi:["yobi",
80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},g={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],
e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},l=null,p=null,u=f,m=b,z=1,D=1,E,C=0;C<c.length;C++){E=null===c[C][2]?[]:c[C][2];if(c[C][1]===u||0<=E.indexOf(u))l=c[C];if(c[C][1]===m||0<=E.indexOf(m))p=c[C]}if(null===l)for(E=e[f.substring(0,2)],C=g[f.substring(0,1)],"da"===f.substring(0,2)&&(C=["dekao",10,"da"]),E?(z=E[2],
u=f.substring(2)):C&&(z=C[1],u=f.substring(C[2].length)),f=0;f<c.length;f++)if(E=null===c[f][2]?[]:c[f][2],c[f][1]===u||0<=E.indexOf(u))l=c[f];if(null===p)for(e=e[b.substring(0,2)],g=g[b.substring(0,1)],"da"===b.substring(0,2)&&(g=["dekao",10,"da"]),e?(D=e[2],m=b.substring(2)):g&&(D=g[1],m=b.substring(g[2].length)),b=0;b<c.length;b++)if(E=null===c[b][2]?[]:c[b][2],c[b][1]===m||0<=E.indexOf(m))p=c[b];return null===l||null===p||l[3]!==p[3]?r.na:h*l[6]*z/(p[6]*D)},DEC2BIN:function(h,f){h=w.parseNumber(h);
if(h instanceof Error)return h;if(!/^-?[0-9]{1,3}$/.test(h)||-512>h||511<h)return r.num;if(0>h)return"1"+REPT("0",9-(512+h).toString(2).length)+(512+h).toString(2);var b=parseInt(h,10).toString(2);if("undefined"===typeof f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num},DEC2HEX:function(h,f){h=w.parseNumber(h);if(h instanceof Error)return h;if(!/^-?[0-9]{1,12}$/.test(h)||-549755813888>h||549755813887<h)return r.num;if(0>h)return(1099511627776+
h).toString(16);var b=parseInt(h,10).toString(16);if("undefined"===typeof f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num},DEC2OCT:function(h,f){h=w.parseNumber(h);if(h instanceof Error)return h;if(!/^-?[0-9]{1,9}$/.test(h)||-536870912>h||536870911<h)return r.num;if(0>h)return(1073741824+h).toString(8);var b=parseInt(h,10).toString(8);if("undefined"===typeof f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);
return f>=b.length?REPT("0",f-b.length)+b:r.num},DELTA:function(h,f){f=void 0===f?0:f;h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:h===f?1:0},ERF:function(h,f){}};t.ERF.PRECISE=function(){};t.ERFC=function(h){};t.ERFC.PRECISE=function(){};t.GESTEP=function(h,f){f=f||0;h=w.parseNumber(h);return w.anyIsError(f,h)?h:h>=f?1:0};t.HEX2BIN=function(h,f){if(!/^[0-9A-Fa-f]{1,10}$/.test(h))return r.num;var b=10===h.length&&"f"===h.substring(0,1).toLowerCase()?!0:!1,c=b?parseInt(h,
16)-1099511627776:parseInt(h,16);if(-512>c||511<c)return r.num;if(b)return"1"+REPT("0",9-(512+c).toString(2).length)+(512+c).toString(2);b=c.toString(2);if(void 0===f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num};t.HEX2DEC=function(h){if(!/^[0-9A-Fa-f]{1,10}$/.test(h))return r.num;h=parseInt(h,16);return 549755813888<=h?h-1099511627776:h};t.HEX2OCT=function(h,f){if(!/^[0-9A-Fa-f]{1,10}$/.test(h))return r.num;var b=parseInt(h,
16);if(536870911<b&&0xffe0000000>b)return r.num;if(0xffe0000000<=b)return(b-0xffc0000000).toString(8);b=b.toString(8);if(void 0===f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num};t.IMABS=function(h){var f=t.IMREAL(h);h=t.IMAGINARY(h);return w.anyIsError(f,h)?r.value:Math.sqrt(Math.pow(f,2)+Math.pow(h,2))};t.IMAGINARY=function(h){if(void 0===h||!0===h||!1===h)return r.value;if(0===h||"0"===h)return 0;if(0<=["i","j"].indexOf(h))return 1;
h=h.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var f=h.indexOf("+"),b=h.indexOf("-");0===f&&(f=h.indexOf("+",1));0===b&&(b=h.indexOf("-",1));var c=h.substring(h.length-1,h.length);c="i"===c||"j"===c;return 0<=f||0<=b?c?0<=f?isNaN(h.substring(0,f))||isNaN(h.substring(f+1,h.length-1))?r.num:Number(h.substring(f+1,h.length-1)):isNaN(h.substring(0,b))||isNaN(h.substring(b+1,h.length-1))?r.num:-Number(h.substring(b+1,h.length-1)):r.num:c?isNaN(h.substring(0,h.length-
1))?r.num:h.substring(0,h.length-1):isNaN(h)?r.num:0};t.IMARGUMENT=function(h){var f=t.IMREAL(h);h=t.IMAGINARY(h);return w.anyIsError(f,h)?r.value:0===f&&0===h?r.div0:0===f&&0<h?Math.PI/2:0===f&&0>h?-Math.PI/2:0===h&&0<f?0:0===h&&0>f?-Math.PI:0<f?Math.atan(h/f):0>f&&0<=h?Math.atan(h/f)+Math.PI:Math.atan(h/f)-Math.PI};t.IMCONJUGATE=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;var c=h.substring(h.length-1);return 0!==b?t.COMPLEX(f,-b,"i"===c||"j"===c?c:"i"):h};
t.IMCOS=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.cos(f)*(Math.exp(b)+Math.exp(-b))/2,-Math.sin(f)*(Math.exp(b)-Math.exp(-b))/2,"i"===h||"j"===h?h:"i")};t.IMCOSH=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.cos(b)*(Math.exp(f)+Math.exp(-f))/2,Math.sin(b)*(Math.exp(f)-Math.exp(-f))/2,"i"===h||"j"===h?h:"i")};t.IMCOT=function(h){var f=
t.IMREAL(h),b=t.IMAGINARY(h);return w.anyIsError(f,b)?r.value:t.IMDIV(t.IMCOS(h),t.IMSIN(h))};t.IMDIV=function(h,f){var b=t.IMREAL(h),c=t.IMAGINARY(h),e=t.IMREAL(f),g=t.IMAGINARY(f);if(w.anyIsError(b,c,e,g))return r.value;var l=h.substring(h.length-1),p=f.substring(f.length-1),u="i";"j"===l?u="j":"j"===p&&(u="j");if(0===e&&0===g)return r.num;l=e*e+g*g;return t.COMPLEX((b*e+c*g)/l,(c*e-b*g)/l,u)};t.IMEXP=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-
1);f=Math.exp(f);return t.COMPLEX(f*Math.cos(b),f*Math.sin(b),"i"===h||"j"===h?h:"i")};t.IMLN=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.log(Math.sqrt(f*f+b*b)),Math.atan(b/f),"i"===h||"j"===h?h:"i")};t.IMLOG10=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.log(Math.sqrt(f*f+b*b))/Math.log(10),Math.atan(b/f)/Math.log(10),"i"===
h||"j"===h?h:"i")};t.IMLOG2=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.log(Math.sqrt(f*f+b*b))/Math.log(2),Math.atan(b/f)/Math.log(2),"i"===h||"j"===h?h:"i")};t.IMPOWER=function(h,f){f=w.parseNumber(f);var b=t.IMREAL(h),c=t.IMAGINARY(h);if(w.anyIsError(f,b,c))return r.value;b=h.substring(h.length-1);b="i"===b||"j"===b?b:"i";c=Math.pow(t.IMABS(h),f);var e=t.IMARGUMENT(h);return t.COMPLEX(c*Math.cos(f*e),c*Math.sin(f*
e),b)};t.IMPRODUCT=function(){for(var h=arguments[0],f=1;f<arguments.length;f++){var b=t.IMREAL(h);h=t.IMAGINARY(h);var c=t.IMREAL(arguments[f]),e=t.IMAGINARY(arguments[f]);if(w.anyIsError(b,h,c,e))return r.value;h=t.COMPLEX(b*c-h*e,b*e+h*c)}return h};t.IMREAL=function(h){if(void 0===h||!0===h||!1===h)return r.value;if(0===h||"0"===h||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(h))return 0;var f=h.indexOf("+"),b=h.indexOf("-");0===f&&(f=h.indexOf("+",1));0===b&&(b=h.indexOf("-",
1));var c=h.substring(h.length-1,h.length);c="i"===c||"j"===c;return 0<=f||0<=b?c?0<=f?isNaN(h.substring(0,f))||isNaN(h.substring(f+1,h.length-1))?r.num:Number(h.substring(0,f)):isNaN(h.substring(0,b))||isNaN(h.substring(b+1,h.length-1))?r.num:Number(h.substring(0,b)):r.num:c?isNaN(h.substring(0,h.length-1))?r.num:0:isNaN(h)?r.num:h};t.IMSEC=function(h){if(!0===h||!1===h)return r.value;var f=t.IMREAL(h),b=t.IMAGINARY(h);return w.anyIsError(f,b)?r.value:t.IMDIV("1",t.IMCOS(h))};t.IMSECH=function(h){var f=
t.IMREAL(h),b=t.IMAGINARY(h);return w.anyIsError(f,b)?r.value:t.IMDIV("1",t.IMCOSH(h))};t.IMSIN=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.sin(f)*(Math.exp(b)+Math.exp(-b))/2,Math.cos(f)*(Math.exp(b)-Math.exp(-b))/2,"i"===h||"j"===h?h:"i")};t.IMSINH=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;h=h.substring(h.length-1);return t.COMPLEX(Math.cos(b)*(Math.exp(f)-Math.exp(-f))/
2,Math.sin(b)*(Math.exp(f)+Math.exp(-f))/2,"i"===h||"j"===h?h:"i")};t.IMSQRT=function(h){var f=t.IMREAL(h),b=t.IMAGINARY(h);if(w.anyIsError(f,b))return r.value;f=h.substring(h.length-1);f="i"===f||"j"===f?f:"i";b=Math.sqrt(t.IMABS(h));h=t.IMARGUMENT(h);return t.COMPLEX(b*Math.cos(h/2),b*Math.sin(h/2),f)};t.IMCSC=function(h){if(!0===h||!1===h)return r.value;var f=t.IMREAL(h),b=t.IMAGINARY(h);return w.anyIsError(f,b)?r.num:t.IMDIV("1",t.IMSIN(h))};t.IMCSCH=function(h){if(!0===h||!1===h)return r.value;
var f=t.IMREAL(h),b=t.IMAGINARY(h);return w.anyIsError(f,b)?r.num:t.IMDIV("1",t.IMSINH(h))};t.IMSUB=function(h,f){var b=this.IMREAL(h),c=this.IMAGINARY(h),e=this.IMREAL(f),g=this.IMAGINARY(f);if(w.anyIsError(b,c,e,g))return r.value;var l=h.substring(h.length-1),p=f.substring(f.length-1),u="i";"j"===l?u="j":"j"===p&&(u="j");return this.COMPLEX(b-e,c-g,u)};t.IMSUM=function(){for(var h=w.flatten(arguments),f=h[0],b=1;b<h.length;b++){var c=this.IMREAL(f);f=this.IMAGINARY(f);var e=this.IMREAL(h[b]),g=
this.IMAGINARY(h[b]);if(w.anyIsError(c,f,e,g))return r.value;f=this.COMPLEX(c+e,f+g)}return f};t.IMTAN=function(h){if(!0===h||!1===h)return r.value;var f=t.IMREAL(h),b=t.IMAGINARY(h);return w.anyIsError(f,b)?r.value:this.IMDIV(this.IMSIN(h),this.IMCOS(h))};t.OCT2BIN=function(h,f){if(!/^[0-7]{1,10}$/.test(h))return r.num;var b=10===h.length&&"7"===h.substring(0,1)?!0:!1,c=b?parseInt(h,8)-1073741824:parseInt(h,8);if(-512>c||511<c)return r.num;if(b)return"1"+REPT("0",9-(512+c).toString(2).length)+(512+
c).toString(2);b=c.toString(2);if("undefined"===typeof f)return b;if(isNaN(f))return r.value;if(0>f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num};t.OCT2DEC=function(h){if(!/^[0-7]{1,10}$/.test(h))return r.num;h=parseInt(h,8);return 536870912<=h?h-1073741824:h};t.OCT2HEX=function(h,f){if(!/^[0-7]{1,10}$/.test(h))return r.num;var b=parseInt(h,8);if(536870912<=b)return"ff"+(b+3221225472).toString(16);b=b.toString(16);if(void 0===f)return b;if(isNaN(f))return r.value;if(0>
f)return r.num;f=Math.floor(f);return f>=b.length?REPT("0",f-b.length)+b:r.num};return t}();k.financial=function(){function t(b){return b&&b.getTime&&!isNaN(b.getTime())}function h(b){return b instanceof Date?b:new Date(b)}var f={ACCRINT:function(b,c,e,g,l,p,u){b=h(b);c=h(c);e=h(e);return t(b)&&t(c)&&t(e)?0>=g||0>=l||-1===[1,2,4].indexOf(p)||-1===[0,1,2,3,4].indexOf(u)||e<=b?"#NUM!":(l||0)*g*YEARFRAC(b,e,u||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,
COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(b,c,e,g,l,p){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);if(w.anyIsError(b,c,e))return r.value;if(0>=b||0>=c||0>=e||1>g||1>l||g>l||0!==p&&1!==p)return r.num;c=f.PMT(b,c,e,0,p);var u=0;for(1===g&&0===p&&(u=-e,g++);g<=l;g++)u=1===p?u+(f.FV(b,g-2,c,e,1)-c):u+f.FV(b,g-1,c,e,0);return u*b},CUMPRINC:function(b,c,e,g,l,p){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);if(w.anyIsError(b,c,e))return r.value;if(0>=b||0>=c||0>=e||
1>g||1>l||g>l||0!==p&&1!==p)return r.num;c=f.PMT(b,c,e,0,p);var u=0;for(1===g&&(u=0===p?c+e*b:c,g++);g<=l;g++)u=0<p?u+(c-(f.FV(b,g-2,c,e,1)-c)*b):u+(c-f.FV(b,g-1,c,e,0)*b);return u},DB:function(b,c,e,g,l){l=void 0===l?12:l;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);if(w.anyIsError(b,c,e,g,l))return r.value;if(0>b||0>c||0>e||0>g||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(l)||g>e)return r.num;if(c>=b)return 0;c=(1-Math.pow(c/b,1/e)).toFixed(3);for(var p=
l=b*c*l/12,u=0,m=g===e?e-1:g,z=2;z<=m;z++)u=(b-p)*c,p+=u;return 1===g?l:g===e?(b-p)*c:u},DDB:function(b,c,e,g,l){l=void 0===l?2:l;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);if(w.anyIsError(b,c,e,g,l))return r.value;if(0>b||0>c||0>e||0>g||0>=l||g>e)return r.num;if(c>=b)return 0;for(var p=0,u=0,m=1;m<=g;m++)u=Math.min(l/e*(b-p),b-c-p),p+=u;return u},DISC:null,DOLLARDE:function(b,c){b=w.parseNumber(b);c=w.parseNumber(c);if(w.anyIsError(b,c))return r.value;
if(0>c)return r.num;if(0<=c&&1>c)return r.div0;c=parseInt(c,10);var e=parseInt(b,10);e+=b%1*Math.pow(10,Math.ceil(Math.log(c)/Math.LN10))/c;var g=Math.pow(10,Math.ceil(Math.log(c)/Math.LN2)+1);return Math.round(e*g)/g},DOLLARFR:function(b,c){b=w.parseNumber(b);c=w.parseNumber(c);if(w.anyIsError(b,c))return r.value;if(0>c)return r.num;if(0<=c&&1>c)return r.div0;c=parseInt(c,10);return parseInt(b,10)+b%1*Math.pow(10,-Math.ceil(Math.log(c)/Math.LN10))*c},DURATION:null,EFFECT:function(b,c){b=w.parseNumber(b);
c=w.parseNumber(c);if(w.anyIsError(b,c))return r.value;if(0>=b||1>c)return r.num;c=parseInt(c,10);return Math.pow(1+b/c,c)-1},FV:function(b,c,e,g,l){g=g||0;l=l||0;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);if(w.anyIsError(b,c,e,g,l))return r.value;0===b?b=g+e*c:(c=Math.pow(1+b,c),b=1===l?g*c+e*(1+b)*(c-1)/b:g*c+e*(c-1)/b);return-b},FVSCHEDULE:function(b,c){b=w.parseNumber(b);c=w.parseNumberArray(w.flatten(c));if(w.anyIsError(b,c))return r.value;
for(var e=c.length,g=b,l=0;l<e;l++)g*=1+c[l];return g},INTRATE:null,IPMT:function(b,c,e,g,l,p){l=l||0;p=p||0;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);p=w.parseNumber(p);if(w.anyIsError(b,c,e,g,l,p))return r.value;e=f.PMT(b,e,g,l,p);return(1===c?1===p?0:-g:1===p?f.FV(b,c-2,e,g,1)-e:f.FV(b,c-1,e,g,0))*b},IRR:function(b,c){c=c||0;b=w.parseNumberArray(w.flatten(b));c=w.parseNumber(c);if(w.anyIsError(b,c))return r.value;for(var e=function(D,E,C){C+=
1;for(var F=D[0],I=1;I<D.length;I++)F+=D[I]/Math.pow(C,(E[I]-E[0])/365);return F},g=function(D,E,C){C+=1;for(var F=0,I=1;I<D.length;I++){var J=(E[I]-E[0])/365;F-=J*D[I]/Math.pow(C,J+1)}return F},l=[],p=!1,u=!1,m=0;m<b.length;m++)l[m]=0===m?0:l[m-1]+365,0<b[m]&&(p=!0),0>b[m]&&(u=!0);if(!p||!u)return r.num;p=void 0===c?.1:c;u=!0;do{var z=e(b,l,p);u=p-z/g(b,l,p);m=Math.abs(u-p);p=u;u=1E-10<m&&1E-10<Math.abs(z)}while(u);return p},ISPMT:function(b,c,e,g){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);
g=w.parseNumber(g);return w.anyIsError(b,c,e,g)?r.value:g*b*(c/e-1)},MDURATION:null,MIRR:function(b,c,e){b=w.parseNumberArray(w.flatten(b));c=w.parseNumber(c);e=w.parseNumber(e);if(w.anyIsError(b,c,e))return r.value;for(var g=b.length,l=[],p=[],u=0;u<g;u++)0>b[u]?l.push(b[u]):p.push(b[u]);b=-f.NPV(e,p)*Math.pow(1+e,g-1);c=f.NPV(c,l)*(1+c);return Math.pow(b/c,1/(g-1))-1},NOMINAL:function(b,c){b=w.parseNumber(b);c=w.parseNumber(c);if(w.anyIsError(b,c))return r.value;if(0>=b||1>c)return r.num;c=parseInt(c,
10);return(Math.pow(b+1,1/c)-1)*c},NPER:function(b,c,e,g,l){l=void 0===l?0:l;g=void 0===g?0:g;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);return w.anyIsError(b,c,e,g,l)?r.value:Math.log((c*(1+b*l)-g*b)/(e*b+c*(1+b*l)))/Math.log(1+b)},NPV:function(){var b=w.parseNumberArray(w.flatten(arguments));if(b instanceof Error)return b;for(var c=b[0],e=0,g=1;g<b.length;g++)e+=b[g]/Math.pow(1+c,g);return e},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,
PDURATION:function(b,c,e){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);return w.anyIsError(b,c,e)?r.value:0>=b?r.num:(Math.log(e)-Math.log(c))/Math.log(1+b)},PMT:function(b,c,e,g,l){g=g||0;l=l||0;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);if(w.anyIsError(b,c,e,g,l))return r.value;0===b?b=(e+g)/c:(c=Math.pow(1+b,c),b=1===l?(g*b/(c-1)+e*b/(1-1/c))/(1+b):g*b/(c-1)+e*b/(1-1/c));return-b},PPMT:function(b,c,e,g,l,p){l=l||0;p=p||0;b=w.parseNumber(b);
e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);p=w.parseNumber(p);return w.anyIsError(b,e,g,l,p)?r.value:f.PMT(b,e,g,l,p)-f.IPMT(b,c,e,g,l,p)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(b,c,e,g,l){g=g||0;l=l||0;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);return w.anyIsError(b,c,e,g,l)?r.value:0===b?-e*c-g:((1-Math.pow(1+b,c))/b*e*(1+b*l)-g)/Math.pow(1+b,c)},RATE:function(b,c,e,g,l,p){p=void 0===p?.01:p;g=void 0===g?0:g;l=void 0===
l?0:l;b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);l=w.parseNumber(l);p=w.parseNumber(p);if(w.anyIsError(b,c,e,g,l,p))return r.value;for(var u=0,m=!1;100>u&&!m;){var z=Math.pow(p+1,b),D=Math.pow(p+1,b-1);z=p-(g+z*e+c*(z-1)*(p*l+1)/p)/(b*D*e-c*(z-1)*(p*l+1)/Math.pow(p,2)+(b*c*D*(p*l+1)/p+c*(z-1)*l/p));1E-6>Math.abs(z-p)&&(m=!0);u++;p=z}return m?p:Number.NaN+p},RECEIVED:null,RRI:function(b,c,e){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);return w.anyIsError(b,
c,e)?r.value:0===b||0===c?r.num:Math.pow(e/c,1/b)-1},SLN:function(b,c,e){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);return w.anyIsError(b,c,e)?r.value:0===e?r.num:(b-c)/e},SYD:function(b,c,e,g){b=w.parseNumber(b);c=w.parseNumber(c);e=w.parseNumber(e);g=w.parseNumber(g);if(w.anyIsError(b,c,e,g))return r.value;if(0===e||1>g||g>e)return r.num;g=parseInt(g,10);return(b-c)*(e-g+1)*2/(e*(e+1))},TBILLEQ:function(b,c,e){b=w.parseDate(b);c=w.parseDate(c);e=w.parseNumber(e);return w.anyIsError(b,
c,e)?r.value:0>=e||b>c||31536E6<c-b?r.num:365*e/(360-e*DAYS360(b,c,!1))},TBILLPRICE:function(b,c,e){b=w.parseDate(b);c=w.parseDate(c);e=w.parseNumber(e);return w.anyIsError(b,c,e)?r.value:0>=e||b>c||31536E6<c-b?r.num:100*(1-e*DAYS360(b,c,!1)/360)},TBILLYIELD:function(b,c,e){b=w.parseDate(b);c=w.parseDate(c);e=w.parseNumber(e);return w.anyIsError(b,c,e)?r.value:0>=e||b>c||31536E6<c-b?r.num:360*(100-e)/(e*DAYS360(b,c,!1))},VDB:null,XIRR:function(b,c,e){b=w.parseNumberArray(w.flatten(b));c=w.parseDateArray(w.flatten(c));
e=w.parseNumber(e);if(w.anyIsError(b,c,e))return r.value;for(var g=function(z,D,E){E+=1;for(var C=z[0],F=1;F<z.length;F++)C+=z[F]/Math.pow(E,DAYS(D[F],D[0])/365);return C},l=function(z,D,E){E+=1;for(var C=0,F=1;F<z.length;F++){var I=DAYS(D[F],D[0])/365;C-=I*z[F]/Math.pow(E,I+1)}return C},p=!1,u=!1,m=0;m<b.length;m++)0<b[m]&&(p=!0),0>b[m]&&(u=!0);if(!p||!u)return r.num;e=e||.1;p=!0;do m=g(b,c,e),p=e-m/l(b,c,e),u=Math.abs(p-e),e=p,p=1E-10<u&&1E-10<Math.abs(m);while(p);return e},XNPV:function(b,c,e){b=
w.parseNumber(b);c=w.parseNumberArray(w.flatten(c));e=w.parseDateArray(w.flatten(e));if(w.anyIsError(b,c,e))return r.value;for(var g=0,l=0;l<c.length;l++)g+=c[l]/Math.pow(1+b,DAYS(e[l],e[0])/365);return g},YIELD:null,YIELDDISC:null,YIELDMAT:null};return f}();k.information=function(){var t={CELL:null,ERROR:{}};t.ERROR.TYPE=function(h){switch(h){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na};
t.INFO=null;t.ISBLANK=function(h){return null===h};t.ISBINARY=function(h){return/^[01]{1,10}$/.test(h)};t.ISERR=function(h){return 0<=[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(h)||"number"===typeof h&&(isNaN(h)||!isFinite(h))};t.ISERROR=function(h){return t.ISERR(h)||h===r.na};t.ISEVEN=function(h){return Math.floor(Math.abs(h))&1?!1:!0};t.ISFORMULA=null;t.ISLOGICAL=function(h){return!0===h||!1===h};t.ISNA=function(h){return h===r.na};t.ISNONTEXT=function(h){return"string"!==typeof h};t.ISNUMBER=
function(h){return"number"===typeof h&&!isNaN(h)&&isFinite(h)};t.ISODD=function(h){return Math.floor(Math.abs(h))&1?!0:!1};t.ISREF=null;t.ISTEXT=function(h){return"string"===typeof h};t.N=function(h){return this.ISNUMBER(h)?h:h instanceof Date?h.getTime():!0===h?1:!1===h?0:this.ISERROR(h)?h:0};t.NA=function(){return r.na};t.SHEET=null;t.SHEETS=null;t.TYPE=function(h){if(this.ISNUMBER(h))return 1;if(this.ISTEXT(h))return 2;if(this.ISLOGICAL(h))return 4;if(this.ISERROR(h))return 16;if(Array.isArray(h))return 64};
return t}();k.logical=function(){return{AND:function(){for(var t=w.flatten(arguments),h=!0,f=0;f<t.length;f++)t[f]||(h=!1);return h},CHOOSE:function(){if(2>arguments.length)return r.na;var t=arguments[0];return 1>t||254<t||arguments.length<t+1?r.value:arguments[t]},FALSE:function(){return!1},IF:function(t,h,f){return t?h:f},IFERROR:function(t,h){return ISERROR(t)?h:t},IFNA:function(t,h){return t===r.na?h:t},NOT:function(t){return!t},OR:function(){for(var t=w.flatten(arguments),h=!1,f=0;f<t.length;f++)t[f]&&
(h=!0);return h},TRUE:function(){return!0},XOR:function(){for(var t=w.flatten(arguments),h=0,f=0;f<t.length;f++)t[f]&&h++;return Math.floor(Math.abs(h))&1?!0:!1},SWITCH:function(){if(0<arguments.length){var t=arguments[0],h=arguments.length-1,f=Math.floor(h/2),b=!1;h=0===h%2?null:arguments[arguments.length-1];if(f)for(var c=0;c<f;c++)if(t===arguments[2*c+1]){var e=arguments[2*c+2];b=!0;break}!b&&h&&(e=h)}return e}}}();k.math=function(){var t={ABS:function(f){f=w.parseNumber(f);return f instanceof
Error?f:Math.abs(w.parseNumber(f))},ACOS:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.acos(f)},ACOSH:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.log(f+Math.sqrt(f*f-1))},ACOT:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.atan(1/f)},ACOTH:function(f){f=w.parseNumber(f);return f instanceof Error?f:.5*Math.log((f+1)/(f-1))},AGGREGATE:null,ARABIC:function(f){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(f))return r.value;
var b=0;f.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(c){b+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[c]});return b},ASIN:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.asin(f)},ASINH:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.log(f+Math.sqrt(f*f+1))},ATAN:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.atan(f)},ATAN2:function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:Math.atan2(f,
b)},ATANH:function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.log((1+f)/(1-f))/2},BASE:function(f,b,c){c=c||0;f=w.parseNumber(f);b=w.parseNumber(b);c=w.parseNumber(c);if(w.anyIsError(f,b,c))return r.value;c=void 0===c?0:c;f=f.toString(b);return Array(Math.max(c+1-f.length,0)).join("0")+f},CEILING:function(f,b,c){b=void 0===b?1:b;c=void 0===c?0:c;f=w.parseNumber(f);b=w.parseNumber(b);c=w.parseNumber(c);if(w.anyIsError(f,b,c))return r.value;if(0===b)return 0;b=Math.abs(b);return 0<=f?Math.ceil(f/
b)*b:0===c?-1*Math.floor(Math.abs(f)/b)*b:-1*Math.ceil(Math.abs(f)/b)*b}};t.CEILING.MATH=t.CEILING;t.CEILING.PRECISE=t.CEILING;t.COMBIN=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:t.FACT(f)/(t.FACT(b)*t.FACT(f-b))};t.COMBINA=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:0===f&&0===b?1:t.COMBIN(f+b-1,f-1)};t.COS=function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.cos(f)};t.COSH=function(f){f=w.parseNumber(f);
return f instanceof Error?f:(Math.exp(f)+Math.exp(-f))/2};t.COT=function(f){f=w.parseNumber(f);return f instanceof Error?f:1/Math.tan(f)};t.COTH=function(f){f=w.parseNumber(f);if(f instanceof Error)return f;f=Math.exp(2*f);return(f+1)/(f-1)};t.CSC=function(f){f=w.parseNumber(f);return f instanceof Error?f:1/Math.sin(f)};t.CSCH=function(f){f=w.parseNumber(f);return f instanceof Error?f:2/(Math.exp(f)-Math.exp(-f))};t.DECIMAL=function(f,b){return 1>arguments.length?r.value:parseInt(f,b)};t.DEGREES=
function(f){f=w.parseNumber(f);return f instanceof Error?f:180*f/Math.PI};t.EVEN=function(f){f=w.parseNumber(f);return f instanceof Error?f:t.CEILING(f,-2,-1)};t.EXP=Math.exp;var h=[];t.FACT=function(f){f=w.parseNumber(f);if(f instanceof Error)return f;f=Math.floor(f);if(0===f||1===f)return 1;0<h[f]||(h[f]=t.FACT(f-1)*f);return h[f]};t.FACTDOUBLE=function(f){f=w.parseNumber(f);if(f instanceof Error)return f;f=Math.floor(f);return 0>=f?1:f*t.FACTDOUBLE(f-2)};t.FLOOR=function(f,b,c){b=void 0===b?1:
b;c=void 0===c?0:c;f=w.parseNumber(f);b=w.parseNumber(b);c=w.parseNumber(c);if(w.anyIsError(f,b,c))return r.value;if(0===b)return 0;b=Math.abs(b);return 0<=f?Math.floor(f/b)*b:0===c?-1*Math.ceil(Math.abs(f)/b)*b:-1*Math.floor(Math.abs(f)/b)*b};t.FLOOR.MATH=t.FLOOR;t.GCD=null;t.INT=function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.floor(f)};t.LCM=function(){var f=w.parseNumberArray(w.flatten(arguments));if(f instanceof Error)return f;for(var b,c,e,g=1;void 0!==(e=f.pop());)for(;1<e;){if(e%
2){b=3;for(c=Math.floor(Math.sqrt(e));b<=c&&e%b;b+=2);c=b<=c?b:e}else c=2;e/=c;g*=c;for(b=f.length;b;0===f[--b]%c&&1===(f[b]/=c)&&f.splice(b,1));}return g};t.LN=function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.log(f)};t.LOG=function(f,b){f=w.parseNumber(f);b=void 0===b?10:w.parseNumber(b);return w.anyIsError(f,b)?r.value:Math.log(f)/Math.log(b)};t.LOG10=function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.log(f)/Math.log(10)};t.MDETERM=null;t.MINVERSE=null;t.MMULT=null;t.MOD=
function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);if(w.anyIsError(f,b))return r.value;if(0===b)return r.div0;var c=Math.abs(f%b);return 0<b?c:-c};t.MROUND=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:0>f*b?r.num:Math.round(f/b)*b};t.MULTINOMIAL=function(){var f=w.parseNumberArray(w.flatten(arguments));if(f instanceof Error)return f;for(var b=0,c=1,e=0;e<f.length;e++)b+=f[e],c*=t.FACT(f[e]);return t.FACT(b)/c};t.MUNIT=null;t.ODD=function(f){f=w.parseNumber(f);
if(f instanceof Error)return f;var b=Math.ceil(Math.abs(f));b=b&1?b:b+1;return 0<f?b:-b};t.PI=function(){return Math.PI};t.POWER=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);if(w.anyIsError(f,b))return r.value;var c=Math.pow(f,b);return isNaN(c)?r.num:c};t.PRODUCT=function(){var f=w.parseNumberArray(w.flatten(arguments));if(f instanceof Error)return f;for(var b=1,c=0;c<f.length;c++)b*=f[c];return b};t.QUOTIENT=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:
parseInt(f/b,10)};t.RADIANS=function(f){f=w.parseNumber(f);return f instanceof Error?f:f*Math.PI/180};t.RAND=function(){return Math.random()};t.RANDBETWEEN=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:f+Math.ceil((b-f+1)*Math.random())-1};t.ROMAN=null;t.ROUND=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:Math.round(f*Math.pow(10,b))/Math.pow(10,b)};t.ROUNDDOWN=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,
b)?r.value:(0<f?1:-1)*Math.floor(Math.abs(f)*Math.pow(10,b))/Math.pow(10,b)};t.ROUNDUP=function(f,b){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:(0<f?1:-1)*Math.ceil(Math.abs(f)*Math.pow(10,b))/Math.pow(10,b)};t.SEC=function(f){f=w.parseNumber(f);return f instanceof Error?f:1/Math.cos(f)};t.SECH=function(f){f=w.parseNumber(f);return f instanceof Error?f:2/(Math.exp(f)+Math.exp(-f))};t.SERIESSUM=function(f,b,c,e){f=w.parseNumber(f);b=w.parseNumber(b);c=w.parseNumber(c);e=
w.parseNumberArray(e);if(w.anyIsError(f,b,c,e))return r.value;for(var g=e[0]*Math.pow(f,b),l=1;l<e.length;l++)g+=e[l]*Math.pow(f,b+l*c);return g};t.SIGN=function(f){f=w.parseNumber(f);return f instanceof Error?f:0>f?-1:0===f?0:1};t.SIN=function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.sin(f)};t.SINH=function(f){f=w.parseNumber(f);return f instanceof Error?f:(Math.exp(f)-Math.exp(-f))/2};t.SQRT=function(f){f=w.parseNumber(f);return f instanceof Error?f:0>f?r.num:Math.sqrt(f)};t.SQRTPI=
function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.sqrt(f*Math.PI)};t.SUBTOTAL=null;t.ADD=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:f+b};t.MINUS=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:f-b};t.DIVIDE=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:0===b?r.div0:
f/b};t.MULTIPLY=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:f*b};t.GTE=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.error:f>=b};t.LT=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.error:f<b};t.LTE=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,
b)?r.error:f<=b};t.EQ=function(f,b){return 2!==arguments.length?r.na:f===b};t.NE=function(f,b){return 2!==arguments.length?r.na:f!==b};t.POW=function(f,b){if(2!==arguments.length)return r.na;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.error:t.POWER(f,b)};t.SUM=function(){for(var f=0,b=Object.keys(arguments),c=0;c<b.length;++c){var e=arguments[b[c]];"number"===typeof e?f+=e:"string"===typeof e?(e=parseFloat(e),!isNaN(e)&&(f+=e)):Array.isArray(e)&&(f+=t.SUM.apply(null,e))}return f};
t.SUMIF=function(){var f=w.argsToArray(arguments),b=f.pop();f=w.parseNumberArray(w.flatten(f));if(f instanceof Error)return f;for(var c=0,e=0;e<f.length;e++)c+=eval(f[e]+b)?f[e]:0;return c};t.SUMIFS=function(){var f=w.argsToArray(arguments),b=w.parseNumberArray(w.flatten(f.shift()));if(b instanceof Error)return b;for(var c=b.length,e=f.length,g=0,l=0;l<c;l++){for(var p=b[l],u="",m=0;m<e;m+=2)u=isNaN(f[m][l])?u+('"'+f[m][l]+'"'+f[m+1]):u+(f[m][l]+f[m+1]),m!==e-1&&(u+=" && ");u=u.slice(0,-4);eval(u)&&
(g+=p)}return g};t.SUMPRODUCT=null;t.SUMSQ=function(){var f=w.parseNumberArray(w.flatten(arguments));if(f instanceof Error)return f;for(var b=0,c=f.length,e=0;e<c;e++)b+=ISNUMBER(f[e])?f[e]*f[e]:0;return b};t.SUMX2MY2=function(f,b){f=w.parseNumberArray(w.flatten(f));b=w.parseNumberArray(w.flatten(b));if(w.anyIsError(f,b))return r.value;for(var c=0,e=0;e<f.length;e++)c+=f[e]*f[e]-b[e]*b[e];return c};t.SUMX2PY2=function(f,b){f=w.parseNumberArray(w.flatten(f));b=w.parseNumberArray(w.flatten(b));if(w.anyIsError(f,
b))return r.value;var c=0;f=w.parseNumberArray(w.flatten(f));b=w.parseNumberArray(w.flatten(b));for(var e=0;e<f.length;e++)c+=f[e]*f[e]+b[e]*b[e];return c};t.SUMXMY2=function(f,b){f=w.parseNumberArray(w.flatten(f));b=w.parseNumberArray(w.flatten(b));if(w.anyIsError(f,b))return r.value;var c=0;f=w.flatten(f);b=w.flatten(b);for(var e=0;e<f.length;e++)c+=Math.pow(f[e]-b[e],2);return c};t.TAN=function(f){f=w.parseNumber(f);return f instanceof Error?f:Math.tan(f)};t.TANH=function(f){f=w.parseNumber(f);
if(f instanceof Error)return f;f=Math.exp(2*f);return(f-1)/(f+1)};t.TRUNC=function(f,b){b=void 0===b?0:b;f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)?r.value:(0<f?1:-1)*Math.floor(Math.abs(f)*Math.pow(10,b))/Math.pow(10,b)};return t}();k.misc=function(){var t={UNIQUE:function(){for(var h=[],f=0;f<arguments.length;++f){for(var b=!1,c=arguments[f],e=0;e<h.length&&!(b=h[e]===c);++e);b||h.push(c)}return h}};t.FLATTEN=w.flatten;t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,
0)};t.REFERENCE=function(h,f){try{for(var b=f.split("."),c=h,e=0;e<b.length;++e){var g=b[e];if("]"===g[g.length-1]){var l=g.indexOf("["),p=g.substring(l+1,g.length-1);c=c[g.substring(0,l)][p]}else c=c[g]}return c}catch(u){}};t.JOIN=function(h,f){return h.join(f)};t.NUMBERS=function(){return w.flatten(arguments).filter(function(h){return"number"===typeof h})};t.NUMERAL=null;return t}();k.text=function(){var t={ASC:null,BAHTTEXT:null,CHAR:function(h){h=w.parseNumber(h);return h instanceof Error?h:String.fromCharCode(h)},
CLEAN:function(h){return(h||"").replace(/[\0-\x1F]/g,"")},CODE:function(h){return(h||"").charCodeAt(0)},CONCATENATE:function(){for(var h=w.flatten(arguments),f;-1<(f=h.indexOf(!0));)h[f]="TRUE";for(;-1<(f=h.indexOf(!1));)h[f]="FALSE";return h.join("")},DBCS:null,DOLLAR:null,EXACT:function(h,f){return h===f},FIND:function(h,f,b){return f?f.indexOf(h,(void 0===b?0:b)-1)+1:null},FIXED:null,HTML2TEXT:function(h){var f="";h&&(h instanceof Array?h.forEach(function(b){""!==f&&(f+="\n");f+=b.replace(/<(?:.|\n)*?>/gm,
"")}):f=h.replace(/<(?:.|\n)*?>/gm,""));return f},LEFT:function(h,f){f=w.parseNumber(void 0===f?1:f);return f instanceof Error||"string"!==typeof h?r.value:h?h.substring(0,f):null},LEN:function(h){return 0===arguments.length?r.error:"string"===typeof h?h?h.length:0:h.length?h.length:r.value},LOWER:function(h){return"string"!==typeof h?r.value:h?h.toLowerCase():h},MID:function(h,f,b){f=w.parseNumber(f);b=w.parseNumber(b);if(w.anyIsError(f,b)||"string"!==typeof h)return b;--f;return h.substring(f,f+
b)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(h){if(void 0===h||0===h.length)return r.value;!0===h&&(h="TRUE");!1===h&&(h="FALSE");if(isNaN(h)&&"number"===typeof h)return r.value;"number"===typeof h&&(h=""+h);return h.replace(/\w\S*/g,function(f){return f.charAt(0).toUpperCase()+f.substr(1).toLowerCase()})},REGEXEXTRACT:function(h,f){var b=h.match(new RegExp(f));return b?b[1<b.length?b.length-1:0]:null},REGEXMATCH:function(h,f,b){h=h.match(new RegExp(f));return b?h:!!h},REGEXREPLACE:function(h,
f,b){return h.replace(new RegExp(f),b)},REPLACE:function(h,f,b,c){f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(f,b)||"string"!==typeof h||"string"!==typeof c?r.value:h.substr(0,f-1)+c+h.substr(f-1+b)},REPT:function(h,f){f=w.parseNumber(f);return f instanceof Error?f:Array(f+1).join(h)},RIGHT:function(h,f){f=w.parseNumber(void 0===f?1:f);return f instanceof Error?f:h?h.substring(h.length-f):null},SEARCH:function(h,f,b){if("string"!==typeof h||"string"!==typeof f)return r.value;b=void 0===
b?0:b;h=f.toLowerCase().indexOf(h.toLowerCase(),b-1)+1;return 0===h?r.value:h},SPLIT:function(h,f){return h.split(f)},SUBSTITUTE:function(h,f,b,c){if(h&&f&&b){if(void 0===c)return h.replace(new RegExp(f,"g"),b);for(var e=0,g=0;0<h.indexOf(f,e);)if(e=h.indexOf(f,e+1),g++,g===c)return h.substring(0,e)+b+h.substring(e+f.length)}else return h},T:function(h){return"string"===typeof h?h:""},TEXT:null,TRIM:function(h){return"string"!==typeof h?r.value:h.replace(/ +/g," ").trim()}};t.UNICHAR=t.CHAR;t.UNICODE=
t.CODE;t.UPPER=function(h){return"string"!==typeof h?r.value:h.toUpperCase()};t.VALUE=null;return t}();k.stats=function(){var t={AVEDEV:null,AVERAGE:function(){for(var h=w.numbers(w.flatten(arguments)),f=h.length,b=0,c=0,e=0;e<f;e++)b+=h[e],c+=1;return b/c},AVERAGEA:function(){for(var h=w.flatten(arguments),f=h.length,b=0,c=0,e=0;e<f;e++){var g=h[e];"number"===typeof g&&(b+=g);!0===g&&b++;null!==g&&c++}return b/c},AVERAGEIF:function(h,f,b){b=b||h;h=w.flatten(h);b=w.parseNumberArray(w.flatten(b));
if(b instanceof Error)return b;for(var c=0,e=0,g=0;g<h.length;g++)eval(h[g]+f)&&(e+=b[g],c++);return e/c},AVERAGEIFS:null,COUNT:function(){return w.numbers(w.flatten(arguments)).length},COUNTA:function(){var h=w.flatten(arguments);return h.length-t.COUNTBLANK(h)},COUNTIN:function(h,f){for(var b=0,c=0;c<h.length;c++)h[c]===f&&b++;return b},COUNTBLANK:function(){for(var h=w.flatten(arguments),f=0,b,c=0;c<h.length;c++)b=h[c],null!==b&&""!==b||f++;return f},COUNTIF:function(){var h=w.argsToArray(arguments),
f=h.pop();h=w.flatten(h);/[<>=!]/.test(f)||(f='=="'+f+'"');for(var b=0,c=0;c<h.length;c++)"string"!==typeof h[c]?eval(h[c]+f)&&b++:eval('"'+h[c]+'"'+f)&&b++;return b},COUNTIFS:function(){for(var h=w.argsToArray(arguments),f=Array(w.flatten(h[0]).length),b=0;b<f.length;b++)f[b]=!0;for(b=0;b<h.length;b+=2){var c=w.flatten(h[b]),e=h[b+1];/[<>=!]/.test(e)||(e='=="'+e+'"');for(var g=0;g<c.length;g++)f[g]="string"!==typeof c[g]?f[g]&&eval(c[g]+e):f[g]&&eval('"'+c[g]+'"'+e)}for(b=h=0;b<f.length;b++)f[b]&&
h++;return h},COUNTUNIQUE:function(){return UNIQUE.apply(null,w.flatten(arguments)).length},FISHER:function(h){h=w.parseNumber(h);return h instanceof Error?h:Math.log((1+h)/(1-h))/2},FISHERINV:function(h){h=w.parseNumber(h);if(h instanceof Error)return h;h=Math.exp(2*h);return(h-1)/(h+1)},FREQUENCY:function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumberArray(w.flatten(f));if(w.anyIsError(h,f))return r.value;for(var b=h.length,c=f.length,e=[],g=0;g<=c;g++)for(var l=e[g]=0;l<b;l++)0===g?h[l]<=
f[0]&&(e[0]+=1):g<c?h[l]>f[g-1]&&h[l]<=f[g]&&(e[g]+=1):g===c&&h[l]>f[c-1]&&(e[c]+=1);return e},LARGE:function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);return w.anyIsError(h,f)?h:h.sort(function(b,c){return c-b})[f-1]},MAX:function(){var h=w.numbers(w.flatten(arguments));return 0===h.length?0:Math.max.apply(Math,h)},MAXA:function(){var h=w.arrayValuesToNumbers(w.flatten(arguments));return 0===h.length?0:Math.max.apply(Math,h)},MIN:function(){var h=w.numbers(w.flatten(arguments));
return 0===h.length?0:Math.min.apply(Math,h)},MINA:function(){var h=w.arrayValuesToNumbers(w.flatten(arguments));return 0===h.length?0:Math.min.apply(Math,h)},MODE:{}};t.MODE.MULT=function(){var h=w.parseNumberArray(w.flatten(arguments));if(h instanceof Error)return h;for(var f=h.length,b={},c=[],e=0,g,l=0;l<f;l++)g=h[l],b[g]=b[g]?b[g]+1:1,b[g]>e&&(e=b[g],c=[]),b[g]===e&&(c[c.length]=g);return c};t.MODE.SNGL=function(){var h=w.parseNumberArray(w.flatten(arguments));return h instanceof Error?h:t.MODE.MULT(h).sort(function(f,
b){return f-b})[0]};t.PERCENTILE={};t.PERCENTILE.EXC=function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);if(w.anyIsError(h,f))return r.value;h=h.sort(function(e,g){return e-g});var b=h.length;if(f<1/(b+1)||f>1-1/(b+1))return r.num;b=f*(b+1)-1;var c=Math.floor(b);return w.cleanFloat(b===c?h[b]:h[c]+(b-c)*(h[c+1]-h[c]))};t.PERCENTILE.INC=function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);if(w.anyIsError(h,f))return r.value;h=h.sort(function(e,g){return e-g});var b=f*
(h.length-1),c=Math.floor(b);return w.cleanFloat(b===c?h[b]:h[c]+(b-c)*(h[c+1]-h[c]))};t.PERCENTRANK={};t.PERCENTRANK.EXC=function(h,f,b){b=void 0===b?3:b;h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);b=w.parseNumber(b);if(w.anyIsError(h,f,b))return r.value;h=h.sort(function(m,z){return m-z});var c=UNIQUE.apply(null,h),e=h.length,g=c.length;b=Math.pow(10,b);for(var l=0,p=!1,u=0;!p&&u<g;)f===c[u]?(l=(h.indexOf(c[u])+1)/(e+1),p=!0):f>=c[u]&&(f<c[u+1]||u===g-1)&&(l=(h.indexOf(c[u])+1+(f-c[u])/
(c[u+1]-c[u]))/(e+1),p=!0),u++;return Math.floor(l*b)/b};t.PERCENTRANK.INC=function(h,f,b){b=void 0===b?3:b;h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);b=w.parseNumber(b);if(w.anyIsError(h,f,b))return r.value;h=h.sort(function(m,z){return m-z});var c=UNIQUE.apply(null,h),e=h.length,g=c.length;b=Math.pow(10,b);for(var l=0,p=!1,u=0;!p&&u<g;)f===c[u]?(l=h.indexOf(c[u])/(e-1),p=!0):f>=c[u]&&(f<c[u+1]||u===g-1)&&(l=(h.indexOf(c[u])+(f-c[u])/(c[u+1]-c[u]))/(e-1),p=!0),u++;return Math.floor(l*
b)/b};t.PERMUT=function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:FACT(h)/FACT(h-f)};t.PERMUTATIONA=function(h,f){h=w.parseNumber(h);f=w.parseNumber(f);return w.anyIsError(h,f)?r.value:Math.pow(h,f)};t.PHI=function(h){h=w.parseNumber(h);return h instanceof Error?r.value:Math.exp(-.5*h*h)/2.5066282746310002};t.PROB=function(h,f,b,c){if(void 0===b)return 0;c=void 0===c?b:c;h=w.parseNumberArray(w.flatten(h));f=w.parseNumberArray(w.flatten(f));b=w.parseNumber(b);c=w.parseNumber(c);
if(w.anyIsError(h,f,b,c))return r.value;if(b===c)return 0<=h.indexOf(b)?f[h.indexOf(b)]:0;for(var e=h.sort(function(u,m){return u-m}),g=e.length,l=0,p=0;p<g;p++)e[p]>=b&&e[p]<=c&&(l+=f[h.indexOf(e[p])]);return l};t.QUARTILE={};t.QUARTILE.EXC=function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);if(w.anyIsError(h,f))return r.value;switch(f){case 1:return t.PERCENTILE.EXC(h,.25);case 2:return t.PERCENTILE.EXC(h,.5);case 3:return t.PERCENTILE.EXC(h,.75);default:return r.num}};t.QUARTILE.INC=
function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);if(w.anyIsError(h,f))return r.value;switch(f){case 1:return t.PERCENTILE.INC(h,.25);case 2:return t.PERCENTILE.INC(h,.5);case 3:return t.PERCENTILE.INC(h,.75);default:return r.num}};t.RANK={};t.RANK.AVG=function(h,f,b){h=w.parseNumber(h);f=w.parseNumberArray(w.flatten(f));if(w.anyIsError(h,f))return r.value;f=w.flatten(f);f=f.sort(b?function(g,l){return g-l}:function(g,l){return l-g});b=f.length;for(var c=0,e=0;e<b;e++)f[e]===h&&
c++;return 1<c?(2*f.indexOf(h)+c+1)/2:f.indexOf(h)+1};t.RANK.EQ=function(h,f,b){h=w.parseNumber(h);f=w.parseNumberArray(w.flatten(f));if(w.anyIsError(h,f))return r.value;f=f.sort(b?function(c,e){return c-e}:function(c,e){return e-c});return f.indexOf(h)+1};t.RSQ=function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumberArray(w.flatten(f));return w.anyIsError(h,f)?r.value:Math.pow(t.PEARSON(h,f),2)};t.SMALL=function(h,f){h=w.parseNumberArray(w.flatten(h));f=w.parseNumber(f);return w.anyIsError(h,
f)?h:h.sort(function(b,c){return b-c})[f-1]};t.STANDARDIZE=function(h,f,b){h=w.parseNumber(h);f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(h,f,b)?r.value:(h-f)/b};t.STDEV={};t.STDEV.P=function(){var h=t.VAR.P.apply(this,arguments);return Math.sqrt(h)};t.STDEV.S=function(){var h=t.VAR.S.apply(this,arguments);return Math.sqrt(h)};t.STDEVA=function(){var h=t.VARA.apply(this,arguments);return Math.sqrt(h)};t.STDEVPA=function(){var h=t.VARPA.apply(this,arguments);return Math.sqrt(h)};t.VAR=
{};t.VAR.P=function(){for(var h=w.numbers(w.flatten(arguments)),f=h.length,b=0,c=t.AVERAGE(h),e=0;e<f;e++)b+=Math.pow(h[e]-c,2);return b/f};t.VAR.S=function(){for(var h=w.numbers(w.flatten(arguments)),f=h.length,b=0,c=t.AVERAGE(h),e=0;e<f;e++)b+=Math.pow(h[e]-c,2);return b/(f-1)};t.VARA=function(){for(var h=w.flatten(arguments),f=h.length,b=0,c=0,e=t.AVERAGEA(h),g=0;g<f;g++){var l=h[g];b="number"===typeof l?b+Math.pow(l-e,2):!0===l?b+Math.pow(1-e,2):b+Math.pow(0-e,2);null!==l&&c++}return b/(c-1)};
t.VARPA=function(){for(var h=w.flatten(arguments),f=h.length,b=0,c=0,e=t.AVERAGEA(h),g=0;g<f;g++){var l=h[g];b="number"===typeof l?b+Math.pow(l-e,2):!0===l?b+Math.pow(1-e,2):b+Math.pow(0-e,2);null!==l&&c++}return b/c};t.WEIBULL={};t.WEIBULL.DIST=function(h,f,b,c){h=w.parseNumber(h);f=w.parseNumber(f);b=w.parseNumber(b);return w.anyIsError(h,f,b)?r.value:c?1-Math.exp(-Math.pow(h/b,f)):Math.pow(h,f-1)*Math.exp(-Math.pow(h/b,f))*f/Math.pow(b,f)};t.Z={};t.Z.TEST=function(h,f,b){h=w.parseNumberArray(w.flatten(h));
f=w.parseNumber(f);if(w.anyIsError(h,f))return r.value;b=b||t.STDEV.S(h);var c=h.length;return 1-t.NORM.S.DIST((t.AVERAGE(h)-f)/(b/Math.sqrt(c)),!0)};return t}();k.utils=function(){return{PROGRESS:function(t,h){return'<div style="width:'+(t?t:"0")+"%;height:4px;background-color:"+(h?h:"red")+';margin-top:1px;"></div>'},RATING:function(t){for(var h='<div class="jrating">',f=0;5>f;f++)h=f<t?h+'<div class="jrating-selected"></div>':h+"<div></div>";return h+"</div>"}}}();for(var v=0;v<Object.keys(k).length;v++)for(var d=
k[Object.keys(k)[v]],n=Object.keys(d),q=0;q<n.length;q++)if(d[n[q]])if("function"==typeof d[n[q]]||"object"==typeof d[n[q]]){if(window[n[q]]=d[n[q]],window[n[q]].toString=function(){return"#ERROR"},"object"==typeof d[n[q]])for(var y=Object.keys(d[n[q]]),a=0;a<y.length;a++)window[n[q]][y[a]].toString=function(){return"#ERROR"}}else window[n[q]]=function(){return n[q]+"Not implemented"};else window[n[q]]=function(){return n[q]+"Not implemented"};var x=null,A=null,H=null;window.TABLE=function(){return H};
window.COLUMN=window.COL=function(){return parseInt(x)+1};window.ROW=function(){return parseInt(A)+1};window.CELL=function(){return B.getColumnNameFromCoords(x,A)};window.VALUE=function(t,h,f){return H.getValueFromCoords(parseInt(t)-1,parseInt(h)-1,f)};window.THISROWCELL=function(t){return H.getValueFromCoords(parseInt(t)-1,parseInt(A))};var B=function(t,h,f,b,c){H=c;x=f;A=b;b="";c=Object.keys(h);if(c.length)for(f=0;f<c.length;f++)b=-1==c[f].indexOf(".")&&-1==c[f].indexOf("!")?b+("var "+c[f]+" = "+
h[c[f]]+";\n"):b+(c[f]+" = "+h[c[f]]+";\n");t=t.replace(/\$/g,"");t=t.replace(/!/g,".");h="";f=0;c=["=","!",">","<"];for(var e=0;e<t.length;e++)'"'==t[e]&&(f=0==f?1:0),1==f?h+=t[e]:(h+=t[e].toUpperCase(),0<e&&"="==t[e]&&-1==c.indexOf(t[e-1])&&-1==c.indexOf(t[e+1])&&(h+="="));h=h.replace(/\^/g,"**");h=h.replace(/<>/g,"!=");h=h.replace(/&/g,"+");t=h=h.replace(/\$/g,"");if((h=t.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g))&&h.length)for(f=0;f<h.length;f++)c=B.getTokensFromRange(h[f]),
t=t.replace(h[f],"["+c.join(",")+"]");return(new Function(b+"; return "+t))()};B.getColumnNameFromCoords=function(t,h){var f=parseInt(t),b="";701<f?(b+=String.fromCharCode(64+parseInt(f/676)),b+=String.fromCharCode(64+parseInt(f%676/26))):25<f&&(b+=String.fromCharCode(64+parseInt(f/26)));b+=String.fromCharCode(65+f%26);return b+(parseInt(h)+1)};B.getCoordsFromColumnName=function(t){var h=/^[a-zA-Z]+/.exec(t);if(h){for(var f=0,b=0;b<h[0].length;b++)f+=parseInt(h[0].charCodeAt(b)-64)*Math.pow(26,h[0].length-
1-b);f--;0>f&&(f=0);t=parseInt(/[0-9]+$/.exec(t))||null;0<t&&t--;return[f,t]}};B.getRangeFromTokens=function(t){t=t.filter(function(c){return"#REF!"!=c});for(var h="",f="",b=0;b<t.length;b++)0<=t[b].indexOf(".")?h=".":0<=t[b].indexOf("!")&&(h="!"),h&&(f=t[b].split(h),t[b]=f[1],f=f[0]+h);t.sort(function(c,e){var g=Helpers.getCoordsFromColumnName(c),l=Helpers.getCoordsFromColumnName(e);return g[1]>l[1]?1:g[1]<l[1]?-1:g[0]>l[0]?1:g[0]<l[0]?-1:0});return t.length?f+(t[0]+":"+t[t.length-1]):"#REF!"};B.getTokensFromRange=
function(t){if(0<t.indexOf(".")){var h=t.split(".");t=h[1];h=h[0]+"."}else 0<t.indexOf("!")?(h=t.split("!"),t=h[1],h=h[0]+"!"):h="";t=t.split(":");var f=B.getCoordsFromColumnName(t[0]),b=B.getCoordsFromColumnName(t[1]);if(f[0]<=b[0]){t=f[0];var c=b[0]}else t=b[0],c=f[0];if(null===f[1]&&null==b[1])for(var e=null,g=null,l=Object.keys(vars),p=0;p<l.length;p++){var u=B.getCoordsFromColumnName(l[p]);u[0]===f[0]&&(null===e||u[1]<e)&&(e=u[1]);u[0]===b[0]&&(null===g||u[1]>g)&&(g=u[1])}else f[1]<=b[1]?(e=
f[1],g=b[1]):(e=b[1],g=f[1]);for(f=[];e<=g;e++){b=[];for(p=t;p<=c;p++)b.push(h+B.getColumnNameFromCoords(p,e));f.push(b)}return f};B.setFormula=function(t){for(var h=Object.keys(t),f=0;f<h.length;f++)"function"==typeof t[h[f]]&&(window[h[f]]=t[h[f]])};return B}()})},{}],2:[function(T,S,U){(function(r,w){"object"===typeof U&&"undefined"!==typeof S?S.exports=w():r.jSuites=w()})(this,function(){var r=function(k){var v={},d=function(q,y){return q[y.type]&&q[y.type]==y?!0:q.parentNode?d(q.parentNode,y):
!1},n=function(q){if(0<r.current.length)for(var y=0;y<r.current.length;y++)r.current[y]&&!d(q.target,r.current[y])&&r.current[y].close()};v.init=function(){document.addEventListener("click",n);v.version="4.9.0"};v.tracking=function(q,y){if(1==y)r.current=r.current.filter(function(x){return null!==x}),setTimeout(function(){r.current.push(q)},0);else{var a=r.current.indexOf(q);0<=a&&(r.current[a]=null)}};v.path=function(q,y){q=q.split(".");if(q.length){for(var a=this,x;1<q.length;){x=q.shift();if(!a.hasOwnProperty(x)){if(void 0===
y)return;a[x]={}}a=a[x]}x=q.shift();return void 0!==y?(a[x]=y,!0):a[x]}return!1};v.setDictionary=function(q){v.dictionary=q;for(var y=0;y<r.calendar.weekdays.length;y++)q=r.translate(r.calendar.weekdays[y]),r.calendar.weekdays[y]&&(r.calendar.weekdays[y]=q,r.calendar.weekdaysShort[y]=q.substr(0,3));for(y=0;y<r.calendar.months.length;y++)if(q=r.translate(r.calendar.months[y]))r.calendar.months[y]=q,r.calendar.monthsShort[y]=q.substr(0,3)};v.dictionary={};v.translate=function(q){return v.dictionary[q]||
q};v.current=[];return v}();"undefined"!==typeof document&&r.init();r.ajax=function(k,v){if(Array.isArray(k)){var d={instance:[],complete:v};if(0<k.length)for(var n=0;n<k.length;n++)k[n].multiple=d,d.instance.push(r.ajax(k[n]));return d}k.data||(k.data={});k.type&&(k.method=k.type);k.method||(k.method="GET");k.dataType||(k.dataType="json");if(k.data){var q=function(A,H){var B=[],t=Object.keys(A);if(t.length)for(var h=0;h<t.length;h++){var f=H?H+"["+t[h]+"]":t[h];if("object"==typeof A[t[h]]){f=q(A[t[h]],
f);for(var b=Object.keys(f),c=0;c<b.length;c++)B[b[c]]=f[b[c]]}else B[f]=A[t[h]]}return B};d=[];var y=q(k.data),a=Object.keys(y);for(n=0;n<a.length;n++)d.push(a[n]+"="+encodeURIComponent(y[a[n]]));"GET"==k.method&&0<d.length&&(0>k.url.indexOf("?")&&(k.url+="?"),k.url+=d.join("&"))}var x=new XMLHttpRequest;x.open(k.method,k.url,!0);x.setRequestHeader("X-Requested-With","XMLHttpRequest");"POST"==k.method?(x.setRequestHeader("Accept","application/json"),x.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):
"json"==k.dataType?x.setRequestHeader("Content-Type","text/json"):"blob"==k.dataType?x.responseType="blob":"html"==k.dataType&&x.setRequestHeader("Content-Type","text/html");1!=k.cache&&(x.setRequestHeader("pragma","no-cache"),x.setRequestHeader("cache-control","no-cache"));1==k.withCredentials&&(x.withCredentials=!0);"function"==typeof k.beforeSend&&k.beforeSend(x);x.onload=function(){if(200===x.status)if("json"==k.dataType)try{var A=JSON.parse(x.responseText);k.success&&"function"==typeof k.success&&
k.success(A)}catch(B){k.error&&"function"==typeof k.error&&k.error(B,A)}else A="blob"==k.dataType?x.response:x.responseText,k.success&&"function"==typeof k.success&&k.success(A);else k.error&&"function"==typeof k.error&&k.error(x.responseText,x.status);r.ajax.queue&&0<r.ajax.queue.length&&r.ajax.send(r.ajax.queue.shift());if(r.ajax.requests&&r.ajax.requests.length){var H=r.ajax.requests.indexOf(x);r.ajax.requests.splice(H,1);r.ajax.requests.length||k.complete&&"function"==typeof k.complete&&k.complete(A);
k.group&&r.ajax.oncomplete&&"function"==typeof r.ajax.oncomplete[k.group]&&!r.ajax.pending(k.group)&&(r.ajax.oncomplete[k.group](),r.ajax.oncomplete[k.group]=null);k.multiple&&k.multiple.instance&&(H=k.multiple.instance.indexOf(x),k.multiple.instance.splice(H,1),k.multiple.instance.length||k.multiple.complete&&"function"==typeof k.multiple.complete&&k.multiple.complete(A))}};x.options=k;x.data=d;1==k.queue&&0<r.ajax.requests.length?r.ajax.queue.push(x):r.ajax.send(x);return x};r.ajax.send=function(k){k.data?
k.send(k.data.join("&")):k.send();r.ajax.requests.push(k)};r.ajax.exists=function(k,v){var d=new XMLHttpRequest;d.open("HEAD",k,!1);d.send();d.status&&v(d.status)};r.ajax.pending=function(k){var v=0,d=r.ajax.requests;if(d&&d.length)for(var n=0;n<d.length;n++)k&&k!=d[n].options.group||v++;return v};r.ajax.oncomplete={};r.ajax.requests=[];r.ajax.queue=[];r.alert=function(k){800>r.getWindowWidth()&&r.dialog?r.dialog.open({title:"Alert",message:k}):alert(k)};r.animation={};r.animation.slideLeft=function(k,
v,d){1==v?(k.classList.add("slide-left-in"),setTimeout(function(){k.classList.remove("slide-left-in");"function"==typeof d&&d()},400)):(k.classList.add("slide-left-out"),setTimeout(function(){k.classList.remove("slide-left-out");"function"==typeof d&&d()},400))};r.animation.slideRight=function(k,v,d){1==v?(k.classList.add("slide-right-in"),setTimeout(function(){k.classList.remove("slide-right-in");"function"==typeof d&&d()},400)):(k.classList.add("slide-right-out"),setTimeout(function(){k.classList.remove("slide-right-out");
"function"==typeof d&&d()},400))};r.animation.slideTop=function(k,v,d){1==v?(k.classList.add("slide-top-in"),setTimeout(function(){k.classList.remove("slide-top-in");"function"==typeof d&&d()},400)):(k.classList.add("slide-top-out"),setTimeout(function(){k.classList.remove("slide-top-out");"function"==typeof d&&d()},400))};r.animation.slideBottom=function(k,v,d){1==v?(k.classList.add("slide-bottom-in"),setTimeout(function(){k.classList.remove("slide-bottom-in");"function"==typeof d&&d()},400)):(k.classList.add("slide-bottom-out"),
setTimeout(function(){k.classList.remove("slide-bottom-out");"function"==typeof d&&d()},100))};r.animation.fadeIn=function(k,v){k.style.display="";k.classList.add("fade-in");setTimeout(function(){k.classList.remove("fade-in");"function"==typeof v&&v()},2E3)};r.animation.fadeOut=function(k,v){k.classList.add("fade-out");setTimeout(function(){k.style.display="none";k.classList.remove("fade-out");"function"==typeof v&&v()},1E3)};r.calendar=function(k,v){if(k.calendar)return k.calendar.setOptions(v,!0);
var d={type:"calendar",options:{},date:null,setOptions:function(m,z){for(var D={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:r.calendar.monthsShort,monthsFull:r.calendar.months,weekdays:r.calendar.weekdays,weekdays_short:r.calendar.weekdays,textDone:r.translate("Done"),textReset:r.translate("Reset"),textUpdate:r.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,
mode:null,position:null,dataType:null},E=0;E<D.weekdays_short.length;E++)D.weekdays_short[E]=D.weekdays_short[E].substr(0,1);for(var C in D)if(m&&m.hasOwnProperty(C))d.options[C]=m[C];else if("undefined"==typeof d.options[C]||!0===z)d.options[C]=D[C];x.style.display=0==d.options.resetButton?"none":"";d.options.readonly?k.setAttribute("readonly","readonly"):k.removeAttribute("readonly");d.options.placeholder?k.setAttribute("placeholder",d.options.placeholder):k.removeAttribute("placeholder");r.isNumeric(d.options.value)&&
0<d.options.value&&(d.options.value=r.calendar.numToDate(d.options.value),d.options.dataType="numeric");x.innerHTML=d.options.textReset;A.innerHTML=d.options.textDone;l.innerHTML=d.options.textUpdate;k.setAttribute("data-mask",d.options.format.toLowerCase());if(D=!d.options.value&&d.options.today?r.calendar.now():d.options.value)d.options.value=null,d.setValue(D);return d},open:function(m){if(!a.classList.contains("jcalendar-focus")&&!a.classList.contains("jcalendar-inline")){r.calendar.current=d;
r.tracking(d,!0);d.getDays();"year-month-picker"==d.options.type&&d.getMonths();d.options.time&&(p.value=d.date[3],u.value=d.date[4]);a.classList.add("jcalendar-focus");if(800>r.getWindowWidth()||d.options.fullscreen)a.classList.add("jcalendar-fullsize"),r.animation.slideBottom(B,1);else{a.classList.remove("jcalendar-fullsize");m=k.getBoundingClientRect();var z=B.getBoundingClientRect();if(d.options.position)H.style.position="fixed",H.style.top=window.innerHeight<m.bottom+z.height?m.top-(z.height+
2)+"px":m.top+m.height+2+"px",H.style.left=m.left+"px";else{if(window.innerHeight<m.bottom+z.height){var D=-1*(m.height+z.height+2);0>D+m.top&&(D=-1*(m.top+m.height));H.style.top=D+"px"}else H.style.top="2px";window.innerWidth<m.left+z.width?(D=window.innerWidth-(m.left+z.width+20),H.style.left=D+"px"):H.style.left="0px"}}if("function"==typeof d.options.onopen)d.options.onopen(k)}},close:function(m,z){if(a.classList.contains("jcalendar-focus")){if(!1!==z){var D=a.querySelector(".jcalendar-selected");
D="string"==typeof z?z:!D||D.classList.contains("jcalendar-disabled")?d.options.value:d.getValue();d.setValue(D)}if(!m&&"function"==typeof d.options.onclose)d.options.onclose(k);a.classList.remove("jcalendar-focus");r.tracking(d,!1);r.calendar.current=null}return d.options.value},prev:function(){"years"==d.options.mode?(d.date[0]-=12,d.getYears()):"months"==d.options.mode?(d.date[0]=parseInt(d.date[0])-1,d.getMonths()):(2>d.date[1]?(--d.date[0],d.date[1]=12):--d.date[1],d.getDays())},next:function(){"years"==
d.options.mode?(d.date[0]=parseInt(d.date[0])+12,d.getYears()):"months"==d.options.mode?(d.date[0]=parseInt(d.date[0])+1,d.getMonths()):(11<d.date[1]?(d.date[0]=parseInt(d.date[0])+1,d.date[1]=1):d.date[1]=parseInt(d.date[1])+1,d.getDays())},setToday:function(){var m=(new Date).toISOString().substr(0,10);d.setValue(m);return m},setValue:function(m){m||(m=""+m);var z=m,D=d.options.value;if(D!=z){if(z){d.setLabel(z,d.options);var E=z.split(" ");E[1]||(E[1]="00:00:00");var C=E[1].split(":");E=E[0].split("-");
m=parseInt(E[0]);var F=parseInt(E[1]);E=parseInt(E[2]);var I=parseInt(C[0]);C=parseInt(C[1]);d.date=[m,F,E,I,C,0];m=d.setLabel(z,d.options)}else d.date=null,m="";d.options.value=z;if("function"==typeof d.options.onchange)d.options.onchange(k,z,D);if(k.value!=m&&(k.value=m,"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value})}d.getDays()},getValue:function(){return d.date?d.options.time?r.two(d.date[0])+"-"+r.two(d.date[1])+"-"+r.two(d.date[2])+" "+r.two(d.date[3])+":"+
r.two(d.date[4])+":"+r.two(0):r.two(d.date[0])+"-"+r.two(d.date[1])+"-"+r.two(d.date[2])+" "+r.two(0)+":"+r.two(0)+":"+r.two(0):""},update:function(m,z){if(!m.classList.contains("jcalendar-disabled")){var D=a.querySelector(".jcalendar-selected");D&&D.classList.remove("jcalendar-selected");m.classList.add("jcalendar-selected");m.classList.contains("jcalendar-set-month")?d.date[1]=z:d.date[2]=m.innerText;d.options.time?(d.date[3]=p.value,d.date[4]=u.value):d.close()}y()},reset:function(){d.setValue("");
d.date=null;d.close(!1,!1)},getDays:function(){d.options.mode="days";var m=new Date,z=d.date&&r.isNumeric(d.date[0])?d.date[0]:parseInt(m.getFullYear()),D=d.date&&r.isNumeric(d.date[1])?d.date[1]:parseInt(m.getMonth())+1,E=d.date&&r.isNumeric(d.date[2])?d.date[2]:parseInt(m.getDate()),C=d.date&&r.isNumeric(d.date[3])?d.date[3]:parseInt(m.getHours()),F=d.date&&r.isNumeric(d.date[4])?d.date[4]:parseInt(m.getMinutes());d.date=[z,D,E,C,F,0];t.innerHTML=z;h.innerHTML=d.options.months[D-1];C=m.getMonth()==
D-1&&m.getFullYear()==z?!0:!1;F=m.getDate();m=new Date(z,D,0,0,0);var I=m.getDate();m=new Date(z,D-1,0,0,0);m=m.getDay()+1;var J=d.options.startingDay||0;m-=J;b.innerHTML="";var M=document.createElement("tr");M.setAttribute("align","center");b.appendChild(M);for(var P=0;7>P;P++){var N=document.createElement("td");N.classList.add("jcalendar-weekday");N.innerHTML=d.options.weekdays_short[J];M.appendChild(N);J++;6<J&&(J=0)}for(var G=J=0,K=0;6>K;K++){M=document.createElement("tr");M.setAttribute("align",
"center");var L=!0;for(P=0;7>P;P++){N=document.createElement("td");N.classList.add("jcalendar-set-day");if(J>=m&&J<m+I){G++;N.innerHTML=G;G==E&&N.classList.add("jcalendar-selected");C&&F==G&&(N.style.fontWeight="bold");L=r.calendar.now(new Date(z,D-1,G),!0);if(d.options.validRange){var O=!d.options.validRange[1]||L<=d.options.validRange[1]?!0:!1;(!d.options.validRange[0]||L>=d.options.validRange[0])&&O||N.classList.add("jcalendar-disabled")}L=!1}M.appendChild(N);J++}0==L&&b.appendChild(M)}e.style.display=
d.options.time?"":"none";y()},getMonths:function(){d.options.mode="months";var m=d.options.months,z=new Date,D=parseInt(z.getFullYear());z=parseInt(z.getMonth())+1;var E=d.date&&r.isNumeric(d.date[0])?d.date[0]:D,C=d.date&&r.isNumeric(d.date[1])?d.date[1]:z;t.innerHTML=d.date[0];h.innerHTML=m[C-1];var F=document.createElement("table");F.setAttribute("width","100%");for(var I=null,J=0;12>J;J++){J%4||(I=document.createElement("tr"),I.setAttribute("align","center"),F.appendChild(I));var M=document.createElement("td");
M.classList.add("jcalendar-set-month");M.setAttribute("data-value",J+1);M.innerText=m[J];if(d.options.validRange){var P=E+"-"+r.two(J+1),N=!d.options.validRange[0]||P>=d.options.validRange[0].substr(0,7)?!0:!1;P=!d.options.validRange[1]||P<=d.options.validRange[1].substr(0,7)?!0:!1;N&&P||M.classList.add("jcalendar-disabled")}J+1==C&&M.classList.add("jcalendar-selected");D==E&&J+1==z&&(M.style.fontWeight="bold");I.appendChild(M)}b.innerHTML='<tr><td colspan="7"></td></tr>';b.children[0].children[0].appendChild(F);
y()},getYears:function(){d.options.mode="years";var m=new Date,z=m.getFullYear();m=d.date&&r.isNumeric(d.date[0])?d.date[0]:parseInt(m.getFullYear());for(var D=[],E=0;25>E;E++)D[E]=parseInt(d.date[0])+(E-12);var C=document.createElement("table");C.setAttribute("width","100%");for(E=0;25>E;E++){if(!(E%5)){var F=document.createElement("tr");F.setAttribute("align","center");C.appendChild(F)}var I=document.createElement("td");I.classList.add("jcalendar-set-year");I.innerText=D[E];m==D[E]&&I.classList.add("jcalendar-selected");
z==D[E]&&(I.style.fontWeight="bold");F.appendChild(I)}b.innerHTML='<tr><td colspan="7"></td></tr>';b.firstChild.firstChild.appendChild(C);y()},setLabel:function(m,z){return r.calendar.getDateString(m,z)},fromFormatted:function(m,z){return r.calendar.extractDateFromString(m,z)}},n=function(m){if(r.findElement(m.target,"jcalendar-container")){var z=m.target.className;"jcalendar-prev"==z?d.prev():"jcalendar-next"==z?d.next():"jcalendar-month"==z?d.getMonths():"jcalendar-year"==z?d.getYears():"jcalendar-set-year"==
z?(d.date[0]=m.target.innerText,"year-month-picker"==d.options.type?d.getMonths():d.getDays()):m.target.classList.contains("jcalendar-set-month")?(z=parseInt(m.target.getAttribute("data-value")),"year-month-picker"==d.options.type?d.update(m.target,z):(d.date[1]=z,d.getDays())):"jcalendar-confirm"==z||"jcalendar-update"==z||"jcalendar-close"==z?d.close():"jcalendar-backdrop"==z?d.close(!1,!1):"jcalendar-reset"==z?d.reset():m.target.classList.contains("jcalendar-set-day")&&m.target.innerText&&d.update(m.target)}else d.close()},
q=function(m){m.target.value&&3<m.target.value.length&&(m=r.calendar.extractDateFromString(m.target.value,d.options.format))&&d.setValue(m)},y=function(){var m=a.querySelector(".jcalendar-selected");m&&m.classList.contains("jcalendar-disabled")?(l.setAttribute("disabled","disabled"),p.setAttribute("disabled","disabled"),u.setAttribute("disabled","disabled")):(l.removeAttribute("disabled"),p.removeAttribute("disabled"),u.removeAttribute("disabled"));if("function"==typeof d.options.onupdate)d.options.onupdate(k,
d.getValue())},a=null,x=null,A=null,H=null,B=null,t=null,h=null,f=null,b=null,c=null,e=null,g=null,l=null,p=null,u=null;(function(){"INPUT"==k.tagName&&k.value&&(v.value=k.value);x=document.createElement("div");x.className="jcalendar-reset";A=document.createElement("div");A.className="jcalendar-confirm";c=document.createElement("div");c.className="jcalendar-controls";c.style.borderBottom="1px solid #ddd";c.appendChild(x);c.appendChild(A);H=document.createElement("div");H.className="jcalendar-container";
B=document.createElement("div");B.className="jcalendar-content";H.appendChild(B);"DIV"==k.tagName?(a=k,a.classList.add("jcalendar-inline")):(B.appendChild(c),a=document.createElement("div"),a.className="jcalendar");a.classList.add("jcalendar-container");a.appendChild(H);var m=document.createElement("div");m.className="jcalendar-table";B.appendChild(m);var z=document.createElement("td");z.setAttribute("colspan","2");z.className="jcalendar-prev";t=document.createElement("span");t.className="jcalendar-year";
h=document.createElement("span");h.className="jcalendar-month";var D=document.createElement("td");D.className="jcalendar-header";D.setAttribute("colspan","3");D.appendChild(h);D.appendChild(t);var E=document.createElement("td");E.setAttribute("colspan","2");E.className="jcalendar-next";var C=document.createElement("thead"),F=document.createElement("tr");F.appendChild(z);F.appendChild(D);F.appendChild(E);C.appendChild(F);f=document.createElement("table");b=document.createElement("tbody");f.setAttribute("cellpadding",
"0");f.setAttribute("cellspacing","0");f.appendChild(C);f.appendChild(b);m.appendChild(f);p=document.createElement("select");p.className="jcalendar-select";p.onchange=function(){d.date[3]=this.value;if("function"==typeof d.options.onupdate)d.options.onupdate(k,d.getValue())};for(m=0;24>m;m++)z=document.createElement("option"),z.value=m,z.innerHTML=r.two(m),p.appendChild(z);u=document.createElement("select");u.className="jcalendar-select";u.onchange=function(){d.date[4]=this.value;if("function"==typeof d.options.onupdate)d.options.onupdate(k,
d.getValue())};for(m=0;60>m;m++)z=document.createElement("option"),z.value=m,z.innerHTML=r.two(m),u.appendChild(z);m=document.createElement("div");m.className="jcalendar-controls";e=document.createElement("div");e.className="jcalendar-time";e.style.maxWidth="140px";e.appendChild(p);e.appendChild(u);l=document.createElement("button");l.setAttribute("type","button");l.className="jcalendar-update";g=document.createElement("div");g.style.flexGrow="10";g.appendChild(l);m.appendChild(e);"INPUT"==k.tagName&&
m.appendChild(g);B.appendChild(m);m=document.createElement("div");m.className="jcalendar-backdrop";a.appendChild(m);k.addEventListener("keyup",q);a.addEventListener("swipeleft",function(I){r.animation.slideLeft(f,0,function(){d.next();r.animation.slideRight(f,1)});I.preventDefault();I.stopPropagation()});a.addEventListener("swiperight",function(I){r.animation.slideRight(f,0,function(){d.prev();r.animation.slideLeft(f,1)});I.preventDefault();I.stopPropagation()});k.onmouseup=function(){d.open()};!0===
"ontouchend"in document.documentElement?a.addEventListener("touchend",n):a.addEventListener("mouseup",n);r.calendar.hasEvents||(r.calendar.hasEvents=!0,document.addEventListener("keydown",r.calendar.keydown));d.setOptions(v);"INPUT"==k.tagName?(k.parentNode.insertBefore(a,k.nextSibling),k.setAttribute("autocomplete","off"),k.classList.add("jcalendar-input"),k.value=d.setLabel(d.getValue(),d.options)):(d.getDays(),d.options.time&&(p.value=d.date[3],u.value=d.date[4]));1==d.options.opened&&d.open();
k.change=d.setValue;k.val=function(I){if(void 0===I)return d.getValue();d.setValue(I)};k.calendar=a.calendar=d})();return d};r.calendar.keydown=function(k){var v;if(v=r.calendar.current)13==k.which?v.close(!1,!0):27==k.which&&v.close(!1,!1)};r.calendar.prettify=function(k,v){v||(v={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var d=parseInt((new Date-new Date(k))/1E3/60);String.prototype.format=
function(n){return this.replace("{0}",n)};return 0==d?v.justNow:90>d?v.xMinutesAgo.format(d):1440>d?v.xHoursAgo.format(Math.round(d/60)):20160>d?v.xDaysAgo.format(Math.round(d/1440)):43200>d?v.xWeeksAgo.format(Math.round(d/10080)):1036800>d?v.xMonthsAgo.format(Math.round(d/43200)):v.xYearsAgo.format(Math.round(d/525600))};r.calendar.prettifyAll=function(){for(var k=document.querySelectorAll(".prettydate"),v=0;v<k.length;v++)k[v].getAttribute("data-date")?k[v].innerHTML=r.calendar.prettify(k[v].getAttribute("data-date")):
(k[v].setAttribute("data-date",k[v].innerHTML),k[v].innerHTML=r.calendar.prettify(k[v].innerHTML))};r.calendar.now=function(k,v){if(Array.isArray(k))var d=k[0],n=k[1],q=k[2],y=k[3],a=k[4],x=k[5];else k||(k=new Date),d=k.getFullYear(),n=k.getMonth()+1,q=k.getDate(),y=k.getHours(),a=k.getMinutes(),x=k.getSeconds();return 1==v?r.two(d)+"-"+r.two(n)+"-"+r.two(q):r.two(d)+"-"+r.two(n)+"-"+r.two(q)+" "+r.two(y)+":"+r.two(a)+":"+r.two(x)};r.calendar.toArray=function(k){var v=k.split(-1!==k.indexOf("T")?
"T":" "),d=v[1];v=v[0].split("-");k=parseInt(v[0]);var n=parseInt(v[1]);v=parseInt(v[2]);if(d){d=d.split(":");var q=parseInt(d[0]);d=parseInt(d[1])}else d=q=0;return[k,n,v,q,d,0]};r.calendar.extractDateFromString=function(k,v){if(0<k&&Number(k)==k){var d=new Date(Math.round(864E5*(k-25569)));return d.getFullYear()+"-"+r.two(d.getMonth())+"-"+r.two(d.getDate())+" 00:00:00"}var n=""+k,q=v.replace(/[0-9]/g,""),y=1,a=q.search("YYYY");a=n.substr(a,4);parseInt(a)!=a&&(y=0);var x=q.search("MM");x=n.substr(x,
2);if(parseInt(x)!=x||12<x)y=0;d=q.search("DD");d=n.substr(d,2);if(parseInt(d)!=d||31<d)y=0;var A=q.search("HH");if(0<=A){if(A=n.substr(A,2),!parseInt(A)||23<A)A="00"}else A="00";var H=q.search("MI");if(0<=H){if(H=n.substr(H,2),!parseInt(H)||59<H)H="00"}else H="00";var B=q.search("SS");if(0<=B){if(B=n.substr(B,2),!parseInt(B)||59<B)B="00"}else B="00";return 1==y&&k.length==q.length?a+"-"+x+"-"+d+" "+A+":"+H+":"+B:""};r.calendar.dateToNum=function(k,v){k=new Date(k);v||(v="1899-12-30 "+k.getHours()+
":"+k.getMinutes()+":"+k.getSeconds());v=new Date(v);var d=k.getTime()-v.getTime();return Math.round(d/864E5)};r.calendar.numToDate=function(k){k=new Date(Math.round(864E5*(k-25569)));return k.getFullYear()+"-"+r.two(k.getMonth()+1)+"-"+r.two(k.getDate())+" 00:00:00"};r.calendar.getDateString=function(k,v){v||(v={});var d=v&&"object"==typeof v?v.format:v;d||(d="YYYY-MM-DD");if("number"==typeof k&&0<=d.indexOf("[h]")){var n=parseFloat(24*Number(k));if(0<=d.indexOf("mm")){var q=(""+n).split(".");q[1]?
(n=60*parseFloat("0."+q[1]),n=parseFloat(n.toFixed(2))):n=0;n=parseInt(q[0])+":"+r.two(n)}return n}k instanceof Date?k=r.calendar.now(k):k&&r.isNumeric(k)&&(k=r.calendar.numToDate(k));d=d.match(RegExp("DAY|WD|DDDD|DDD|DD|D|Q|HH24|HH12|HH|H|AM/PM|MI|SS|MS|YYYY|YYY|YY|Y|MONTH|MON|MMMMM|MMMM|MMM|MM|M|.","gi"));for(n=0;n<d.length;n++)"MM"==d[n].toUpperCase()&&(d[n-1]&&0<=d[n-1].toUpperCase().indexOf("H")?d[n]="mi":d[n-2]&&0<=d[n-2].toUpperCase().indexOf("H")?d[n]="mi":d[n+1]&&0<=d[n+1].toUpperCase().indexOf("S")?
d[n]="mi":d[n+2]&&0<=d[n+2].toUpperCase().indexOf("S")&&(d[n]="mi"));var y;if(k){n=""+k;q=-1!==n.indexOf("T")?"T":" ";n=n.split(q);var a=y=q=0;n[1]&&(q=n[1].split(":"),y=q[1]?q[1]:0,a=q[2]?q[2]:0,q=q[0]?q[0]:0);n=n[0].split("-");if(n[0]&&n[1]&&n[2]&&0<n[0]&&0<n[1]&&13>n[1]&&0<n[2]&&32>n[2]){q=[n[0],n[1],n[2],q,y,a];y=[];a=new Date(q[0],q[1]-1,q[2],q[3],q[4],q[5]);for(n=0;n<d.length;n++){var x=n,A=d[x],H=A.toUpperCase(),B=null;"YYYY"===H?B=q[0]:"YYY"===H?B=q[0].substring(1,4):"YY"===H?B=q[0].substring(2,
4):"Y"===H?B=q[0].substring(3,4):"MON"===A?B=r.calendar.months[a.getMonth()].substr(0,3).toUpperCase():"mon"===A?B=r.calendar.months[a.getMonth()].substr(0,3).toLowerCase():"MONTH"===A?B=r.calendar.months[a.getMonth()].toUpperCase():"month"===A?B=r.calendar.months[a.getMonth()].toLowerCase():"MMMMM"===H?B=r.calendar.months[a.getMonth()].substr(0,1):"MMMM"===H||"Month"===A?B=r.calendar.months[a.getMonth()]:"MMM"===H||"Mon"==A?B=r.calendar.months[a.getMonth()].substr(0,3):"MM"===H?B=r.two(q[1]):"M"===
H?B=a.getMonth()+1:"DAY"===A?B=r.calendar.weekdays[a.getDay()].toUpperCase():"day"===A?B=r.calendar.weekdays[a.getDay()].toLowerCase():"DDDD"===H||"Day"==A?B=r.calendar.weekdays[a.getDay()]:"DDD"===H?B=r.calendar.weekdays[a.getDay()].substr(0,3):"DD"===H?B=r.two(q[2]):"D"===H?B=q[2]:"Q"===H?B=Math.floor((a.getMonth()+3)/3):"HH24"===H||"HH"===H?B=r.two(q[3]):"HH12"===H?B=12<q[3]?r.two(q[3]-12):r.two(q[3]):"H"===H?B=q[3]:"MI"===H?B=r.two(q[4]):"SS"===H?B=r.two(q[5]):"MS"===H?B=a.getMilliseconds():"AM/PM"===
H?B=12<=q[3]?"PM":"AM":"WD"===H&&(B=r.calendar.weekdays[a.getDay()]);y[x]=null===B?d[x]:B}k=y.join("")}else k=""}return k};r.calendar.weekdays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");r.calendar.months="January February March April May June July August September October November December".split(" ");r.calendar.weekdaysShort="Sun Mon Tue Wed Thu Fri Sat".split(" ");r.calendar.monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");r.color=function(k,v){if(k.color)return k.color.setOptions(v,
!0);var d={type:"color",options:{}},n=null,q=null,y=null,a=null,x=null,A=null,H=null;d.setOptions=function(m,z){var D={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};m||(m={});m&&!m.palette&&(m.palette=r.palette());for(var E in D)if(m&&m.hasOwnProperty(E))d.options[E]=m[E];else if("undefined"==typeof d.options[E]||!0===z)d.options[E]=D[E];a&&(a.innerHTML=d.options.resetLabel);
x&&(x.innerHTML=d.options.doneLabel);d.options.palette&&H&&H.updateContent(0,f());"string"===typeof d.options.value&&(k.value=d.options.value);d.options.placeholder?k.setAttribute("placeholder",d.options.placeholder):k.getAttribute("placeholder")&&k.removeAttribute("placeholder");return d};d.open=function(){if(!n.classList.contains("jcolor-focus")){r.tracking(d,!0);n.classList.add("jcolor-focus");var m=y.getBoundingClientRect();if(800>r.getWindowWidth()||1==d.options.fullscreen)y.style.top="",y.classList.add("jcolor-fullscreen"),
r.animation.slideBottom(y,1),q.style.display="block";else{y.classList.contains("jcolor-fullscreen")&&(y.classList.remove("jcolor-fullscreen"),q.style.display="");var z=k.getBoundingClientRect();d.options.position?(y.style.position="fixed",y.style.top=window.innerHeight<z.bottom+m.height?z.top-(m.height+2)+"px":z.top+z.height+2+"px",y.style.left=z.left+"px"):y.style.top=window.innerHeight<z.bottom+m.height?-1*(m.height+z.height+2)+"px":"2px"}if("function"==typeof d.options.onopen)d.options.onopen(k);
H.setBorder(H.getActive());if(d.options.value){var D=h(d.options.value);p.forEach(function(E,C){E.value=D[C];E.dispatchEvent(new Event("input"))})}}};d.close=function(m){if(n.classList.contains("jcolor-focus")){n.classList.remove("jcolor-focus");q.style.display="";if(!m&&"function"==typeof d.options.onclose)d.options.onclose(k);r.tracking(d,!1)}return d.options.value};d.setValue=function(m){m||(m="");if(m!=d.options.value){l=d.options.value=m;var z=n.querySelector(".jcolor-selected");z&&z.classList.remove("jcolor-selected");
d.values[m]&&d.values[m].classList.add("jcolor-selected");if("function"==typeof d.options.onchange)d.options.onchange(k,m);if(k.value!=d.options.value&&(k.value=d.options.value,"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value});1==d.options.closeOnChange&&d.close()}};d.getValue=function(){return d.options.value};var B=!1,t=function(m){m=m.toString(16);return 1===m.length?"0"+m:m},h=function(m){return[parseInt("0x"+m.substr(1,2)),parseInt("0x"+m.substr(3,2)),parseInt("0x"+
m.substr(5,2))]},f=function(){var m=document.createElement("div");m.className="jcolor-grid";d.values=[];var z=document.createElement("table");z.setAttribute("cellpadding","7");z.setAttribute("cellspacing","0");for(var D=0;D<d.options.palette.length;D++){for(var E=document.createElement("tr"),C=0;C<d.options.palette[D].length;C++){var F=document.createElement("td"),I=d.options.palette[D][C];7>I.length&&"#"!==I.substr(0,1)&&(I="#"+I);F.style.backgroundColor=I;F.setAttribute("data-value",I);F.innerHTML=
"";E.appendChild(F);d.options.value==I&&F.classList.add("jcolor-selected");d.values[I]=F}z.appendChild(E)}m.appendChild(z);m.addEventListener("mousedown",function(J){"TD"==J.target.tagName&&(J=J.target.getAttribute("data-value"))&&d.setValue(J)});return m},b=document.createElement("canvas");b.width=200;b.height=160;var c=b.getContext("2d"),e=function(){var m=A.firstChild.getBoundingClientRect();b.width=m.width-14;m=c.createLinearGradient(0,0,b.width,0);m.addColorStop(0,"rgb(255,0,0)");m.addColorStop(.15,
"rgb(255,0,255)");m.addColorStop(.33,"rgb(0,0,255)");m.addColorStop(.49,"rgb(0,255,255)");m.addColorStop(.67,"rgb(0,255,0)");m.addColorStop(.84,"rgb(255,255,0)");m.addColorStop(1,"rgb(255,0,0)");c.fillStyle=m;c.fillRect(0,0,b.width,b.height);m=c.createLinearGradient(0,0,0,b.height);m.addColorStop(0,"rgba(255,255,255,1)");m.addColorStop(.5,"rgba(255,255,255,0)");m.addColorStop(.5,"rgba(0,0,0,0)");m.addColorStop(1,"rgba(0,0,0,1)");c.fillStyle=m;c.fillRect(0,0,b.width,b.height)},g=function(){var m=document.createElement("div");
m.className="jcolor-hsl";var z=document.createElement("div");z.className="jcolor-point";var D=document.createElement("div");D.appendChild(b);D.appendChild(z);m.appendChild(D);var E=function(C,F,I){1===C&&(C=m.getBoundingClientRect(),F-=C.left,I-=C.top,0>F&&(F=0),0>I&&(I=0),F>C.width&&(F=C.width),I>C.height&&(I=C.height),z.style.left=F+"px",z.style.top=I+"px",I=c.getImageData(F,I,1,1).data,C=I[1],F=I[2],l="#"+t(I[0])+t(C)+t(F))};m.addEventListener("mousedown",function(C){E(C.buttons,C.clientX,C.clientY)});
m.addEventListener("mousemove",function(C){E(C.buttons,C.clientX,C.clientY)});m.addEventListener("touchmove",function(C){E(1,C.changedTouches[0].clientX,C.changedTouches[0].clientY)});return m},l="",p=[],u=function(){var m=document.createElement("div");m.className="jcolor-sliders";var z=document.createElement("div"),D=function(C){var F=document.createElement("div");F.className="jcolor-sliders-input-container";var I=document.createElement("label");I.innerText=C;C=document.createElement("div");C.className=
"jcolor-sliders-input-subcontainer";var J=document.createElement("input");J.type="range";J.min=0;J.max=255;J.value=0;F.appendChild(I);C.appendChild(J);var M=document.createElement("div");M.innerText=J.value;J.addEventListener("input",function(){M.innerText=J.value});C.appendChild(M);F.appendChild(C);z.appendChild(F);return J};p=[D("Red"),D("Green"),D("Blue")];m.appendChild(z);D=document.createElement("div");D.className="jcolor-sliders-final-color";var E=document.createElement("div");E.style.visibility=
"hidden";E.innerText="a";D.appendChild(E);p.forEach(function(C){C.addEventListener("input",function(){var F=parseInt(p[0].value);var I=parseInt(p[1].value),J=parseInt(p[2].value);F="#"+t(F)+t(I)+t(J);E.innerText=F;E.style.color=F;E.style.removeProperty("visibility");l=F;if(""!==l)for(F=0;F<p.length;F++)I=h(l),I[F]=0,J="linear-gradient(90deg, rgb(",J+=I.join(", "),J+="), rgb(",I[F]=255,J+=I.join(", "),J+="))",p[F].style.backgroundImage=J})});m.appendChild(D);return m};(function(){d.setOptions(v);"INPUT"==
k.tagName&&(k.classList.add("jcolor-input"),k.readOnly=!0);n=document.createElement("div");n.className="jcolor";q=document.createElement("div");q.className="jcolor-backdrop";n.appendChild(q);y=document.createElement("div");y.className="jcolor-content";var m=document.createElement("div");m.className="jcolor-controls";y.appendChild(m);a=document.createElement("div");a.className="jcolor-reset";a.innerHTML=d.options.resetLabel;a.onclick=function(z){d.setValue("");d.close()};m.appendChild(a);x=document.createElement("div");
x.className="jcolor-close";x.innerHTML=d.options.doneLabel;x.onclick=function(z){0<H.getActive()&&d.setValue(l);d.close()};m.appendChild(x);A=document.createElement("div");y.appendChild(A);H=r.tabs(A,{animation:!0,data:[{title:"Grid",contentElement:f()},{title:"Spectrum",contentElement:g()},{title:"Sliders",contentElement:u()}],onchange:function(z,D,E){if(1===E)e();else if(z=""!==l?l:d.getValue(),2===E&&z){var C=h(z);p.forEach(function(F,I){F.value=C[I];F.dispatchEvent(new Event("input"))})}},palette:"modern"});
n.appendChild(y);"INPUT"==k.tagName?k.parentNode.insertBefore(n,k.nextSibling):k.appendChild(n);k.addEventListener("mouseup",function(z){d.open()});q.addEventListener("mousedown",function(z){B=!0});q.addEventListener("mouseup",function(z){B&&(d.close(),B=!1)});window.addEventListener("resize",function(){n.classList.contains("jcolor-focus")&&1==H.getActive()&&e()});1==d.options.opened&&d.open();k.change=d.setValue;k.val=function(z){if(void 0===z)return d.getValue();d.setValue(z)};k.color=d;n.color=
d})();return d};r.contextmenu=function(k,v){function d(a){if(!a.type||"line"!=a.type&&"divisor"!=a.type){B=document.createElement("div");var x=document.createElement("a");x.innerHTML=a.title;a.tooltip&&B.setAttribute("title",a.tooltip);a.icon&&B.setAttribute("data-icon",a.icon);a.id&&(B.id=a.id);a.disabled?B.className="jcontextmenu-disabled":a.onclick&&(B.method=a.onclick,B.addEventListener("mousedown",function(t){t.preventDefault()}),B.addEventListener("mouseup",function(){this.method(this)}));B.appendChild(x);
if(a.submenu){x=document.createElement("span");x.innerHTML="&#9658;";B.appendChild(x);B.classList.add("jcontexthassubmenu");x=document.createElement("div");x.classList.add("jcontextmenu");x.setAttribute("tabindex","900");a=a.submenu;for(var A=0;A<a.length;A++){var H=d(a[A]);x.appendChild(H)}B.appendChild(x)}else a.shortcut&&(x=document.createElement("span"),x.innerHTML=a.shortcut,B.appendChild(x))}else var B=document.createElement("hr");return B}var n={options:{}},q={items:null,onclick:null},y;for(y in q)v&&
v.hasOwnProperty(y)?n.options[y]=v[y]:n.options[y]=q[y];k.classList.add("jcontextmenu");k.setAttribute("tabindex","900");n.open=function(a,x){x&&(n.options.items=x,n.create(x));if(n.options.items&&0<n.options.items.length||k.children.length){if(a.target)var A=a.clientX,H=a.clientY;else A=a.x,H=a.y;k.classList.add("jcontextmenu-focus");k.focus();var B=k.getBoundingClientRect();window.innerHeight<H+B.height?(H-=B.height,0>H&&(H=0),k.style.top=H+"px"):k.style.top=H+"px";k.style.left=window.innerWidth<
A+B.width?0<A-B.width?A-B.width+"px":"10px":A+"px"}};n.close=function(){k.classList.contains("jcontextmenu-focus")&&k.classList.remove("jcontextmenu-focus")};n.create=function(a){k.innerHTML="";for(var x=0;x<a.length;x++){var A=d(a[x]);k.appendChild(A)}};"function"==typeof n.options.onclick&&k.addEventListener("click",function(a){n.options.onclick(n,a)});n.options.items&&n.create(n.options.items);k.addEventListener("blur",function(a){n.close()});r.contextmenu.hasEvents||(window.addEventListener("mousewheel",
function(){n.close()}),document.addEventListener("contextmenu",function(a){var x=r.contextmenu.getElement(a.target);x&&((x=document.querySelector("#"+x))?(x.contextmenu.open(a),a.preventDefault()):console.error("JSUITES: Contextmenu id not found"))}),r.contextmenu.hasEvents=!0);return k.contextmenu=n};r.contextmenu.getElement=function(k){function v(n){n.parentNode&&n.getAttribute("aria-contextmenu-id")?d=n.getAttribute("aria-contextmenu-id"):n.parentNode&&v(n.parentNode)}var d=0;v(k);return d};r.dropdown=
function(k,v){if(k.dropdown)return k.dropdown.setOptions(v,!0);var d={type:"dropdown",options:{}},n=function(l,p){if(l&&l.length&&(!1!==d.options.sortResults&&("function"==typeof d.options.sortResults?l.sort(d.options.sortResults):l.sort(q)),d.setData(l),"function"==typeof d.options.onload))d.options.onload(k,d,l,p);p&&a(p);if(void 0===p||null===p)d.options.value="";k.value=d.options.value;1==d.options.opened&&d.open()},q=function(l,p){if("string"==typeof l)var u=l;else l.text?u=l.text:l.name&&(u=
l.name);if("string"==typeof p)var m=p;else p.text?m=p.text:p.name&&(m=p.name);return"string"==typeof u||"string"==typeof m?("string"!=typeof u&&(u=""+u),"string"!=typeof m&&(m=""+m),u.localeCompare(m)):u-m},y=function(){d.value={};for(var l=0;l<d.items.length;l++)1==d.items[l].selected&&(d.items[l].element&&d.items[l].element.classList.remove("jdropdown-selected"),d.items[l].selected=null);d.options.value=""},a=function(l){y();if(null!==l)if(l){Array.isArray(l)||(l=(""+l).split(";"));for(var p=0;p<
l.length;p++)d.value[l[p]]=""}else"undefined"!==typeof d.value[""]&&(d.value[""]="");for(p=0;p<d.items.length;p++)"undefined"!==typeof d.value[x(p)]&&(d.items[p].element&&d.items[p].element.classList.add("jdropdown-selected"),d.items[p].selected=!0,d.value[x(p)]=A(p));d.options.value=Object.keys(d.value).join(";");d.header.value=d.getText()},x=function(l,p){var u=d.options.format?"id":"value";return d.items[l]?void 0!==p?d.items[l].data[u]=p:d.items[l].data[u]:""},A=function(l,p){var u=d.options.format?
"name":"text";return d.items[l]?void 0!==p?d.items[l].data[u]=p:d.items[l].data[u]:""},H=function(){for(var l=[],p=Object.keys(d.value),u=0;u<p.length;u++)l.push(d.value[p[u]]);return l};d.setOptions=function(l,p){l||(l={});var u={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,
onbeforeinsert:null,sortResults:!1,autofocus:!1},m;for(m in u)if(l&&l.hasOwnProperty(m))d.options[m]=l[m];else if("undefined"==typeof d.options[m]||!0===p)d.options[m]=u[m];if(1==d.options.remoteSearch||"searchbar"===d.options.type)d.options.autocomplete=!0;1==d.options.newOptions?d.header.classList.add("jdropdown-add"):d.header.classList.remove("jdropdown-add");1==d.options.autocomplete?d.header.removeAttribute("readonly"):d.header.setAttribute("readonly","readonly");d.options.placeholder?d.header.setAttribute("placeholder",
d.options.placeholder):d.header.removeAttribute("placeholder");k.classList.remove("jdropdown-searchbar");k.classList.remove("jdropdown-picker");k.classList.remove("jdropdown-list");"searchbar"==d.options.type?k.classList.add("jdropdown-searchbar"):"list"==d.options.type?k.classList.add("jdropdown-list"):"picker"==d.options.type?k.classList.add("jdropdown-picker"):800>r.getWindowWidth()?d.options.autocomplete?(k.classList.add("jdropdown-searchbar"),d.options.type="searchbar"):(k.classList.add("jdropdown-picker"),
d.options.type="picker"):(d.options.width?(k.style.width=d.options.width,k.style.minWidth=d.options.width):(k.style.removeProperty("width"),k.style.removeProperty("min-width")),k.classList.add("jdropdown-default"),d.options.type="default");"searchbar"==d.options.type?B.appendChild(f):t.insertBefore(f,t.firstChild);d.options.url&&!l.data?r.ajax({url:d.options.url,method:"GET",dataType:"json",success:function(z){z&&n(z,d.options.value)}}):n(d.options.data,d.options.value);return d};var B=null,t=null,
h=null,f=null,b=null,c=null,e=null;d.getUrl=function(){return d.options.url};d.setUrl=function(l,p){d.options.url=l;r.ajax({url:d.options.url,method:"GET",dataType:"json",success:function(u){d.setData(u);"function"==typeof p&&p(d)}})};d.setId=function(l,p){var u=d.options.format?"id":"value";"object"==typeof l?l[u]=p:d.items[l].data[u]=p};d.add=function(l,p){if(!l){var u=1==d.options.autocomplete?d.header.value:"";l=prompt(r.translate("Add A New Option"),u);if(!l)return!1}p||(p=r.guid());u=d.options.format?
{id:p,name:l}:{value:p,text:l};if("function"==typeof d.options.onbeforeinsert){var m=d.options.onbeforeinsert(d,u);if(!1===m)return!1;m&&(u=m)}d.options.data.push(u);m=d.createItem(u);h.appendChild(m.element);if("function"==typeof d.options.oninsert)d.options.oninsert(d,u,m);"none"==h.style.display&&(h.style.display="");d.results&&d.results.push(m);return u};d.createItem=function(l,p,u){d.options.format?(l.id||void 0===l.value||(l.id=l.value),l.name||void 0===l.text||(l.name=l.text)):(l.value||void 0===
l.id||(l.value=l.id),l.text||void 0===l.name||(l.text=l.name));u={};u.element=document.createElement("div");u.element.className="jdropdown-item";u.element.indexValue=d.items.length;u.data=l;p&&(u.group=p);l.id&&u.element.setAttribute("id",l.id);1==l.disabled&&u.element.setAttribute("data-disabled",!0);l.tooltip&&u.element.setAttribute("title",l.tooltip);l.image?(p=document.createElement("img"),p.className="jdropdown-image",p.src=l.image,l.title||p.classList.add("jdropdown-image-small"),u.element.appendChild(p)):
l.icon?(p=document.createElement("span"),p.className="jdropdown-icon material-icons",p.innerText=l.icon,l.title||p.classList.add("jdropdown-icon-small"),l.color&&(p.style.color=l.color),u.element.appendChild(p)):l.color&&(p=document.createElement("div"),p.className="jdropdown-color",p.style.backgroundColor=l.color,u.element.appendChild(p));var m=d.options.format?l.name:l.text;p=document.createElement("div");p.className="jdropdown-description";p.innerHTML=m||"&nbsp;";l.title&&(m=document.createElement("div"),
m.className="jdropdown-title",m.innerText=l.title,p.appendChild(m));d.value[d.options.format?l.id:l.value]&&(u.element.classList.add("jdropdown-selected"),u.selected=!0);d.items.push(u);u.element.appendChild(p);return u};d.appendData=function(l){if(l.length){for(var p=[],u=[],m=0;m<l.length;m++)l[m].group?(u[l[m].group]||(u[l[m].group]=[]),u[l[m].group].push(m)):p.push(m);var z=0,D=Object.keys(u);if(0<D.length)for(m=0;m<D.length;m++){var E=document.createElement("div");E.className="jdropdown-group";
var C=document.createElement("div");C.className="jdropdown-group-name";C.innerHTML=D[m];var F=document.createElement("i");F.className="jdropdown-group-arrow jdropdown-group-arrow-down";C.appendChild(F);F=document.createElement("div");F.className="jdropdown-group-items";for(var I=0;I<u[D[m]].length;I++){var J=d.createItem(l[u[D[m]][I]],E,D[m]);if(0==d.options.lazyLoading||200>z)F.appendChild(J.element),z++}E.appendChild(C);E.appendChild(F);d.groups.push(E);0<F.children.length&&h.appendChild(E)}if(p.length)for(m=
0;m<p.length;m++)if(J=d.createItem(l[p[m]]),0==d.options.lazyLoading||200>z)h.appendChild(J.element),z++}};d.setData=function(l){if(l.length){for(var p=0;p<l.length;p++)"object"!=typeof l[p]&&(l[p]=d.options.format?{id:l[p],name:l[p]}:{value:l[p],text:l[p]});y();h.innerHTML="";d.header.value="";d.items=[];d.appendData(l);d.options.data=l}};d.getData=function(){return d.options.data};d.getPosition=function(l){for(var p=0;p<d.items.length;p++)if(x(p)==l)return p;return!1};d.getText=function(l){var p=
H();return l?p:p.join("; ")};d.getValue=function(l){var p=Object.keys(d.value);return l?p:p.join(";")};var g=function(l){if("function"==typeof d.options.onchange)d.options.onchange(k,d,l,d.options.value);if(k.value!=d.options.value&&(k.value=d.options.value,"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value})};d.setValue=function(l){var p=d.getValue();Array.isArray(l)&&(l=l.join(";"));p!==l&&(a(l),g(p))};d.resetSelected=function(){d.setValue(null)};d.selectIndex=function(l,
p){l=parseInt(l);if(d.items&&d.items[l]&&(!0===p||!0!==d.items[l].data.disabled))if(d.setCursor(l,!1),d.options.multiple){var u=d.options.value;d.items[l].selected?(d.items[l].element.classList.remove("jdropdown-selected"),d.items[l].selected=!1,delete d.value[x(l)]):(d.items[l].element.classList.add("jdropdown-selected"),d.items[l].selected=!0,d.value[x(l)]=A(l));d.options.value=Object.keys(d.value).join(";");0==d.options.autocomplete&&(d.header.value=H().join("; "));g(u)}else d.items[l].selected?
d.setValue(null):d.setValue(x(l)),d.close()};d.selectItem=function(l){d.selectIndex(l.indexValue)};d.find=function(l){if(d.search==l.trim())return!1;d.search=l;d.setCursor();if(d.groups.length)for(var p=0;p<d.groups.length;p++)d.groups[p].lastChild.innerHTML="";h.innerHTML="";if(1==d.options.remoteSearch)d.results=null,p=d.options.url+(0<d.options.url.indexOf("?")?"&":"?")+"q="+l,r.ajax({url:p,method:"GET",dataType:"json",success:function(C){d.items=[];var F=Object.keys(d.value);if(F.length)for(var I=
0;I<F.length;I++){a:{var J=F[I];for(var M=0;M<C.length;M++)if(!d.options.format){if(C[M].value==J){J=!0;break a}}else if(C[M].id==J){J=!0;break a}J=!1}J||(d.options.format?C.unshift({id:F[I],name:d.value[F[I]]}):C.unshift({value:F[I],text:d.value[F[I]]}))}d.appendData(C);h.style.display=C.length?"":"none"}});else{l=new RegExp(l,"gi");var u=[];for(p=0;p<d.items.length;p++){var m=A(p),z=d.items[p].data.title||"",D=d.items[p].data.group||"",E=d.items[p].data.synonym||"";E&&(E=E.join(" "));(null==l||
1==d.items[p].selected||m.match(l)||z.match(l)||D.match(l)||E.match(l))&&u.push(d.items[p])}if(u.length)for(h.style.display="",d.results=u,l=u.length||0,1==d.options.lazyLoading&&200<l&&(l=200),p=0;p<l;p++)d.results[p].group?(d.results[p].group.parentNode||h.appendChild(d.results[p].group),d.results[p].group.lastChild.appendChild(d.results[p].element)):h.appendChild(d.results[p].element);else h.style.display="none",d.results=null}1==d.options.autofocus&&d.first()};d.open=function(){if(!k.classList.contains("jdropdown-focus")){r.dropdown.current=
d;r.tracking(d,!0);k.classList.add("jdropdown-focus");800>r.getWindowWidth()&&(null==d.options.type||"picker"==d.options.type)&&r.animation.slideBottom(t,1);1==d.options.autocomplete&&(d.header.value=d.search,d.header.focus());var l=Object.keys(d.value);l[0]&&(l=d.getPosition(l[0]),!1!==l&&d.setCursor(l));if(!d.options.type||"default"==d.options.type){l=k.getBoundingClientRect();var p=t.getBoundingClientRect();d.options.position?(t.style.position="fixed",window.innerHeight<l.bottom+p.height?(t.style.top=
"",t.style.bottom=window.innerHeight-l.top+1+"px"):(t.style.top=l.bottom+"px",t.style.bottom=""),t.style.left=l.left+"px"):window.innerHeight<l.bottom+p.height?(t.style.top="",t.style.bottom=l.height+1+"px"):(t.style.top="",t.style.bottom="");t.style.minWidth=l.width+"px";d.options.maxWidth&&(t.style.maxWidth=d.options.maxWidth);h.style.display=d.items.length||1!=d.options.autocomplete?"":"none"}}if("function"==typeof d.options.onopen)d.options.onopen(k)};d.close=function(l){if(k.classList.contains("jdropdown-focus")){d.header.value=
d.getText();d.setCursor();if(!l&&"function"==typeof d.options.onclose)d.options.onclose(k);d.header.blur&&d.header.blur();k.classList.remove("jdropdown-focus");r.tracking(d,!1);r.dropdown.current=null}return d.getValue()};d.setCursor=function(l,p){null!=d.currentIndex&&d.items&&d.items[d.currentIndex]&&d.items[d.currentIndex].element.classList.remove("jdropdown-cursor");if(void 0==l)d.currentIndex=null;else if(l=parseInt(l),d.items[l].element.parentNode&&(d.items[l].element.classList.add("jdropdown-cursor"),
d.currentIndex=l,!1!==p&&d.items[d.currentIndex].element)){var u=d.items[d.currentIndex].element;h.scrollTop=u.offsetTop-u.scrollTop+u.clientTop-95}};d.resetCursor=d.setCursor;d.updateCursor=d.setCursor;d.reset=function(){d.setCursor();d.setValue(null)};d.first=function(){!0===d.options.lazyLoading&&d.loadFirst();var l=h.querySelectorAll(".jdropdown-item");l.length&&d.setCursor(l[0].indexValue)};d.last=function(){!0===d.options.lazyLoading&&d.loadLast();var l=h.querySelectorAll(".jdropdown-item");
l.length&&d.setCursor(l[l.length-1].indexValue)};d.next=function(l){var p=null;if(l){if(1==l.length){var u=d.currentIndex||-1;l=l.toLowerCase();var m,z,D=h.querySelectorAll(".jdropdown-item");if(D.length){for(var E=0;E<D.length;E++)if(D[E].indexValue>u&&(m=d.items[D[E].indexValue])&&(z=m.element.innerText[0])&&(z=z.toLowerCase(),l==z)){p=D[E].indexValue;break}d.setCursor(p)}}}else if(void 0==d.currentIndex||null==d.currentIndex)d.first();else{l=d.items[d.currentIndex].element;if(u=l.nextElementSibling)u.classList.contains("jdropdown-group")&&
(u=u.lastChild.firstChild),p=u.indexValue;else if(l.parentNode.classList.contains("jdropdown-group-items")){if(u=l.parentNode.parentNode.nextElementSibling)u.classList.contains("jdropdown-group")?u=u.lastChild.firstChild:u.classList.contains("jdropdown-item")?p=u.indexValue:u=null;u&&(p=u.indexValue)}null!==p&&d.setCursor(p)}};d.prev=function(){var l=null;if(null===d.currentIndex)d.first();else{var p=d.items[d.currentIndex].element,u=p.previousElementSibling;if(u)u.classList.contains("jdropdown-group")&&
(u=u.lastChild.lastChild),l=u.indexValue;else if(p.parentNode.classList.contains("jdropdown-group-items")){if(u=p.parentNode.parentNode.previousElementSibling)u.classList.contains("jdropdown-group")?u=u.lastChild.lastChild:u.classList.contains("jdropdown-item")?l=u.indexValue:u=null;u&&(l=u.indexValue)}}null!==l&&d.setCursor(l)};d.loadFirst=function(){var l=d.results?d.results:d.items,p=l.length||0;1==d.options.lazyLoading&&200<p&&(p=200);h.innerHTML="";for(var u=0;u<p;u++)l[u].group?(l[u].group.parentNode||
h.appendChild(l[u].group),l[u].group.lastChild.appendChild(l[u].element)):h.appendChild(l[u].element);h.scrollTop=0};d.loadLast=function(){var l=d.results?d.results:d.items,p=l.length;if(200<p){h.innerHTML="";for(p-=200;p<l.length;p++)l[p].group?(l[p].group.parentNode||h.appendChild(l[p].group),l[p].group.lastChild.appendChild(l[p].element)):h.appendChild(l[p].element);h.scrollTop=h.scrollHeight}};d.loadUp=function(){var l=!1,p=d.results?d.results:d.items,u=h.querySelectorAll(".jdropdown-item")[0].indexValue;
u=d.items[u];u=p.indexOf(u)-1;if(0<u){for(l=0;0<u&&p[u]&&200>l;)p[u].group?(p[u].group.parentNode||h.insertBefore(p[u].group,h.firstChild),p[u].group.lastChild.insertBefore(p[u].element,p[u].group.lastChild.firstChild)):h.insertBefore(p[u].element,h.firstChild),u--,l++;l=!0}return l};d.loadDown=function(){var l=!1,p=d.results?d.results:d.items,u=h.querySelectorAll(".jdropdown-item");u=u[u.length-1].indexValue;u=d.items[u];u=p.indexOf(u)+1;if(u<p.length){for(l=0;u<p.length&&p[u]&&200>l;)p[u].group?
(p[u].group.parentNode||h.appendChild(p[u].group),p[u].group.lastChild.appendChild(p[u].element)):h.appendChild(p[u].element),u++,l++;l=!0}return l};(function(){v||(v={});if("SELECT"==k.tagName){var l=r.dropdown.extractFromDom(k,v);k=l.el;v=l.options}!v.placeholder&&k.getAttribute("placeholder")&&(v.placeholder=k.getAttribute("placeholder"));d.value={};d.items=[];d.groups=[];d.search="";d.results=null;k.classList.add("jdropdown");B=document.createElement("div");B.className="jdropdown-container-header";
d.header=document.createElement("input");d.header.className="jdropdown-header";d.header.type="text";d.header.setAttribute("autocomplete","off");d.header.onfocus=function(){if("function"==typeof d.options.onfocus)d.options.onfocus(k)};d.header.onblur=function(){if("function"==typeof d.options.onblur)d.options.onblur(k)};d.header.onkeyup=function(p){1!=d.options.autocomplete||e?d.options.autocomplete||d.next(p.key):(d.search!=d.header.value.trim()&&(e=setTimeout(function(){d.find(d.header.value.trim());
e=null},400)),k.classList.contains("jdropdown-focus")||d.open())};r.dropdown.hasEvents||(r.dropdown.hasEvents=!0,document.addEventListener("keydown",r.dropdown.keydown));t=document.createElement("div");t.className="jdropdown-container";h=document.createElement("div");h.className="jdropdown-content";f=document.createElement("div");f.className="jdropdown-close";f.innerHTML="Done";b=document.createElement("div");b.className="jdropdown-reset";b.innerHTML="x";b.onclick=function(){d.reset();d.close()};
c=document.createElement("div");c.className="jdropdown-backdrop";B.appendChild(d.header);t.appendChild(h);k.appendChild(B);k.appendChild(t);k.appendChild(c);d.setOptions(v);!0==="ontouchsend"in document.documentElement?k.addEventListener("touchsend",r.dropdown.mouseup):k.addEventListener("mouseup",r.dropdown.mouseup);1==d.options.lazyLoading&&r.lazyLoading(h,{loadUp:d.loadUp,loadDown:d.loadDown});k.change=d.setValue;k.val=function(p){if(void 0===p)return d.getValue(d.options.multiple?!0:!1);d.setValue(p)};
k.dropdown=d})();return d};r.dropdown.keydown=function(k){var v;if(v=r.dropdown.current)if(13==k.which||9==k.which)v.header.value&&null==v.currentIndex&&v.options.newOptions?v.add():(null==v.currentIndex&&1==v.options.autocomplete&&""!=v.header.value&&v.find(v.header.value),v.selectIndex(v.currentIndex));else if(38==k.which)null==v.currentIndex?v.first():0<v.currentIndex&&v.prev(),k.preventDefault();else if(40==k.which)null==v.currentIndex?v.first():v.currentIndex+1<v.items.length&&v.next(),k.preventDefault();
else if(36==k.which)v.first(),k.target.classList.contains("jdropdown-header")||k.preventDefault();else if(35==k.which)v.last(),k.target.classList.contains("jdropdown-header")||k.preventDefault();else if(27==k.which)v.close();else if(33==k.which){if(null==v.currentIndex)v.first();else if(0<v.currentIndex)for(var d=0;7>d;d++)v.prev();k.preventDefault()}else if(34==k.which){if(null==v.currentIndex)v.first();else if(v.currentIndex+1<v.items.length)for(d=0;7>d;d++)v.next();k.preventDefault()}};r.dropdown.mouseup=
function(k){var v=r.findElement(k.target,"jdropdown");if(v){var d=v.dropdown;if(k.target.classList.contains("jdropdown-header"))v.classList.contains("jdropdown-focus")&&v.classList.contains("jdropdown-default")?(v=v.getBoundingClientRect(),30>v.width-((k.changedTouches&&k.changedTouches[0]?k.changedTouches[0].clientX:k.clientX)-v.left)?k.target.classList.contains("jdropdown-add")?d.add():d.close():0==d.options.autocomplete&&d.close()):d.open();else if(k.target.classList.contains("jdropdown-group-name")){if(v=
k.target.nextSibling.children,"none"!=k.target.nextSibling.style.display)for(k=0;k<v.length;k++)"none"!=v[k].style.display&&d.selectItem(v[k])}else k.target.classList.contains("jdropdown-group-arrow")?k.target.classList.contains("jdropdown-group-arrow-down")?(k.target.classList.remove("jdropdown-group-arrow-down"),k.target.classList.add("jdropdown-group-arrow-up"),k.target.parentNode.nextSibling.style.display="none"):(k.target.classList.remove("jdropdown-group-arrow-up"),k.target.classList.add("jdropdown-group-arrow-down"),
k.target.parentNode.nextSibling.style.display=""):k.target.classList.contains("jdropdown-item")?d.selectItem(k.target):k.target.classList.contains("jdropdown-image")?d.selectItem(k.target.parentNode):k.target.classList.contains("jdropdown-description")?d.selectItem(k.target.parentNode):k.target.classList.contains("jdropdown-title")?d.selectItem(k.target.parentNode.parentNode):(k.target.classList.contains("jdropdown-close")||k.target.classList.contains("jdropdown-backdrop"))&&d.close()}};r.dropdown.extractFromDom=
function(k,v){v||(v={});!k.getAttribute("multiple")||v&&void 0!=v.multiple||(v.multiple=!0);!k.getAttribute("placeholder")||v&&void 0!=v.placeholder||(v.placeholder=k.getAttribute("placeholder"));!k.getAttribute("data-autocomplete")||v&&void 0!=v.autocomplete||(v.autocomplete=!0);v&&void 0!=v.width||(v.width=k.offsetWidth);!k.value||v&&void 0!=v.value||(v.value=k.value);if(!v||void 0==v.data){v.data=[];for(var d=0;d<k.children.length;d++)if("OPTGROUP"==k.children[d].tagName)for(var n=0;n<k.children[d].children.length;n++)v.data.push({value:k.children[d].children[n].value,
text:k.children[d].children[n].innerHTML,group:k.children[d].getAttribute("label")});else v.data.push({value:k.children[d].value,text:k.children[d].innerHTML})}v&&void 0!=v.onchange||(v.onchange=function(q,y,a,x){1==v.multiple?obj.items[y].classList.contains("jdropdown-selected")?k.options[y].setAttribute("selected","selected"):k.options[y].removeAttribute("selected"):k.value=x});d=document.createElement("div");k.parentNode.insertBefore(d,k);k.style.display="none";return{el:d,options:v}};r.editor=
function(k,v){var d={options:{}},n={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5E6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null},q;for(q in n)v&&v.hasOwnProperty(q)?d.options[q]=v[q]:d.options[q]=n[q];var y=null,a=null,x=[];k.innerHTML="";d.el=k;"function"==
typeof d.options.onclick&&(k.onclick=function(G){d.options.onclick(k,d,G)});k.classList.add("jeditor-container");1==d.options.padding&&k.classList.add("jeditor-padding");0==d.options.border&&(k.style.border="0px");var A=document.createElement("div");A.className="jsnippet";A.setAttribute("contenteditable",!1);var H=document.createElement("div");H.className="jeditor-toolbar";var B=document.createElement("div");B.setAttribute("contenteditable",!0);B.setAttribute("spellcheck",!1);B.className="jeditor";
d.options.placeholder&&B.setAttribute("data-placeholder",d.options.placeholder);if(d.options.maxHeight||d.options.height)B.style.overflowY="auto",d.options.maxHeight&&(B.style.maxHeight=d.options.maxHeight),d.options.height&&(B.style.height=d.options.height);(n=d.options.value?d.options.value:k.innerHTML?k.innerHTML:"")||(n="");var t=function(G){if("function"==typeof d.options.onchange)d.options.onchange(k,d,G);d.options.value=d.getData();if(k.value!=d.options.value&&(k.value=d.options.value,"function"==
typeof k.onchange))k.onchange({type:"change",target:k,value:k.value})},h=function(G){if(window.getSelection){var K=window.getSelection();if(K.rangeCount){var L=K.getRangeAt(0);L.deleteContents();L.insertNode(G);L.setStartAfter(G);L.setEndAfter(G);K.removeAllRanges();K.addRange(L)}}},f=function(){var G;if(G=A.children[0]){G.classList.contains("jslider-grid")||G.classList.add("jslider-grid");var K=G.children.length;G.setAttribute("data-number",4<K?4:K);4<K?G.setAttribute("data-total",K-4):G.removeAttribute("data-total")}},
b=function(G){A.innerHTML="";for(var K=["image","title","description","host","url"],L=0;L<K.length;L++){var O=document.createElement("div");O.className="jsnippet-"+K[L];O.setAttribute("data-k",K[L]);A.appendChild(O);if(G[K[L]])if("image"==K[L]){Array.isArray(G.image)||(G.image=[G.image]);for(var Q=0;Q<G.image.length;Q++){var R=document.createElement("img");R.src=G.image[Q];O.appendChild(R)}}else O.innerHTML=G[K[L]]}B.appendChild(document.createElement("br"));B.appendChild(A)},c=function(){clearTimeout(y);
y=setTimeout(function(){if(!B.querySelector(".jsnippet")){var G=B.innerHTML.replace(/\n/g," "),K=document.createElement("div");K.innerHTML=G;if(G=r.editor.detectUrl(K.innerText))"jpg"==G[0].substr(-3)||"png"==G[0].substr(-3)||"gif"==G[0].substr(-3)?d.addImage(G[0],!0):(K=r.editor.youtubeParser(G[0]),d.parseWebsite(G[0],K))}},1E3)};d.parseContent=function(){c()};d.parseWebsite=function(G,K){if(d.options.remoteParser){K&&(G="https://www.youtube.com/watch?v="+K);var L={title:"",description:"",image:"",
host:G.split("/")[2],url:G};r.ajax({url:d.options.remoteParser+encodeURI(G.trim()),method:"GET",dataType:"json",success:function(O){O.title&&(L.title=O.title);O.description&&(L.description=O.description);O.host&&(L.host=O.host);O.url&&(L.url=O.url);b(L);O.image?d.addImage(O.image,!0):O["og:image"]&&d.addImage(O["og:image"],!0)}})}else console.log("The remoteParser is not defined")};d.setData=function(G){B.innerHTML=G;d.options.focus&&r.editor.setCursor(B,!0);x=[]};d.getFiles=function(){for(var G=
B.querySelectorAll(".jfile"),K=[],L=0;L<G.length;L++)x[G[L].src]&&K.push(x[G[L].src]);return K};d.getText=function(){return B.innerText};d.getData=function(G){if(G){G={content:""};if(A.innerHTML){G.snippet={};for(var K=0;K<A.children.length;K++){var L=A.children[K].getAttribute("data-k");if(L)if("image"==L)for(G.snippet.image||(G.snippet.image=[]),L=0;L<A.children[K].children.length;L++)G.snippet.image.push(A.children[K].children[L].getAttribute("src"));else G.snippet[L]=A.children[K].innerHTML}}L=
Object.keys(x);if(L.length)for(G.files=[],K=0;K<L.length;K++)G.files.push(x[L[K]]);K=B.innerHTML;K=K.replace(/<br>/g,"\n");K=K.replace(/<\/div>/g,"</div>\n");K=K.replace(/<(?:.|\n)*?>/gm,"");G.content=K.trim()}else G=B.innerHTML;return G};d.reset=function(){B.innerHTML="";A.innerHTML="";x=[]};d.addPdf=function(G){if("data"!=G.result.substr(0,4))console.error("Invalid source");else{var K=document.createElement("canvas");K.width=60;K.height=60;var L=new Image;K.getContext("2d").drawImage(L,0,0,K.width,
K.height);K.toBlob(function(O){var Q=document.createElement("img");Q.src=window.URL.createObjectURL(O);Q.title=G.name;Q.className="jfile pdf";x[Q.src]={file:Q.src,extension:"pdf",content:G.result};h(Q)})}};d.addImage=function(G,K){if("data"==G.substr(0,4)||d.options.remoteParser){if("data"==G.substr(0,4)){var L=G.split(";");L=L[0].split("/");L=L[1]}else L=G.substr(G.lastIndexOf(".")+1),G=d.options.remoteParser+G;var O=new Image;O.onload=function(){var Q=document.createElement("canvas");Q.width=O.width;
Q.height=O.height;Q.getContext("2d").drawImage(O,0,0,Q.width,Q.height);Q.toBlob(function(R){var V=document.createElement("img");V.src=window.URL.createObjectURL(R);V.classList.add("jfile");V.setAttribute("tabindex","900");x[V.src]={file:V.src,extension:L,content:Q.toDataURL()};d.options.dropAsSnippet||K?(A.innerHTML||b({}),A.children[0].appendChild(V),f(),x[V.src].snippet=!0):h(V);t()})};O.src=G}else console.error("remoteParser not defined in your initialization")};d.addFile=function(G){for(var K=
[],L=0;L<G.length;L++)if(G[L].size>d.options.maxFileSize)alert("The file is too big");else{var O=G[L].type.split("/");(O="image"==O[0]?1:"pdf"==O[1]?2:0)?(K[L]=new FileReader,K[L].index=L,K[L].type=O,K[L].name=G[L].name,K[L].date=G[L].lastModified,K[L].size=G[L].size,K[L].addEventListener("load",function(Q){2==Q.target.type?1==d.options.acceptFiles&&d.addPdf(Q.target):d.addImage(Q.target.result)},!1),K[L].readAsDataURL(G[L])):alert("The extension is not allowed")}};d.destroy=function(){B.removeEventListener("mouseup",
e);B.removeEventListener("mousedown",g);B.removeEventListener("mousemove",l);B.removeEventListener("keyup",p);B.removeEventListener("keydown",u);B.removeEventListener("dragstart",F);B.removeEventListener("dragenter",I);B.removeEventListener("dragover",J);B.removeEventListener("drop",M);B.removeEventListener("paste",C);"function"==typeof d.options.onblur&&B.removeEventListener("blur",P);"function"==typeof d.options.onfocus&&B.removeEventListener("focus",N);k.editor=null;k.classList.remove("jeditor-container");
H.remove();A.remove();B.remove()};var e=function(G){a&&a.e&&a.e.classList.remove("resizing");a=!1},g=function(G){var K=function(O){var Q=O.getBoundingClientRect();40>Q.width-(G.clientX-Q.left)&&40>G.clientY-Q.top&&(O.innerHTML="",O.remove())};if("IMG"==G.target.tagName)if(G.target.style.cursor){K=G.target.getBoundingClientRect();a={e:G.target,x:G.clientX,y:G.clientY,w:K.width,h:K.height,d:G.target.style.cursor};G.target.width||(G.target.width=K.width+"px");G.target.height||(G.target.height=K.height+
"px");K=window.getSelection();if(K.rangeCount)for(var L=0;L<K.rangeCount;L++)K.removeRange(K.getRangeAt(L));G.target.classList.add("resizing")}else a=!0;else G.target.classList.contains("jsnippet")?K(G.target):G.target.parentNode.classList.contains("jsnippet")&&K(G.target.parentNode),a=!0},l=function(G){if("IMG"==G.target.tagName&&!G.target.parentNode.classList.contains("jsnippet-image")&&1==d.options.allowImageResize&&G.target.getAttribute("tabindex")){var K=G.target.getBoundingClientRect();G.target.style.cursor=
5>G.clientY-K.top?5>K.width-(G.clientX-K.left)?"ne-resize":5>G.clientX-K.left?"nw-resize":"n-resize":5>K.height-(G.clientY-K.top)?5>K.width-(G.clientX-K.left)?"se-resize":5>G.clientX-K.left?"sw-resize":"s-resize":5>K.width-(G.clientX-K.left)?"e-resize":5>G.clientX-K.left?"w-resize":""}if(1==G.which&&a&&a.d){if("e-resize"==a.d||"ne-resize"==a.d||"se-resize"==a.d)if(a.e.width=a.w+(G.clientX-a.x),G.shiftKey){var L=a.h/a.w*(G.clientX-a.x);a.e.height=a.h+L}else L=null;L||"s-resize"!=a.d&&"se-resize"!=
a.d&&"sw-resize"!=a.d||G.shiftKey||(a.e.height=a.h+(G.clientY-a.y))}},p=function(G){B.innerHTML||(B.innerHTML="<div><br></div>");if("function"==typeof d.options.onkeyup)d.options.onkeyup(k,d,G)},u=function(G){1==d.options.parseURL&&c();if("function"==typeof d.options.onkeydown)d.options.onkeydown(k,d,G);"Delete"==G.key&&"IMG"==G.target.tagName&&G.target.parentNode.classList.contains("jsnippet-image")&&(G.target.remove(),f())},m=[HTMLUnknownElement],z="color font-weight font-size background background-color margin".split(" "),
D=function(G){if(G.attributes&&G.attributes.length){var K=null,L=G.getAttribute("style");if(L){K=[];L=L.split(";");for(var O=0;O<L.length;O++){var Q=L[O].trim().split(":");if(0<=z.indexOf(Q[0].trim())){var R=Q.shift();Q=Q.join(":");K.push(R+":"+Q)}}}if("IMG"==G.tagName)d.options.acceptImages?(G.setAttribute("tabindex","900"),d.addImage(G.src)):G.remove();else for(L=G.attributes.length-1;0<=L;L--)G.removeAttribute(G.attributes[L].name);G.style="";K&&K.length&&G.setAttribute("style",K.join(";"))}if(G.children.length)for(L=
0;L<G.children.length;L++)D(G.children[L]);0<=m.indexOf(G.constructor)&&G.remove()},E=function(G){G&&(G=G.replace(RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var K=document.createElement("span");K.innerHTML=G;D(K);return K},C=function(G){if(1==d.options.filterPaste){if(G.clipboardData||G.originalEvent.clipboardData)var K=(G.originalEvent||G).clipboardData.getData("text/html"),L=(G.originalEvent||G).clipboardData.getData("text/plain"),O=(G.originalEvent||G).clipboardData.files;else window.clipboardData&&
(K=window.clipboardData.getData("Html"),L=window.clipboardData.getData("Text"),O=window.clipboardData.files);O.length?d.addFile(O):K?(K=E(K),h(K)):(K=L.split("\r\n"),G.target.innerText?(K=K.map(function(Q){return"<div>"+Q+"</div>"}),document.execCommand("insertHtml",!1,K.join(""))):K.map(function(Q){var R=document.createElement("div");R.innerText=Q;B.appendChild(R)}));G.preventDefault()}},F=function(G){a&&a.e&&G.preventDefault()},I=function(G){a||0==d.options.dropZone||(k.classList.add("jeditor-dragging"),
G.preventDefault())},J=function(G){a||0==d.options.dropZone||(y&&clearTimeout(y),y=setTimeout(function(){k.classList.remove("jeditor-dragging")},100),G.preventDefault())},M=function(G){if(!a&&0!=d.options.dropZone){var K=null;document.caretRangeFromPoint?K=document.caretRangeFromPoint(G.clientX,G.clientY):G.rangeParent&&(K=document.createRange(),K.setStart(G.rangeParent,G.rangeOffset));var L=window.getSelection();L.removeAllRanges();L.addRange(K);L.anchorNode.parentNode.focus();K=(G.originalEvent||
G).dataTransfer.getData("text/html");L=(G.originalEvent||G).dataTransfer.getData("text/plain");var O=(G.originalEvent||G).dataTransfer.files;if(O.length)d.addFile(O);else if(L&&(L=document.createElement("div"),L.innerHTML=K,K=L.querySelectorAll("img"),K.length))for(L=0;L<K.length;L++)d.addImage(K[L].src);k.classList.remove("jeditor-dragging");G.preventDefault()}},P=function(G){if("function"==typeof d.options.onblur)d.options.onblur(k,d,G);t(G)},N=function(G){if("function"==typeof d.options.onfocus)d.options.onfocus(k,
d,G)};B.addEventListener("mouseup",e);B.addEventListener("mousedown",g);B.addEventListener("mousemove",l);B.addEventListener("keyup",p);B.addEventListener("keydown",u);B.addEventListener("dragstart",F);B.addEventListener("dragenter",I);B.addEventListener("dragover",J);B.addEventListener("drop",M);B.addEventListener("paste",C);B.addEventListener("focus",N);B.addEventListener("blur",P);if("function"==typeof d.options.onload)d.options.onload(k,d,B);B.innerHTML=n;k.appendChild(B);d.options.snippet&&b(d.options.snippet);
null==d.options.toolbar&&(d.options.toolbar=r.editor.getDefaultToolbar());d.options.toolbar&&(k.appendChild(H),r.toolbar(H,{container:!0,responsive:!0,items:d.options.toolbar}));d.options.focus&&r.editor.setCursor(B,"initial"==d.options.focus?!0:!1);k.change=d.setData;k.val=function(G){if(void 0===G)return G="true"===k.getAttribute("data-html")?!1:!0,d.getData(G);d.setData(G)};return k.editor=d};r.editor.setCursor=function(k,v){k.focus();document.execCommand("selectAll");var d=window.getSelection(),
n=d.getRangeAt(0);if(1==v)var q=n.startContainer,y=0;else q=n.endContainer,y=q.length;n.setStart(q,y);n.setEnd(q,y);d.removeAllRanges();d.addRange(n)};r.editor.getDomain=function(k){return k.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]};r.editor.detectUrl=function(k){(k=k.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig))&&"www"==k[0].substr(0,3)&&(k[0]="http://"+k[0]);return k};r.editor.youtubeParser=function(k){return(k=
k.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&\?]*).*/))&&11==k[7].length?k[7]:!1};r.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(k,v,d){document.execCommand("bold");document.queryCommandState("bold")?d.classList.add("selected"):d.classList.remove("selected")}},{content:"format_italic",
onclick:function(k,v,d){document.execCommand("italic");document.queryCommandState("italic")?d.classList.add("selected"):d.classList.remove("selected")}},{content:"format_underline",onclick:function(k,v,d){document.execCommand("underline");document.queryCommandState("underline")?d.classList.add("selected"):d.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(k,v,d){document.execCommand("insertUnorderedList");document.queryCommandState("insertUnorderedList")?
d.classList.add("selected"):d.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(k,v,d){document.execCommand("insertOrderedList");document.queryCommandState("insertOrderedList")?d.classList.add("selected"):d.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(k,v,d){document.execCommand("indent",!0,null);document.queryCommandState("indent")?d.classList.add("selected"):d.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent");
document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]};r.form=function(k,v){var d={options:{}},n={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(y,a){r.alert(a)}},q;for(q in n)v&&v.hasOwnProperty(q)?d.options[q]=v[q]:d.options[q]=n[q];d.options.validations||
(d.options.validations={});d.options.submitButton||(d.options.submitButton=k.querySelector("input[type=submit]"));d.options.submitButton&&d.options.url&&(d.options.submitButton.onclick=function(){d.save()});d.options.validations.email||(d.options.validations.email=r.validations.email);d.options.validations.length||(d.options.validations.length=r.validations.length);d.options.validations.required||(d.options.validations.required=r.validations.required);d.setUrl=function(y){d.options.url=y};d.load=
function(){r.ajax({url:d.options.url,method:"GET",dataType:"json",queue:!0,success:function(y){if("function"==typeof d.options.onbeforeload){var a=d.options.onbeforeload(k,y);a&&(y=a)}r.form.setElements(k,y);if("function"==typeof d.options.onload)d.options.onload(k,y)}})};d.save=function(){var y=d.validate();if(y)d.options.onerror(k,y);else{var a=r.form.getElements(k,!0);if("function"==typeof d.options.onbeforesave&&(a=d.options.onbeforesave(k,a),!1===a))return;r.ajax({url:d.options.url,method:"POST",
dataType:"json",data:a,success:function(x){if("function"==typeof d.options.onsave)d.options.onsave(k,a,x)}})}};d.remove=function(){if("function"==typeof d.options.onbeforeremove&&!1===d.options.onbeforeremove(k,d))return!1;r.ajax({url:d.options.url,method:"DELETE",dataType:"json",success:function(y){if("function"==typeof d.options.onremove)d.options.onremove(k,d,y);d.reset()}})};d.validateElement=function(y){var a=!1,x=r.form.getValue(y),A=y.getAttribute("data-validation");if("function"==typeof d.options.validations[A]&&
!d.options.validations[A](x,y))y.classList.add("error"),d.options.submitButton&&d.options.submitButton.setAttribute("disabled",!0),a=y.getAttribute("data-error")||"There is an error in the form",y.setAttribute("title",a);else if(y.classList.contains("error")){x=!1;y.classList.remove("error");y.removeAttribute("title");y=k.querySelectorAll("input, select, textarea, div[name]");for(A=0;A<y.length;A++)y[A].getAttribute("data-validation")&&y[A].classList.contains("error")&&(x=!0);d.options.submitButton&&
(x?d.options.submitButton.setAttribute("disabled",!0):d.options.submitButton.removeAttribute("disabled"))}return a};d.reset=function(){for(var y=k.querySelectorAll("input, select, textarea, div[name]"),a=0;a<y.length;a++)y[a].getAttribute("name")&&("checkbox"==y[a].type||"radio"==y[a].type?y[a].checked=!1:"function"==typeof y[a].val?y[a].val(""):y[a].value="")};d.validate=function(){for(var y=[],a=k.querySelectorAll("input, select, textarea, div[name]"),x=0;x<a.length;x++)if(a[x].getAttribute("data-validation")){var A=
d.validateElement(a[x]);A&&y.push(A)}return 0<y.length?y.join("<br>"):!1};d.getError=function(){return d.validation()?!0:!1};d.setHash=function(){return d.getHash(r.form.getElements(k))};d.getHash=function(y){var a=0,x;if(0!==y.length)for(x=0;x<y.length;x++){var A=y.charCodeAt(x);a=(a<<5)-a+A;a|=0}return a};d.isChanged=function(){var y=d.setHash();return d.options.currentHash!=y};d.resetTracker=function(){d.options.currentHash=d.setHash();d.options.ignore=!1};d.setIgnore=function(y){d.options.ignore=
y?!0:!1};setTimeout(function(){d.options.currentHash=d.setHash()},1E3);k.addEventListener("keyup",function(y){y.target.getAttribute("data-validation")&&d.validateElement(y.target)});r.form.hasEvents||(window.addEventListener("beforeunload",function(y){if(d.isChanged()&&0==d.options.ignore){var a=d.options.message?d.options.message:"o/";if(a)return"undefined"==typeof y&&(y=window.event),y&&(y.returnValue=a),a}}),r.form.hasEvents=!0);return k.form=d};r.form.getValue=function(k){var v=null;if("checkbox"==
k.type)1==k.checked&&(v=k.value||!0);else if("radio"==k.type)1==k.checked&&(v=k.value);else if("select"==k.tagName&&1==k.multiple){v=[];k=k.querySelectorAll("options[selected]");for(var d=0;d<k.length;d++)v.push(k[d].value)}else v="function"==typeof k.val?k.val():k.value||"";return v};r.form.getElements=function(k,v){for(var d={},n,q=k.querySelectorAll("input, select, textarea, div[name]"),y=0;y<q.length;y++)if(n=q[y].getAttribute("name"))d[n]=r.form.getValue(q[y])||"";return 1==v?d:JSON.stringify(d)};
r.form.setElements=function(k,v){for(var d,n,q=k.querySelectorAll("input, select, textarea, div[name]"),y=0;y<q.length;y++){var a=q[y].getAttribute("type");if(d=q[y].getAttribute("name"))d=d.replace(new RegExp(/\[(.*?)\]/ig),".$1"),n=null,d.match(/\./)?(d=r.path.call(v,d)||"","undefined"!==typeof d&&(n=d)):"undefined"!==typeof v[d]&&(n=v[d]),null!==n&&("checkbox"==a||"radio"==a?q[y].checked=n?!0:!1:"function"==typeof q[y].val?q[y].val(n):q[y].value=n)}};r.tracker=r.form;r.focus=function(k){if(k.innerText.length){var v=
document.createRange(),d=window.getSelection(),n=k.childNodes[k.childNodes.length-1];v.setStart(n,n.length);v.collapse(!0);d.removeAllRanges();d.addRange(v);k.scrollLeft=k.scrollWidth}};r.isNumeric=function(k){return!isNaN(k)&&null!==k&&""!==k};r.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(k){var v=16*Math.random()|0;return("x"==k?v:v&3|8).toString(16)})};r.getNode=function(){var k=document.getSelection().anchorNode;return k?3==k.nodeType?k.parentNode:k:null};
r.hash=function(k){var v=0,d;if(0!==k.length)for(d=0;d<k.length;d++){var n=k.charCodeAt(d);32<n&&(v=(v<<5)-v+n,v|=0)}return v};r.randomColor=function(k){var v=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");6>v.length&&(v=v[0]+v[0]+v[1]+v[1]+v[2]+v[2]);var d=[],n;for(n=0;3>n;n++){var q=parseInt(v.substr(2*n,2),16);q=Math.round(Math.min(Math.max(0,q+-.25*q),255)).toString(16);d.push(("00"+q).substr(q.length))}return 1==k?"#"+r.two(d[0].toString(16))+r.two(d[1].toString(16))+
r.two(d[2].toString(16)):d};r.getWindowWidth=function(){var k=window,v=document,d=v.documentElement;v=v.getElementsByTagName("body")[0];return k.innerWidth||d.clientWidth||v.clientWidth};r.getWindowHeight=function(){var k=window,v=document,d=v.documentElement;v=v.getElementsByTagName("body")[0];return k.innerHeight||d.clientHeight||v.clientHeight};r.getPosition=function(k){if(k.changedTouches&&k.changedTouches[0]){var v=k.changedTouches[0].pageX;k=k.changedTouches[0].pageY}else v=window.Event?k.pageX:
k.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),k=window.Event?k.pageY:k.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[v,k]};r.click=function(k){if(k.click)k.click();else{var v=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});k.dispatchEvent(v)}};r.findElement=function(k,v){function d(q){q&&!n&&("function"==typeof v?n=v(q):"string"==typeof v&&q.classList&&q.classList.contains(v)&&
(n=q));q.parentNode&&!n&&d(q.parentNode)}var n=!1;d(k);return n};r.two=function(k){k=""+k;1==k.length&&(k="0"+k);return k};r.sha512=function(k){function v(F,I){this.highOrder=F;this.lowOrder=I}function d(F,I){var J=(F.lowOrder&65535)+(I.lowOrder&65535);var M=(F.lowOrder>>>16)+(I.lowOrder>>>16)+(J>>>16);var P=(M&65535)<<16|J&65535;J=(F.highOrder&65535)+(I.highOrder&65535)+(M>>>16);M=(F.highOrder>>>16)+(I.highOrder>>>16)+(J>>>16);return new v((M&65535)<<16|J&65535,P)}function n(F,I,J,M){var P=(F.lowOrder&
65535)+(I.lowOrder&65535)+(J.lowOrder&65535)+(M.lowOrder&65535);var N=(F.lowOrder>>>16)+(I.lowOrder>>>16)+(J.lowOrder>>>16)+(M.lowOrder>>>16)+(P>>>16);var G=(N&65535)<<16|P&65535;P=(F.highOrder&65535)+(I.highOrder&65535)+(J.highOrder&65535)+(M.highOrder&65535)+(N>>>16);N=(F.highOrder>>>16)+(I.highOrder>>>16)+(J.highOrder>>>16)+(M.highOrder>>>16)+(P>>>16);return new v((N&65535)<<16|P&65535,G)}function q(F,I,J,M,P){var N=(F.lowOrder&65535)+(I.lowOrder&65535)+(J.lowOrder&65535)+(M.lowOrder&65535)+(P.lowOrder&
65535);var G=(F.lowOrder>>>16)+(I.lowOrder>>>16)+(J.lowOrder>>>16)+(M.lowOrder>>>16)+(P.lowOrder>>>16)+(N>>>16);var K=(G&65535)<<16|N&65535;N=(F.highOrder&65535)+(I.highOrder&65535)+(J.highOrder&65535)+(M.highOrder&65535)+(P.highOrder&65535)+(G>>>16);G=(F.highOrder>>>16)+(I.highOrder>>>16)+(J.highOrder>>>16)+(M.highOrder>>>16)+(P.highOrder>>>16)+(N>>>16);return new v((G&65535)<<16|N&65535,K)}function y(F,I){return 32>=I?new v(F.highOrder>>>I|F.lowOrder<<32-I,F.lowOrder>>>I|F.highOrder<<32-I):new v(F.lowOrder>>>
I|F.highOrder<<32-I,F.highOrder>>>I|F.lowOrder<<32-I)}function a(F){var I=y(F,28),J=y(F,34);F=y(F,39);return new v(I.highOrder^J.highOrder^F.highOrder,I.lowOrder^J.lowOrder^F.lowOrder)}function x(F){var I=y(F,14),J=y(F,18);F=y(F,41);return new v(I.highOrder^J.highOrder^F.highOrder,I.lowOrder^J.lowOrder^F.lowOrder)}function A(F){var I=y(F,1),J=y(F,8);F=B(F,7);return new v(I.highOrder^J.highOrder^F.highOrder,I.lowOrder^J.lowOrder^F.lowOrder)}function H(F){var I=y(F,19),J=y(F,61);F=B(F,6);return new v(I.highOrder^
J.highOrder^F.highOrder,I.lowOrder^J.lowOrder^F.lowOrder)}function B(F,I){return 32>=I?new v(F.highOrder>>>I,F.lowOrder>>>I|F.highOrder<<32-I):new v(0,F.highOrder<<32-I)}var t=[new v(1779033703,4089235720),new v(3144134277,2227873595),new v(1013904242,4271175723),new v(2773480762,1595750129),new v(1359893119,2917565137),new v(2600822924,725511199),new v(528734635,4215389547),new v(1541459225,327033209)],h=[new v(1116352408,3609767458),new v(1899447441,602891725),new v(3049323471,3964484399),new v(3921009573,
2173295548),new v(961987163,4081628472),new v(1508970993,3053834265),new v(2453635748,2937671579),new v(2870763221,3664609560),new v(3624381080,2734883394),new v(310598401,1164996542),new v(607225278,1323610764),new v(1426881987,3590304994),new v(1925078388,4068182383),new v(2162078206,991336113),new v(2614888103,633803317),new v(3248222580,3479774868),new v(3835390401,2666613458),new v(4022224774,944711139),new v(264347078,2341262773),new v(604807628,2007800933),new v(770255983,1495990901),new v(1249150122,
1856431235),new v(1555081692,3175218132),new v(1996064986,2198950837),new v(2554220882,3999719339),new v(2821834349,766784016),new v(2952996808,2566594879),new v(3210313671,3203337956),new v(3336571891,1034457026),new v(3584528711,2466948901),new v(113926993,3758326383),new v(338241895,168717936),new v(666307205,1188179964),new v(773529912,1546045734),new v(1294757372,1522805485),new v(1396182291,2643833823),new v(1695183700,2343527390),new v(1986661051,1014477480),new v(2177026350,1206759142),new v(2456956037,
344077627),new v(2730485921,1290863460),new v(2820302411,3158454273),new v(3259730800,3505952657),new v(3345764771,106217008),new v(3516065817,3606008344),new v(3600352804,1432725776),new v(4094571909,1467031594),new v(275423344,851169720),new v(430227734,3100823752),new v(506948616,1363258195),new v(659060556,3750685593),new v(883997877,3785050280),new v(958139571,3318307427),new v(1322822218,3812723403),new v(1537002063,2003034995),new v(1747873779,3602036899),new v(1955562222,1575990012),new v(2024104815,
1125592928),new v(2227730452,2716904306),new v(2361852424,442776044),new v(2428436474,593698344),new v(2756734187,3733110249),new v(3204031479,2999351573),new v(3329325298,3815920427),new v(3391569614,3928383900),new v(3515267271,566280711),new v(3940187606,3454069534),new v(4118630271,4000239992),new v(116418474,1914138554),new v(174292421,2731055270),new v(289380356,3203993006),new v(460393269,320620315),new v(685471733,587496836),new v(852142971,1086792851),new v(1017036298,365543100),new v(1126000580,
2618297676),new v(1288033470,3409855158),new v(1501505948,4234509866),new v(1607167915,987167468),new v(1816402316,1246189591)],f=Array(64),b;k=unescape(encodeURIComponent(k));var c=8*k.length;k=function(F){for(var I=[],J=8*F.length,M=0;M<J;M+=8)I[M>>5]|=(F.charCodeAt(M/8)&255)<<24-M%32;return I}(k);k[c>>5]|=128<<24-c%32;k[(c+128>>10<<5)+31]=c;for(c=0;c<k.length;c+=32){var e=t[0];var g=t[1];var l=t[2];var p=t[3];var u=t[4];var m=t[5];var z=t[6];var D=t[7];for(b=0;80>b;b++){f[b]=16>b?new v(k[2*b+c],
k[2*b+c+1]):n(H(f[b-2]),f[b-7],A(f[b-15]),f[b-16]);var E=q(D,x(u),new v(u.highOrder&m.highOrder^~u.highOrder&z.highOrder,u.lowOrder&m.lowOrder^~u.lowOrder&z.lowOrder),h[b],f[b]);var C=d(a(e),new v(e.highOrder&g.highOrder^e.highOrder&l.highOrder^g.highOrder&l.highOrder,e.lowOrder&g.lowOrder^e.lowOrder&l.lowOrder^g.lowOrder&l.lowOrder));D=z;z=m;m=u;u=d(p,E);p=l;l=g;g=e;e=d(E,C)}t[0]=d(e,t[0]);t[1]=d(g,t[1]);t[2]=d(l,t[2]);t[3]=d(p,t[3]);t[4]=d(u,t[4]);t[5]=d(m,t[5]);t[6]=d(z,t[6]);t[7]=d(D,t[7])}k=
[];for(c=0;c<t.length;c++)k.push(t[c].highOrder),k.push(t[c].lowOrder);return function(F){for(var I="",J=4*F.length,M,P=0;P<J;P+=1)M=F[P>>2]>>8*(3-P%4),I+="0123456789abcdef".charAt(M>>4&15)+"0123456789abcdef".charAt(M&15);return I}(k)};r.login||(r.login={},r.login.sha512=r.sha512);r.image=r.upload=function(k,v){var d={options:{}},n={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}},
q;for(q in n)v&&v.hasOwnProperty(q)?d.options[q]=v[q]:d.options[q]=n[q];1==d.options.multiple&&k.setAttribute("data-multiple",!0);k.content=[];k.classList.add("jupload");1==d.options.input&&k.classList.add("input");d.add=function(x){0==d.options.multiple&&(k.content=[],k.innerText="");if("image"==d.options.type){var A=document.createElement("img");A.setAttribute("src",x.file);A.setAttribute("tabindex",-1);k.getAttribute("name")||(A.className="jfile",A.content=x);k.appendChild(A)}else{A=x.name?x.name:
x.file;var H=document.createElement("div");H.innerText=A||d.options.type;H.classList.add("jupload-item");H.setAttribute("tabindex",-1);k.appendChild(H)}x.content&&(x.file=r.guid());k.content.push(x);if("function"==typeof d.options.onchange)d.options.onchange(k,x)};d.addFromFile=function(x){if(x.type.split("/")[0]==d.options.type){var A=new FileReader;A.addEventListener("load",function(H){H={file:H.srcElement.result,extension:x.name.substr(x.name.lastIndexOf(".")+1),name:x.name,size:x.size,lastmodified:x.lastModified,
content:H.srcElement.result};d.add(H)});A.readAsDataURL(x)}else alert(d.options.text.extensionNotAllowed)};d.addFromUrl=function(x){if("data"==x.substr(0,4)||d.options.remoteParser)if("data"==x.substr(0,4)){var A=x.split(";");A=A[0].split("/");A[0].replace("data:","")==d.options.type?d.add({file:x,name:"",extension:A[1],content:x}):alert(d.options.text.extensionNotAllowed)}else A=x.substr(x.lastIndexOf(".")+1),x=d.options.remoteParser+x,r.ajax({url:x,type:"GET",dataType:"blob",success:function(H){}});
else console.error("remoteParser not defined in your initialization")};n=d.options.type+"/"+d.options.extension;var y=document.createElement("input");y.type="file";y.setAttribute("accept",n);y.onchange=function(){for(var x=0;x<this.files.length;x++)d.addFromFile(this.files[x])};1==d.options.multiple&&y.setAttribute("multiple",!0);var a=null;k.addEventListener("click",function(x){a=null;k.children.length&&x.target!==k?x.target.parentNode==k&&(a=x.target):r.click(y)});k.addEventListener("dblclick",
function(x){r.click(y)});k.addEventListener("dragenter",function(x){k.style.border="1px dashed #000"});k.addEventListener("dragleave",function(x){k.style.border="1px solid #eee"});k.addEventListener("dragstop",function(x){k.style.border="1px solid #eee"});k.addEventListener("dragover",function(x){x.preventDefault()});k.addEventListener("keydown",function(x){a&&46==x.which&&(x=Array.prototype.indexOf.call(k.children,a),0<=x&&(k.content.splice(x,1),a.remove(),a=null))});k.addEventListener("drop",function(x){x.preventDefault();
x.stopPropagation();var A=(x.originalEvent||x).dataTransfer.getData("text/html");if((x.originalEvent||x).dataTransfer.files.length)for(A=0;A<x.dataTransfer.files.length;A++)d.addFromFile(x.dataTransfer.files[A]);else if(A&&(0==d.options.multiple&&(k.innerText=""),x=document.createElement("div"),x.innerHTML=A,x=x.querySelectorAll("img"),x.length))for(A=0;A<x.length;A++)d.addFromUrl(x[A].src);k.style.border="1px solid #eee";return!1});k.val=function(x){if(void 0===x)return k.content&&k.content.length?
k.content:null;k.innerText="";k.content=[];if(x)if(Array.isArray(x))for(var A=0;A<x.length;A++)"string"==typeof x[A]?d.add({file:x[A]}):d.add(x[A]);else"string"==typeof x&&d.add({file:x})};return k.upload=k.image=d};r.image.create=function(k){var v=document.createElement("img");v.setAttribute("src",k.file);v.className="jfile";v.setAttribute("tabindex",-1);v.content=k;return v};r.lazyLoading=function(k,v){v.loadUp&&"function"==typeof v.loadUp||(v.loadUp=function(){return!1});v.loadDown&&"function"==
typeof v.loadDown||(v.loadDown=function(){return!1});v.timer||(v.timer=100);var d=null,n=function(q){if(null==d){q=!1;var y=k.scrollTop;k.scrollTop+2*k.clientHeight>=k.scrollHeight?v.loadDown()&&(y==k.scrollTop&&(k.scrollTop-=k.clientHeight),q=!0):k.scrollTop<=k.clientHeight&&v.loadUp()&&(y==k.scrollTop&&(k.scrollTop+=k.clientHeight),q=!0);d=setTimeout(function(){d=null},v.timer);if(q&&"function"==typeof v.onupdate)v.onupdate()}};k.onscroll=function(q){n(q)};k.onwheel=function(q){n(q)};return{}};
r.loading=function(){var k={},v=null;k.show=function(){v||(v=document.createElement("div"),v.className="jloading");document.body.appendChild(v)};k.hide=function(){v&&v.parentNode&&document.body.removeChild(v)};return k}();r.mask=function(){var k={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:"YYYY YYY YY MMMMM MMMM MMM MM DDDDD DDDD DDD DD DY DAY WD D Q HH24 HH12 HH \\[H\\] H AM/PM PM AM MI SS MS MONTH MON Y M".split(" "),general:["A",
"0","[0-9a-zA-Z$]+","."]},v=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var m=0;this.date[4]&&(m=parseFloat(this.date[4]/60));m=parseInt(this.date[3])+m;m/=24}else if(this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]){if(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),m=r.two(this.date[0])+"-"+r.two(this.date[1])+"-"+r.two(this.date[2]),this.date[3]||this.date[4]||this.date[5])m+=" "+r.two(this.date[3])+":"+r.two(this.date[4])+":"+r.two(this.date[5])}else m=
r.two(this.date[3])+":"+r.two(this.date[4])+":"+r.two(this.date[5]);return m},d=function(m){return null===m||""===m||void 0===m?!0:!1},n=function(m){return"="==(""+m).chartAt(0)},q=function(m){return"currency"===m||"percentage"===m||"numeric"===m?!0:!1},y=function(m){if(m&&Number(m)==m)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var z=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=z[1]}m||(m=this.mask);z=RegExp("0{1}(.{1})0+","ig");if((z=z.exec(m))&&
z[1]&&1==z[1].length)return this.options.decimal=z[1],z[1];z=RegExp("#,##","ig");m.match(z)?this.options.decimal=".":this.options.decimal=",";return null},a=function(m,z){if(""==m)return"";z||(z=y.call(this));m=(""+m).split(z);m[0]=m[0].match(/[\-0-9]+/g,"");m[0]&&(m[0]=m[0].join(""));if(m[0])void 0!==m[1]&&(m[1]=m[1].match(/[0-9]+/g,""),m[1]=m[1]?m[1].join(""):"");else return"";return m},x=function(m){if(""==m)return"";var z=y.call(this),D=Object.create(this.options||{});D.minimumFractionDigits||
(D.minimumFractionDigits=1);m=a.call(this,m);if(""==m)return"";if(m[0]){var E=parseFloat(m.join("."));"percent"==D.style&&(E/=100)}else E=null;D=(new Intl.NumberFormat(this.locale,D)).format(E);D=D.split(z);(E=D[1].replace(/[0-9]*/g,""))&&(D[2]=E);D[1]=void 0!==m[1]?z+m[1]:"";return D.join("")},A=function(m){return(m=a.call(this,m))?parseFloat(m.join(".")):null},H=function(m,z){if(void 0===m){if("DIV"==this.tagName){var D=0,E=window.getSelection();E&&0!==E.rangeCount&&(D=E.getRangeAt(0),E=D.cloneRange(),
E.selectNodeContents(this),E.setEnd(D.endContainer,D.endOffset),D=E.toString().length);return D}return this.selectionStart}D=B.call(this);if(z){E=null;for(var C=0;C<D.length;C++)if(D[C].match(/[\-0-9]/g)||"."==D[C]||","==D[C])E=C;null===E&&(E=D.indexOf(" "));m>=E&&(m=E+1)}m>D.length&&(m=D.length);m&&("DIV"==this.tagName?(E=window.getSelection(),D=document.createRange(),D.setStart(this.childNodes[0],m),E.removeAllRanges(),E.addRange(D)):this.selectionEnd=this.selectionStart=m)},B=function(m,z,D){if("DIV"==
this.tagName){if(void 0===m)return this.innerText;this.innerText!==m&&(this.innerText=m,z&&H.call(this,z,D))}else{if(void 0===m)return this.value;this.value!==m&&(this.value=m,z&&H.call(this,z,D))}},t=r.calendar.weekdays,h=r.calendar.weekdaysShort,f=r.calendar.months,b=r.calendar.monthsShort,c={YEAR:function(m,z){var D=""+(new Date).getFullYear();"undefined"===typeof this.values[this.index]&&(this.values[this.index]="");0<=parseInt(m)&&10>=parseInt(m)&&this.values[this.index].length<z&&(this.values[this.index]+=
m);this.values[this.index].length==z&&(2==z?D=D.substr(0,2)+this.values[this.index]:3==z?D=D.substr(0,1)+this.values[this.index]:4==z&&(D=this.values[this.index]),this.date[0]=D,this.index++)},YYYY:function(m){c.YEAR.call(this,m,4)},YYY:function(m){c.YEAR.call(this,m,3)},YY:function(m){c.YEAR.call(this,m,2)},FIND:function(m,z){d(this.values[this.index])&&(this.values[this.index]="");for(var D=0,E=0,C=(this.values[this.index]+m).toLowerCase(),F=0;F<z.length;F++)0==z[F].toLowerCase().indexOf(C)&&(D=
F,E++);if(1<E)this.values[this.index]+=m;else if(1==E)return this.values[this.index]=z[D],this.index++,D},MMM:function(m){m=c.FIND.call(this,m,b);void 0!==m&&(this.date[1]=m+1)},MMMM:function(m){m=c.FIND.call(this,m,f);void 0!==m&&(this.date[1]=m+1)},MMMMM:function(m){d(this.values[this.index])&&(this.values[this.index]="");m=(this.values[this.index]+m).toLowerCase();for(var z=0;z<f.length;z++)if(0==f[z][0].toLowerCase().indexOf(m)){this.values[this.index]=f[z][0];this.date[1]=z+1;this.index++;break}},
MM:function(m){d(this.values[this.index])?1<parseInt(m)&&10>parseInt(m)?(this.date[1]=this.values[this.index]="0"+m,this.index++):2>parseInt(m)&&(this.values[this.index]=m):1==this.values[this.index]&&3>parseInt(m)?(this.date[1]=this.values[this.index]+=m,this.index++):0==this.values[this.index]&&0<parseInt(m)&&10>parseInt(m)&&(this.date[1]=this.values[this.index]+=m,this.index++)},M:function(m){var z=!1;0<=parseInt(m)&&10>parseInt(m)?d(this.values[this.index])?(this.values[this.index]=m,1<m&&(this.date[1]=
this.values[this.index],this.index++)):1==this.values[this.index]&&3>parseInt(m)?(this.date[1]=this.values[this.index]+=m,this.index++):0==this.values[this.index]&&0<parseInt(m)?(this.date[1]=this.values[this.index]+=m,this.index++):z=!0:z=!0;1==z&&(m=parseInt(this.values[this.index]),0<m&&12>m&&(this.date[2]=this.values[this.index],this.index++,this.position--))},D:function(m){var z=!1;0<=parseInt(m)&&10>parseInt(m)?d(this.values[this.index])?(this.values[this.index]=m,3<parseInt(m)&&(this.date[2]=
this.values[this.index],this.index++)):3==this.values[this.index]&&2>parseInt(m)?(this.date[2]=this.values[this.index]+=m,this.index++):1==this.values[this.index]||2==this.values[this.index]?(this.date[2]=this.values[this.index]+=m,this.index++):0==this.values[this.index]&&0<parseInt(m)?(this.date[2]=this.values[this.index]+=m,this.index++):z=!0:z=!0;1==z&&(m=parseInt(this.values[this.index]),0<m&&32>m&&(this.date[2]=this.values[this.index],this.index++,this.position--))},DD:function(m){d(this.values[this.index])?
3<parseInt(m)&&10>parseInt(m)?(this.date[2]=this.values[this.index]="0"+m,this.index++):10>parseInt(m)&&(this.values[this.index]=m):3==this.values[this.index]&&2>parseInt(m)?(this.date[2]=this.values[this.index]+=m,this.index++):(1==this.values[this.index]||2==this.values[this.index])&&10>parseInt(m)?(this.date[2]=this.values[this.index]+=m,this.index++):0==this.values[this.index]&&0<parseInt(m)&&10>parseInt(m)&&(this.date[2]=this.values[this.index]+=m,this.index++)},DDD:function(m){c.FIND.call(this,
m,h)},DDDD:function(m){c.FIND.call(this,m,t)},HH12:function(m,z){d(this.values[this.index])?1<parseInt(m)&&10>parseInt(m)?(z&&(m=0+m),this.date[3]=this.values[this.index]=m,this.index++):10>parseInt(m)&&(this.values[this.index]=m):1==this.values[this.index]&&3>parseInt(m)?(this.date[3]=this.values[this.index]+=m,this.index++):1>this.values[this.index]&&10>parseInt(m)&&(this.date[3]=this.values[this.index]+=m,this.index++)},HH24:function(m,z){0<=parseInt(m)&&10>parseInt(m)&&(null==this.values[this.index]||
""==this.values[this.index]?2<parseInt(m)&&10>parseInt(m)?(z&&(m=0+m),this.date[3]=this.values[this.index]=m,this.index++):10>parseInt(m)&&(this.values[this.index]=m):2==this.values[this.index]&&4>parseInt(m)?(this.date[3]=this.values[this.index]+=m,this.index++):2>this.values[this.index]&&10>parseInt(m)&&(this.date[3]=this.values[this.index]+=m,this.index++))},HH:function(m){c.HH24.call(this,m,1)},H:function(m){c.HH24.call(this,m,0)},"\\[H\\]":function(m){void 0==this.values[this.index]&&(this.values[this.index]=
"");m.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=m:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(m,z){null==this.values[this.index]||""==this.values[this.index]?5<parseInt(m)&&10>parseInt(m)?(this.date[z]=this.values[this.index]="0"+m,this.index++):10>parseInt(m)&&(this.values[this.index]=m):10>parseInt(m)&&(this.date[z]=this.values[this.index]+=m,this.index++)},MI:function(m){c.N60.call(this,m,4)},SS:function(m){c.N60.call(this,
m,5)},"AM/PM":function(m){this.values[this.index]="";m&&(this.values[this.index]=12<this.date[3]?"PM":"AM");this.index++},WD:function(m){"undefined"===typeof this.values[this.index]&&(this.values[this.index]="");0<=parseInt(m)&&7>parseInt(m)&&(this.values[this.index]=m);1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(m){var z=y.call(this),D=!1;d(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(D=!0);var E=a.call(this,this.values[this.index],
z);E&&(this.values[this.index]=E.join(z));if(0<=parseInt(m)&&10>parseInt(m)){if("0"!=this.values[this.index]||m==z)this.values[this.index]+=m}else this.values[this.index]&&m==z?z&&-1==this.values[this.index].indexOf(z)&&(this.values[this.index]+=m):"-"==m&&(D=!0);!0===D&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(m){c["0{1}(.{1}0+)?"].call(this,m);this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&
(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(m){c["0{1}(.{1}0+)?"].call(this,m);m=y.call(this);var z=this.tokens[this.index].substr(1,1),D="-"===this.values[this.index][0]?!0:!1,E=a.call(this,this.values[this.index],m);if(""!==E){var C=E[0].match(/[0-9]/g);if(C){C=C.join("");for(var F=[],I=0,J=C.length-1;0<=J;J--)F.push(C[J]),I++,I%3||F.push(z);F=F.reverse();E[0]=F.join("");E[0].substr(0,1)==z&&(E[0]=E[0].substr(1))}else E[0]="";this.values[this.index]=
E.join(m);D&&(this.values[this.index]="-"+this.values[this.index])}},0:function(m){m.match(/[0-9]/g)&&(this.values[this.index]=m,this.index++)},"[0-9a-zA-Z$]+":function(m){d(this.values[this.index])&&(this.values[this.index]="");var z=this.tokens[this.index];z[this.values[this.index].length]==m?(this.values[this.index]+=m,this.values[this.index]==z&&this.index++):(this.values[this.index]=z,this.index++,m.match(/[\-0-9]/g)&&this.position--)},A:function(m){m.match(/[a-zA-Z]/gi)&&(this.values[this.index]=
m,this.index++)},".":function(m){c["[0-9a-zA-Z$]+"].call(this,m)}},e=function(m){var z="general"==this.type?[].concat(k.general):[].concat(k.currency,k.datetime,k.percentage,k.numeric,k.general);z=new RegExp(z.join("|"),"gi");return m.match(z)},g=function(m){for(var z=this.type?"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"]:Object.keys(k),D=0;D<z.length;D++)for(var E=z[D],C=0;C<k[E].length;C++)if(m.match(new RegExp(k[E][C],
"gi")))return{type:E,method:k[E][C]}},l=function(m){var z=g.call(this,m);if(z)var D=z.type;if(D){var E=0;m=e.call(this,m);for(var C=0;C<m.length;C++)(z=g.call(this,m[C]))&&q(z.type)&&E++;1<E&&(D="general")}return D};n=function(m){return"="==(""+m)[0]?!0:!1};var p=function(m){return(""+ +m).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(z,D,E,C,F){return 0>F?D+"0."+Array(1-F-E.length).join(0)+E+C:D+E+C+Array(F-C.length+1).join(0)})},u=function(m,z,D){var E,C={input:null,value:null,options:{},values:[],
index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof m){C.input=m.target;C.value=B.call(m.target);C.caret=H.call(m.target);if(E=m.target.getAttribute("data-mask"))C.mask=E;if(E=m.target.getAttribute("data-type"))C.type=E;if(m.target.mask)m.target.mask.options&&(C.options=m.target.mask.options),m.target.mask.locale&&(C.locale=m.target.mask.locale);else if(E=m.target.getAttribute("data-locale"))C.locale=E,C.mask&&(C.options.style=C.mask);if(m.target.attributes&&m.target.attributes.length)for(E=
0;E<m.target.attributes.length;E++){var F=m.target.attributes[E].name;z=m.target.attributes[E].value;"data"==F.substr(0,4)&&(C.options[F.substr(5)]=z)}}else{if("string"==typeof z)C.mask=z;else for(F=Object.keys(z),E=0;E<F.length;E++)C[F[E]]=z[F[E]];"number"===typeof m&&(y.call(C,C.mask),m=(""+m).replace(".",C.options.decimal));C.value=m;C.input&&(B.call(C.input,m),r.focus(C.input),C.caret=H.call(C.input))}if(!n(C.value)&&(C.mask||C.locale)){C.mask&&(C.mask=C.mask.replace("[-]",""),C.mask.indexOf("##")&&
(E=C.mask.split(";"),E[0]&&(E[0]=E[0].replace("*",""),E[0]=E[0].replace(/_/g,""),E[0]=E[0].replace(/-/g,""),E[0]=E[0].replace("(",""),E[0]=E[0].replace(")","")),C.mask=E[0]),C.type||(C.type=l.call(C,C.mask)),C.tokens=e.call(C,C.mask));if("object"!==typeof m||!m.inputType||"insertText"==m.inputType||"insertFromPaste"==m.inputType)if(C.locale)if(C.input){if(m=C.input,F=B.call(m))y.call(C),E=x.call(C,F),F=E.length-F.length,F=H.call(m)+F,B.call(m,E,F,!0)}else var I=x.call(C,C.value);else{I=C.tokens;m=
[];for(E=0;E<I.length;E++)(F=g.call(C,I[E]))?m.push(F.method):m.push(null);for(E=0;E<m.length;E++)"MM"==m[E]&&(m[E-1]&&0<=m[E-1].indexOf("H")?m[E]="MI":m[E-2]&&0<=m[E-2].indexOf("H")?m[E]="MI":m[E+1]&&0<=m[E+1].indexOf("S")?m[E]="MI":m[E+2]&&0<=m[E+2].indexOf("S")&&(m[E]="MI"));for(C.methods=m;C.position<C.value.length&&"undefined"!==typeof C.tokens[C.index];)"function"==typeof c[C.methods[C.index]]?(c[C.methods[C.index]].call(C,C.value[C.position]),C.position++):(C.values[C.index]=C.tokens[C.index],
C.index++);if(q(C.type)){for(;"undefined"!==typeof C.tokens[C.index];)(E=g.call(C,C.tokens[C.index]))&&"general"==E.type&&(C.values[C.index]=C.tokens[C.index]),C.index++;m=!0}else m=!1;I=C.values.join("");C.input&&(E=I.length-C.value.length,B.call(C.input,I,0<E?C.caret+E:C.caret,m))}C.input&&(m=null,q(C.type)?(C.number=A.call(C,B.call(C.input)),m="percentage"==C.type?C.number/100:C.number):"datetime"==C.type&&(m=v.call(C),C.date[0]&&C.date[1]&&C.date[2]&&C.input.setAttribute("data-completed",!0)),
m&&C.input.setAttribute("data-value",m));if(void 0!==I)return D?C:I}};u.prepare=function(m,z){z||(z={});return e.call(z,m)};u.apply=function(m){var z=B.call(m.target);1==m.key.length&&(z+=m.key);B.call(m.target,u(z,m.target.getAttribute("data-mask")))};u.run=function(m,z,D){return u(m,{mask:z,decimal:D})};u.extract=function(m,z,D){if(d(m))return m;if("object"!=typeof z)return C;z.options||(z.options={});!z.mask&&z.format&&(z.mask=z.format);y.call(z,z.mask);var E=null;"percent"==z.type||"percent"==
z.options.style?E="percentage":z.mask&&(E=l.call(z,z.mask));if("datetime"===E){m instanceof Date&&r.calendar.getDateString(C,z.mask);m=u(m,z,!0);var C=v.call(m);m.date[0]&&m.date[1]&&m.date[2]&&!(m.date[3]||m.date[4]||m.date[5])&&(C=r.calendar.now(m.date),C=r.calendar.dateToNum(C))}else C=A.call(z,m),"percentage"==E&&(C/=100),m=z;m.value=C;return D?m:C};u.render=function(m,z,D){if(d(m)||"object"!=typeof z)return m;z.options||(z.options={});!z.mask&&z.format&&(z.mask=z.format);var E=null;"percent"==
z.type||"percent"==z.options.style?E="percentage":z.mask?E=l.call(z,z.mask):m instanceof Date&&(E="datetime");var C=!1;"datetime"==E||"calendar"==z.type?((E=r.calendar.getDateString(m,z.mask))&&(m=E),z.mask&&D&&(C=!0)):("percentage"==E&&(m*=100),"number"===typeof m?(z.mask&&D?(D=z.mask.match(RegExp("0{1}(.{1})0+","ig")))&&D[0]?(D=D[0].length-2,E=m.toFixed(D)):E=""+m:z.locale&&D?(D=(""+m).split("."),D[1]||(D[1]="00"),E=D.join(".")):E=p(m),null!==E&&(m=E,y.call(z,z.mask),z.options.decimal&&(m=m.replace(".",
z.options.decimal)))):z.mask&&D&&(C=!0));if(C&&(C=z.mask.length-m.length,0<C))for(D=0;D<C;D++)m+=" ";return m=u(m,z)};u.set=function(m,z){if(z){m.setAttribute("data-mask",z);var D=new Event("input",{bubbles:!0,cancelable:!0});m.dispatchEvent(D)}};"undefined"!==typeof document&&document.addEventListener("input",function(m){(m.target.getAttribute("data-mask")||m.target.mask)&&u(m)});return u}();r.modal=function(k,v){var d={options:{}},n={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,
title:null,padding:null},q;for(q in n)v&&v.hasOwnProperty(q)?d.options[q]=v[q]:d.options[q]=n[q];!d.options.title&&k.getAttribute("title")&&(d.options.title=k.getAttribute("title"));for(n=document.createElement("div");k.children[0];)n.appendChild(k.children[0]);d.content=document.createElement("div");d.content.className="jmodal_content";for(d.content.innerHTML=k.innerHTML;n.children[0];)d.content.appendChild(n.children[0]);d.container=document.createElement("div");d.container.className="jmodal";d.container.appendChild(d.content);
d.options.padding&&(d.content.style.padding=d.options.padding);d.options.width&&(d.container.style.width=d.options.width);d.options.height&&(d.container.style.height=d.options.height);d.options.title?d.container.setAttribute("title",d.options.title):d.container.classList.add("no-title");k.innerHTML="";k.style.display="none";k.appendChild(d.container);var y=document.createElement("div");y.className="jmodal_backdrop";y.onclick=function(){d.close()};k.appendChild(y);d.open=function(){k.style.display=
"block";var a=d.container.getBoundingClientRect();r.getWindowWidth()<a.width?(d.container.style.top="",d.container.style.left="",d.container.classList.add("jmodal_fullscreen"),r.animation.slideBottom(d.container,1)):y.style.display="block";r.modal.current=d;if("function"==typeof d.options.onopen)d.options.onopen(k,d)};d.resetPosition=function(){d.container.style.top="";d.container.style.left=""};d.isOpen=function(){return"none"!=k.style.display?!0:!1};d.close=function(){k.style.display="none";y.style.display=
"";r.modal.current=null;d.container.classList.remove("jmodal_fullscreen");if("function"==typeof d.options.onclose)d.options.onclose(k,d)};r.modal.hasEvents||(r.modal.current=d,!0==="ontouchstart"in document.documentElement?document.addEventListener("touchstart",r.modal.mouseDownControls):(document.addEventListener("mousedown",r.modal.mouseDownControls),document.addEventListener("mousemove",r.modal.mouseMoveControls),document.addEventListener("mouseup",r.modal.mouseUpControls)),document.addEventListener("keydown",
r.modal.keyDownControls),r.modal.hasEvents=!0);d.options.url?r.ajax({url:d.options.url,method:"GET",dataType:"text/html",success:function(a){d.content.innerHTML=a;d.options.closed||d.open()}}):d.options.closed||d.open();return k.modal=d};r.modal.current=null;r.modal.position=null;r.modal.keyDownControls=function(k){27==k.which&&r.modal.current&&r.modal.current.close()};r.modal.mouseUpControls=function(k){r.modal.current&&(r.modal.current.container.style.cursor="auto");r.modal.position=null};r.modal.mouseMoveControls=
function(k){if(r.modal.current&&r.modal.position)if(1==k.which||3==k.which){var v=r.modal.position;r.modal.current.container.style.top=v[1]+(k.clientY-v[3])+v[5]/2+"px";r.modal.current.container.style.left=v[0]+(k.clientX-v[2])+v[4]/2+"px";r.modal.current.container.style.cursor="move"}else r.modal.current.container.style.cursor="auto"};r.modal.mouseDownControls=function(k){r.modal.position=[];k.target.classList.contains("jmodal")&&setTimeout(function(){var v=k.target.getBoundingClientRect();if(k.changedTouches&&
k.changedTouches[0])var d=k.changedTouches[0].clientX,n=k.changedTouches[0].clientY;else d=k.clientX,n=k.clientY;50>v.width-(d-v.left)&&50>n-v.top?setTimeout(function(){r.modal.current.close()},100):k.target.getAttribute("title")&&50>n-v.top&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),r.modal.position=[v.left,v.top,k.clientX,k.clientY,v.width,v.height])},100)};r.notification=function(k){var v={options:{}},d={icon:null,name:"Notification",
date:null,error:null,title:null,message:null,timeout:4E3,autoHide:!0,closeable:!0};for(q in d)k&&k.hasOwnProperty(q)?v.options[q]=k[q]:v.options[q]=d[q];var n=document.createElement("div");n.className="jnotification";v.options.error&&n.classList.add("jnotification-error");k=document.createElement("div");k.className="jnotification-container";n.appendChild(k);d=document.createElement("div");d.className="jnotification-header";k.appendChild(d);var q=document.createElement("div");q.className="jnotification-image";
d.appendChild(q);if(v.options.icon){var y=document.createElement("img");y.src=v.options.icon;q.appendChild(y)}q=document.createElement("div");q.className="jnotification-name";q.innerHTML=v.options.name;d.appendChild(q);1==v.options.closeable&&(q=document.createElement("div"),q.className="jnotification-close",q.onclick=function(){v.hide()},d.appendChild(q));q=document.createElement("div");q.className="jnotification-date";d.appendChild(q);d=document.createElement("div");d.className="jnotification-content";
k.appendChild(d);v.options.title&&(k=document.createElement("div"),k.className="jnotification-title",k.innerHTML=v.options.title,d.appendChild(k));k=document.createElement("div");k.className="jnotification-message";k.innerHTML=v.options.message;d.appendChild(k);v.show=function(){document.body.appendChild(n);800<r.getWindowWidth()?r.animation.fadeIn(n):r.animation.slideTop(n,1)};v.hide=function(){800<r.getWindowWidth()?r.animation.fadeOut(n,function(){n.parentNode&&(n.parentNode.removeChild(n),a&&
clearTimeout(a))}):r.animation.slideTop(n,0,function(){n.parentNode&&(n.parentNode.removeChild(n),a&&clearTimeout(a))})};v.show();if(1==v.options.autoHide)var a=setTimeout(function(){v.hide()},v.options.timeout);800>r.getWindowWidth()&&n.addEventListener("swipeup",function(x){v.hide();x.preventDefault();x.stopPropagation()});return v};r.notification.isVisible=function(){var k=document.querySelector(".jnotification");return k&&k.parentNode?!0:!1};r.palette=function(k){var v={material:["#ffebee #fce4ec #f3e5f5 #e8eaf6 #e3f2fd #e0f7fa #e0f2f1 #e8f5e9 #f1f8e9 #f9fbe7 #fffde7 #fff8e1 #fff3e0 #fbe9e7 #efebe9 #fafafa #eceff1".split(" "),
"#ffcdd2 #f8bbd0 #e1bee7 #c5cae9 #bbdefb #b2ebf2 #b2dfdb #c8e6c9 #dcedc8 #f0f4c3 #fff9c4 #ffecb3 #ffe0b2 #ffccbc #d7ccc8 #f5f5f5 #cfd8dc".split(" "),"#ef9a9a #f48fb1 #ce93d8 #9fa8da #90caf9 #80deea #80cbc4 #a5d6a7 #c5e1a5 #e6ee9c #fff59d #ffe082 #ffcc80 #ffab91 #bcaaa4 #eeeeee #b0bec5".split(" "),"#e57373 #f06292 #ba68c8 #7986cb #64b5f6 #4dd0e1 #4db6ac #81c784 #aed581 #dce775 #fff176 #ffd54f #ffb74d #ff8a65 #a1887f #e0e0e0 #90a4ae".split(" "),"#ef5350 #ec407a #ab47bc #5c6bc0 #42a5f5 #26c6da #26a69a #66bb6a #9ccc65 #d4e157 #ffee58 #ffca28 #ffa726 #ff7043 #8d6e63 #bdbdbd #78909c".split(" "),
"#f44336 #e91e63 #9c27b0 #3f51b5 #2196f3 #00bcd4 #009688 #4caf50 #8bc34a #cddc39 #ffeb3b #ffc107 #ff9800 #ff5722 #795548 #9e9e9e #607d8b".split(" "),"#e53935 #d81b60 #8e24aa #3949ab #1e88e5 #00acc1 #00897b #43a047 #7cb342 #c0ca33 #fdd835 #ffb300 #fb8c00 #f4511e #6d4c41 #757575 #546e7a".split(" "),"#d32f2f #c2185b #7b1fa2 #303f9f #1976d2 #0097a7 #00796b #388e3c #689f38 #afb42b #fbc02d #ffa000 #f57c00 #e64a19 #5d4037 #616161 #455a64".split(" "),"#c62828 #ad1457 #6a1b9a #283593 #1565c0 #00838f #00695c #2e7d32 #558b2f #9e9d24 #f9a825 #ff8f00 #ef6c00 #d84315 #4e342e #424242 #37474f".split(" "),
"#b71c1c #880e4f #4a148c #1a237e #0d47a1 #006064 #004d40 #1b5e20 #33691e #827717 #f57f17 #ff6f00 #e65100 #bf360c #3e2723 #212121 #263238".split(" ")],fire:["0b1a6d 840f38 b60718 de030b ff0c0c fd491c fc7521 faa331 fbb535 ffc73a".split(" "),"071147 5f0b28 930513 be0309 ef0000 fa3403 fb670b f9991b faad1e ffc123".split(" "),"03071e 370617 6a040f 9d0208 d00000 dc2f02 e85d04 f48c06 faa307 ffba08".split(" "),"020619 320615 61040d 8c0207 bc0000 c82a02 d05203 db7f06 e19405 efab00".split(" "),"020515 2d0513 58040c 7f0206 aa0000 b62602 b94903 c57205 ca8504 d89b00".split(" ")],
baby:["eddcd2 fff1e6 fde2e4 fad2e1 c5dedd dbe7e4 f0efeb d6e2e9 bcd4e6 99c1de".split(" "),"e1c4b3 ffd5b5 fab6ba f5a8c4 aacecd bfd5cf dbd9d0 baceda 9dc0db 7eb1d5".split(" "),"daa990 ffb787 f88e95 f282a9 8fc4c3 a3c8be cec9b3 9dbcce 82acd2 649dcb".split(" "),"d69070 ff9c5e f66770 f05f8f 74bbb9 87bfae c5b993 83aac3 699bca 4d89c2".split(" "),"c97d5d f58443 eb4d57 e54a7b 66a9a7 78ae9c b5a67e 7599b1 5c88b7 4978aa".split(" ")]};return v[k]?v[k]:v.material};r.picker=function(k,v){if(k.picker)return k.picker.setOptions(v,
!0);var d={type:"picker",options:{}},n=null,q=null;d.setOptions=function(y,a){var x={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};y&&y.options&&(y.data=y.options);for(var A in x)if(y&&y.hasOwnProperty(A))d.options[A]=y[A];else if("undefined"==typeof d.options[A]||!0===a)d.options[A]=x[A];n.style.display=!1===d.options.header?"none":"";n.style.width=d.options.width?parseInt(d.options.width)+
"px":"";d.options.height?(q.style.maxHeight=d.options.height+"px",q.style.overflow="scroll"):q.style.overflow="";0<d.options.columns&&(q.classList.add("jpicker-columns"),q.style.width=d.options.width?d.options.width:36*d.options.columns+"px");isNaN(d.options.value)&&(d.options.value="0");q.innerHTML="";x=Object.keys(d.options.data);for(A=0;A<x.length;A++){var H=document.createElement("div");H.classList.add("jpicker-item");H.k=x[A];H.v=d.options.data[x[A]];H.innerHTML=d.getLabel(x[A]);q.appendChild(H)}d.setValue(d.options.value);
return d};d.getValue=function(){return d.options.value};d.setValue=function(y){d.setLabel(y);d.options.value=String(y);if(k.value!=d.options.value&&(k.value=d.options.value,"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value});"generic"!==q.children[y].getAttribute("type")&&d.close()};d.getLabel=function(y){y=d.options.data[y]||null;"function"==typeof d.options.render&&(y=d.options.render(y));return y};d.setLabel=function(y){y=d.options.content?'<i class="material-icons">'+
d.options.content+"</i>":d.getLabel(y);n.innerHTML=y};d.open=function(){if(!k.classList.contains("jpicker-focus")){r.tracking(d,!0);k.classList.add("jpicker-focus");k.focus();var y=n.getBoundingClientRect(),a=q.getBoundingClientRect();q.style.marginTop=window.innerHeight<y.bottom+a.height?-1*(a.height+4)+"px":y.height+2+"px";!0===d.options.right&&(q.style.marginLeft=-1*a.width+24+"px");if("function"==typeof d.options.onopen)d.options.onopen(k,d)}};d.close=function(){if(k.classList.contains("jpicker-focus")&&
(k.classList.remove("jpicker-focus"),r.tracking(d,!1),"function"==typeof d.options.onclose))d.options.onclose(k,d)};(function(){k.classList.add("jpicker");k.setAttribute("tabindex","900");k.onmousedown=function(y){k.classList.contains("jpicker-focus")||d.open()};n=document.createElement("div");n.classList.add("jpicker-header");q=document.createElement("div");q.classList.add("jpicker-content");q.onclick=function(y){(y=r.findElement(y.target,"jpicker-item"))&&y.parentNode===q&&(d.setValue(y.k),"function"==
typeof d.options.onchange&&d.options.onchange.call(d,k,d,y.v,y.v,y.k))};k.appendChild(n);k.appendChild(q);k.value=v.value||0;d.setOptions(v);if("function"==typeof d.options.onload)d.options.onload(k,d);k.change=d.setValue;k.val=function(y){if(void 0===y)return d.getValue();d.setValue(y)};k.picker=d})();return d};r.progressbar=function(k,v){var d={options:{}},n={value:0,onchange:null,width:null},q;for(q in n)v&&v.hasOwnProperty(q)?d.options[q]=v[q]:d.options[q]=n[q];k.classList.add("jprogressbar");
k.setAttribute("tabindex",1);k.setAttribute("data-value",d.options.value);var y=document.createElement("div");y.style.width=d.options.value+"%";y.style.color="#fff";k.appendChild(y);d.options.width&&(k.style.width=d.options.width);d.setValue=function(a){a=parseInt(a);d.options.value=a;y.style.width=a+"%";k.setAttribute("data-value",a+"%");k.style.color=6>a?"#000":"#fff";d.options.value=a;if("function"==typeof d.options.onchange)d.options.onchange(k,a);if(k.value!=d.options.value&&(k.value=d.options.value,
"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value})};d.getValue=function(){return d.options.value};n=function(a){if(a.which){var x=k.getBoundingClientRect();d.setValue(Math.round(((a.changedTouches&&a.changedTouches[0]?a.changedTouches[0].clientX:a.clientX)-x.left)/x.width*100))}};!0==="touchstart"in document.documentElement?(k.addEventListener("touchstart",n),k.addEventListener("touchend",n)):(k.addEventListener("mousedown",n),k.addEventListener("mousemove",n));k.change=
d.setValue;k.val=function(a){if(void 0===a)return d.getValue();d.setValue(a)};return k.progressbar=d};r.rating=function(k,v){if(k.rating)return k.rating.setOptions(v,!0);var d={options:{},setOptions:function(n,q){var y={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(a in y)if(n&&n.hasOwnProperty(a))d.options[a]=n[a];else if("undefined"==typeof d.options[a]||!0===q)d.options[a]=y[a];k.innerHTML="";for(y=0;y<d.options.number;y++){var a=document.createElement("div");
a.setAttribute("data-index",y+1);a.setAttribute("title",d.options.tooltip[y]);k.appendChild(a)}if(d.options.value)for(y=0;y<d.options.number;y++)y<d.options.value&&k.children[y].classList.add("jrating-selected");return d},setValue:function(n){for(var q=0;q<d.options.number;q++)q<n?k.children[q].classList.add("jrating-selected"):(k.children[q].classList.remove("jrating-over"),k.children[q].classList.remove("jrating-selected"));d.options.value=n;if("function"==typeof d.options.onchange)d.options.onchange(k,
n);if(k.value!=d.options.value&&(k.value=d.options.value,"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value})},getValue:function(){return d.options.value}};(function(){d.setOptions(v);k.classList.add("jrating");k.addEventListener("click",function(n){n=n.target.getAttribute("data-index");void 0!=n&&(n==d.options.value?d.setValue(0):d.setValue(n))});k.addEventListener("mouseover",function(n){n=n.target.getAttribute("data-index");for(var q=0;q<d.options.number;q++)q<n?k.children[q].classList.add("jrating-over"):
k.children[q].classList.remove("jrating-over")});k.addEventListener("mouseout",function(n){for(n=0;n<d.options.number;n++)k.children[n].classList.remove("jrating-over")});k.change=d.setValue;k.val=function(n){if(void 0===n)return d.getValue();d.setValue(n)};k.rating=d})();return d};r.search=function(k,v){if(k.search)return k.search;var d=null,n=function(A){x.innerHTML="";if(A.length){k.style.display="block";for(var H=11>A.length?A.length:10,B=0;B<H;B++){var t=A[B].text;!t&&A[B].name&&(t=A[B].name);
var h=A[B].value;!h&&A[B].id&&(h=A[B].id);var f=document.createElement("div");f.setAttribute("data-value",h);f.setAttribute("data-text",t);f.className="jsearch_item";A[B].id&&f.setAttribute("id",A[B].id);0==B&&f.classList.add("selected");h=document.createElement("img");A[B].image?h.src=A[B].image:h.style.display="none";f.appendChild(h);h=document.createElement("div");h.innerHTML=t;f.appendChild(h);x.appendChild(f)}}else k.style.display=""},q=function(A){if(A!=a.terms)if(a.terms=A,d=0,Array.isArray(a.options.data)){var H=
a.options.data.filter(function(B){a:{for(var t in B)if(0<=(""+B[t]).toLowerCase().search(A)){B=!0;break a}B=!1}return B});n(H)}else r.ajax({url:a.options.data+A,method:"GET",dataType:"json",success:function(B){n(B)}})},y=null,a=function(A){y&&clearTimeout(y);y=setTimeout(function(){q(A)},500)};a.options={data:v.data||null,input:v.input||null,onselect:v.onselect||null};a.selectIndex=function(A){var H=A.getAttribute("id"),B=A.getAttribute("data-text");A=A.getAttribute("data-value");if("function"==typeof a.options.onselect)a.options.onselect(a,
B,A,H);a.close()};a.open=function(){k.style.display="block"};a.close=function(){y&&clearTimeout(y);a.terms="";x.innerHTML="";k.style.display=""};a.isOpened=function(){return k.style.display?!0:!1};a.keydown=function(A){a.isOpened()&&("Enter"==A.key?x.children[d]&&(a.selectIndex(x.children[d]),A.preventDefault()):"ArrowUp"===A.key?(x.children[0]&&(x.children[d].classList.remove("selected"),0<d&&d--,x.children[d].classList.add("selected")),A.preventDefault()):"ArrowDown"===A.key&&(x.children[d].classList.remove("selected"),
9>d&&x.children[d+1]&&d++,x.children[d].classList.add("selected"),A.preventDefault()))};a.keyup=function(A){a.options.input?a(a.options.input.value):(A=r.getNode())&&a(A.innerText)};var x=document.createElement("div");x.classList.add("jsearch_container");x.onmousedown=function(A){var H=A.target.classList.contains("jsearch_item")?A.target:A.target.parentNode;a.selectIndex(H);A.preventDefault()};k.appendChild(x);k.classList.add("jsearch");return k.search=a};r.slider=function(k,v){var d={options:{},
currentImage:null};v&&(d.options=v);k.setAttribute("tabindex","900");d.options.items=[];if(!k.classList.contains("jslider")){k.classList.add("jslider");k.classList.add("unselectable");d.options.height&&(k.style.minHeight=d.options.height);d.options.width&&(k.style.width=d.options.width);if(d.options.grid){k.classList.add("jslider-grid");var n=k.children.length;4<n&&k.setAttribute("data-total",n-4);k.setAttribute("data-number",4<n?4:n)}var q=document.createElement("div");q.classList.add("jslider-counter");
if(0<k.children.length)for(n=0;n<k.children.length;n++){d.options.items.push(k.children[n]);var y=document.createElement("div");y.onclick=function(){var x=Array.prototype.slice.call(q.children).indexOf(this);d.show(d.currentImage=d.options.items[x])};q.appendChild(y)}n=document.createElement("div");n.className="jslider-caption";var a=document.createElement("div");y=document.createElement("div");y.className="jslider-close";y.innerHTML="";y.onclick=function(){d.close()};a.appendChild(n);a.appendChild(y)}d.updateCounter=
function(x){for(var A=0;A<q.children.length;A++)if(q.children[A].classList.contains("jslider-counter-focus")){q.children[A].classList.remove("jslider-counter-focus");break}q.children[x].classList.add("jslider-counter-focus")};d.show=function(x){x||(x=k.children[0]);k.classList.add("jslider-focus");k.classList.remove("jslider-grid");k.appendChild(a);k.appendChild(q);var A=d.options.items.indexOf(x);d.updateCounter(A);for(A=0;A<k.children.length;A++)k.children[A].style.display="";x.style.display="block";
x.previousElementSibling?k.classList.add("jslider-left"):k.classList.remove("jslider-left");x.nextElementSibling&&"IMG"==x.nextElementSibling.tagName?k.classList.add("jslider-right"):k.classList.remove("jslider-right");d.currentImage=x;d.currentImage.offsetHeight>d.currentImage.offsetWidth&&d.currentImage.classList.add("jslider-vertical");a.children[0].innerText=d.currentImage.getAttribute("title")};d.open=function(){d.show();if("function"==typeof d.options.onopen)d.options.onopen(k)};d.close=function(){k.classList.remove("jslider-focus");
k.classList.remove("jslider-left");k.classList.remove("jslider-right");d.options.grid&&k.classList.add("jslider-grid");for(var x=0;x<k.children.length;x++)k.children[x].style.display="";q.remove();a.remove();d.currentImage=null;if("function"==typeof d.options.onclose)d.options.onclose(k)};d.reset=function(){k.innerHTML=""};d.next=function(){var x=d.currentImage.nextElementSibling;x&&"IMG"===x.tagName&&d.show(d.currentImage.nextElementSibling)};d.prev=function(){d.currentImage.previousElementSibling&&
d.show(d.currentImage.previousElementSibling)};n=function(x){if("IMG"==x.target.tagName)d.show(x.target);else if(!x.target.classList.contains("jslider-close")&&!x.target.parentNode.classList.contains("jslider-counter")&&!x.target.classList.contains("jslider-counter")){var A=x.offsetX||x.changedTouches[0].clientX;40>x.target.clientWidth-A?d.next():40>A&&d.prev()}};!0==="ontouchend"in document.documentElement?k.addEventListener("touchend",n):k.addEventListener("mouseup",n);k.addEventListener("swipeleft",
function(x){d.next();x.preventDefault();x.stopPropagation()});k.addEventListener("swiperight",function(x){d.prev();x.preventDefault();x.stopPropagation()});k.addEventListener("keydown",function(x){27==x.which&&d.close()});return k.slider=d};r.sorting=function(k,v){var d={};var n={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},q=null,y;for(y in n)v&&v.hasOwnProperty(y)?d[y]=v[y]:d[y]=n[y];k.classList.add("jsorting");k.addEventListener("dragstart",function(x){var A=Array.prototype.indexOf.call(x.target.parentNode.children,
x.target);q={element:x.target,o:A,d:A};x.target.style.opacity="0.25";if("function"==typeof d.ondragstart)d.ondragstart(k,x.target,x)});k.addEventListener("dragover",function(x){x.preventDefault();a(x.target)&&q&&"true"==x.target.getAttribute("draggable")&&q.element!=x.target&&((d.direction?x.target.clientWidth/2>x.offsetX:x.target.clientHeight/2>x.offsetY)?x.target.parentNode.insertBefore(q.element,x.target):x.target.parentNode.insertBefore(q.element,x.target.nextSibling),q.d=Array.prototype.indexOf.call(x.target.parentNode.children,
q.element))});k.addEventListener("dragleave",function(x){x.preventDefault()});k.addEventListener("dragend",function(x){x.preventDefault();if(q){if("function"==typeof d.ondragend)d.ondragend(k,q.element,x);q.o<q.d?x.target.parentNode.insertBefore(q.element,x.target.parentNode.children[q.o]):x.target.parentNode.insertBefore(q.element,x.target.parentNode.children[q.o].nextSibling);q.element.style.opacity="";q=null}});k.addEventListener("drop",function(x){x.preventDefault();if(q&&q.o!=q.d&&"function"==
typeof d.ondrop)d.ondrop(k,q.o,q.d,q.element,x.target,x);q.element.style.opacity="";q=null});var a=function(x){function A(B){B.className&&B.classList.contains("jsorting")&&(H=!0);H||A(B.parentNode)}var H=!1;A(x);return H};for(n=0;n<k.children.length;n++)k.children[n].hasAttribute("draggable")||k.children[n].setAttribute("draggable","true");k.val=function(){for(var x,A=[],H=0;H<k.children.length;H++)(x=k.children[H].getAttribute("data-id"))&&A.push(x);return A};return k};r.tabs=function(k,v){var d=
{options:{}},n={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null};for(H in n)v&&v.hasOwnProperty(H)?d.options[H]=v[H]:d.options[H]=n[H];k.classList.add("jtabs");var q=null,y=null,a=null,x=function(B){if(d.options.animation){var t=d.headers.children[B].getBoundingClientRect();"modern"==d.options.palette?(a.style.width=t.width-
4+"px",a.style.left=d.headers.children[B].offsetLeft+2+"px"):(a.style.width=t.width+"px",a.style.left=d.headers.children[B].offsetLeft+"px");"bottom"==d.options.position?a.style.top="0px":a.style.bottom="0px"}},A=function(B){"function"==typeof d.headers.scrollTo?d.headers.scrollTo({left:B,behavior:"smooth"}):d.headers.scrollLeft=B;1>=B?q.classList.add("disabled"):q.classList.remove("disabled");B>=d.headers.scrollWidth-d.headers.offsetWidth?y.classList.add("disabled"):y.classList.remove("disabled");
d.headers.scrollWidth<=d.headers.offsetWidth?(q.style.display="none",y.style.display="none"):(q.style.display="",y.style.display="")};d.setBorder=x;d.open=function(B){for(var t=null,h=0;h<d.headers.children.length;h++)d.headers.children[h].classList.contains("jtabs-selected")&&(t=h),d.headers.children[h].classList.remove("jtabs-selected"),d.content.children[h]&&d.content.children[h].classList.remove("jtabs-selected");d.headers.children[B].classList.add("jtabs-selected");d.content.children[B]&&d.content.children[B].classList.add("jtabs-selected");
if(t!=B&&"function"==typeof d.options.onchange&&d.content.children[B])d.options.onchange(k,d,B,d.headers.children[B],d.content.children[B]);if(1==d.options.hideHeaders&&3>d.headers.children.length&&0==d.options.allowCreate)d.headers.parentNode.style.display="none";else{x(B);d.headers.parentNode.style.display="";t=d.headers.children[B].offsetLeft;B=t+d.headers.children[B].offsetWidth;h=d.headers.scrollLeft;var f=h+d.headers.offsetWidth;h<=t&&f>=B||A(t-1)}};d.selectIndex=function(B){B=Array.prototype.indexOf.call(d.headers.children,
B);0<=B&&d.open(B);return B};d.rename=function(B,t){t||(t=prompt("New title",d.headers.children[B].innerText));d.headers.children[B].innerText=t;d.open(B)};d.create=function(B,t){if("function"==typeof d.options.onbeforecreate){var h=d.options.onbeforecreate(k);if(!1===h)return!1;B=h}h=d.appendElement(B);if("function"==typeof d.options.oncreate)d.options.oncreate(k,h);return h};d.remove=function(B){return d.deleteElement(B)};d.nextNumber=function(){for(var B=0,t=0;t<d.headers.children.length;t++){var h=
d.headers.children[t].innerText.match(/[0-9].*/);h>B&&(B=parseInt(h))}B?B++:B=1;return B};d.deleteElement=function(B){if(d.headers.children[B])d.headers.removeChild(d.headers.children[B]),d.content.removeChild(d.content.children[B]);else return!1;d.open(0);if("function"==typeof d.options.ondelete)d.options.ondelete(k,B)};d.appendElement=function(B){B||(B=prompt("Title?",""));if(B){var t=document.createElement("div");d.content.appendChild(t);var h=document.createElement("div");h.innerHTML=B;h.content=
t;d.headers.insertBefore(h,d.headers.lastChild);d.options.allowChangePosition&&h.setAttribute("draggable","true");d.selectIndex(h);return t}};d.getActive=function(){for(var B=0;B<d.headers.children.length;B++)if(d.headers.children[B].classList.contains("jtabs-selected"))return B;return 0};d.updateContent=function(B,t){if("string"===typeof t){var h=document.createElement("div");h.innerHTML=t}d.content.children[B].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected");d.content.replaceChild(t,
d.content.children[B])};d.updatePosition=function(B,t){B>t?d.content.insertBefore(d.content.children[B],d.content.children[t]):d.content.insertBefore(d.content.children[B],d.content.children[t].nextSibling);d.open(t);if("function"==typeof d.options.onchangeposition)d.options.onchangeposition(d.headers,B,t)};d.move=function(B,t){B>t?d.headers.insertBefore(d.headers.children[B],d.headers.children[t]):d.headers.insertBefore(d.headers.children[B],d.headers.children[t].nextSibling);d.updatePosition(B,
t)};d.setBorder=x;d.init=function(){k.innerHTML="";d.headers=document.createElement("div");d.content=document.createElement("div");d.headers.classList.add("jtabs-headers");d.content.classList.add("jtabs-content");d.options.palette?k.classList.add("jtabs-modern"):k.classList.remove("jtabs-modern");d.options.padding&&(d.content.style.padding=parseInt(d.options.padding)+"px");var B=document.createElement("div");B.className="jtabs-headers-container";B.appendChild(d.headers);var t=document.createElement("div");
t.className="jtabs-controls";t.setAttribute("draggable","false");B.appendChild(t);"bottom"==d.options.position?(k.appendChild(d.content),k.appendChild(B)):(k.appendChild(B),k.appendChild(d.content));1==d.options.allowCreate&&(B=document.createElement("div"),B.className="jtabs-add",B.onclick=function(){d.create()},t.appendChild(B));q=document.createElement("div");q.className="jtabs-prev";q.onclick=function(){A(d.headers.scrollLeft-d.headers.offsetWidth)};t.appendChild(q);y=document.createElement("div");
y.className="jtabs-next";y.onclick=function(){A(d.headers.scrollLeft+d.headers.offsetWidth)};t.appendChild(y);for(t=0;t<d.options.data.length;t++){B=d.options.data[t].titleElement?d.options.data[t].titleElement:document.createElement("div");if(d.options.data[t].icon){var h=document.createElement("div"),f=document.createElement("i");f.classList.add("material-icons");f.innerHTML=d.options.data[t].icon;h.appendChild(f);B.appendChild(h)}d.options.data[t].title&&(h=document.createTextNode(d.options.data[t].title),
B.appendChild(h));d.options.data[t].width&&(B.style.width=d.options.data[t].width);d.options.data[t].contentElement?h=d.options.data[t].contentElement:(h=document.createElement("div"),h.innerHTML=d.options.data[t].content);d.headers.appendChild(B);d.content.appendChild(h)}a=document.createElement("div");a.className="jtabs-border";d.headers.appendChild(a);d.options.animation&&k.classList.add("jtabs-animation");d.headers.addEventListener("click",function(b){b=b.target.parentNode.classList.contains("jtabs-headers")?
b.target:"I"==b.target.tagName?b.target.parentNode.parentNode:b.target.parentNode;b=d.selectIndex(b);if("function"==typeof d.options.onclick)d.options.onclick(k,d,b,d.headers.children[b],d.content.children[b])});d.headers.addEventListener("contextmenu",function(b){d.selectIndex(b.target)});d.headers.children.length&&d.open(0);A(0);1==d.options.allowChangePosition&&r.sorting(d.headers,{direction:1,ondrop:function(b,c,e){d.updatePosition(c,e)}});if("function"==typeof d.options.onload)d.options.onload(k,
d)};if(k.children[0]&&k.children[0].children.length)for(n=0;n<k.children[0].children.length;n++){var H=d.options.data&&d.options.data[n]?d.options.data[n]:{};k.children[1]&&k.children[1].children[n]?(H.titleElement=k.children[0].children[n],H.contentElement=k.children[1].children[n]):H.contentElement=k.children[0].children[n];d.options.data[n]=H}H=!1;if(d.options.data)for(n=0;n<d.options.data.length;n++)d.options.data[n].url&&(r.ajax({url:d.options.data[n].url,type:"GET",dataType:"text/html",index:n,
success:function(B){d.options.data[this.index].content=B},complete:function(){d.init()}}),H=!0);H||d.init();return k.tabs=d};r.tags=function(k,v){if(k.tags)return k.tags.setOptions(v,!0);var d={type:"tags",options:{}},n=function(){return d.options.limit&&k.children.length>=d.options.limit?!0:!1},q=null,y=null;d.setOptions=function(p,u){var m={value:"",limit:null,limitMessage:"The limit of entries is: ",search:null,placeholder:null,validation:null,onbeforechange:null,onchange:null,onfocus:null,onblur:null,
onload:null,colors:null},z;for(z in m)if(p&&p.hasOwnProperty(z))d.options[z]=p[z];else if("undefined"==typeof d.options[z]||!0===u)d.options[z]=m[z];d.options.placeholder?k.setAttribute("data-placeholder",d.options.placeholder):k.removeAttribute("data-placeholder");k.placeholder=d.options.placeholder;d.setValue(d.options.value);H();d.options.search?y||(y=document.createElement("div"),k.parentNode.insertBefore(y,k.nextSibling),q=r.search(y,{data:d.options.search,onselect:function(D,E,C){d.selectIndex(E,
C)}})):y&&(q=null,y.remove(),y=null);return d};d.add=function(p,u){if("function"==typeof d.options.onbeforechange){var m=d.options.onbeforechange(k,d,d.options.value,p);if(!1===m)return!1;null!=m&&(p=m)}q&&q.close();if(n())alert(d.options.limitMessage+" "+d.options.limit);else{m=r.getNode();if(!(m&&m.parentNode&&m.parentNode.classList.contains("jtags")&&m.nextSibling)||m.nextSibling.innerText&&m.nextSibling.innerText.trim()){k.lastChild&&(k.lastChild.innerText.trim()||k.removeChild(k.lastChild));
if(p&&"string"!=typeof p)for(m=0;m<=p.length;m++){if(!n()){if(p[m]&&"string"!=typeof p[m])z=p[m].text,D=p[m].value;else var z=p[m]||"",D=null;z=x(z,D)}}else z=x(p,p,m);A()}else z=m.nextSibling;u&&a(z)}};d.remove=function(p){p.parentNode.removeChild(p);k.children.length?A():d.add("",!0)};d.getData=function(){for(var p=[],u=0;u<k.children.length;u++){var m=k.children[u].innerText.replace("\n",""),z=k.children[u].getAttribute("data-value");z||(z=m);(m||z)&&p.push({text:m,value:z})}return p};d.getValue=
function(p){var u;if(null!=p)(u=k.children[p].getAttribute("data-value"))||(u=k.children[p].innerText.replace("\n",""));else{p=[];for(var m=0;m<k.children.length;m++)(u=k.children[m].innerText.replace("\n",""))&&p.push(d.getValue(m));u=p.join(",")}return u};d.setValue=function(p){p?k.value!=p&&(Array.isArray(p)?d.add(p):(p=(""+p).trim(),p=t(p),k.innerHTML="",d.add(p))):d.reset()};d.reset=function(){k.classList.add("jtags-empty");k.innerHTML="<div></div>";A()};d.isValid=function(){for(var p=0,u=0;u<
k.children.length;u++)k.children[u].classList.contains("jtags_error")&&p++;return 0==p?!0:!1};d.selectIndex=function(p,u){var m=r.getNode();m&&(m.innerText=p,u&&m.setAttribute("data-value",u),m.classList.remove("jtags_error"),n()||d.add("",!0))};d.search=function(p){};d.destroy=function(){k.removeEventListener("mouseup",e);k.removeEventListener("keydown",f);k.removeEventListener("keyup",b);k.removeEventListener("paste",c);k.removeEventListener("focus",g);k.removeEventListener("blur",l);k.parentNode.removeChild(k)};
var a=function(p){var u=document.createRange(),m=window.getSelection();u.setStart(p,p.innerText.length||0);u.collapse(!0);m.removeAllRanges();m.addRange(u);p.scrollLeft=p.scrollWidth},x=function(p,u,m){var z=document.createElement("div");z.innerHTML=p?p:"";u&&z.setAttribute("data-value",u);m&&m.parentNode.classList.contains("jtags")?k.insertBefore(z,m.nextSibling):k.appendChild(z);return z},A=function(){var p=d.getValue();if(p!=d.options.value){d.options.value=p;if("function"==typeof d.options.onchange)d.options.onchange(k,
d,d.options.value);if(k.value!=d.options.value&&(k.value=d.options.value,"function"==typeof k.onchange))k.onchange({type:"change",target:k,value:k.value})}H()},H=function(){for(var p=0;p<k.children.length;p++)d.getValue(p)?(k.children[p].classList.add("jtags_label"),"function"==typeof d.options.validation?d.getValue(p)?d.options.validation(k.children[p],k.children[p].innerText,k.children[p].getAttribute("data-value"))?k.children[p].classList.remove("jtags_error"):k.children[p].classList.add("jtags_error"):
k.children[p].classList.remove("jtags_error"):k.children[p].classList.remove("jtags_error")):k.children[p].classList.remove("jtags_label");B()},B=function(){k.innerText.trim()?k.classList.remove("jtags-empty"):(k.innerHTML="<div></div>",k.classList.add("jtags-empty"))},t=function(p){var u=[],m="";if(p=p.trim()){for(var z=0;z<p.length;z++)","==p[z]||";"==p[z]||"\n"==p[z]?m&&(u.push(m.trim()),m=""):m+=p[z];m&&u.push(m)}return u},h=0,f=function(p){h=window.getSelection().anchorOffset;B();if("Tab"===
p.key||";"===p.key||","===p.key){var u=window.getSelection().anchorOffset;1<u&&(n()||d.add("",!0));p.preventDefault()}else"Enter"==p.key?q&&q.isOpened()||(u=window.getSelection().anchorOffset,1<u&&(n()||d.add("",!0)),p.preventDefault()):"Backspace"==p.key&&1==k.children.length&&1>window.getSelection().anchorOffset&&p.preventDefault();q&&q.keydown(p)},b=function(p){39==p.which?(p=window.getSelection().anchorOffset,1<p&&p==h&&d.add("",!0)):13==p.which||38==p.which||40==p.which?p.preventDefault():q&&
q.keyup(p);H()},c=function(p){if(p.clipboardData||p.originalEvent.clipboardData)var u=(p.originalEvent||p).clipboardData.getData("text/plain");else window.clipboardData&&(u=window.clipboardData.getData("Text"));u=t(u);1<u.length&&(d.add(u,!0),p.preventDefault())},e=function(p){if(p.target.parentNode&&p.target.parentNode.classList.contains("jtags")&&(p.target.classList.contains("jtags_label")||p.target.classList.contains("jtags_error"))){var u=p.target.getBoundingClientRect();16>u.width-(p.clientX-
u.left)&&d.remove(p.target)}p.target==k&&a(k.lastChild)},g=function(){if(!k.classList.contains("jtags-focus")){if(!k.children.length||d.getValue(k.children.length-1))n()||x("");if("function"==typeof d.options.onfocus)d.options.onfocus(k,d,d.getValue());k.classList.add("jtags-focus")}},l=function(){if(k.classList.contains("jtags-focus")){q&&q.close();for(var p=0;p<k.children.length-1;p++)d.getValue(p)||k.removeChild(k.children[p]);A();k.classList.remove("jtags-focus");if("function"==typeof d.options.onblur)d.options.onblur(k,
d,d.getValue())}};(function(){!0==="touchend"in document.documentElement?k.addEventListener("touchend",e):k.addEventListener("mouseup",e);k.addEventListener("keydown",f);k.addEventListener("keyup",b);k.addEventListener("paste",c);k.addEventListener("focus",g);k.addEventListener("blur",l);k.setAttribute("contenteditable",!0);k.classList.add("jtags");d.setOptions(v);if("function"==typeof d.options.onload)d.options.onload(k,d);k.change=d.setValue;k.val=function(p){if(void 0===p)return d.getValue();d.setValue(p)};
k.tags=d})();return d};r.toolbar=function(k,v){var d={options:{}},n={app:null,container:!1,badge:!1,title:!1,responsive:!1,items:[]},q;for(q in n)v&&v.hasOwnProperty(q)?d.options[q]=v[q]:d.options[q]=n[q];!k&&v.app&&v.app.el&&(k=document.createElement("div"),v.app.el.appendChild(k));var y=document.createElement("div");y.classList.add("jtoolbar-item");y.classList.add("jtoolbar-arrow");var a=document.createElement("div");a.classList.add("jtoolbar-floating");y.appendChild(a);d.selectItem=function(A){for(var H=
x.children,B=0;B<H.length;B++)A!=H[B]&&H[B].classList.remove("jtoolbar-selected");A.classList.add("jtoolbar-selected")};d.hide=function(){r.animation.slideBottom(k,0,function(){k.style.display="none"})};d.show=function(){k.style.display="";r.animation.slideBottom(k,1)};d.get=function(){return k};d.setBadge=function(A,H){x.children[A].children[1].firstChild.innerHTML=H};d.destroy=function(){toolbar.remove();k.innerHTML=""};d.update=function(A,H){for(var B=0;B<x.children.length;B++){var t=x.children[B];
"function"==typeof t.updateState&&t.updateState(k,d,t,A,H)}};d.create=function(A){x.innerHTML="";for(var H=0;H<A.length;H++){var B=document.createElement("div");B.classList.add("jtoolbar-item");A[H].width&&(B.style.width=parseInt(A[H].width)+"px");A[H].k&&(B.k=A[H].k);A[H].tooltip&&B.setAttribute("title",A[H].tooltip);A[H].id&&B.setAttribute("id",A[H].id);A[H].updateState&&(B.updateState=A[H].updateState);A[H].active&&B.classList.add("jtoolbar-active");if("select"==A[H].type||"dropdown"==A[H].type)r.picker(B,
A[H]);else if("divisor"==A[H].type)B.classList.add("jtoolbar-divisor");else if("label"==A[H].type)B.classList.add("jtoolbar-label"),B.innerHTML=A[H].content;else{var t=document.createElement("i");if("undefined"===typeof A[H]["class"])t.classList.add("material-icons");else for(var h=A[H]["class"].split(" "),f=0;f<h.length;f++)t.classList.add(h[f]);t.innerHTML=A[H].content?A[H].content:"";B.appendChild(t);1==d.options.badge&&(t=document.createElement("div"),t.classList.add("jbadge"),h=document.createElement("div"),
h.innerHTML=A[H].badge?A[H].badge:"",t.appendChild(h),B.appendChild(t));A[H].title&&(1==d.options.title?(t=document.createElement("span"),t.innerHTML=A[H].title,B.appendChild(t)):B.setAttribute("title",A[H].title));d.options.app&&A[H].route&&(B.route=A[H].route,B.onclick=function(){d.options.app.pages(this.route)},d.options.app.pages(A[H].route,{toolbarItem:B,closed:!0}))}A[H].onclick&&(B.onclick=A[H].onclick.bind(A[H],k,d,B));x.appendChild(B)}d.refresh()};d.open=function(){y.classList.add("jtoolbar-arrow-selected");
a.getBoundingClientRect().bottom>window.innerHeight?a.style.bottom="0":a.style.removeProperty("bottom");a.style.right="0";y.children[0].focus();r.tracking(d,!0)};d.close=function(){y.classList.remove("jtoolbar-arrow-selected");r.tracking(d,!1)};d.refresh=function(){if(1==d.options.responsive){for(y.remove();a.firstChild;)x.appendChild(a.firstChild);var A=k.parentNode.getBoundingClientRect().width;if(A<x.offsetWidth)for(A-=50;x.lastChild&&A<x.offsetWidth;)a.insertBefore(x.lastChild,a.firstChild);0<
a.children.length&&x.appendChild(y)}};k.onclick=function(A){var H=r.findElement(A.target,"jtoolbar-item");H&&d.selectItem(H);A.target.classList.contains("jtoolbar-arrow")&&d.open()};window.addEventListener("resize",function(){d.refresh()});k.classList.add("jtoolbar");k.innerHTML="";1==d.options.container&&k.classList.add("jtoolbar-container");var x=document.createElement("div");k.appendChild(x);d.options.app&&k.classList.add("jtoolbar-mobile");d.create(d.options.items);return k.toolbar=d};r.validations=
function(k,v){return"function"===typeof r.validations[v.type]?r.validations[v.type](k,v):null};r.validations.email=function(k){var v=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return k&&v.test(k)?!0:!1};r.validations.required=function(k){return k.trim()?!0:!1};r.validations.number=function(k){return r.isNumber(k)};r.validations.login=function(k){var v=new RegExp(/^[a-zA-Z0-9_\-\.\s+]+$/);return k&&v.test(k)?!0:!1};var w=function(k,v){return"="===v.constraint?k===v.reference:"<"===v.constraint?k<v.reference:
"<="===v.constraint?k<=v.reference:">"===v.constraint?k>v.reference:">="===v.constraint?k>=v.reference:"between"===v.constraint?k>=v.reference[0]&&k<=v.reference[1]:"not between"===v.constraint?k<v.reference[0]||k>v.reference[1]:null};r.validations.number=function(k,v){return r.isNumeric(k)?void 0===v||void 0===v.constraint?!0:w(k,v):!1};r.validations.date=function(k,v){return"Invalid Date"==new Date(k)?!1:void 0===v||void 0===v.constraint?!0:"object"===typeof v?(k=(new Date(k)).getTime(),Array.isArray(v.reference)?
v.reference=v.reference.map(function(d){return(new Date(d)).getTime()}):v.reference=(new Date(v.reference)).getTime(),w(k,v)):null};r.validations.itemList=function(k,v){return v.reference.some(function(d){return d==k})};r.validations.text=function(k,v){return"string"!==typeof k?!1:void 0===v||void 0===v.constraint?!0:"="===v.constraint?k===v.reference:"contains"===v.constraint?k.includes(v.reference):"not contain"===v.constraint?!k.includes(v.reference):"email"===v.constraint?r.validations.email(k):
"url"===v.constraint?(new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig)).test(k)?!0:!1:null};r.validations.constraints=function(){};return r})},{}],3:[function(T,S,U){if(!r&&"function"===typeof T)var r=T("jsuites");if(!w&&"function"===typeof w)var w=T("@jspreadsheet/formula");(function(k,v){"object"===typeof U&&"undefined"!==typeof S?S.exports=v():k.jspreadsheet=k.jexcel=v()})(this,function(){var k=function(){var q={title:"Jspreadsheet",version:"4.9.0",type:"CE",
host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}};return function(){return q}}(),v=function(q){q=(""+q)[0];return"="==q||"#"==q?!0:!1},d=function(q){if(q.format||q.mask||q.locale){var y={};q.mask?y.mask=q.mask:q.format?y.mask=q.format:(y.locale=q.locale,y.options=q.options);q.decimal&&(y.options||(y.options={}),y.options={decimal:q.decimal});return y}return null},n=function(q,y){var a={options:{}};
if(!(q instanceof Element||q instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==q.tagName)if(y=n.createFromTable(q,y)){var x=document.createElement("div");q.parentNode.insertBefore(x,q);q.remove();q=x}else return console.error("Jspreadsheet: el is not a valid DOM element"),!1;x={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,
defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",
csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,
onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,
onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",
orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",
thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var A in x)if(y&&y.hasOwnProperty(A))if("text"===
A){a.options[A]=x[A];for(var H in y[A])y[A].hasOwnProperty(H)&&(a.options[A][H]=y[A][H])}else a.options[A]=y[A];else a.options[A]=x[A];a.el=q;a.corner=null;a.contextMenu=null;a.textarea=null;a.ads=null;a.content=null;a.table=null;a.thead=null;a.tbody=null;a.rows=[];a.results=null;a.searchInput=null;a.toolbar=null;a.pagination=null;a.pageNumber=null;a.headerContainer=null;a.colgroupContainer=null;a.headers=[];a.records=[];a.history=[];a.formula=[];a.colgroup=[];a.selection=[];a.highlighted=[];a.selectedCell=
null;a.selectedContainer=null;a.style=[];a.data=null;a.filter=null;a.filters=[];a.cursor=null;a.historyIndex=-1;a.ignoreEvents=!1;a.ignoreHistory=!1;a.edition=null;a.hashString=null;a.resizing=null;a.dragging=null;1==a.options.lazyLoading&&0==a.options.tableOverflow&&0==a.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),a.options.lazyLoading=!1);a.fullscreen=function(b){null==b&&(b=!a.options.fullscreen);a.options.fullscreen!=
b&&(a.options.fullscreen=b,1==b?q.classList.add("fullscreen"):q.classList.remove("fullscreen"))};a.dispatch=function(b){if(!a.ignoreEvents){if("function"==typeof a.options.onevent)var c=a.options.onevent.apply(this,arguments);"function"==typeof a.options[b]&&(c=a.options[b].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==b&&a.options.persistance){var e=1==a.options.persistance?a.options.url:a.options.persistance,g=a.prepareJson(arguments[2]);a.save(e,g)}return c};a.prepareTable=
function(){var b=a.options.columns.length;if(a.options.data&&"undefined"!==typeof a.options.data[0]){var c=Object.keys(a.options.data[0]);c.length>b&&(b=c.length)}a.options.minDimensions[0]>b&&(b=a.options.minDimensions[0]);for(var e=[],g=0;g<b;g++)a.options.colHeaders[g]||(a.options.colHeaders[g]=""),a.options.colWidths[g]||(a.options.colWidths[g]=a.options.defaultColWidth),a.options.colAlignments[g]||(a.options.colAlignments[g]=a.options.defaultColAlign),a.options.columns[g]?a.options.columns[g].type||
(a.options.columns[g].type="text"):a.options.columns[g]={type:"text"},a.options.columns[g].name||(a.options.columns[g].name=c&&c[g]?c[g]:g),a.options.columns[g].source||(a.options.columns[g].source=[]),a.options.columns[g].options||(a.options.columns[g].options=[]),a.options.columns[g].editor||(a.options.columns[g].editor=null),a.options.columns[g].allowEmpty||(a.options.columns[g].allowEmpty=!1),a.options.columns[g].title||(a.options.columns[g].title=a.options.colHeaders[g]?a.options.colHeaders[g]:
""),a.options.columns[g].width||(a.options.columns[g].width=a.options.colWidths[g]?a.options.colWidths[g]:a.options.defaultColWidth),a.options.columns[g].align||(a.options.columns[g].align=a.options.colAlignments[g]?a.options.colAlignments[g]:"center"),"autocomplete"==a.options.columns[g].type||"dropdown"==a.options.columns[g].type?a.options.columns[g].url&&e.push({url:a.options.columns[g].url,index:g,method:"GET",dataType:"json",success:function(l){for(var p=0;p<l.length;p++)a.options.columns[this.index].source.push(l[p])}}):
"calendar"!=a.options.columns[g].type||a.options.columns[g].options.format||(a.options.columns[g].options.format="DD/MM/YYYY");e.length?r.ajax(e,function(){a.createTable()}):a.createTable()};a.createTable=function(){a.table=document.createElement("table");a.thead=document.createElement("thead");a.tbody=document.createElement("tbody");a.headers=[];a.colgroup=[];a.content=document.createElement("div");a.content.classList.add("jexcel_content");a.content.onscroll=function(p){a.scrollControls(p)};a.content.onwheel=
function(p){a.wheelControls(p)};a.toolbar=document.createElement("div");a.toolbar.classList.add("jexcel_toolbar");var b=document.createElement("div"),c=document.createTextNode(a.options.text.search+": ");a.searchInput=document.createElement("input");a.searchInput.classList.add("jexcel_search");b.appendChild(c);b.appendChild(a.searchInput);a.searchInput.onfocus=function(){a.resetSelection()};var e=document.createElement("div");if(0<a.options.pagination&&a.options.paginationOptions&&0<a.options.paginationOptions.length){a.paginationDropdown=
document.createElement("select");a.paginationDropdown.classList.add("jexcel_pagination_dropdown");a.paginationDropdown.onchange=function(){a.options.pagination=parseInt(this.value);a.page(0)};for(var g=0;g<a.options.paginationOptions.length;g++)c=document.createElement("option"),c.value=a.options.paginationOptions[g],c.innerHTML=a.options.paginationOptions[g],a.paginationDropdown.appendChild(c);a.paginationDropdown.value=a.options.pagination;e.appendChild(document.createTextNode(a.options.text.show));
e.appendChild(a.paginationDropdown);e.appendChild(document.createTextNode(a.options.text.entries))}c=document.createElement("div");c.classList.add("jexcel_filter");c.appendChild(e);c.appendChild(b);a.colgroupContainer=document.createElement("colgroup");g=document.createElement("col");g.setAttribute("width","50");a.colgroupContainer.appendChild(g);if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(g=0;g<a.options.nestedHeaders.length;g++)a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders[g]));
else a.thead.appendChild(a.createNestedHeader(a.options.nestedHeaders));a.headerContainer=document.createElement("tr");g=document.createElement("td");g.classList.add("jexcel_selectall");a.headerContainer.appendChild(g);for(g=0;g<a.options.columns.length;g++)a.createCellHeader(g),a.headerContainer.appendChild(a.headers[g]),a.colgroupContainer.appendChild(a.colgroup[g]);a.thead.appendChild(a.headerContainer);if(1==a.options.filters){a.filter=document.createElement("tr");b=document.createElement("td");
a.filter.appendChild(b);for(g=0;g<a.options.columns.length;g++)b=document.createElement("td"),b.innerHTML="&nbsp;",b.setAttribute("data-x",g),b.className="jexcel_column_filter","hidden"==a.options.columns[g].type&&(b.style.display="none"),a.filter.appendChild(b);a.thead.appendChild(a.filter)}a.table=document.createElement("table");a.table.classList.add("jexcel");a.table.setAttribute("cellpadding","0");a.table.setAttribute("cellspacing","0");a.table.setAttribute("unselectable","yes");a.table.appendChild(a.colgroupContainer);
a.table.appendChild(a.thead);a.table.appendChild(a.tbody);a.options.textOverflow||a.table.classList.add("jexcel_overflow");a.corner=document.createElement("div");a.corner.className="jexcel_corner";a.corner.setAttribute("unselectable","on");a.corner.setAttribute("onselectstart","return false");0==a.options.selectionCopy&&(a.corner.style.display="none");a.textarea=document.createElement("textarea");a.textarea.className="jexcel_textarea";a.textarea.id="jexcel_textarea";a.textarea.tabIndex="-1";a.contextMenu=
document.createElement("div");a.contextMenu.className="jexcel_contextmenu";r.contextmenu(a.contextMenu,{onclick:function(){a.contextMenu.contextmenu.close(!1)}});g=document.createElement("a");g.setAttribute("href","https://bossanova.uk/jspreadsheet/");a.ads=document.createElement("div");a.ads.className="jexcel_about";try{if("undefined"!==typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var l=document.createElement("img");l.src="//bossanova.uk/jspreadsheet/logo.png";
g.appendChild(l)}}catch(p){}l=document.createElement("span");l.innerHTML="Jspreadsheet CE";g.appendChild(l);a.ads.appendChild(g);document.createElement("div").classList.add("jexcel_table");a.pagination=document.createElement("div");a.pagination.classList.add("jexcel_pagination");l=document.createElement("div");g=document.createElement("div");a.pagination.appendChild(l);a.pagination.appendChild(g);a.options.pagination||(a.pagination.style.display="none");1==a.options.search&&q.appendChild(c);a.content.appendChild(a.table);
a.content.appendChild(a.corner);a.content.appendChild(a.textarea);q.appendChild(a.toolbar);q.appendChild(a.content);q.appendChild(a.pagination);q.appendChild(a.contextMenu);q.appendChild(a.ads);q.classList.add("jexcel_container");a.options.toolbar&&a.options.toolbar.length&&a.createToolbar();1==a.options.fullscreen?q.classList.add("fullscreen"):1==a.options.tableOverflow&&(a.options.tableHeight&&(a.content.style["overflow-y"]="auto",a.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",
a.content.style.maxHeight=a.options.tableHeight),a.options.tableWidth&&(a.content.style["overflow-x"]="auto",a.content.style.width=a.options.tableWidth));1!=a.options.tableOverflow&&a.options.toolbar&&q.classList.add("with-toolbar");1==a.options.columnDrag&&a.thead.classList.add("draggable");1==a.options.columnResize&&a.thead.classList.add("resizable");1==a.options.rowDrag&&a.tbody.classList.add("draggable");1==a.options.rowResize&&a.tbody.classList.add("resizable");a.setData();a.options.style&&a.setStyle(a.options.style,
null,null,1,1);if(a.options.classes)for(c=Object.keys(a.options.classes),g=0;g<c.length;g++)l=n.getIdFromColumnName(c[g],!0),a.records[l[1]][l[0]].classList.add(a.options.classes[c[g]])};a.refresh=function(){a.options.url?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(b){a.options.data=b.data?b.data:b;a.setData();1==a.options.loadingSpin&&r.loading.hide()}})):a.setData()};a.setData=function(b){b&&
("string"==typeof b&&(b=JSON.parse(b)),a.options.data=b);a.options.data||(a.options.data=[]);if(a.options.data&&a.options.data[0]&&!Array.isArray(a.options.data[0])){b=[];for(var c=0;c<a.options.data.length;c++){for(var e=[],g=0;g<a.options.columns.length;g++)e[g]=a.options.data[c][a.options.columns[g].name];b.push(e)}a.options.data=b}b=a.options.columns.length;c=a.options.data.length;e=a.options.minDimensions[0];g=a.options.minDimensions[1];b=e>b?e:b;e=g>c?g:c;for(c=0;c<e;c++)for(g=0;g<b;g++)void 0==
a.options.data[c]&&(a.options.data[c]=[]),void 0==a.options.data[c][g]&&(a.options.data[c][g]="");a.rows=[];a.results=null;a.records=[];a.history=[];a.historyIndex=-1;a.tbody.innerHTML="";1==a.options.lazyLoading?(g=0,b=100>a.options.data.length?a.options.data.length:100,a.options.pagination&&(a.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):a.options.pagination?(a.pageNumber||(a.pageNumber=0),g=a.options.pagination*a.pageNumber,b=a.options.pagination*
a.pageNumber+a.options.pagination,a.options.data.length<b&&(b=a.options.data.length)):(g=0,b=a.options.data.length);for(c=0;c<a.options.data.length;c++)e=a.createRow(c,a.options.data[c]),c>=g&&c<b&&a.tbody.appendChild(e);1!=a.options.lazyLoading&&a.options.pagination&&a.updatePagination();if(a.options.mergeCells)for(c=Object.keys(a.options.mergeCells),g=0;g<c.length;g++)b=a.options.mergeCells[c[g]],a.setMerge(c[g],b[0],b[1],1);a.updateTable();a.dispatch("onload",q,a)};a.getData=function(b,c){for(var e=
[],g,l=0,p=1==c||0==a.options.copyCompatibility?!0:!1,u=a.options.columns.length,m=a.options.data.length,z=0;z<m;z++){for(var D=g=0;D<u;D++)if(!b||a.records[z][D].classList.contains("highlight"))e[l]||(e[l]=[]),e[l][g]=p?a.options.data[z][D]:a.records[z][D].innerHTML,g++;0<g&&l++}return e};a.getJsonRow=function(b){b=a.options.data[b];for(var c=a.options.columns.length,e={},g=0;g<c;g++)a.options.columns[g].name||(a.options.columns[g].name=g),e[a.options.columns[g].name]=b[g];return e};a.getJson=function(b){for(var c=
[],e=a.options.columns.length,g=a.options.data.length,l=0;l<g;l++){for(var p=null,u=0;u<e;u++)if(!b||a.records[l][u].classList.contains("highlight"))null==p&&(p={}),a.options.columns[u].name||(a.options.columns[u].name=u),p[a.options.columns[u].name]=a.options.data[l][u];null!=p&&c.push(p)}return c};a.prepareJson=function(b){for(var c=[],e=0;e<b.length;e++){var g=b[e].x,l=b[e].y;g=a.options.columns[g].name?a.options.columns[g].name:g;c[l]||(c[l]={row:l,data:{}});c[l].data[g]=b[e].newValue}return c.filter(function(p){return null!=
p})};a.save=function(b,c){var e=a.dispatch("onbeforesave",q,a,c);if(e)c=e;else if(!1===e)return!1;r.ajax({url:b,method:"POST",dataType:"json",data:{data:JSON.stringify(c)},success:function(g){a.dispatch("onsave",q,a,c)}})};a.getRowData=function(b){return a.options.data[b]};a.setRowData=function(b,c){for(var e=0;e<a.headers.length;e++){var g=n.getColumnNameFromId([e,b]);null!=c[e]&&a.setValue(g,c[e])}};a.getColumnData=function(b){for(var c=[],e=0;e<a.options.data.length;e++)c.push(a.options.data[e][b]);
return c};a.setColumnData=function(b,c){for(var e=0;e<a.rows.length;e++){var g=n.getColumnNameFromId([b,e]);null!=c[e]&&a.setValue(g,c[e])}};a.createRow=function(b,c){a.records[b]||(a.records[b]=[]);c||(c=a.options.data[b]);a.rows[b]=document.createElement("tr");a.rows[b].setAttribute("data-y",b);var e=null;a.options.defaultRowHeight&&(a.rows[b].style.height=a.options.defaultRowHeight+"px");a.options.rows[b]&&(a.options.rows[b].height&&(a.rows[b].style.height=a.options.rows[b].height),a.options.rows[b].title&&
(e=a.options.rows[b].title));e||(e=parseInt(b+1));var g=document.createElement("td");g.innerHTML=e;g.setAttribute("data-y",b);g.className="jexcel_row";a.rows[b].appendChild(g);for(e=0;e<a.options.columns.length;e++)a.records[b][e]=a.createCell(e,b,c[e]),a.rows[b].appendChild(a.records[b][e]);return a.rows[b]};a.parseValue=function(b,c,e,g){"="==(""+e).substr(0,1)&&1==a.options.parseFormulas&&(e=a.executeFormula(e,b,c));(b=a.options.columns[b])&&!v(e)&&(c=d(b))&&(e&&e==Number(e)&&(e=Number(e)),b=r.mask.render(e,
c,!0),g&&c.mask&&(c=c.mask.split(";"),c[1]&&(c[1].match(RegExp("\\[Red\\]","gi"))&&(0>e?g.classList.add("red"):g.classList.remove("red")),c[1].match(RegExp("\\(","gi"))&&0>e&&(b="("+b+")"))),b&&(e=b));return e};a.createCell=function(b,c,e){var g=document.createElement("td");g.setAttribute("data-x",b);g.setAttribute("data-y",c);if("="==(""+e).substr(0,1)&&1==a.options.secureFormulas){var l=h(e);l!=e&&(e=l)}a.options.columns[b].editor?(!1===a.options.stripHTML||!1===a.options.columns[b].stripHTML?g.innerHTML=
e:g.innerText=e,"function"==typeof a.options.columns[b].editor.createCell&&(g=a.options.columns[b].editor.createCell(g))):"hidden"==a.options.columns[b].type?(g.style.display="none",g.innerText=e):"checkbox"==a.options.columns[b].type||"radio"==a.options.columns[b].type?(l=document.createElement("input"),l.type=a.options.columns[b].type,l.name="c"+b,l.checked=1==e||1==e||"true"==e?!0:!1,l.onclick=function(){a.setValue(g,this.checked)},1!=a.options.columns[b].readOnly&&0!=a.options.editable||l.setAttribute("disabled",
"disabled"),g.appendChild(l),a.options.data[c][b]=l.checked):"calendar"==a.options.columns[b].type?(l=r.calendar.extractDateFromString(e,a.options.columns[b].options.format),g.innerText=r.calendar.getDateString(l?l:e,a.options.columns[b].options.format)):"dropdown"==a.options.columns[b].type||"autocomplete"==a.options.columns[b].type?(g.classList.add("jexcel_dropdown"),g.innerText=a.getDropDownValue(b,e)):"color"==a.options.columns[b].type?"square"==a.options.columns[b].render?(l=document.createElement("div"),
l.className="color",l.style.backgroundColor=e,g.appendChild(l)):(g.style.color=e,g.innerText=e):"image"==a.options.columns[b].type?e&&"data:image"==e.substr(0,10)&&(l=document.createElement("img"),l.src=e,g.appendChild(l)):"html"==a.options.columns[b].type?g.innerHTML=B(a.parseValue(b,c,e,g)):!1===a.options.stripHTML||!1===a.options.columns[b].stripHTML?g.innerHTML=B(a.parseValue(b,c,e,g)):g.innerText=a.parseValue(b,c,e,g);1==a.options.columns[b].readOnly&&(g.className="readonly");g.style.textAlign=
a.options.columns[b].align?a.options.columns[b].align:"center";0!=a.options.columns[b].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[b].wordWrap||200<g.innerHTML.length)&&(g.style.whiteSpace="pre-wrap");0<b&&1==this.options.textOverflow&&(e||g.innerHTML?a.records[c][b-1].style.overflow="hidden":b==a.options.columns.length-1&&(g.style.overflow="hidden"));return g};a.createCellHeader=function(b){var c=a.options.columns[b].width?a.options.columns[b].width:a.options.defaultColWidth,e=a.options.columns[b].align?
a.options.columns[b].align:a.options.defaultColAlign;a.headers[b]=document.createElement("td");a.options.stripHTML?a.headers[b].innerText=a.options.columns[b].title?a.options.columns[b].title:n.getColumnName(b):a.headers[b].innerHTML=a.options.columns[b].title?a.options.columns[b].title:n.getColumnName(b);a.headers[b].setAttribute("data-x",b);a.headers[b].style.textAlign=e;a.options.columns[b].title&&a.headers[b].setAttribute("title",a.options.columns[b].title);a.options.columns[b].id&&a.headers[b].setAttribute("id",
a.options.columns[b].id);a.colgroup[b]=document.createElement("col");a.colgroup[b].setAttribute("width",c);"hidden"==a.options.columns[b].type&&(a.headers[b].style.display="none",a.colgroup[b].style.display="none")};a.updateNestedHeader=function(b,c,e){a.options.nestedHeaders[c][b].title&&(a.options.nestedHeaders[c][b].title=e,a.options.nestedHeaders[c].element.children[b+1].innerText=e)};a.createNestedHeader=function(b){var c=document.createElement("tr");c.classList.add("jexcel_nested");var e=document.createElement("td");
c.appendChild(e);b.element=c;for(var g=0,l=0;l<b.length;l++){b[l].colspan||(b[l].colspan=1);b[l].align||(b[l].align="center");b[l].title||(b[l].title="");e=b[l].colspan;for(var p=[],u=0;u<e;u++)a.options.columns[g]&&"hidden"==a.options.columns[g].type&&e++,p.push(g),g++;e=document.createElement("td");e.setAttribute("data-column",p.join(","));e.setAttribute("colspan",b[l].colspan);e.setAttribute("align",b[l].align);e.innerText=b[l].title;c.appendChild(e)}return c};a.createToolbar=function(b){b?a.options.toolbar=
b:b=a.options.toolbar;for(var c=0;c<b.length;c++)if("i"==b[c].type){var e=document.createElement("i");e.classList.add("jexcel_toolbar_item");e.classList.add("material-icons");e.setAttribute("data-k",b[c].k);e.setAttribute("data-v",b[c].v);e.setAttribute("id",b[c].id);b[c].tooltip&&e.setAttribute("title",b[c].tooltip);e.onclick=b[c].onclick&&typeof b[c].onclick?function(p){return function(){b[p].onclick(q,a,this)}}(c):function(){var p=this.getAttribute("data-k"),u=this.getAttribute("data-v");a.setStyle(a.highlighted,
p,u)};e.innerText=b[c].content;a.toolbar.appendChild(e)}else if("select"==b[c].type){e=document.createElement("select");e.classList.add("jexcel_toolbar_item");e.setAttribute("data-k",b[c].k);b[c].tooltip&&e.setAttribute("title",b[c].tooltip);e.onchange=b[c].onchange&&typeof b[c].onchange?b[c].onchange:function(){var p=this.getAttribute("data-k");a.setStyle(a.highlighted,p,this.value)};for(var g=0;g<b[c].v.length;g++){var l=document.createElement("option");l.value=b[c].v[g];l.innerText=b[c].v[g];e.appendChild(l)}a.toolbar.appendChild(e)}else"color"==
b[c].type&&(e=document.createElement("i"),e.classList.add("jexcel_toolbar_item"),e.classList.add("material-icons"),e.setAttribute("data-k",b[c].k),e.setAttribute("data-v",""),b[c].tooltip&&e.setAttribute("title",b[c].tooltip),a.toolbar.appendChild(e),e.innerText=b[c].content,r.color(e,{onchange:function(p,u){var m=p.getAttribute("data-k");a.setStyle(a.highlighted,m,u)}}))};a.setMerge=function(b,c,e,g){var l=!1;if(!b)if(a.highlighted.length){c=parseInt(a.highlighted[0].getAttribute("data-x"));e=parseInt(a.highlighted[0].getAttribute("data-y"));
var p=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-x")),u=parseInt(a.highlighted[a.highlighted.length-1].getAttribute("data-y"));b=n.getColumnNameFromId([c,e]);c=p-c+1;e=u-e+1}else return alert(a.options.text.noCellsSelected),null;u=n.getIdFromColumnName(b,!0);if(a.options.mergeCells[b])a.records[u[1]][u[0]].getAttribute("data-merged")&&(l=a.options.text.cellAlreadyMerged);else if((!c||2>c)&&(!e||2>e))l=a.options.text.invalidMergeProperties;else for(p=u[1];p<u[1]+e;p++)for(var m=
u[0];m<u[0]+c;m++)n.getColumnNameFromId([m,p]),a.records[p][m].getAttribute("data-merged")&&(l=a.options.text.thereIsAConflictWithAnotherMergedCell);if(l)alert(l);else{1<c?a.records[u[1]][u[0]].setAttribute("colspan",c):c=1;1<e?a.records[u[1]][u[0]].setAttribute("rowspan",e):e=1;a.options.mergeCells[b]=[c,e,[]];a.records[u[1]][u[0]].setAttribute("data-merged","true");a.records[u[1]][u[0]].style.overflow="hidden";l=[];for(p=u[1];p<u[1]+e;p++)for(m=u[0];m<u[0]+c;m++)if(u[0]!=m||u[1]!=p)l.push(a.options.data[p][m]),
a.updateCell(m,p,"",!0),a.options.mergeCells[b][2].push(a.records[p][m]),a.records[p][m].style.display="none",a.records[p][m]=a.records[u[1]][u[0]];a.updateSelection(a.records[u[1]][u[0]]);g||(a.setHistory({action:"setMerge",column:b,colspan:c,rowspan:e,data:l}),a.dispatch("onmerge",q,b,c,e))}};a.getMerge=function(b){var c={};if(b)c=a.options.mergeCells[b]?[a.options.mergeCells[b][0],a.options.mergeCells[b][1]]:null;else if(a.options.mergeCells){b=Object.keys(a.options.mergeCells);for(var e=0;e<b.length;e++)c[b[e]]=
[a.options.mergeCells[b[e]][0],a.options.mergeCells[b[e]][1]]}return c};a.removeMerge=function(b,c,e){if(a.options.mergeCells[b]){var g=n.getIdFromColumnName(b,!0);a.records[g[1]][g[0]].removeAttribute("colspan");a.records[g[1]][g[0]].removeAttribute("rowspan");a.records[g[1]][g[0]].removeAttribute("data-merged");for(var l=a.options.mergeCells[b],p=0,u=0;u<l[1];u++)for(var m=0;m<l[0];m++)if(0<u||0<m)a.records[g[1]+u][g[0]+m]=l[2][p],a.records[g[1]+u][g[0]+m].style.display="",c&&c[p]&&a.updateCell(g[0]+
m,g[1]+u,c[p]),p++;a.updateSelection(a.records[g[1]][g[0]],a.records[g[1]+u-1][g[0]+m-1]);e||delete a.options.mergeCells[b]}};a.destroyMerged=function(b){if(a.options.mergeCells)for(var c=Object.keys(a.options.mergeCells),e=0;e<c.length;e++)a.removeMerge(c[e],null,b)};a.isColMerged=function(b,c){var e=[];if(a.options.mergeCells)for(var g=Object.keys(a.options.mergeCells),l=0;l<g.length;l++){var p=n.getIdFromColumnName(g[l],!0),u=a.options.mergeCells[g[l]][0],m=p[0];p=p[0]+(1<u?u-1:0);null==c?m<=b&&
p>=b&&e.push(g[l]):c?m<b&&p>=b&&e.push(g[l]):m<=b&&p>b&&e.push(g[l])}return e};a.isRowMerged=function(b,c){var e=[];if(a.options.mergeCells)for(var g=Object.keys(a.options.mergeCells),l=0;l<g.length;l++){var p=n.getIdFromColumnName(g[l],!0),u=a.options.mergeCells[g[l]][1],m=p[1];p=p[1]+(1<u?u-1:0);null==c?m<=b&&p>=b&&e.push(g[l]):c?m<b&&p>=b&&e.push(g[l]):m<=b&&p>b&&e.push(g[l])}return e};a.openFilter=function(b){if(a.options.filters){b=parseInt(b);a.resetSelection();var c=[];if("checkbox"==a.options.columns[b].type)c.push({id:"true",
name:"True"}),c.push({id:"false",name:"False"});else{for(var e=[],g=!1,l=0;l<a.options.data.length;l++){c=a.options.data[l][b];var p=a.records[l][b].innerHTML;c&&p?e[c]=p:g=!0}p=Object.keys(e);c=[];for(l=0;l<p.length;l++)c.push({id:p[l],name:e[p[l]]});g&&c.push({value:"",id:"",name:"(Blanks)"})}e=document.createElement("div");a.filter.children[b+1].innerHTML="";a.filter.children[b+1].appendChild(e);a.filter.children[b+1].style.paddingLeft="0px";a.filter.children[b+1].style.paddingRight="0px";a.filter.children[b+
1].style.overflow="initial";r.dropdown(e,{data:c,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==a.filters[b]?a.filters[b]:null,width:"100%",position:1==a.options.tableOverflow||1==a.options.fullscreen?!0:!1,onclose:function(u){a.resetFilters();a.filters[b]=u.dropdown.getValue(!0);a.filter.children[b+1].innerHTML=u.dropdown.getText();a.filter.children[b+1].style.paddingLeft="";a.filter.children[b+1].style.paddingRight="";a.filter.children[b+1].style.overflow="";a.closeFilter(b);a.refreshSelection()}})}else console.log("Jspreadsheet: filters not enabled.")};
a.resetFilters=function(){if(a.options.filters)for(var b=0;b<a.filter.children.length;b++)a.filter.children[b].innerHTML="&nbsp;",a.filters[b]=null};a.closeFilter=function(b){if(!b)for(var c=0;c<a.filter.children.length;c++)a.filters[c]&&(b=c);c=a.filters[b];a.results=[];for(var e=0;e<a.options.data.length;e++){a:{var g=c;for(var l=b,p=e,u=0;u<g.length;u++)if(""==g[u]&&(!1===a.options.data[p][l]||""==""+a.options.data[p][l])||""!=g[u]&&(0<=(""+a.options.data[p][l]).search(g[u])||0<=(""+a.records[p][l].innerHTML).search(g[u]))){g=
!0;break a}g=!1}g&&a.results.push(e)}a.results.length||(a.results=null);a.updateResult()};a.openEditor=function(b,c,e){var g=b.getAttribute("data-y"),l=b.getAttribute("data-x");a.dispatch("oneditionstart",q,b,l,g);0<l&&(a.records[g][l-1].style.overflow="hidden");var p=function(z){var D=b.getBoundingClientRect();z=document.createElement(z);z.style.width=D.width+"px";z.style.height=D.height-2+"px";z.style.minHeight=D.height-2+"px";b.classList.add("editor");b.innerHTML="";b.appendChild(z);a.dispatch("oncreateeditor",
q,b,l,g,z);return z};if(1!=b.classList.contains("readonly"))if(a.edition=[a.records[g][l],a.records[g][l].innerHTML,l,g],a.options.columns[l].editor)a.options.columns[l].editor.openEditor(b,q,c,e);else if("hidden"!=a.options.columns[l].type)if("checkbox"==a.options.columns[l].type||"radio"==a.options.columns[l].type)c=b.children[0].checked?!1:!0,a.setValue(b,c),a.edition=null;else if("dropdown"==a.options.columns[l].type||"autocomplete"==a.options.columns[l].type){c=a.options.data[g][l];a.options.columns[l].multiple&&
!Array.isArray(c)&&(c=c.split(";"));var u="function"==typeof a.options.columns[l].filter?a.options.columns[l].filter(q,b,l,g,a.options.columns[l].source):a.options.columns[l].source;e=[];for(var m=0;m<u.length;m++)e.push(u[m]);p=p("div");u={data:e,multiple:a.options.columns[l].multiple?!0:!1,autocomplete:a.options.columns[l].autocomplete||"autocomplete"==a.options.columns[l].type?!0:!1,opened:!0,value:c,width:"100%",height:p.style.minHeight,position:1==a.options.tableOverflow||1==a.options.fullscreen?
!0:!1,onclose:function(){a.closeEditor(b,!0)}};a.options.columns[l].options&&a.options.columns[l].options.type&&(u.type=a.options.columns[l].options.type);r.dropdown(p,u)}else if("calendar"==a.options.columns[l].type||"color"==a.options.columns[l].type){c=a.options.data[g][l];p=p("input");p.value=c;if(1==a.options.tableOverflow||1==a.options.fullscreen)a.options.columns[l].options.position=!0;a.options.columns[l].options.value=a.options.data[g][l];a.options.columns[l].options.opened=!0;a.options.columns[l].options.onclose=
function(z,D){a.closeEditor(b,!0)};"color"==a.options.columns[l].type?r.color(p,a.options.columns[l].options):r.calendar(p,a.options.columns[l].options);p.focus()}else"html"==a.options.columns[l].type?(c=a.options.data[g][l],p=p("div"),p.style.position="relative",e=document.createElement("div"),e.classList.add("jexcel_richtext"),p.appendChild(e),r.editor(e,{focus:!0,value:c}),c=b.getBoundingClientRect(),p=e.getBoundingClientRect(),e.style.top=window.innerHeight<c.bottom+p.height?c.top-(p.height+2)+
"px":c.top+"px"):"image"==a.options.columns[l].type?(c=b.children[0],p=p("div"),p.style.position="relative",e=document.createElement("div"),e.classList.add("jclose"),c&&c.src&&e.appendChild(c),p.appendChild(e),r.image(e,a.options.imageOptions),c=b.getBoundingClientRect(),p=e.getBoundingClientRect(),e.style.top=window.innerHeight<c.bottom+p.height?c.top-(p.height+2)+"px":c.top+"px"):(c=1==c?"":a.options.data[g][l],p=0==a.options.columns[l].wordWrap||1!=a.options.wordWrap&&1!=a.options.columns[l].wordWrap?
p("input"):p("textarea"),p.focus(),p.value=c,u=a.options.columns[l],e=null,!v(c)&&(e=d(u))&&(u.disabledMaskOnEdition||(u.mask?(u=u.mask.split(";"),p.setAttribute("data-mask",u[0])):u.locale&&p.setAttribute("data-locale",u.locale)),e.input=p,p.mask=e,r.mask.render(c,e,!1)),p.onblur=function(){a.closeEditor(b,!0)},p.scrollLeft=p.scrollWidth)};a.closeEditor=function(b,c){var e=parseInt(b.getAttribute("data-x")),g=parseInt(b.getAttribute("data-y"));if(1==c){if(a.options.columns[e].editor)var l=a.options.columns[e].editor.closeEditor(b,
c);else if("checkbox"!=a.options.columns[e].type&&"radio"!=a.options.columns[e].type&&"hidden"!=a.options.columns[e].type)if("dropdown"==a.options.columns[e].type||"autocomplete"==a.options.columns[e].type)l=b.children[0].dropdown.close(!0);else if("calendar"==a.options.columns[e].type)l=b.children[0].calendar.close(!0);else if("color"==a.options.columns[e].type)l=b.children[0].color.close(!0);else if("html"==a.options.columns[e].type)l=b.children[0].children[0].editor.getData();else if("image"==
a.options.columns[e].type)l=(l=b.children[0].children[0].children[0])&&"IMG"==l.tagName?l.src:"";else if("numeric"==a.options.columns[e].type)l=b.children[0].value,"="!=l.substr(0,1)&&""==l&&(l=a.options.columns[e].allowEmpty?"":0),b.children[0].onblur=null;else{l=b.children[0].value;b.children[0].onblur=null;var p;(p=d(a.options.columns[e]))&&""!==l&&!v(l)&&"number"!==typeof l&&(p=r.mask.extract(l,p,!0))&&""!==p.value&&(l=p.value)}a.options.data[g][e]==l?b.innerHTML=a.edition[1]:a.setValue(b,l)}else a.options.columns[e].editor?
a.options.columns[e].editor.closeEditor(b,c):"dropdown"==a.options.columns[e].type||"autocomplete"==a.options.columns[e].type?b.children[0].dropdown.close(!0):"calendar"==a.options.columns[e].type?b.children[0].calendar.close(!0):"color"==a.options.columns[e].type?b.children[0].color.close(!0):b.children[0].onblur=null,b.innerHTML=a.edition&&a.edition[1]?a.edition[1]:"";a.dispatch("oneditionend",q,b,e,g,l,c);b.classList.remove("editor");a.edition=null};a.getCell=function(b){b=n.getIdFromColumnName(b,
!0);return a.records[b[1]][b[0]]};a.getCellFromCoords=function(b,c){return a.records[c][b]};a.getLabel=function(b){b=n.getIdFromColumnName(b,!0);return a.records[b[1]][b[0]].innerHTML};a.getLabelFromCoords=function(b,c){return a.records[c][b].innerHTML};a.getValue=function(b,c){if("object"==typeof b)var e=b.getAttribute("data-x"),g=b.getAttribute("data-y");else b=n.getIdFromColumnName(b,!0),e=b[0],g=b[1];var l=null;null!=e&&null!=g&&(a.records[g]&&a.records[g][e]&&(c||1==a.options.copyCompatibility)?
l=a.records[g][e].innerHTML:a.options.data[g]&&"undefined"!=a.options.data[g][e]&&(l=a.options.data[g][e]));return l};a.getValueFromCoords=function(b,c,e){var g=null;null!=b&&null!=c&&(a.records[c]&&a.records[c][b]&&e||1==a.options.copyCompatibility?g=a.records[c][b].innerHTML:a.options.data[c]&&"undefined"!=a.options.data[c][b]&&(g=a.options.data[c][b]));return g};a.setValue=function(b,c,e){var g=[];if("string"==typeof b){var l=n.getIdFromColumnName(b,!0),p=l[0];l=l[1];g.push(a.updateCell(p,l,c,
e));a.updateFormulaChain(p,l,g)}else if(l=p=null,b&&b.getAttribute&&(p=b.getAttribute("data-x"),l=b.getAttribute("data-y")),null!=p&&null!=l)g.push(a.updateCell(p,l,c,e)),a.updateFormulaChain(p,l,g);else{var u=Object.keys(b);if(0<u.length)for(var m=0;m<u.length;m++)"string"==typeof b[m]?(l=n.getIdFromColumnName(b[m],!0),p=l[0],l=l[1]):null!=b[m].x&&null!=b[m].y?(p=b[m].x,l=b[m].y,null!=b[m].newValue?c=b[m].newValue:null!=b[m].value&&(c=b[m].value)):(p=b[m].getAttribute("data-x"),l=b[m].getAttribute("data-y")),
null!=p&&null!=l&&(g.push(a.updateCell(p,l,c,e)),a.updateFormulaChain(p,l,g))}a.setHistory({action:"setValue",records:g,selection:a.selectedCell});a.updateTable();a.onafterchanges(q,g)};a.setValueFromCoords=function(b,c,e,g){var l=[];l.push(a.updateCell(b,c,e,g));a.updateFormulaChain(b,c,l);a.setHistory({action:"setValue",records:l,selection:a.selectedCell});a.updateTable();a.onafterchanges(q,l)};a.setCheckRadioValue=function(){for(var b=[],c=Object.keys(a.highlighted),e=0;e<c.length;e++){var g=a.highlighted[e].getAttribute("data-x"),
l=a.highlighted[e].getAttribute("data-y");"checkbox"!=a.options.columns[g].type&&"radio"!=a.options.columns[g].type||b.push(a.updateCell(g,l,!a.options.data[l][g]))}b.length&&(a.setHistory({action:"setValue",records:b,selection:a.selectedCell}),a.onafterchanges(q,b))};var B=function(b){var c=new Option;c.innerHTML=b;var e;for(b=c.getElementsByTagName("script");e=b[0];)e.parentNode.removeChild(e);return c.innerHTML};a.updateCell=function(b,c,e,g){if(1!=a.records[c][b].classList.contains("readonly")||
g){if("="==(""+e).substr(0,1)&&1==a.options.secureFormulas){var l=h(e);l!=e&&(e=l)}l=a.dispatch("onbeforechange",q,a.records[c][b],b,c,e);void 0!=l&&(e=l);a.options.columns[b].editor&&"function"==typeof a.options.columns[b].editor.updateCell&&(e=a.options.columns[b].editor.updateCell(a.records[c][b],e,g));g={x:b,y:c,col:b,row:c,newValue:e,oldValue:a.options.data[c][b]};if(a.options.columns[b].editor)a.options.data[c][b]=e;else if("checkbox"==a.options.columns[b].type||"radio"==a.options.columns[b].type){if("radio"==
a.options.columns[b].type)for(l=0;l<a.options.data.length;l++)a.options.data[l][b]=!1;a.records[c][b].children[0].checked=1==e||1==e||"true"==e||"TRUE"==e?!0:!1;a.options.data[c][b]=a.records[c][b].children[0].checked}else"dropdown"==a.options.columns[b].type||"autocomplete"==a.options.columns[b].type?(a.options.data[c][b]=e,a.records[c][b].innerText=a.getDropDownValue(b,e)):"calendar"==a.options.columns[b].type?(l=r.calendar.extractDateFromString(e,a.options.columns[b].options.format),a.options.data[c][b]=
e,a.records[c][b].innerText=r.calendar.getDateString(l?l:e,a.options.columns[b].options.format)):"color"==a.options.columns[b].type?(a.options.data[c][b]=e,"square"==a.options.columns[b].render?(l=document.createElement("div"),l.className="color",l.style.backgroundColor=e,a.records[c][b].innerText="",a.records[c][b].appendChild(l)):(a.records[c][b].style.color=e,a.records[c][b].innerText=e)):"image"==a.options.columns[b].type?(e=""+e,a.options.data[c][b]=e,a.records[c][b].innerHTML="",e&&"data:image"==
e.substr(0,10)&&(l=document.createElement("img"),l.src=e,a.records[c][b].appendChild(l))):(a.options.data[c][b]=e,"html"==a.options.columns[b].type?a.records[c][b].innerHTML=B(a.parseValue(b,c,e)):!1===a.options.stripHTML||!1===a.options.columns[b].stripHTML?a.records[c][b].innerHTML=B(a.parseValue(b,c,e,a.records[c][b])):a.records[c][b].innerText=a.parseValue(b,c,e,a.records[c][b]),a.records[c][b].style.whiteSpace=0!=a.options.columns[b].wordWrap&&(1==a.options.wordWrap||1==a.options.columns[b].wordWrap||
200<a.records[c][b].innerHTML.length)?"pre-wrap":"");0<b&&(a.records[c][b-1].style.overflow=e?"hidden":"");a.dispatch("onchange",q,a.records[c]&&a.records[c][b]?a.records[c][b]:null,b,c,e,g.oldValue)}else g={x:b,y:c,col:b,row:c};return g};a.copyData=function(b,c){var e=a.getData(!0,!0),g=a.selectedContainer,l=parseInt(b.getAttribute("data-x")),p=parseInt(b.getAttribute("data-y")),u=parseInt(c.getAttribute("data-x")),m=parseInt(c.getAttribute("data-y")),z=[],D=!1;if(g[0]==l)var E=p<g[1]?p-g[1]:1,C=
0;else C=l<g[0]?l-g[0]:1,E=0;for(var F=0,I=p;I<=m;I++)if(!a.rows[I]||"none"!=a.rows[I].style.display){void 0==e[F]&&(F=0);p=0;g[0]!=l&&(C=l<g[0]?l-g[0]:1);for(var J=l;J<=u;J++){if(a.records[I][J]&&!a.records[I][J].classList.contains("readonly")&&"none"!=a.records[I][J].style.display&&0==D){if(!a.selection.length&&""!=a.options.data[I][J]){D=!0;continue}void 0==e[F]?p=0:void 0==e[F][p]&&(p=0);var M=e[F][p];if(M&&!e[1]&&1==a.options.autoIncrement)if("text"==a.options.columns[J].type||"number"==a.options.columns[J].type)if("="==
(""+M).substr(0,1)){var P=M.match(/([A-Z]+[0-9]+)/g);if(P){for(var N=[],G=0;G<P.length;G++){var K=n.getIdFromColumnName(P[G],1);K[0]+=C;K[1]+=E;0>K[1]&&(K[1]=0);K=n.getColumnNameFromId([K[0],K[1]]);K!=P[G]&&(N[P[G]]=K)}N&&(M=a.updateFormula(M,N))}}else M==Number(M)&&(M=Number(M)+E);else"calendar"==a.options.columns[J].type&&(M=new Date(M),M.setDate(M.getDate()+E),M=M.getFullYear()+"-"+n.doubleDigitFormat(parseInt(M.getMonth()+1))+"-"+n.doubleDigitFormat(M.getDate())+" 00:00:00");z.push(a.updateCell(J,
I,M));a.updateFormulaChain(J,I,z)}p++;g[0]!=l&&C++}F++;E++}a.setHistory({action:"setValue",records:z,selection:a.selectedCell});a.updateTable();a.onafterchanges(q,z)};a.refreshSelection=function(){a.selectedCell&&a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])};a.conditionalSelectionUpdate=function(b,c,e){1==b?a.selectedCell&&(c>=a.selectedCell[1]&&c<=a.selectedCell[3]||e>=a.selectedCell[1]&&e<=a.selectedCell[3])&&a.resetSelection():a.selectedCell&&
(c>=a.selectedCell[0]&&c<=a.selectedCell[2]||e>=a.selectedCell[0]&&e<=a.selectedCell[2])&&a.resetSelection()};a.resetSelection=function(b){if(a.highlighted.length){u=1;for(var c=0;c<a.highlighted.length;c++){a.highlighted[c].classList.remove("highlight");a.highlighted[c].classList.remove("highlight-left");a.highlighted[c].classList.remove("highlight-right");a.highlighted[c].classList.remove("highlight-top");a.highlighted[c].classList.remove("highlight-bottom");a.highlighted[c].classList.remove("highlight-selected");
var e=parseInt(a.highlighted[c].getAttribute("data-x")),g=parseInt(a.highlighted[c].getAttribute("data-y"));if(a.highlighted[c].getAttribute("data-merged")){var l=parseInt(a.highlighted[c].getAttribute("colspan")),p=parseInt(a.highlighted[c].getAttribute("rowspan"));l=0<l?e+(l-1):e;p=0<p?g+(p-1):g}else l=e,p=g;for(;e<=l;e++)a.headers[e]&&a.headers[e].classList.remove("selected");for(e=g;e<=p;e++)a.rows[e]&&a.rows[e].classList.remove("selected")}}else var u=0;a.highlighted=[];a.selectedCell=null;a.corner.style.top=
"-2000px";a.corner.style.left="-2000px";1==b&&1==u&&a.dispatch("onblur",q);return u};a.updateSelection=function(b,c,e){var g=b.getAttribute("data-x");b=b.getAttribute("data-y");if(c){var l=c.getAttribute("data-x");c=c.getAttribute("data-y")}else l=g,c=b;a.updateSelectionFromCoords(g,b,l,c,e)};a.updateSelectionFromCoords=function(b,c,e,g,l){var p=a.resetSelection();null==c&&(c=0,g=a.rows.length-1);null==e&&(e=b);null==g&&(g=c);b>=a.headers.length&&(b=a.headers.length-1);c>=a.rows.length&&(c=a.rows.length-
1);e>=a.headers.length&&(e=a.headers.length-1);g>=a.rows.length&&(g=a.rows.length-1);a.selectedCell=[b,c,e,g];if(null!=b){a.records[c][b]&&a.records[c][b].classList.add("highlight-selected");if(parseInt(b)<parseInt(e)){var u=parseInt(b);b=parseInt(e)}else u=parseInt(e),b=parseInt(b);parseInt(c)<parseInt(g)?(e=parseInt(c),c=parseInt(g)):(e=parseInt(g),c=parseInt(c));for(g=u;g<=b;g++)for(var m=e;m<=c;m++)if(a.records[m][g]&&a.records[m][g].getAttribute("data-merged")){var z=parseInt(a.records[m][g].getAttribute("data-x")),
D=parseInt(a.records[m][g].getAttribute("data-y")),E=parseInt(a.records[m][g].getAttribute("colspan")),C=parseInt(a.records[m][g].getAttribute("rowspan"));1<E&&(z<u&&(u=z),z+E>b&&(b=z+E-1));C&&(D<e&&(e=D),D+C>c&&(c=D+C-1))}C=E=D=z=null;for(m=e;m<=c;m++)"none"!=a.rows[m].style.display&&(null==E&&(E=m),C=m);for(g=u;g<=b;g++){for(m=e;m<=c;m++)"none"!=a.rows[m].style.display&&"none"!=a.records[m][g].style.display&&(a.records[m][g].classList.add("highlight"),a.highlighted.push(a.records[m][g]));"hidden"!=
a.options.columns[g].type&&(null==z&&(z=g),D=g)}z||(z=0);D||(D=0);for(g=z;g<=D;g++)"hidden"!=a.options.columns[g].type&&(a.records[E]&&a.records[E][g]&&a.records[E][g].classList.add("highlight-top"),a.records[C]&&a.records[C][g]&&a.records[C][g].classList.add("highlight-bottom"),a.headers[g].classList.add("selected"));for(m=E;m<=C;m++)a.rows[m]&&"none"!=a.rows[m].style.display&&(a.records[m][z].classList.add("highlight-left"),a.records[m][D].classList.add("highlight-right"),a.rows[m].classList.add("selected"));
a.selectedContainer=[z,E,D,C]}0==p&&(a.dispatch("onfocus",q),a.removeCopyingSelection());a.dispatch("onselection",q,z,E,D,C,l);a.updateCornerPosition()};a.removeCopySelection=function(){for(var b=0;b<a.selection.length;b++)a.selection[b].classList.remove("selection"),a.selection[b].classList.remove("selection-left"),a.selection[b].classList.remove("selection-right"),a.selection[b].classList.remove("selection-top"),a.selection[b].classList.remove("selection-bottom");a.selection=[]};a.updateCopySelection=
function(b,c){a.removeCopySelection();var e=a.selectedContainer[0],g=a.selectedContainer[1],l=a.selectedContainer[2],p=a.selectedContainer[3];if(null!=b&&null!=c){if(0<b-l)var u=parseInt(l)+1,m=parseInt(b);else u=parseInt(b),m=parseInt(e)-1;if(0<c-p)var z=parseInt(p)+1,D=parseInt(c);else z=parseInt(c),D=parseInt(g)-1;m-u<=D-z?(u=parseInt(e),m=parseInt(l)):(z=parseInt(g),D=parseInt(p));for(e=z;e<=D;e++)for(g=u;g<=m;g++)a.records[e][g]&&"none"!=a.rows[e].style.display&&"none"!=a.records[e][g].style.display&&
(a.records[e][g].classList.add("selection"),a.records[z][g].classList.add("selection-top"),a.records[D][g].classList.add("selection-bottom"),a.records[e][u].classList.add("selection-left"),a.records[e][m].classList.add("selection-right"),a.selection.push(a.records[e][g]))}};a.updateCornerPosition=function(){if(a.highlighted.length){var b=a.highlighted[a.highlighted.length-1],c=a.content.getBoundingClientRect(),e=c.left;c=c.top;var g=b.getBoundingClientRect();b=g.left;var l=g.width,p=b-e+a.content.scrollLeft+
l-4;a.corner.style.top=g.top-c+a.content.scrollTop+g.height-4+"px";a.corner.style.left=p+"px";a.options.freezeColumns?(c=a.getFreezeWidth(),b-e+l<c?a.corner.style.display="none":1==a.options.selectionCopy&&(a.corner.style.display="")):1==a.options.selectionCopy&&(a.corner.style.display="")}else a.corner.style.top="-2000px",a.corner.style.left="-2000px"};a.updateScroll=function(b){var c=a.content.getBoundingClientRect(),e=c.left,g=c.top,l=c.width;c=c.height;var p=a.records[a.selectedCell[3]][a.selectedCell[2]].getBoundingClientRect(),
u=p.left,m=p.top,z=p.width;p=p.height;0==b||1==b?(b=u-e+a.content.scrollLeft,g=m-g+a.content.scrollTop-2):(b=u-e+a.content.scrollLeft+z,g=m-g+a.content.scrollTop+p);g>a.content.scrollTop+30&&g<a.content.scrollTop+c||(a.content.scrollTop=g<a.content.scrollTop+30?g-p:g-(c-2));g=a.getFreezeWidth();b>a.content.scrollLeft+g&&b<a.content.scrollLeft+l||(b<a.content.scrollLeft+30?(a.content.scrollLeft=b,50>a.content.scrollLeft&&(a.content.scrollLeft=0)):a.content.scrollLeft=b<a.content.scrollLeft+g?b-g-1:
b-(l-20))};a.getWidth=function(b){if(b)"object"==typeof b&&(b=$(b).getAttribute("data-x")),b=a.colgroup[b].getAttribute("width");else{b=[];for(var c=0;c<a.headers.length;c++)b.push(a.options.columns[c].width)}return b};a.setWidth=function(b,c,e){if(c){if(Array.isArray(b)){e||(e=[]);for(var g=0;g<b.length;g++){e[g]||(e[g]=a.colgroup[b[g]].getAttribute("width"));var l=Array.isArray(c)&&c[g]?c[g]:c;a.colgroup[b[g]].setAttribute("width",l);a.options.columns[b[g]].width=l}}else e||(e=a.colgroup[b].getAttribute("width")),
a.colgroup[b].setAttribute("width",c),a.options.columns[b].width=c;a.setHistory({action:"setWidth",column:b,oldValue:e,newValue:c});a.dispatch("onresizecolumn",q,b,c,e);a.updateCornerPosition()}};a.setHeight=function(b,c,e){0<c&&("object"==typeof b&&(b=b.getAttribute("data-y")),e||(e=a.rows[b].getAttribute("height"),e||(e=a.rows[b].getBoundingClientRect().height)),c=parseInt(c),a.rows[b].style.height=c+"px",a.options.rows[b]||(a.options.rows[b]={}),a.options.rows[b].height=c,a.setHistory({action:"setHeight",
row:b,oldValue:e,newValue:c}),a.dispatch("onresizerow",q,b,c,e),a.updateCornerPosition())};a.getHeight=function(b){if(b)"object"==typeof b&&(b=$(b).getAttribute("data-y")),b=a.rows[b].style.height;else{b=[];for(var c=0;c<a.rows.length;c++){var e=a.rows[c].style.height;e&&(b[c]=e)}}return b};a.setFooter=function(b){b&&(a.options.footers=b);if(a.options.footers)for(a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot)),b=0;b<a.options.footers.length;b++){if(a.tfoot.children[b])var c=
a.tfoot.children[b];else{c=document.createElement("tr");var e=document.createElement("td");c.appendChild(e);a.tfoot.appendChild(c)}for(var g=0;g<a.headers.length;g++)a.options.footers[b][g]||(a.options.footers[b][g]=""),a.tfoot.children[b].children[g+1]?e=a.tfoot.children[b].children[g+1]:(e=document.createElement("td"),c.appendChild(e),e.style.textAlign=a.options.columns[g].align?a.options.columns[g].align:"center"),e.innerText=a.parseValue(g,b,a.options.footers[b][g])}};a.getHeader=function(b){return a.headers[b].innerText};
a.setHeader=function(b,c){if(a.headers[b]){var e=a.headers[b].innerText;c||(c=prompt(a.options.text.columnName,e));c&&(a.headers[b].innerText=c,a.headers[b].setAttribute("title",c),a.options.columns[b].title=c);a.setHistory({action:"setHeader",column:b,oldValue:e,newValue:c});a.dispatch("onchangeheader",q,b,e,c)}};a.getHeaders=function(b){for(var c=[],e=0;e<a.headers.length;e++)c.push(a.getHeader(e));return b?c:c.join(a.options.csvDelimiter)};a.getMeta=function(b,c){return b?c?a.options.meta[b]&&
a.options.meta[b][c]?a.options.meta[b][c]:null:a.options.meta[b]?a.options.meta[b]:null:a.options.meta};a.setMeta=function(b,c,e){a.options.meta||(a.options.meta={});if(c&&e)a.options.meta[b]||(a.options.meta[b]={}),a.options.meta[b][c]=e;else for(var g=Object.keys(b),l=0;l<g.length;l++){a.options.meta[g[l]]||(a.options.meta[g[l]]={});for(var p=Object.keys(b[g[l]]),u=0;u<p.length;u++)a.options.meta[g[l]][p[u]]=b[g[l]][p[u]]}a.dispatch("onchangemeta",q,b,c,e)};a.updateMeta=function(b){if(a.options.meta){for(var c=
{},e=Object.keys(a.options.meta),g=0;g<e.length;g++)b[e[g]]?c[b[e[g]]]=a.options.meta[e[g]]:c[e[g]]=a.options.meta[e[g]];a.options.meta=c}};a.getStyle=function(b,c){if(b)return b=n.getIdFromColumnName(b,!0),c?a.records[b[1]][b[0]].style[c]:a.records[b[1]][b[0]].getAttribute("style");for(var e={},g=a.options.data[0].length,l=a.options.data.length,p=0;p<l;p++)for(var u=0;u<g;u++){var m=c?a.records[p][u].style[c]:a.records[p][u].getAttribute("style");if(m){var z=n.getColumnNameFromId([u,p]);e[z]=m}}return e};
a.resetStyle=function(b,c){for(var e=Object.keys(b),g=0;g<e.length;g++){var l=n.getIdFromColumnName(e[g],!0);a.records[l[1]]&&a.records[l[1]][l[0]]&&a.records[l[1]][l[0]].setAttribute("style","")}a.setStyle(b,null,null,null,c)};a.setStyle=function(b,c,e,g,l){var p={},u={},m=function(F,I,J){var M=n.getIdFromColumnName(F,!0);if(a.records[M[1]]&&a.records[M[1]][M[0]]&&(0==a.records[M[1]][M[0]].classList.contains("readonly")||g)){var P=a.records[M[1]][M[0]].style[I];P!=J||g?a.records[M[1]][M[0]].style[I]=
J:(J="",a.records[M[1]][M[0]].style[I]="");u[F]||(u[F]=[]);p[F]||(p[F]=[]);u[F].push([I+":"+P]);p[F].push([I+":"+J])}};if(c&&e)if("string"==typeof b)m(b,c,e);else for(var z=[],D=0;D<b.length;D++){var E=b[D].getAttribute("data-x"),C=b[D].getAttribute("data-y");E=n.getColumnNameFromId([E,C]);z[E]||(m(E,c,e),z[E]=!0)}else for(z=Object.keys(b),D=0;D<z.length;D++)for(E=b[z[D]],"string"==typeof E&&(E=E.split(";")),C=0;C<E.length;C++)"string"==typeof E[C]&&(E[C]=E[C].split(":")),E[C][0].trim()&&m(z[D],E[C][0].trim(),
E[C][1]);z=Object.keys(u);for(D=0;D<z.length;D++)u[z[D]]=u[z[D]].join(";");z=Object.keys(p);for(D=0;D<z.length;D++)p[z[D]]=p[z[D]].join(";");l||a.setHistory({action:"setStyle",oldValue:u,newValue:p});a.dispatch("onchangestyle",q,b,c,e)};a.getComments=function(b,c){if(b)return"string"==typeof b&&(b=n.getIdFromColumnName(b,!0)),c?[a.records[b[1]][b[0]].getAttribute("title"),a.records[b[1]][b[0]].getAttribute("author")]:a.records[b[1]][b[0]].getAttribute("title")||"";for(var e={},g=0;g<a.options.data.length;g++)for(var l=
0;l<a.options.columns.length;l++){var p=a.records[g][l].getAttribute("title");p&&(b=n.getColumnNameFromId([l,g]),e[b]=p)}return e};a.setComments=function(b,c,e){var g="string"==typeof b?n.getIdFromColumnName(b,!0):b,l=a.records[g[1]][g[0]].getAttribute("title");e=a.records[g[1]][g[0]].getAttribute("data-author");var p=[l,e];a.records[g[1]][g[0]].setAttribute("title",c?c:"");a.records[g[1]][g[0]].setAttribute("data-author",e?e:"");c?a.records[g[1]][g[0]].classList.add("jexcel_comments"):a.records[g[1]][g[0]].classList.remove("jexcel_comments");
a.setHistory({action:"setComments",column:b,newValue:[c,e],oldValue:p});a.dispatch("oncomments",q,c,l,g,g[0],g[1])};a.getConfig=function(){var b=a.options;b.style=a.getStyle();b.mergeCells=a.getMerge();b.comments=a.getComments();return b};a.orderBy=function(b,c){if(0<=b){if(0<Object.keys(a.options.mergeCells).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1;c=null==c?a.headers[b].classList.contains("arrow-down")?1:0:c?1:0;var e=
[];if("number"==a.options.columns[b].type||"percentage"==a.options.columns[b].type||"autonumber"==a.options.columns[b].type||"color"==a.options.columns[b].type)for(var g=0;g<a.options.data.length;g++)e[g]=[g,Number(a.options.data[g][b])];else if("calendar"==a.options.columns[b].type||"checkbox"==a.options.columns[b].type||"radio"==a.options.columns[b].type)for(g=0;g<a.options.data.length;g++)e[g]=[g,a.options.data[g][b]];else for(g=0;g<a.options.data.length;g++)e[g]=[g,a.records[g][b].innerText.toLowerCase()];
"function"!==typeof a.options.sorting&&(a.options.sorting=function(p){return function(u,m){var z=u[1],D=m[1];return p?""===z&&""!==D?1:""!==z&&""===D?-1:z>D?-1:z<D?1:0:""===z&&""!==D?1:""!==z&&""===D?-1:z>D?1:z<D?-1:0}});e=e.sort(a.options.sorting(c));var l=[];for(g=0;g<e.length;g++)l[g]=e[g][0];a.setHistory({action:"orderBy",rows:l,column:b,order:c});a.updateOrderArrow(b,c);a.updateOrder(l);a.dispatch("onsort",q,b,c);return!0}};a.updateOrderArrow=function(b,c){for(var e=0;e<a.headers.length;e++)a.headers[e].classList.remove("arrow-up"),
a.headers[e].classList.remove("arrow-down");c?a.headers[b].classList.add("arrow-up"):a.headers[b].classList.add("arrow-down")};a.updateOrder=function(b){for(var c=[],e=0;e<b.length;e++)c[e]=a.options.data[b[e]];a.options.data=c;c=[];for(e=0;e<b.length;e++)c[e]=a.records[b[e]];a.records=c;c=[];for(e=0;e<b.length;e++)c[e]=a.rows[b[e]];a.rows=c;a.updateTableReferences();if(a.results&&a.results.length)a.searchInput.value?a.search(a.searchInput.value):a.closeFilter();else if(a.results=null,a.pageNumber=
0,0<a.options.pagination)a.page(0);else if(1==a.options.lazyLoading)a.loadPage(0);else for(e=0;e<a.rows.length;e++)a.tbody.appendChild(a.rows[e])};a.moveRow=function(b,c,e){if(0<Object.keys(a.options.mergeCells).length){var g=b>c?1:0;if(a.isRowMerged(b).length||a.isRowMerged(c,g).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1}if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length)if(confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))a.resetSearch();
else return!1;a.results=null}e||(0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[c])?b>c?a.tbody.insertBefore(a.rows[b],a.rows[c]):a.tbody.insertBefore(a.rows[b],a.rows[c].nextSibling):a.tbody.removeChild(a.rows[b]));a.rows.splice(c,0,a.rows.splice(b,1)[0]);a.records.splice(c,0,a.records.splice(b,1)[0]);a.options.data.splice(c,0,a.options.data.splice(b,1)[0]);0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber);a.setHistory({action:"moveRow",oldValue:b,
newValue:c});a.updateTableReferences();a.dispatch("onmoverow",q,b,c)};a.insertRow=function(b,c,e){if(1==a.options.allowInsertRow){var g=[];if(0<b)var l=b;else l=1,b&&(g=b);e=e?!0:!1;b=a.options.data.length-1;if(void 0==c||c>=parseInt(b)||0>c)c=b;if(!1===a.dispatch("onbeforeinsertrow",q,c,l,e))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isRowMerged(c,e).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1;if(1==a.options.search){if(a.results&&
a.results.length!=a.rows.length)if(confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))a.resetSearch();else return!1;a.results=null}b=e?c:c+1;for(var p=a.records.splice(b),u=a.options.data.splice(b),m=a.rows.splice(b),z=[],D=[],E=[],C=b;C<l+b;C++){a.options.data[C]=[];for(var F=0;F<a.options.columns.length;F++)a.options.data[C][F]=g[F]?g[F]:"";F=a.createRow(C,a.options.data[C]);m[0]?0<=Array.prototype.indexOf.call(a.tbody.children,m[0])&&a.tbody.insertBefore(F,m[0]):0<=Array.prototype.indexOf.call(a.tbody.children,
a.rows[c])&&a.tbody.appendChild(F);z.push(a.records[C]);D.push(a.options.data[C]);E.push(F)}Array.prototype.push.apply(a.records,p);Array.prototype.push.apply(a.options.data,u);Array.prototype.push.apply(a.rows,m);0<a.options.pagination&&a.page(a.pageNumber);a.setHistory({action:"insertRow",rowNumber:c,numOfRows:l,insertBefore:e,rowRecords:z,rowData:D,rowNode:E});a.updateTableReferences();a.dispatch("oninsertrow",q,c,l,z,e)}};a.deleteRow=function(b,c){if(1==a.options.allowDeleteRow)if(1==a.options.allowDeletingAllRows||
1<a.options.data.length){if(void 0==b){var e=a.getSelectedRows();e[0]?(b=parseInt(e[0].getAttribute("data-y")),c=e.length):(b=a.options.data.length-1,c=1)}e=a.options.data.length-1;if(void 0==b||b>e||0>b)b=e;c||(c=1);b+c>=a.options.data.length&&(c=a.options.data.length-b);if(!1===a.dispatch("onbeforedeleterow",q,b,c))return!1;if(-1<parseInt(b)){var g=!1;if(0<Object.keys(a.options.mergeCells).length)for(var l=b;l<b+c;l++)a.isRowMerged(l,!1).length&&(g=!0);if(g)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();
else return!1;if(1==a.options.search){if(a.results&&a.results.length!=a.rows.length)if(confirm(a.options.text.thisActionWillClearYourSearchResultsAreYouSure))a.resetSearch();else return!1;a.results=null}0==a.options.allowDeletingAllRows&&e+1===c&&(c--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(l=b;l<b+c;l++)0<=Array.prototype.indexOf.call(a.tbody.children,a.rows[l])&&(a.rows[l].className="",a.rows[l].parentNode.removeChild(a.rows[l]));e=a.records.splice(b,c);g=a.options.data.splice(b,
c);l=a.rows.splice(b,c);0<a.options.pagination&&a.tbody.children.length!=a.options.pagination&&a.page(a.pageNumber);a.conditionalSelectionUpdate(1,b,b+c-1);a.setHistory({action:"deleteRow",rowNumber:b,numOfRows:c,insertBefore:1,rowRecords:e,rowData:g,rowNode:l});a.updateTableReferences();a.dispatch("ondeleterow",q,b,c,e)}}else console.error("Jspreadsheet: It is not possible to delete the last row")};a.moveColumn=function(b,c){if(0<Object.keys(a.options.mergeCells).length){var e=b>c?1:0;if(a.isColMerged(b).length||
a.isColMerged(c,e).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1}b=parseInt(b);c=parseInt(c);if(b>c)for(a.headerContainer.insertBefore(a.headers[b],a.headers[c]),a.colgroupContainer.insertBefore(a.colgroup[b],a.colgroup[c]),e=0;e<a.rows.length;e++)a.rows[e].insertBefore(a.records[e][b],a.records[e][c]);else for(a.headerContainer.insertBefore(a.headers[b],a.headers[c].nextSibling),a.colgroupContainer.insertBefore(a.colgroup[b],
a.colgroup[c].nextSibling),e=0;e<a.rows.length;e++)a.rows[e].insertBefore(a.records[e][b],a.records[e][c].nextSibling);a.options.columns.splice(c,0,a.options.columns.splice(b,1)[0]);a.headers.splice(c,0,a.headers.splice(b,1)[0]);a.colgroup.splice(c,0,a.colgroup.splice(b,1)[0]);for(e=0;e<a.rows.length;e++)a.options.data[e].splice(c,0,a.options.data[e].splice(b,1)[0]),a.records[e].splice(c,0,a.records[e].splice(b,1)[0]);if(a.options.footers)for(e=0;e<a.options.footers.length;e++)a.options.footers[e].splice(c,
0,a.options.footers[e].splice(b,1)[0]);a.setHistory({action:"moveColumn",oldValue:b,newValue:c});a.updateTableReferences();a.dispatch("onmovecolumn",q,b,c)};a.insertColumn=function(b,c,e,g){if(1==a.options.allowInsertColumn){var l=[];if(0<b)var p=b;else p=1,b&&(l=b);e=e?!0:!1;b=a.options.columns.length-1;if(void 0==c||c>=parseInt(b)||0>c)c=b;if(!1===a.dispatch("onbeforeinsertcolumn",q,c,p,e))return!1;if(0<Object.keys(a.options.mergeCells).length&&a.isColMerged(c,e).length)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();
else return!1;g||(g=[]);for(var u=0;u<p;u++)g[u]||(g[u]={type:"text",source:[],options:[],width:a.options.defaultColWidth,align:a.options.defaultColAlign});b=e?c:c+1;a.options.columns=n.injectArray(a.options.columns,b,g);var m=a.headers.splice(b),z=a.colgroup.splice(b),D=[],E=[],C=[],F=[],I=[];for(u=b;u<p+b;u++)a.createCellHeader(u),a.headerContainer.insertBefore(a.headers[u],a.headerContainer.children[u+1]),a.colgroupContainer.insertBefore(a.colgroup[u],a.colgroupContainer.children[u+1]),D.push(a.headers[u]),
E.push(a.colgroup[u]);if(a.options.footers)for(var J=0;J<a.options.footers.length;J++){I[J]=[];for(u=0;u<p;u++)I[J].push("");a.options.footers[J].splice(b,0,I[J])}for(J=0;J<a.options.data.length;J++){var M=a.options.data[J].splice(b),P=a.records[J].splice(b);F[J]=[];C[J]=[];for(u=b;u<p+b;u++){var N=l[J]?l[J]:"";a.options.data[J][u]=N;var G=a.createCell(u,J,a.options.data[J][u]);a.records[J][u]=G;a.rows[J]&&a.rows[J].insertBefore(G,a.rows[J].children[u+1]);F[J].push(N);C[J].push(G)}Array.prototype.push.apply(a.options.data[J],
M);Array.prototype.push.apply(a.records[J],P)}Array.prototype.push.apply(a.headers,m);Array.prototype.push.apply(a.colgroup,z);if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(J=0;J<a.options.nestedHeaders.length;J++){l=parseInt(a.options.nestedHeaders[J][a.options.nestedHeaders[J].length-1].colspan)+p;a.options.nestedHeaders[J][a.options.nestedHeaders[J].length-1].colspan=l;a.thead.children[J].children[a.thead.children[J].children.length-
1].setAttribute("colspan",l);l=a.thead.children[J].children[a.thead.children[J].children.length-1].getAttribute("data-column");l=l.split(",");for(u=b;u<p+b;u++)l.push(u);a.thead.children[J].children[a.thead.children[J].children.length-1].setAttribute("data-column",l)}else l=parseInt(a.options.nestedHeaders[0].colspan)+p,a.options.nestedHeaders[0].colspan=l,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",l);a.setHistory({action:"insertColumn",columnNumber:c,
numOfColumns:p,insertBefore:e,columns:g,headers:D,colgroup:E,records:C,footers:I,data:F});a.updateTableReferences();a.dispatch("oninsertcolumn",q,c,p,C,e)}};a.deleteColumn=function(b,c){if(1==a.options.allowDeleteColumn)if(1<a.headers.length){if(void 0==b){var e=a.getSelectedColumns(!0);e.length?(b=parseInt(e[0]),c=parseInt(e.length)):(b=a.headers.length-1,c=1)}e=a.options.data[0].length-1;if(void 0==b||b>e||0>b)b=e;c||(c=1);c>a.options.data[0].length-b&&(c=a.options.data[0].length-b);if(!1===a.dispatch("onbeforedeletecolumn",
q,b,c))return!1;if(-1<parseInt(b)){e=!1;if(0<Object.keys(a.options.mergeCells).length)for(var g=b;g<b+c;g++)a.isColMerged(g,!1).length&&(e=!0);if(e)if(confirm(a.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))a.destroyMerged();else return!1;e=a.options.columns.splice(b,c);for(g=b;g<b+c;g++)a.colgroup[g].className="",a.headers[g].className="",a.colgroup[g].parentNode.removeChild(a.colgroup[g]),a.headers[g].parentNode.removeChild(a.headers[g]);for(var l=a.headers.splice(b,c),p=a.colgroup.splice(b,
c),u=[],m=[],z=[],D=0;D<a.options.data.length;D++)for(g=b;g<b+c;g++)a.records[D][g].className="",a.records[D][g].parentNode.removeChild(a.records[D][g]);for(D=0;D<a.options.data.length;D++)m[D]=a.options.data[D].splice(b,c),u[D]=a.records[D].splice(b,c);if(a.options.footers)for(D=0;D<a.options.footers.length;D++)z[D]=a.options.footers[D].splice(b,c);a.conditionalSelectionUpdate(0,b,b+c-1);if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(g=
0;g<a.options.nestedHeaders.length;g++)D=parseInt(a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-1].colspan)-c,a.options.nestedHeaders[g][a.options.nestedHeaders[g].length-1].colspan=D,a.thead.children[g].children[a.thead.children[g].children.length-1].setAttribute("colspan",D);else D=parseInt(a.options.nestedHeaders[0].colspan)-c,a.options.nestedHeaders[0].colspan=D,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",D);a.setHistory({action:"deleteColumn",
columnNumber:b,numOfColumns:c,insertBefore:1,columns:e,headers:l,colgroup:p,records:u,footers:z,data:m});a.updateTableReferences();a.dispatch("ondeletecolumn",q,b,c,u)}}else console.error("Jspreadsheet: It is not possible to delete the last column")};a.getSelectedRows=function(b){for(var c=[],e=0;e<a.rows.length;e++)a.rows[e].classList.contains("selected")&&(b?c.push(e):c.push(a.rows[e]));return c};a.getSelectedColumns=function(){for(var b=[],c=0;c<a.headers.length;c++)a.headers[c].classList.contains("selected")&&
b.push(c);return b};a.getHighlighted=function(){return a.highlighted};a.updateTableReferences=function(){for(var b=0;b<a.headers.length;b++){var c=a.headers[b].getAttribute("data-x");c!=b&&(a.headers[b].setAttribute("data-x",b),a.headers[b].getAttribute("title")||(a.headers[b].innerHTML=n.getColumnName(b)))}for(var e=0;e<a.rows.length;e++)if(a.rows[e]){var g=a.rows[e].getAttribute("data-y");g!=e&&(a.rows[e].setAttribute("data-y",e),a.rows[e].children[0].setAttribute("data-y",e),a.rows[e].children[0].innerHTML=
e+1)}var l=[],p=[],u=function(E,C,F,I){E!=F&&a.records[I][F].setAttribute("data-x",F);C!=I&&a.records[I][F].setAttribute("data-y",I);if(E!=F||C!=I)E=n.getColumnNameFromId([E,C]),F=n.getColumnNameFromId([F,I]),l[E]=F};for(e=0;e<a.records.length;e++)for(b=0;b<a.records[0].length;b++)if(a.records[e][b])if(c=a.records[e][b].getAttribute("data-x"),g=a.records[e][b].getAttribute("data-y"),a.records[e][b].getAttribute("data-merged")){var m=n.getColumnNameFromId([c,g]),z=n.getColumnNameFromId([b,e]);null==
p[m]&&(m==z?p[m]=!1:(c=parseInt(b-c),g=parseInt(e-g),p[m]=[z,c,g]))}else u(c,g,b,e);var D=Object.keys(p);if(D.length)for(b=0;b<D.length;b++)if(p[D[b]]){e=n.getIdFromColumnName(D[b],!0);c=e[0];g=e[1];u(c,g,c+p[D[b]][1],g+p[D[b]][2]);m=D[b];z=p[D[b]][0];for(e=0;e<a.options.mergeCells[m][2].length;e++)c=parseInt(a.options.mergeCells[m][2][e].getAttribute("data-x")),g=parseInt(a.options.mergeCells[m][2][e].getAttribute("data-y")),a.options.mergeCells[m][2][e].setAttribute("data-x",c+p[D[b]][1]),a.options.mergeCells[m][2][e].setAttribute("data-y",
g+p[D[b]][2]);a.options.mergeCells[z]=a.options.mergeCells[m];delete a.options.mergeCells[m]}a.updateFormulas(l);a.updateMeta(l);a.refreshSelection();a.updateTable()};a.updateTable=function(){if(0<a.options.minSpareRows){for(var b=0,c=a.rows.length-1;0<=c;c--){for(var e=!1,g=0;g<a.headers.length;g++)a.options.data[c][g]&&(e=!0);if(e)break;else b++}0<a.options.minSpareRows-b&&a.insertRow(a.options.minSpareRows-b)}if(0<a.options.minSpareCols){b=0;for(g=a.headers.length-1;0<=g;g--){e=!1;for(c=0;c<a.rows.length;c++)a.options.data[c][g]&&
(e=!0);if(e)break;else b++}0<a.options.minSpareCols-b&&a.insertColumn(a.options.minSpareCols-b)}if("function"==typeof a.options.updateTable){a.options.detachForUpdates&&q.removeChild(a.content);for(c=0;c<a.rows.length;c++)for(g=0;g<a.headers.length;g++)a.options.updateTable(q,a.records[c][g],g,c,a.options.data[c][g],a.records[c][g].innerText,n.getColumnNameFromId([g,c]));a.options.detachForUpdates&&q.insertBefore(a.content,a.pagination)}a.options.footers&&a.setFooter();setTimeout(function(){a.updateCornerPosition()},
0)};a.isReadOnly=function(b){if(b=a.getCell(b))return b.classList.contains("readonly")?!0:!1};a.setReadOnly=function(b,c){if(b=a.getCell(b))c?b.classList.add("readonly"):b.classList.remove("readonly")};a.showRow=function(b){a.rows[b].style.display=""};a.hideRow=function(b){a.rows[b].style.display="none"};a.showColumn=function(b){a.headers[b].style.display="";a.colgroup[b].style.display="";for(var c=0;c<a.options.data.length;c++)a.records[c][b].style.display=""};a.hideColumn=function(b){a.headers[b].style.display=
"none";a.colgroup[b].style.display="none";for(var c=0;c<a.options.data.length;c++)a.records[c][b].style.display="none"};a.showIndex=function(){a.table.classList.remove("jexcel_hidden_index")};a.hideIndex=function(){a.table.classList.add("jexcel_hidden_index")};var t=[];a.updateFormulaChain=function(b,c,e){var g=n.getColumnNameFromId([b,c]);if(a.formula[g]&&0<a.formula[g].length)if(t[g])a.records[c][b].innerHTML="#ERROR",a.formula[g]="";else for(t[g]=!0,b=0;b<a.formula[g].length;b++){c=n.getIdFromColumnName(a.formula[g][b],
!0);var l=""+a.options.data[c[1]][c[0]];"="==l.substr(0,1)?e.push(a.updateCell(c[0],c[1],l,!0)):Object.keys(a.formula)[b]=null;a.updateFormulaChain(c[0],c[1],e)}t=[]};a.updateFormulas=function(b){for(var c=0;c<a.options.data.length;c++)for(var e=0;e<a.options.data[0].length;e++){var g=""+a.options.data[c][e];if("="==g.substr(0,1)){var l=a.updateFormula(g,b);l!=g&&(a.options.data[c][e]=l)}}l=[];var p=Object.keys(a.formula);for(c=0;c<p.length;c++){var u=p[c];g=a.formula[u];b[u]&&(u=b[u]);l[u]=[];for(e=
0;e<g.length;e++){var m=g[e];b[m]&&(m=b[m]);l[u].push(m)}}a.formula=l};a.updateFormula=function(b,c){for(var e=/[A-Z]/,g=/[0-9]/,l="",p=null,u=null,m="",z=0;z<b.length;z++)e.exec(b[z])?(p=1,u=0,m+=b[z]):g.exec(b[z])?(u=p?1:0,m+=b[z]):(p&&u&&(m=c[m]?c[m]:m),l+=m,l+=b[z],u=p=0,m="");m&&(p&&u&&(m=c[m]?c[m]:m),l+=m);return l};var h=function(b){for(var c="",e=0,g=0;g<b.length;g++)'"'==b[g]&&(e=0==e?1:0),c=1==e?c+b[g]:c+b[g].toUpperCase();return c};a.executeFormula=function(b,c,e){var g=[],l=[],p=function(u,
m,z){var D=n.getColumnNameFromId([m,z]);if(l[D])return console.error("Reference loop detected"),"#ERROR";l[D]=!0;var E=function(P){for(var N=0;N<P.length;N++){var G=[],K=P[N].split(":"),L=n.getIdFromColumnName(K[0],!0),O=n.getIdFromColumnName(K[1],!0);if(L[0]<=O[0]){K=L[0];var Q=O[0]}else K=O[0],Q=L[0];if(L[1]<=O[1]){var R=L[1];L=O[1]}else R=O[1],L=L[1];for(;R<=L;R++)for(O=K;O<=Q;O++)G.push(n.getColumnNameFromId([O,R]));u=u.replace(P[N],G.join(","))}};u=u.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");
var C=u.match(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g);C&&C.length&&E(C);if((C=u.match(/([A-Z]+[0-9]+)/g))&&-1<C.indexOf(D))return console.error("Self Reference detected"),"#ERROR";E={};if(C)for(var F=0;F<C.length;F++)if(a.formula[C[F]]||(a.formula[C[F]]=[]),0>a.formula[C[F]].indexOf(D)&&a.formula[C[F]].push(D),eval("typeof("+C[F]+') == "undefined"')){var I=n.getIdFromColumnName(C[F],1),J="undefined"!=typeof a.options.data[I[1]]&&"undefined"!=typeof a.options.data[I[1]][I[0]]?a.options.data[I[1]][I[0]]:
"";"="==(""+J).substr(0,1)&&(g[C[F]]?J=g[C[F]]:(J=p(J,I[0],I[1]),g[C[F]]=J));""==(""+J).trim()?E[C[F]]=null:J==Number(J)&&1==a.options.autoCasting?E[C[F]]=Number(J):(I=a.parseNumber(J,I[0]),E[C[F]]=1==a.options.autoCasting&&I?I:'"'+J+'"')}try{var M=n.formula(u.substr(1),E,m,z,a)}catch(P){M="#ERROR",console.log(P)}return M};return p(b,c,e)};a.parseNumber=function(b,c){var e=(""+b).split(c&&a.options.columns[c].decimal?a.options.columns[c].decimal:".");e[0]=e[0].match(/[+-]?[0-9]/g);e[0]&&(e[0]=e[0].join(""));
e[1]&&(e[1]=e[1].match(/[0-9]*/g).join(""));return b=e[0]&&0<=Number(e[0])?e[1]?Number(e[0]+"."+e[1]):Number(e[0]+".00"):null};a.row=function(b){};a.col=function(b){};a.up=function(b,c){b?0<a.selectedCell[3]&&a.up.visible(1,c?0:1):(0<a.selectedCell[1]&&a.up.visible(0,c?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);if(1==a.options.lazyLoading)if(0==a.selectedCell[1]||
0==a.selectedCell[3])a.loadPage(0),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);else if(a.loadValidation())a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);else{var e=parseInt(a.tbody.firstChild.getAttribute("data-y"));30>a.selectedCell[1]-e&&(a.loadUp(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]))}else 0<a.options.pagination&&(e=a.whichPage(a.selectedCell[3]),
e!=a.pageNumber&&a.page(e));a.updateScroll(1)};a.up.visible=function(b,c){if(0==b)var e=parseInt(a.selectedCell[0]),g=parseInt(a.selectedCell[1]);else e=parseInt(a.selectedCell[2]),g=parseInt(a.selectedCell[3]);if(0==c)for(var l=0;l<g;l++){if("none"!=a.records[l][e].style.display&&"none"!=a.rows[l].style.display){g=l;break}}else g=a.up.get(e,g);0==b?(a.selectedCell[0]=e,a.selectedCell[1]=g):(a.selectedCell[2]=e,a.selectedCell[3]=g)};a.up.get=function(b,c){b=parseInt(b);c=parseInt(c);for(var e=c-1;0<=
e;e--)if("none"!=a.records[e][b].style.display&&"none"!=a.rows[e].style.display&&(!a.records[e][b].getAttribute("data-merged")||a.records[e][b]!=a.records[c][b])){c=e;break}return c};a.down=function(b,c){b?a.selectedCell[3]<a.records.length-1&&a.down.visible(1,c?0:1):(a.selectedCell[1]<a.records.length-1&&a.down.visible(0,c?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);
if(1==a.options.lazyLoading)a.selectedCell[1]==a.records.length-1||a.selectedCell[3]==a.records.length-1?(a.loadPage(-1),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])):a.loadValidation()?a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]):30>parseInt(a.tbody.lastChild.getAttribute("data-y"))-a.selectedCell[3]&&(a.loadDown(),a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],
a.selectedCell[3]));else if(0<a.options.pagination){var e=a.whichPage(a.selectedCell[3]);e!=a.pageNumber&&a.page(e)}a.updateScroll(3)};a.down.visible=function(b,c){if(0==b)var e=parseInt(a.selectedCell[0]),g=parseInt(a.selectedCell[1]);else e=parseInt(a.selectedCell[2]),g=parseInt(a.selectedCell[3]);if(0==c)for(var l=a.rows.length-1;l>g;l--){if("none"!=a.records[l][e].style.display&&"none"!=a.rows[l].style.display){g=l;break}}else g=a.down.get(e,g);0==b?(a.selectedCell[0]=e,a.selectedCell[1]=g):(a.selectedCell[2]=
e,a.selectedCell[3]=g)};a.down.get=function(b,c){b=parseInt(b);c=parseInt(c);for(var e=c+1;e<a.rows.length;e++)if("none"!=a.records[e][b].style.display&&"none"!=a.rows[e].style.display&&(!a.records[e][b].getAttribute("data-merged")||a.records[e][b]!=a.records[c][b])){c=e;break}return c};a.right=function(b,c){b?a.selectedCell[2]<a.headers.length-1&&a.right.visible(1,c?0:1):(a.selectedCell[0]<a.headers.length-1&&a.right.visible(0,c?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);
a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);a.updateScroll(2)};a.right.visible=function(b,c){if(0==b)var e=parseInt(a.selectedCell[0]),g=parseInt(a.selectedCell[1]);else e=parseInt(a.selectedCell[2]),g=parseInt(a.selectedCell[3]);if(0==c)for(var l=a.headers.length-1;l>e;l--){if("none"!=a.records[g][l].style.display){e=l;break}}else e=a.right.get(e,g);0==b?(a.selectedCell[0]=e,a.selectedCell[1]=g):(a.selectedCell[2]=e,a.selectedCell[3]=g)};a.right.get=
function(b,c){b=parseInt(b);c=parseInt(c);for(var e=b+1;e<a.headers.length;e++)if("none"!=a.records[c][e].style.display&&(!a.records[c][e].getAttribute("data-merged")||a.records[c][e]!=a.records[c][b])){b=e;break}return b};a.left=function(b,c){b?0<a.selectedCell[2]&&a.left.visible(1,c?0:1):(0<a.selectedCell[0]&&a.left.visible(0,c?0:1),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);
a.updateScroll(0)};a.left.visible=function(b,c){if(0==b)var e=parseInt(a.selectedCell[0]),g=parseInt(a.selectedCell[1]);else e=parseInt(a.selectedCell[2]),g=parseInt(a.selectedCell[3]);if(0==c)for(var l=0;l<e;l++){if("none"!=a.records[g][l].style.display){e=l;break}}else e=a.left.get(e,g);0==b?(a.selectedCell[0]=e,a.selectedCell[1]=g):(a.selectedCell[2]=e,a.selectedCell[3]=g)};a.left.get=function(b,c){b=parseInt(b);c=parseInt(c);for(var e=b-1;0<=e;e--)if("none"!=a.records[c][e].style.display&&(!a.records[c][e].getAttribute("data-merged")||
a.records[c][e]!=a.records[c][b])){b=e;break}return b};a.first=function(b,c){b?c?a.selectedCell[3]=0:a.left.visible(1,0):(c?a.selectedCell[1]=0:a.left.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);if(1==a.options.lazyLoading&&(0==a.selectedCell[1]||0==a.selectedCell[3]))a.loadPage(0);else if(0<a.options.pagination){var e=a.whichPage(a.selectedCell[3]);e!=a.pageNumber&&a.page(e)}a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],
a.selectedCell[3]);a.updateScroll(1)};a.last=function(b,c){b?c?a.selectedCell[3]=a.records.length-1:a.right.visible(1,0):(c?a.selectedCell[1]=a.records.length-1:a.right.visible(0,0),a.selectedCell[2]=a.selectedCell[0],a.selectedCell[3]=a.selectedCell[1]);if(1==a.options.lazyLoading&&(a.selectedCell[1]==a.records.length-1||a.selectedCell[3]==a.records.length-1))a.loadPage(-1);else if(0<a.options.pagination){var e=a.whichPage(a.selectedCell[3]);e!=a.pageNumber&&a.page(e)}a.updateSelectionFromCoords(a.selectedCell[0],
a.selectedCell[1],a.selectedCell[2],a.selectedCell[3]);a.updateScroll(3)};a.selectAll=function(){a.selectedCell||(a.selectedCell=[]);a.selectedCell[0]=0;a.selectedCell[1]=0;a.selectedCell[2]=a.headers.length-1;a.selectedCell[3]=a.records.length-1;a.updateSelectionFromCoords(a.selectedCell[0],a.selectedCell[1],a.selectedCell[2],a.selectedCell[3])};a.loadPage=function(b){var c=1==a.options.search&&a.results?a.results:a.rows;if(null==b||-1==b)b=Math.ceil(c.length/100)-1;b=100*b+100;b>c.length&&(b=c.length);
var e=b-100;for(0>e&&(e=0);e<b;e++)1==a.options.search&&a.results?a.tbody.appendChild(a.rows[c[e]]):a.tbody.appendChild(a.rows[e]),100<a.tbody.children.length&&a.tbody.removeChild(a.tbody.firstChild)};a.loadUp=function(){var b=1==a.options.search&&a.results?a.results:a.rows,c=0;if(100<b.length){var e=parseInt(a.tbody.firstChild.getAttribute("data-y"));1==a.options.search&&a.results&&(e=b.indexOf(e));if(0<e)for(var g=0;30>g;g++)--e,-1<e&&(1==a.options.search&&a.results?a.tbody.insertBefore(a.rows[b[e]],
a.tbody.firstChild):a.tbody.insertBefore(a.rows[e],a.tbody.firstChild),100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.lastChild),c=1))}return c};a.loadDown=function(){var b=1==a.options.search&&a.results?a.results:a.rows,c=0;if(100<b.length){var e=parseInt(a.tbody.lastChild.getAttribute("data-y"));1==a.options.search&&a.results&&(e=b.indexOf(e));if(e<a.rows.length-1)for(var g=0;30>=g;g++)e<b.length&&(1==a.options.search&&a.results?a.tbody.appendChild(a.rows[b[e]]):a.tbody.appendChild(a.rows[e]),
100<a.tbody.children.length&&(a.tbody.removeChild(a.tbody.firstChild),c=1)),e+=1}return c};a.loadValidation=function(){if(a.selectedCell){var b=parseInt(a.tbody.firstChild.getAttribute("data-y"))/100,c=parseInt(a.selectedCell[3]/100),e=parseInt(a.rows.length/100);if(b!=c&&c<=e&&!Array.prototype.indexOf.call(a.tbody.children,a.rows[a.selectedCell[3]]))return a.loadPage(c),!0}return!1};a.resetSearch=function(){a.searchInput.value="";a.search("");a.results=null};a.search=function(b){b&&(b=b.toLowerCase());
a.options.filters&&a.resetFilters();a.resetSelection();a.pageNumber=0;a.results=[];if(b){var c=function(e){-1==a.results.indexOf(e)&&a.results.push(e)};a.options.data.filter(function(e,g){a:{var l=b;for(var p=0;p<e.length;p++)if(0<=(""+e[p]).toLowerCase().search(l)||0<=(""+a.records[g][p].innerHTML).toLowerCase().search(l)){l=!0;break a}l=!1}if(l){l=a.isRowMerged(g);if(l.length)for(p=0;p<l.length;p++)for(var u=n.getIdFromColumnName(l[p],!0),m=0;m<a.options.mergeCells[l[p]][1];m++)c(u[1]+m);else c(g);
return!0}return!1})}else a.results=null;return a.updateResult()};a.updateResult=function(){var b,c=0;for(b=1==a.options.lazyLoading?100:0<a.options.pagination?a.options.pagination:a.results?a.results.length:a.rows.length;a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(var e=0;e<a.rows.length;e++)!a.results||-1<a.results.indexOf(e)?(c<b&&(a.tbody.appendChild(a.rows[e]),c++),a.rows[e].style.display=""):a.rows[e].style.display="none";0<a.options.pagination&&a.updatePagination();a.updateCornerPosition();
return b};a.whichPage=function(b){1==a.options.search&&a.results&&(b=a.results.indexOf(b));return Math.ceil((parseInt(b)+1)/parseInt(a.options.pagination))-1};a.page=function(b){var c=a.pageNumber,e=1==a.options.search&&a.results?a.results:a.rows,g=parseInt(a.options.pagination);if(null==b||-1==b)b=Math.ceil(e.length/g)-1;a.pageNumber=b;var l=b*g;g=b*g+g;g>e.length&&(g=e.length);for(0>l&&(l=0);a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(;l<g;l++)1==a.options.search&&a.results?
a.tbody.appendChild(a.rows[e[l]]):a.tbody.appendChild(a.rows[l]);0<a.options.pagination&&a.updatePagination();a.updateCornerPosition();a.dispatch("onchangepage",q,b,c)};a.updatePagination=function(){a.pagination.children[0].innerHTML="";a.pagination.children[1].innerHTML="";if(a.options.pagination){var b=1==a.options.search&&a.results?a.results.length:a.rows.length;if(b){b=Math.ceil(b/a.options.pagination);if(6>a.pageNumber)var c=1,e=10>b?b:10;else 5>b-a.pageNumber?(c=b-9,e=b,1>c&&(c=1)):(c=a.pageNumber-
4,e=a.pageNumber+5);if(1<c){var g=document.createElement("div");g.className="jexcel_page";g.innerHTML="<";g.title=1;a.pagination.children[1].appendChild(g)}for(;c<=e;c++)g=document.createElement("div"),g.className="jexcel_page",g.innerHTML=c,a.pagination.children[1].appendChild(g),a.pageNumber==c-1&&g.classList.add("jexcel_page_selected");e<b&&(g=document.createElement("div"),g.className="jexcel_page",g.innerHTML=">",g.title=b,a.pagination.children[1].appendChild(g));a.pagination.children[0].innerHTML=
function(l){var p=Array.prototype.slice.call(arguments,1);return l.replace(/{(\d+)}/g,function(u,m){return"undefined"!=typeof p[m]?p[m]:u})}(a.options.text.showingPage,a.pageNumber+1,b)}else a.pagination.children[0].innerHTML=a.options.text.noRecordsFound}};a.download=function(b){if(0==a.options.allowExport)console.error("Export not allowed");else{b=""+a.copy(!1,a.options.csvDelimiter,!0,b,!0);var c=new Blob(["\ufeff"+b],{type:"text/csv;charset=utf-8;"});window.navigator&&window.navigator.msSaveOrOpenBlob?
window.navigator.msSaveOrOpenBlob(c,a.options.csvFileName+".csv"):(b=document.createElement("a"),c=URL.createObjectURL(c),b.href=c,b.setAttribute("download",a.options.csvFileName+".csv"),document.body.appendChild(b),b.click(),b.parentNode.removeChild(b))}};a.setHistory=function(b){if(1!=a.ignoreHistory){var c=++a.historyIndex;a.history=a.history.slice(0,c+1);a.history[c]=b}};a.copy=function(b,c,e,g,l){c||(c="\t");var p=new RegExp(c,"ig"),u=[],m,z=[],D=[],E=a.options.data[0].length,C=a.options.data.length,
F=!1,I="",J="",M=0,P=0;if(l&&1==a.options.includeHeadersOnDownload||!l&&1==a.options.includeHeadersOnCopy||g){if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length){var N=a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0]?a.options.nestedHeaders:[a.options.nestedHeaders];for(g=0;g<N.length;g++){F=[];for(l=0;l<N[g].length;l++){var G=parseInt(N[g][l].colspan);F.push(N[g][l].title);for(m=0;m<G-1;m++)F.push("")}J+=F.join(c)+"\r\n"}}F=!0}a.style=[];for(g=0;g<C;g++){G=[];m=[];for(l=0;l<E;l++)if(!b||
a.records[g][l].classList.contains("highlight"))1==F&&u.push(a.headers[l].innerText),N=a.options.data[g][l],N.match&&(N.match(p)||N.match(/,/g)||N.match(/\n/)||N.match(/"/))&&(N=N.replace(RegExp('"',"g"),'""'),N='"'+N+'"'),G.push(N),"checkbox"!=a.options.columns[l].type&&"radio"!=a.options.columns[l].type&&(N=1==a.options.stripHTMLOnCopy?a.records[g][l].innerText:a.records[g][l].innerHTML,N.match&&(N.match(p)||N.match(/,/g)||N.match(/\n/)||N.match(/"/))&&(N=N.replace(RegExp('"',"g"),'""'),N='"'+N+
'"')),m.push(N),N=a.records[g][l].getAttribute("style"),N=N.replace("display: none;",""),a.style.push(N?N:"");G.length&&(F&&(M=G.length,z.push(u.join(c))),z.push(G.join(c)));m.length&&(P++,F&&(D.push(u.join(c)),F=!1),D.push(m.join(c)))}E==M&&C==P&&(I=J);b=I+z.join("\r\n");I+=D.join("\r\n");e||(a.textarea.value=1==a.options.copyCompatibility?I:b,a.textarea.select(),document.execCommand("copy"));a.data=1==a.options.copyCompatibility?I:b;a.hashString=a.hash(a.data);if(!e){a.removeCopyingSelection();
if(a.highlighted)for(l=0;l<a.highlighted.length;l++)a.highlighted[l].classList.add("copying"),a.highlighted[l].classList.contains("highlight-left")&&a.highlighted[l].classList.add("copying-left"),a.highlighted[l].classList.contains("highlight-right")&&a.highlighted[l].classList.add("copying-right"),a.highlighted[l].classList.contains("highlight-top")&&a.highlighted[l].classList.add("copying-top"),a.highlighted[l].classList.contains("highlight-bottom")&&a.highlighted[l].classList.add("copying-bottom");
a.dispatch("oncopy",q,1==a.options.copyCompatibility?D:z,a.hashString)}return a.data};a.paste=function(b,c,e){var g=a.dispatch("onbeforepaste",q,e,b,c);if(!1===g)return!1;g&&(e=g);var l=a.hash(e);g=l==a.hashString?a.style:null;1==a.options.copyCompatibility&&l==a.hashString&&(e=a.data);e=a.parseCSV(e,"\t");if(null!=b&&null!=c&&e){for(var p=0,u=[],m={},z={},D=0,E=parseInt(b),C=parseInt(c),F;F=e[p];){l=0;for(E=parseInt(b);null!=F[l];){var I=a.updateCell(E,C,F[l]);u.push(I);a.updateFormulaChain(E,C,
u);g&&g[D]&&(I=n.getColumnNameFromId([E,C]),m[I]=g[D],z[I]=a.getStyle(I),a.records[C][E].setAttribute("style",g[D]),D++);l++;if(null!=F[l]){if(E>=a.headers.length-1)if(1==a.options.allowInsertColumn)a.insertColumn();else break;E=a.right.get(E,C)}}p++;if(e[p]){if(C>=a.rows.length-1)if(1==a.options.allowInsertRow)a.insertRow();else break;C=a.down.get(b,C)}}a.updateSelectionFromCoords(b,c,E,C);a.setHistory({action:"setValue",records:u,selection:a.selectedCell,newStyle:m,oldStyle:z});a.updateTable();
a.dispatch("onpaste",q,e);a.onafterchanges(q,u)}a.removeCopyingSelection()};a.removeCopyingSelection=function(){for(var b=document.querySelectorAll(".jexcel .copying"),c=0;c<b.length;c++)b[c].classList.remove("copying"),b[c].classList.remove("copying-left"),b[c].classList.remove("copying-right"),b[c].classList.remove("copying-top"),b[c].classList.remove("copying-bottom")};a.historyProcessRow=function(b,c){var e=c.insertBefore?+c.rowNumber:c.rowNumber+1;1==a.options.search&&a.results&&a.results.length!=
a.rows.length&&a.resetSearch();if(1==b){for(var g=c.numOfRows,l=e;l<g+e;l++)a.rows[l].parentNode.removeChild(a.rows[l]);a.records.splice(e,g);a.options.data.splice(e,g);a.rows.splice(e,g);a.conditionalSelectionUpdate(1,e,g+e-1)}else for(a.records=n.injectArray(a.records,e,c.rowRecords),a.options.data=n.injectArray(a.options.data,e,c.rowData),a.rows=n.injectArray(a.rows,e,c.rowNode),g=0,l=e;l<c.numOfRows+e;l++)a.tbody.insertBefore(c.rowNode[g],a.tbody.children[l]),g++;0<a.options.pagination&&a.page(a.pageNumber);
a.updateTableReferences()};a.historyProcessColumn=function(b,c){var e=c.insertBefore?c.columnNumber:c.columnNumber+1;if(1==b){var g=c.numOfColumns;a.options.columns.splice(e,g);for(var l=e;l<g+e;l++)a.headers[l].parentNode.removeChild(a.headers[l]),a.colgroup[l].parentNode.removeChild(a.colgroup[l]);a.headers.splice(e,g);a.colgroup.splice(e,g);for(var p=0;p<c.data.length;p++){for(l=e;l<g+e;l++)a.records[p][l].parentNode.removeChild(a.records[p][l]);a.records[p].splice(e,g);a.options.data[p].splice(e,
g)}if(a.options.footers)for(p=0;p<a.options.footers.length;p++)a.options.footers[p].splice(e,g)}else{a.options.columns=n.injectArray(a.options.columns,e,c.columns);a.headers=n.injectArray(a.headers,e,c.headers);a.colgroup=n.injectArray(a.colgroup,e,c.colgroup);g=0;for(l=e;l<c.numOfColumns+e;l++)a.headerContainer.insertBefore(c.headers[g],a.headerContainer.children[l+1]),a.colgroupContainer.insertBefore(c.colgroup[g],a.colgroupContainer.children[l+1]),g++;for(p=0;p<c.data.length;p++)for(a.options.data[p]=
n.injectArray(a.options.data[p],e,c.data[p]),a.records[p]=n.injectArray(a.records[p],e,c.records[p]),g=0,l=e;l<c.numOfColumns+e;l++)a.rows[p].insertBefore(c.records[p][g],a.rows[p].children[l+1]),g++;if(a.options.footers)for(p=0;p<a.options.footers.length;p++)a.options.footers[p]=n.injectArray(a.options.footers[p],e,c.footers[p])}if(a.options.nestedHeaders&&0<a.options.nestedHeaders.length)if(a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(p=0;p<a.options.nestedHeaders.length;p++)e=
1==b?parseInt(a.options.nestedHeaders[p][a.options.nestedHeaders[p].length-1].colspan)-c.numOfColumns:parseInt(a.options.nestedHeaders[p][a.options.nestedHeaders[p].length-1].colspan)+c.numOfColumns,a.options.nestedHeaders[p][a.options.nestedHeaders[p].length-1].colspan=e,a.thead.children[p].children[a.thead.children[p].children.length-1].setAttribute("colspan",e);else e=1==b?parseInt(a.options.nestedHeaders[0].colspan)-c.numOfColumns:parseInt(a.options.nestedHeaders[0].colspan)+c.numOfColumns,a.options.nestedHeaders[0].colspan=
e,a.thead.children[0].children[a.thead.children[0].children.length-1].setAttribute("colspan",e);a.updateTableReferences()};a.undo=function(){var b=a.ignoreEvents?!0:!1,c=a.ignoreHistory?!0:!1;a.ignoreEvents=!0;a.ignoreHistory=!0;var e=[];if(0<=a.historyIndex){var g=a.history[a.historyIndex--];if("insertRow"==g.action)a.historyProcessRow(1,g);else if("deleteRow"==g.action)a.historyProcessRow(0,g);else if("insertColumn"==g.action)a.historyProcessColumn(1,g);else if("deleteColumn"==g.action)a.historyProcessColumn(0,
g);else if("moveRow"==g.action)a.moveRow(g.newValue,g.oldValue);else if("moveColumn"==g.action)a.moveColumn(g.newValue,g.oldValue);else if("setMerge"==g.action)a.removeMerge(g.column,g.data);else if("setStyle"==g.action)a.setStyle(g.oldValue,null,null,1);else if("setWidth"==g.action)a.setWidth(g.column,g.oldValue);else if("setHeight"==g.action)a.setHeight(g.row,g.oldValue);else if("setHeader"==g.action)a.setHeader(g.column,g.oldValue);else if("setComments"==g.action)a.setComments(g.column,g.oldValue[0],
g.oldValue[1]);else if("orderBy"==g.action){e=[];for(var l=0;l<g.rows.length;l++)e[g.rows[l]]=l;a.updateOrderArrow(g.column,g.order?0:1);a.updateOrder(e)}else if("setValue"==g.action){for(l=0;l<g.records.length;l++)e.push({x:g.records[l].x,y:g.records[l].y,newValue:g.records[l].oldValue}),g.oldStyle&&a.resetStyle(g.oldStyle);a.setValue(e);g.selection&&a.updateSelectionFromCoords(g.selection[0],g.selection[1],g.selection[2],g.selection[3])}}a.ignoreEvents=b;a.ignoreHistory=c;a.dispatch("onundo",q,
g)};a.redo=function(){var b=a.ignoreEvents?!0:!1,c=a.ignoreHistory?!0:!1;a.ignoreEvents=!0;a.ignoreHistory=!0;if(a.historyIndex<a.history.length-1){var e=a.history[++a.historyIndex];if("insertRow"==e.action)a.historyProcessRow(0,e);else if("deleteRow"==e.action)a.historyProcessRow(1,e);else if("insertColumn"==e.action)a.historyProcessColumn(0,e);else if("deleteColumn"==e.action)a.historyProcessColumn(1,e);else if("moveRow"==e.action)a.moveRow(e.oldValue,e.newValue);else if("moveColumn"==e.action)a.moveColumn(e.oldValue,
e.newValue);else if("setMerge"==e.action)a.setMerge(e.column,e.colspan,e.rowspan,1);else if("setStyle"==e.action)a.setStyle(e.newValue,null,null,1);else if("setWidth"==e.action)a.setWidth(e.column,e.newValue);else if("setHeight"==e.action)a.setHeight(e.row,e.newValue);else if("setHeader"==e.action)a.setHeader(e.column,e.newValue);else if("setComments"==e.action)a.setComments(e.column,e.newValue[0],e.newValue[1]);else if("orderBy"==e.action)a.updateOrderArrow(e.column,e.order),a.updateOrder(e.rows);
else if("setValue"==e.action){a.setValue(e.records);for(var g=0;g<e.records.length;g++)e.oldStyle&&a.resetStyle(e.newStyle);e.selection&&a.updateSelectionFromCoords(e.selection[0],e.selection[1],e.selection[2],e.selection[3])}}a.ignoreEvents=b;a.ignoreHistory=c;a.dispatch("onredo",q,e)};a.getDropDownValue=function(b,c){var e=[];if(a.options.columns[b]&&a.options.columns[b].source){for(var g=[],l=a.options.columns[b].source,p=0;p<l.length;p++)"object"==typeof l[p]?g[l[p].id]=l[p].name:g[l[p]]=l[p];
l=Array.isArray(c)?c:(""+c).split(";");for(p=0;p<l.length;p++)"object"===typeof l[p]?e.push(g[l[p].id]):g[l[p]]&&e.push(g[l[p]])}else console.error("Invalid column");return 0<e.length?e.join("; "):""};a.parseCSV=function(b,c){b=b.replace(/\r?\n$|\r$|\n$/g,"");9==b.charCodeAt(b.length-1)&&(b+="\x00");c=c||",";for(var e=[],g=!1,l=0,p=0,u=0;u<b.length;u++){var m=b[u],z=b[u+1];e[l]=e[l]||[];e[l][p]=e[l][p]||"";'"'==m&&g&&'"'==z?(e[l][p]+=m,++u):'"'==m?g=!g:m!=c||g?"\r"!=m||"\n"!=z||g?"\n"!=m||g?"\r"!=
m||g?e[l][p]+=m:(++l,p=0):(++l,p=0):(++l,p=0,++u):++p}return e};a.hash=function(b){var c=0,e;if(0!==b.length)for(e=0;e<b.length;e++){var g=b.charCodeAt(e);c=(c<<5)-c+g;c|=0}return c};a.onafterchanges=function(b,c){a.dispatch("onafterchanges",b,c)};a.destroy=function(){n.destroy(q)};a.init=function(){n.current=a;"function"==typeof n.build&&(a.options.root?n.build(a.options.root):(n.build(document),n.build=null));q.setAttribute("tabindex",1);q.addEventListener("focus",function(b){n.current&&!a.selectedCell&&
(a.updateSelectionFromCoords(0,0,0,0),a.left())});a.options.csv?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.csv,method:a.options.method,data:a.options.requestVariables,dataType:"text",success:function(b){b=a.parseCSV(b,a.options.csvDelimiter);if(1==a.options.csvHeaders&&0<b.length)for(var c=b.shift(),e=0;e<c.length;e++)a.options.columns[e]||(a.options.columns[e]={type:"text",align:a.options.defaultColAlign,width:a.options.defaultColWidth}),"undefined"===typeof a.options.columns[e].title&&
(a.options.columns[e].title=c[e]);a.options.data=b;a.prepareTable();1==a.options.loadingSpin&&r.loading.hide()}})):a.options.url?(1==a.options.loadingSpin&&r.loading.show(),r.ajax({url:a.options.url,method:a.options.method,data:a.options.requestVariables,dataType:"json",success:function(b){a.options.data=b.data?b.data:b;a.prepareTable();1==a.options.loadingSpin&&r.loading.hide()}})):a.prepareTable()};a.options.contextMenu=y&&null!=y.contextMenu?y.contextMenu:function(b,c,e,g){b=[];if(null==e)1==a.options.allowInsertColumn&&
b.push({title:a.options.text.insertANewColumnBefore,onclick:function(){a.insertColumn(1,parseInt(c),1)}}),1==a.options.allowInsertColumn&&b.push({title:a.options.text.insertANewColumnAfter,onclick:function(){a.insertColumn(1,parseInt(c),0)}}),1==a.options.allowDeleteColumn&&b.push({title:a.options.text.deleteSelectedColumns,onclick:function(){a.deleteColumn(a.getSelectedColumns().length?void 0:parseInt(c))}}),1==a.options.allowRenameColumn&&b.push({title:a.options.text.renameThisColumn,onclick:function(){a.setHeader(c)}}),
1==a.options.columnSorting&&(b.push({type:"line"}),b.push({title:a.options.text.orderAscending,onclick:function(){a.orderBy(c,0)}}),b.push({title:a.options.text.orderDescending,onclick:function(){a.orderBy(c,1)}}));else if(1==a.options.allowInsertRow&&(b.push({title:a.options.text.insertANewRowBefore,onclick:function(){a.insertRow(1,parseInt(e),1)}}),b.push({title:a.options.text.insertANewRowAfter,onclick:function(){a.insertRow(1,parseInt(e))}})),1==a.options.allowDeleteRow&&b.push({title:a.options.text.deleteSelectedRows,
onclick:function(){a.deleteRow(a.getSelectedRows().length?void 0:parseInt(e))}}),c&&1==a.options.allowComments){b.push({type:"line"});var l=a.records[e][c].getAttribute("title")||"";b.push({title:l?a.options.text.editComments:a.options.text.addComments,onclick:function(){var p=prompt(a.options.text.comments,l);p&&a.setComments([c,e],p)}});l&&b.push({title:a.options.text.clearComments,onclick:function(){a.setComments([c,e],"")}})}b.push({type:"line"});b.push({title:a.options.text.copy,shortcut:"Ctrl + C",
onclick:function(){a.copy(!0)}});navigator&&navigator.clipboard&&b.push({title:a.options.text.paste,shortcut:"Ctrl + V",onclick:function(){a.selectedCell&&navigator.clipboard.readText().then(function(p){p&&n.current.paste(a.selectedCell[0],a.selectedCell[1],p)})}});a.options.allowExport&&b.push({title:a.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){a.download()}});a.options.about&&b.push({title:a.options.text.about,onclick:function(){!0===a.options.about?alert(k().print()):alert(a.options.about)}});
return b};a.scrollControls=function(b){a.wheelControls();0<a.options.freezeColumns&&a.content.scrollLeft!=f&&a.updateFreezePosition();(1==a.options.lazyLoading||1==a.options.tableOverflow)&&a.edition&&"jdropdown"!=b.target.className.substr(0,9)&&a.closeEditor(a.edition[0],!0)};a.wheelControls=function(b){1==a.options.lazyLoading&&null==n.timeControlLoading&&(n.timeControlLoading=setTimeout(function(){a.content.scrollTop+a.content.clientHeight>=a.content.scrollHeight-10?a.loadDown()&&(a.content.scrollTop+
a.content.clientHeight>a.content.scrollHeight-10&&(a.content.scrollTop-=a.content.clientHeight),a.updateCornerPosition()):a.content.scrollTop<=a.content.clientHeight&&a.loadUp()&&(10>a.content.scrollTop&&(a.content.scrollTop+=a.content.clientHeight),a.updateCornerPosition());n.timeControlLoading=null},100))};a.getFreezeWidth=function(){var b=0;if(0<a.options.freezeColumns)for(var c=0;c<a.options.freezeColumns;c++)b+=parseInt(a.options.columns[c].width);return b};var f=0;a.updateFreezePosition=function(){f=
a.content.scrollLeft;var b=0;if(50<f)for(var c=0;c<a.options.freezeColumns;c++){0<c&&(b+=parseInt(a.options.columns[c-1].width));a.headers[c].classList.add("jexcel_freezed");a.headers[c].style.left=b+"px";for(var e=0;e<a.rows.length;e++)if(a.rows[e]&&a.records[e][c]){var g=f+(0<c?a.records[e][c-1].style.width:0)-51+"px";a.records[e][c].classList.add("jexcel_freezed");a.records[e][c].style.left=g}}else for(c=0;c<a.options.freezeColumns;c++)for(a.headers[c].classList.remove("jexcel_freezed"),a.headers[c].style.left=
"",e=0;e<a.rows.length;e++)a.records[e][c]&&(a.records[e][c].classList.remove("jexcel_freezed"),a.records[e][c].style.left="");a.updateCornerPosition()};q.addEventListener("DOMMouseScroll",a.wheelControls);q.addEventListener("mousewheel",a.wheelControls);q.jexcel=a;q.jspreadsheet=a;a.init();return a};n.setDictionary=function(q){r.setDictionary(q)};n.setExtensions=function(q){for(var y=Object.keys(q),a=0;a<y.length;a++)"function"===typeof q[y[a]]&&(n[y[a]]=q[y[a]],n.license&&"function"==typeof q[y[a]].license&&
q[y[a]].license(n.license))};n.formula=w;n.version=k;n.current=null;n.timeControl=null;n.timeControlLoading=null;n.destroy=function(q,y){if(q.jexcel){var a=q.jexcel.options.root?q.jexcel.options.root:document;q.removeEventListener("DOMMouseScroll",q.jexcel.scrollControls);q.removeEventListener("mousewheel",q.jexcel.scrollControls);q.jexcel=null;q.innerHTML="";y&&(a.removeEventListener("mouseup",n.mouseUpControls),a.removeEventListener("mousedown",n.mouseDownControls),a.removeEventListener("mousemove",
n.mouseMoveControls),a.removeEventListener("mouseover",n.mouseOverControls),a.removeEventListener("dblclick",n.doubleClickControls),a.removeEventListener("paste",n.pasteControls),a.removeEventListener("contextmenu",n.contextMenuControls),a.removeEventListener("touchstart",n.touchStartControls),a.removeEventListener("touchend",n.touchEndControls),a.removeEventListener("touchcancel",n.touchEndControls),document.removeEventListener("keydown",n.keyDownControls),n=null)}};n.build=function(q){q.addEventListener("mouseup",
n.mouseUpControls);q.addEventListener("mousedown",n.mouseDownControls);q.addEventListener("mousemove",n.mouseMoveControls);q.addEventListener("mouseover",n.mouseOverControls);q.addEventListener("dblclick",n.doubleClickControls);q.addEventListener("paste",n.pasteControls);q.addEventListener("contextmenu",n.contextMenuControls);q.addEventListener("touchstart",n.touchStartControls);q.addEventListener("touchend",n.touchEndControls);q.addEventListener("touchcancel",n.touchEndControls);q.addEventListener("touchmove",
n.touchEndControls);document.addEventListener("keydown",n.keyDownControls)};n.keyDownControls=function(q){if(n.current){if(n.current.edition)if(27==q.which)n.current.edition&&n.current.closeEditor(n.current.edition[0],!1),q.preventDefault();else if(13==q.which)if("calendar"==n.current.options.columns[n.current.edition[2]].type)n.current.closeEditor(n.current.edition[0],!0);else{if("dropdown"!=n.current.options.columns[n.current.edition[2]].type&&"autocomplete"!=n.current.options.columns[n.current.edition[2]].type)if((1==
n.current.options.wordWrap||1==n.current.options.columns[n.current.edition[2]].wordWrap||200<n.current.options.data[n.current.edition[3]][n.current.edition[2]].length)&&q.altKey){var y=n.current.edition[0].children[0],a=n.current.edition[0].children[0].value,x=y.selectionStart;a=a.slice(0,x)+"\n"+a.slice(x);y.value=a;y.focus();y.selectionStart=x+1;y.selectionEnd=x+1}else n.current.edition[0].children[0].blur()}else 9==q.which&&("calendar"==n.current.options.columns[n.current.edition[2]].type?n.current.closeEditor(n.current.edition[0],
!0):n.current.edition[0].children[0].blur());if(!n.current.edition&&n.current.selectedCell)if(37==q.which)n.current.left(q.shiftKey,q.ctrlKey),q.preventDefault();else if(39==q.which)n.current.right(q.shiftKey,q.ctrlKey),q.preventDefault();else if(38==q.which)n.current.up(q.shiftKey,q.ctrlKey),q.preventDefault();else if(40==q.which)n.current.down(q.shiftKey,q.ctrlKey),q.preventDefault();else if(36==q.which)n.current.first(q.shiftKey,q.ctrlKey),q.preventDefault();else if(35==q.which)n.current.last(q.shiftKey,
q.ctrlKey),q.preventDefault();else if(32==q.which)1==n.current.options.editable&&n.current.setCheckRadioValue(),q.preventDefault();else if(46==q.which)1==n.current.options.editable&&(n.current.selectedRow?1==n.current.options.allowDeleteRow&&confirm(n.current.options.text.areYouSureToDeleteTheSelectedRows)&&n.current.deleteRow():n.current.selectedHeader?1==n.current.options.allowDeleteColumn&&confirm(n.current.options.text.areYouSureToDeleteTheSelectedColumns)&&n.current.deleteColumn():n.current.setValue(n.current.highlighted,
""));else if(13==q.which)q.shiftKey?n.current.up():(1==n.current.options.allowInsertRow&&1==n.current.options.allowManualInsertRow&&n.current.selectedCell[1]==n.current.options.data.length-1&&n.current.insertRow(),n.current.down()),q.preventDefault();else if(9==q.which)q.shiftKey?n.current.left():(1==n.current.options.allowInsertColumn&&1==n.current.options.allowManualInsertColumn&&n.current.selectedCell[0]==n.current.options.data[0].length-1&&n.current.insertColumn(),n.current.right()),q.preventDefault();
else if((q.ctrlKey||q.metaKey)&&!q.shiftKey)65==q.which?(n.current.selectAll(),q.preventDefault()):83==q.which?(n.current.download(),q.preventDefault()):89==q.which?(n.current.redo(),q.preventDefault()):90==q.which?(n.current.undo(),q.preventDefault()):67==q.which?(n.current.copy(!0),q.preventDefault()):88==q.which?(1==n.current.options.editable?n.cutControls():n.copyControls(),q.preventDefault()):86==q.which&&n.pasteControls();else{if(n.current.selectedCell&&1==n.current.options.editable&&(y=n.current.selectedCell[1],
a=n.current.selectedCell[0],"readonly"!=n.current.options.columns[a].type))if(32==q.keyCode)"checkbox"==n.current.options.columns[a].type||"radio"==n.current.options.columns[a].type?q.preventDefault():n.current.openEditor(n.current.records[y][a],!0);else if(113==q.keyCode)n.current.openEditor(n.current.records[y][a],!1);else if(8==q.keyCode||48<=q.keyCode&&57>=q.keyCode||96<=q.keyCode&&111>=q.keyCode||187<=q.keyCode&&190>=q.keyCode||(String.fromCharCode(q.keyCode)==q.key||String.fromCharCode(q.keyCode).toLowerCase()==
q.key.toLowerCase())&&n.validLetter(String.fromCharCode(q.keyCode)))n.current.openEditor(n.current.records[y][a],!0),"calendar"==n.current.options.columns[a].type&&q.preventDefault()}else q.target.classList.contains("jexcel_search")&&(n.timeControl&&clearTimeout(n.timeControl),n.timeControl=setTimeout(function(){n.current.search(q.target.value)},200))}};n.isMouseAction=!1;n.mouseDownControls=function(q){q=q||window.event;var y=q.buttons?q.buttons:q.button?q.button:q.which,a=n.getElement(q.target);
a[0]?n.current!=a[0].jexcel&&(n.current&&(n.current.edition&&n.current.closeEditor(n.current.edition[0],!0),n.current.resetSelection()),n.current=a[0].jexcel):n.current&&(n.current.edition&&n.current.closeEditor(n.current.edition[0],!0),n.current.resetSelection(!0),n.current=null);if(n.current&&1==y){if(q.target.classList.contains("jexcel_selectall"))n.current&&n.current.selectAll();else if(q.target.classList.contains("jexcel_corner"))1==n.current.options.editable&&(n.current.selectedCorner=!0);else{if(1==
a[1]){var x=q.target.getAttribute("data-x");if(x)if(y=q.target.getBoundingClientRect(),1==n.current.options.columnResize&&6>y.width-q.offsetX)for(n.current.resizing={mousePosition:q.pageX,column:x,width:y.width},n.current.headers[x].classList.add("resizing"),y=0;y<n.current.records.length;y++)n.current.records[y][x]&&n.current.records[y][x].classList.add("resizing");else if(1==n.current.options.columnDrag&&6>y.height-q.offsetY)if(n.current.isColMerged(x).length)console.error("Jspreadsheet: This column is part of a merged cell.");
else for(n.current.resetSelection(),n.current.dragging={element:q.target,column:x,destination:x},n.current.headers[x].classList.add("dragging"),y=0;y<n.current.records.length;y++)n.current.records[y][x]&&n.current.records[y][x].classList.add("dragging");else{if(n.current.selectedHeader&&(q.shiftKey||q.ctrlKey)){y=n.current.selectedHeader;var A=x}else n.current.selectedHeader==x&&1==n.current.options.allowRenameColumn&&(n.timeControl=setTimeout(function(){n.current.setHeader(x)},800)),A=y=n.current.selectedHeader=
x;n.current.updateSelectionFromCoords(y,0,A,n.current.options.data.length-1)}else q.target.parentNode.classList.contains("jexcel_nested")&&(q.target.getAttribute("data-column")?(A=q.target.getAttribute("data-column").split(","),y=parseInt(A[0]),A=parseInt(A[A.length-1])):(y=0,A=n.current.options.columns.length-1),n.current.updateSelectionFromCoords(y,0,A,n.current.options.data.length-1))}else n.current.selectedHeader=!1;if(2==a[1])if(a=q.target.getAttribute("data-y"),q.target.classList.contains("jexcel_row"))y=
q.target.getBoundingClientRect(),1==n.current.options.rowResize&&6>y.height-q.offsetY?(n.current.resizing={element:q.target.parentNode,mousePosition:q.pageY,row:a,height:y.height},q.target.parentNode.classList.add("resizing")):1==n.current.options.rowDrag&&6>y.width-q.offsetX?n.current.isRowMerged(a).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==n.current.options.search&&n.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):
(n.current.resetSelection(),n.current.dragging={element:q.target.parentNode,row:a,destination:a},q.target.parentNode.classList.add("dragging")):(y=n.current.selectedRow&&(q.shiftKey||q.ctrlKey)?n.current.selectedRow:n.current.selectedRow=a,n.current.updateSelectionFromCoords(0,y,n.current.options.data[0].length-1,a));else if(q.target.classList.contains("jclose")&&50>q.target.clientWidth-q.offsetX&&50>q.offsetY)n.current.closeEditor(n.current.edition[0],!0);else{var H=function(B){var t=B.getAttribute("data-x"),
h=B.getAttribute("data-y");if(t&&h)return[t,h];if(B.parentNode)return H(B.parentNode)};if(a=H(q.target))x=a[0],a=a[1],n.current.edition&&(n.current.edition[2]!=x||n.current.edition[3]!=a)&&n.current.closeEditor(n.current.edition[0],!0),n.current.edition||(q.shiftKey?n.current.updateSelectionFromCoords(n.current.selectedCell[0],n.current.selectedCell[1],x,a):n.current.updateSelectionFromCoords(x,a)),n.current.selectedHeader=null,n.current.selectedRow=null}else n.current.selectedRow=!1;q.target.classList.contains("jexcel_page")&&
("<"==q.target.innerText?n.current.page(0):">"==q.target.innerText?n.current.page(q.target.getAttribute("title")-1):n.current.page(q.target.innerText-1))}n.isMouseAction=n.current.edition?!1:!0}else n.isMouseAction=!1};n.mouseUpControls=function(q){if(n.current)if(n.current.resizing){if(n.current.resizing.column){q=n.current.colgroup[n.current.resizing.column].getAttribute("width");var y=n.current.getSelectedColumns();if(1<y.length){for(var a=[],x=0;x<y.length;x++)a.push(parseInt(n.current.colgroup[y[x]].getAttribute("width")));
x=y.indexOf(parseInt(n.current.resizing.column));a[x]=n.current.resizing.width;n.current.setWidth(y,q,a)}else n.current.setWidth(n.current.resizing.column,q,n.current.resizing.width);n.current.headers[n.current.resizing.column].classList.remove("resizing");for(y=0;y<n.current.records.length;y++)n.current.records[y][n.current.resizing.column]&&n.current.records[y][n.current.resizing.column].classList.remove("resizing")}else n.current.rows[n.current.resizing.row].children[0].classList.remove("resizing"),
q=n.current.rows[n.current.resizing.row].getAttribute("height"),n.current.setHeight(n.current.resizing.row,q,n.current.resizing.height),n.current.resizing.element.classList.remove("resizing");n.current.resizing=null}else if(n.current.dragging){if(n.current.dragging){if(n.current.dragging.column){q=q.target.getAttribute("data-x");n.current.headers[n.current.dragging.column].classList.remove("dragging");for(y=0;y<n.current.rows.length;y++)n.current.records[y][n.current.dragging.column]&&n.current.records[y][n.current.dragging.column].classList.remove("dragging");
for(x=0;x<n.current.headers.length;x++)n.current.headers[x].classList.remove("dragging-left"),n.current.headers[x].classList.remove("dragging-right");q&&n.current.dragging.column!=n.current.dragging.destination&&n.current.moveColumn(n.current.dragging.column,n.current.dragging.destination)}else n.current.dragging.element.nextSibling?(q=parseInt(n.current.dragging.element.nextSibling.getAttribute("data-y")),n.current.dragging.row<q&&--q):q=parseInt(n.current.dragging.element.previousSibling.getAttribute("data-y")),
n.current.dragging.row!=n.current.dragging.destination&&n.current.moveRow(n.current.dragging.row,q,!0),n.current.dragging.element.classList.remove("dragging");n.current.dragging=null}}else n.current.selectedCorner&&(n.current.selectedCorner=!1,0<n.current.selection.length&&(n.current.copyData(n.current.selection[0],n.current.selection[n.current.selection.length-1]),n.current.removeCopySelection()));n.timeControl&&(clearTimeout(n.timeControl),n.timeControl=null);n.isMouseAction=!1};n.mouseMoveControls=
function(q){q=q||window.event;q.buttons||q.button||q.which||(n.isMouseAction=!1);if(n.current)if(1==n.isMouseAction)n.current.resizing&&(n.current.resizing.column?(q=q.pageX-n.current.resizing.mousePosition,0<n.current.resizing.width+q&&(n.current.colgroup[n.current.resizing.column].setAttribute("width",n.current.resizing.width+q),n.current.updateCornerPosition())):(q=q.pageY-n.current.resizing.mousePosition,0<n.current.resizing.height+q&&(n.current.rows[n.current.resizing.row].setAttribute("height",
n.current.resizing.height+q),n.current.updateCornerPosition())));else{var y=q.target.getAttribute("data-x"),a=q.target.getAttribute("data-y"),x=q.target.getBoundingClientRect();n.current.cursor&&(n.current.cursor.style.cursor="",n.current.cursor=null);q.target.parentNode.parentNode&&q.target.parentNode.parentNode.className&&(q.target.parentNode.parentNode.classList.contains("resizable")&&(q.target&&y&&!a&&6>x.width-(q.clientX-x.left)?(n.current.cursor=q.target,n.current.cursor.style.cursor="col-resize"):
q.target&&!y&&a&&6>x.height-(q.clientY-x.top)&&(n.current.cursor=q.target,n.current.cursor.style.cursor="row-resize")),q.target.parentNode.parentNode.classList.contains("draggable")&&(q.target&&!y&&a&&6>x.width-(q.clientX-x.left)?(n.current.cursor=q.target,n.current.cursor.style.cursor="move"):q.target&&y&&!a&&6>x.height-(q.clientY-x.top)&&(n.current.cursor=q.target,n.current.cursor.style.cursor="move")))}};n.mouseOverControls=function(q){q=q||window.event;q.buttons||q.button||q.which||(n.isMouseAction=
!1);if(n.current&&1==n.isMouseAction){var y=n.getElement(q.target);if(y[0]){if(n.current!=y[0].jexcel&&n.current)return!1;var a=q.target.getAttribute("data-x"),x=q.target.getAttribute("data-y");if(n.current.dragging)if(n.current.dragging.column){if(a)if(n.current.isColMerged(a).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(y=0;y<n.current.headers.length;y++)n.current.headers[y].classList.remove("dragging-left"),n.current.headers[y].classList.remove("dragging-right");
n.current.dragging.column==a?n.current.dragging.destination=parseInt(a):q.target.clientWidth/2>q.offsetX?(n.current.dragging.destination=n.current.dragging.column<a?parseInt(a)-1:parseInt(a),n.current.headers[a].classList.add("dragging-left")):(n.current.dragging.destination=n.current.dragging.column<a?parseInt(a):parseInt(a)+1,n.current.headers[a].classList.add("dragging-right"))}}else x&&(n.current.isRowMerged(x).length?console.error("Jspreadsheet: This row is part of a merged cell."):(a=q.target.clientHeight/
2>q.offsetY?q.target.parentNode.nextSibling:q.target.parentNode,n.current.dragging.element!=a&&(q.target.parentNode.parentNode.insertBefore(n.current.dragging.element,a),n.current.dragging.destination=Array.prototype.indexOf.call(n.current.dragging.element.parentNode.children,n.current.dragging.element))));else if(!n.current.resizing){if(1==y[1]&&n.current.selectedHeader){a=q.target.getAttribute("data-x");var A=n.current.selectedHeader;n.current.updateSelectionFromCoords(A,0,a,n.current.options.data.length-
1)}2==y[1]&&(q.target.classList.contains("jexcel_row")?n.current.selectedRow&&(A=n.current.selectedRow,n.current.updateSelectionFromCoords(0,A,n.current.options.data[0].length-1,x)):n.current.edition||a&&x&&(n.current.selectedCorner?n.current.updateCopySelection(a,x):n.current.selectedCell&&n.current.updateSelectionFromCoords(n.current.selectedCell[0],n.current.selectedCell[1],a,x)))}}}n.timeControl&&(clearTimeout(n.timeControl),n.timeControl=null)};n.doubleClickControls=function(q){if(n.current)if(q.target.classList.contains("jexcel_corner")){if(0<
n.current.highlighted.length){q=n.current.highlighted[0].getAttribute("data-x");var y=parseInt(n.current.highlighted[n.current.highlighted.length-1].getAttribute("data-y"))+1,a=n.current.highlighted[n.current.highlighted.length-1].getAttribute("data-x");n.current.copyData(n.current.records[y][q],n.current.records[n.current.records.length-1][a])}}else if(q.target.classList.contains("jexcel_column_filter"))y=q.target.getAttribute("data-x"),n.current.openFilter(y);else if(a=n.getElement(q.target),1==
a[1]&&1==n.current.options.columnSorting&&(y=q.target.getAttribute("data-x"))&&n.current.orderBy(y),2==a[1]&&1==n.current.options.editable&&!n.current.edition){var x=function(A){if(A.parentNode){var H=A.getAttribute("data-x"),B=A.getAttribute("data-y");return H&&B?A:x(A.parentNode)}};(q=x(q.target))&&q.classList.contains("highlight")&&n.current.openEditor(q)}};n.copyControls=function(q){n.current&&n.copyControls.enabled&&(n.current.edition||n.current.copy(!0))};n.cutControls=function(q){n.current&&
!n.current.edition&&(n.current.copy(!0),1==n.current.options.editable&&n.current.setValue(n.current.highlighted,""))};n.pasteControls=function(q){n.current&&n.current.selectedCell&&!n.current.edition&&1==n.current.options.editable&&(q&&q.clipboardData?(n.current.paste(n.current.selectedCell[0],n.current.selectedCell[1],q.clipboardData.getData("text")),q.preventDefault()):window.clipboardData&&n.current.paste(n.current.selectedCell[0],n.current.selectedCell[1],window.clipboardData.getData("text")))};
n.contextMenuControls=function(q){q=q||window.event;if(n.current)if(n.current.edition)q.preventDefault();else if(n.current.options.contextMenu&&(n.current.contextMenu.contextmenu.close(),n.current)){var y=q.target.getAttribute("data-x"),a=q.target.getAttribute("data-y");if(y||a)(y<parseInt(n.current.selectedCell[0])||y>parseInt(n.current.selectedCell[2])||a<parseInt(n.current.selectedCell[1])||a>parseInt(n.current.selectedCell[3]))&&n.current.updateSelectionFromCoords(y,a,y,a),y=n.current.options.contextMenu(n.current,
y,a,q),n.current.contextMenu.contextmenu.open(q,y),q.preventDefault()}};n.touchStartControls=function(q){var y=n.getElement(q.target);y[0]?n.current!=y[0].jexcel&&(n.current&&n.current.resetSelection(),n.current=y[0].jexcel):n.current&&(n.current.resetSelection(),n.current=null);if(n.current&&!n.current.edition){var a=q.target.getAttribute("data-x");y=q.target.getAttribute("data-y");a&&y&&(n.current.updateSelectionFromCoords(a,y),n.timeControl=setTimeout(function(){n.tmpElement="color"==n.current.options.columns[a].type?
null:q.target;n.current.openEditor(q.target,!1,q)},500))}};n.touchEndControls=function(q){n.timeControl&&(clearTimeout(n.timeControl),n.timeControl=null,n.tmpElement&&"INPUT"==n.tmpElement.children[0].tagName&&n.tmpElement.children[0].focus(),n.tmpElement=null)};n.tabs=function(q,y){var a=[];if(q.classList.contains("jexcel_tabs"))A=q.children[0],H=q.children[1];else{q.innerHTML="";q.classList.add("jexcel_tabs");q.jexcel=[];var x=document.createElement("div"),A=q.appendChild(x);x=document.createElement("div");
var H=q.appendChild(x)}x=[];for(var B=[],t=0;t<y.length;t++){x[t]=document.createElement("div");x[t].classList.add("jexcel_tab");var h=n(x[t],y[t]);H.appendChild(x[t]);a[t]=q.jexcel.push(h);B[t]=document.createElement("div");B[t].classList.add("jexcel_tab_link");B[t].setAttribute("data-spreadsheet",q.jexcel.length-1);B[t].innerHTML=y[t].sheetName;B[t].onclick=function(){for(var f=0;f<A.children.length;f++)A.children[f].classList.remove("selected"),H.children[f].style.display="none";f=this.getAttribute("data-spreadsheet");
H.children[f].style.display="block";A.children[f].classList.add("selected")};A.appendChild(B[t])}for(x=0;x<A.children.length;x++)A.children[x].classList.remove("selected"),H.children[x].style.display="none";A.children[A.children.length-1].classList.add("selected");H.children[A.children.length-1].style.display="block";return a};n.createTabs=n.tabs;n.fromSpreadsheet=function(q,y){var a=function(A){var H=[];A.SheetNames.forEach(function(B){var t={rows:[],columns:[],data:[],style:{}};t.sheetName=B;var h=
A.Sheets[B]["!cols"];if(h&&h.length)for(var f=0;f<h.length;f++)t.columns[f]={},h[f]&&h[f].wpx&&(t.columns[f].width=h[f].wpx+"px");if((h=A.Sheets[B]["!rows"])&&h.length)for(f=0;f<h.length;f++)h[f]&&h[f].hpx&&(t.rows[f]={},t.rows[f].height=h[f].hpx+"px");if((h=A.Sheets[B]["!merges"])&&0<h.length)for(t.mergeCells=[],f=0;f<h.length;f++){var b=h[f].s.c,c=h[f].s.r,e=h[f].e.c,g=h[f].e.r,l=n.getColumnNameFromId([b,c]);t.mergeCells[l]=[e-b+1,g-c+1]}c=b=0;h=Object.keys(A.Sheets[B]);for(f=0;f<h.length;f++)"!"!=
h[f].substr(0,1)&&(e=A.Sheets[B][h[f]],g=n.getIdFromColumnName(h[f],!0),t.data[g[1]]||(t.data[g[1]]=[]),t.data[g[1]][g[0]]=e.f?"="+e.f:e.w,b<g[0]&&(b=g[0]),c<g[1]&&(c=g[1]),e.style&&0<Object.keys(e.style).length&&(t.style[h[f]]=e.style),e.s&&e.s.fgColor&&(t.style[h[f]]&&(t.style[h[f]]+=";"),t.style[h[f]]+="background-color:#"+e.s.fgColor.rgb));B=t.columns;for(h=0;h<=c;h++)for(f=0;f<=b;f++)t.data[h]||(t.data[h]=[]),t.data[h][f]||B<f&&(t.data[h][f]="");H.push(t)});return H};var x=new XMLHttpRequest;
x.open("GET",q,!0);"undefined"!==typeof Uint8Array?(x.responseType="arraybuffer",x.onload=function(A){A=new Uint8Array(x.response);A=XLSX.read(A,{type:"array",cellFormula:!0,cellStyles:!0});y(a(A))}):(x.setRequestHeader("Accept-Charset","x-user-defined"),x.onreadystatechange=function(){if(4==x.readyState&&200==x.status){var A=convertResponseBodyToText(x.responseBody);A=XLSX.read(A,{type:"binary",cellFormula:!0,cellStyles:!0});y(a(A))}});x.send()};n.validLetter=function(q){return q.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?
1:0};n.injectArray=function(q,y,a){return q.slice(0,y).concat(a).concat(q.slice(y))};n.getColumnName=function(q){var y="";701<q?(y+=String.fromCharCode(64+parseInt(q/676)),y+=String.fromCharCode(64+parseInt(q%676/26))):25<q&&(y+=String.fromCharCode(64+parseInt(q/26)));return y+=String.fromCharCode(65+q%26)};n.getIdFromColumnName=function(q,y){var a=/^[a-zA-Z]+/.exec(q);if(a){for(var x=0,A=0;A<a[0].length;A++)x+=parseInt(a[0].charCodeAt(A)-64)*Math.pow(26,a[0].length-1-A);x--;0>x&&(x=0);a=parseInt(/[0-9]+$/.exec(q));
0<a&&a--;q=1==y?[x,a]:x+"-"+a}return q};n.getColumnNameFromId=function(q){Array.isArray(q)||(q=q.split("-"));return n.getColumnName(parseInt(q[0]))+(parseInt(q[1])+1)};n.getElement=function(q){function y(A){A.className&&A.classList.contains("jexcel_container")&&(x=A);"THEAD"==A.tagName?a=1:"TBODY"==A.tagName&&(a=2);A.parentNode&&(x||y(A.parentNode))}var a=0,x=0;y(q);return[x,a]};n.doubleDigitFormat=function(q){q=""+q;1==q.length&&(q="0"+q);return q};n.createFromTable=function(q,y){if("TABLE"!=q.tagName)console.log("Element is not a table");
else{y||(y={});y.columns=[];y.data=[];var a=q.querySelectorAll("colgroup > col");if(a.length)for(var x=0;x<a.length;x++){var A=a[x].style.width;A||(A=a[x].getAttribute("width"));A&&(y.columns[x]||(y.columns[x]={}),y.columns[x].width=A)}A=function(u){var m=u.getBoundingClientRect();m=50<m.width?m.width:50;y.columns[x]||(y.columns[x]={});u.getAttribute("data-celltype")?y.columns[x].type=u.getAttribute("data-celltype"):y.columns[x].type="text";y.columns[x].width=m+"px";y.columns[x].title=u.innerHTML;
y.columns[x].align=u.style.textAlign||"center";if(m=u.getAttribute("name"))y.columns[x].name=m;if(m=u.getAttribute("id"))y.columns[x].id=m};var H=[],B=q.querySelectorAll(":scope > thead > tr");if(B.length){for(a=0;a<B.length-1;a++){var t=[];for(x=0;x<B[a].children.length;x++){var h={title:B[a].children[x].innerText,colspan:B[a].children[x].getAttribute("colspan")||1};t.push(h)}H.push(t)}B=B[B.length-1].children;for(x=0;x<B.length;x++)A(B[x])}h=0;var f={},b={},c={},e={};t=q.querySelectorAll(":scope > tr, :scope > tbody > tr");
for(a=0;a<t.length;a++)if(y.data[h]=[],1!=y.parseTableFirstRowAsHeader||B.length||0!=a){for(x=0;x<t[a].children.length;x++){var g=t[a].children[x].getAttribute("data-formula");g?"="!=g.substr(0,1)&&(g="="+g):g=t[a].children[x].innerHTML;y.data[h].push(g);g=n.getColumnNameFromId([x,a]);var l=t[a].children[x].getAttribute("class");l&&(e[g]=l);l=parseInt(t[a].children[x].getAttribute("colspan"))||0;var p=parseInt(t[a].children[x].getAttribute("rowspan"))||0;if(l||p)f[g]=[l||1,p||1];if(l=t[a].children[x].style&&
"none"==t[a].children[x].style.display)t[a].children[x].style.display="";(l=t[a].children[x].getAttribute("style"))&&(c[g]=l);t[a].children[x].classList.contains("styleBold")&&(c[g]=c[g]?c[g]+"; font-weight:bold;":"font-weight:bold;")}t[a].style&&t[a].style.height&&(b[a]={height:t[a].style.height});h++}else for(x=0;x<t[a].children.length;x++)A(t[a].children[x]);0<Object.keys(H).length&&(y.nestedHeaders=H);0<Object.keys(c).length&&(y.style=c);0<Object.keys(f).length&&(y.mergeCells=f);0<Object.keys(b).length&&
(y.rows=b);0<Object.keys(e).length&&(y.classes=e);t=q.querySelectorAll("tfoot tr");if(t.length){A=[];for(a=0;a<t.length;a++){H=[];for(x=0;x<t[a].children.length;x++)H.push(t[a].children[x].innerText);A.push(H)}0<Object.keys(A).length&&(y.footers=A)}if(1==y.parseTableAutoCellType)for(A=[],x=0;x<y.columns.length;x++){B=H=!0;A[x]=[];for(a=0;a<y.data.length;a++)if(g=y.data[a][x],A[x][g]||(A[x][g]=0),A[x][g]++,25<g.length&&(H=!1),10==g.length){if("-"!=g.substr(4,1)||"-"!=g.substr(7,1))B=!1}else B=!1;a=
Object.keys(A[x]).length;B?y.columns[x].type="calendar":1==H&&1<a&&a<=parseInt(.1*y.data.length)&&(y.columns[x].type="dropdown",y.columns[x].source=Object.keys(A[x]))}return y}};"undefined"!=typeof jQuery&&function(q){q.fn.jspreadsheet=q.fn.jexcel=function(y){var a=q(this).get(0);return a.jexcel?Array.isArray(a.jexcel)?a.jexcel[y][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):a.jexcel[y].apply(this,Array.prototype.slice.call(arguments,1)):n(q(this).get(0),arguments[0])}}(jQuery);
return n})},{"@jspreadsheet/formula":1,jsuites:2}]},{},[3])(3)});

if (! jSuites && typeof(require) === 'function') {
    var jSuites = require('jsuites');
}

if (! formula && typeof(require) === 'function') {
    var formula = require('@jspreadsheet/formula');
}

;(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    global.jspreadsheet = factory();
}(this, (function () {

var jspreadsheet;(function(){var __webpack_modules__={9:function(e,t,n){"use strict";n.r(t),n.d(t,{createFromTable:function(){return p},getCaretIndex:function(){return l},getCellNameFromCoords:function(){return c},getColumnName:function(){return s},getCoordsFromCellName:function(){return u},getCoordsFromRange:function(){return d},invert:function(){return a},isColumnType:function(){return i},parseCSV:function(){return f}});var o=n(898),r=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};function i(e){return["text","numeric","calendar","dropdown","checkbox","color","hidden","radio","image","html"].includes(e)}var l=function(e){var t=0,n=this.config&&this.config.root?this.config.root:window,o=n.getSelection?n.getSelection():null;if(o&&0!==o.rangeCount){var r=o.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),t=i.toString().length}return t},a=function(e){for(var t={},n=Object.keys(e),o=0;o<n.length;o++)t[String(e[n[o]])]=n[o];return t},s=function(e){for(var t,n=e+1,o="";n>0;)t=(n-1)%26,o=String.fromCharCode(65+t).toString()+o,n=parseInt(String((n-t)/26));return o},c=function(e,t){return s(parseInt(String(e)))+(parseInt(String(t))+1)},u=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(String(t[0].charCodeAt(o)-64))*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);var r=/[0-9]+$/.exec(e),i=r?parseInt(r[0]):null;return i&&i>0&&i--,[n,i]}return[null,null]},d=function(e){var t=e.split(":"),n=t[0],o=t[1],i=u(n),l=u(o);return r(r([],i.filter(function(e){return null!==e}),!0),l.filter(function(e){return null!==e}),!0)},f=function(e,t){t=t||",",e=e.replace(/\r?\n$|\r$|\n$/g,"");for(var n=[],o=!1,r=0,i=0,l=0,a=0;a<e.length;a++){var s=e[a],c=e[a+1];n[i]=n[i]||[],n[i][l]=n[i][l]||"",'"'==s&&o&&'"'==c?(n[i][l]+=s,++a):'"'!=s?s!=t||o?"\r"!=s||"\n"!=c||o?"\n"==s&&!o||"\r"==s&&!o?(++i,r=Math.max(r,l),l=0):n[i][l]+=s:(++i,r=Math.max(r,l),l=0,++a):++l:o=!o}return n.forEach(function(e,t){for(var n=e.length;n<=r;n++)e.push("")}),n},p=function(e,t){if("TABLE"!=e.tagName)return console.log("Element is not a table"),{};t||(t={}),t.columns=t.columns||[],t.data=t.data||[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var r=0;r<n.length;r++){var l=n[r].style.width;if(!l){var a=n[r].getAttribute("width");a&&(l=a)}l&&(t.columns[r]||(t.columns[r]={}),t.columns[r].width=l)}var s=function(e,n){var o=e.getBoundingClientRect(),r=o.width>50?o.width:50;t.columns||(t.columns=[]),t.columns[n]||(t.columns[n]={});var l,a=e.getAttribute("data-celltype");a&&i(a)?t.columns[n].type=a:t.columns[n].type="text",t.columns[n].width=r+"px",t.columns[n].title=e.innerHTML,e.style.textAlign&&(t.columns[n].align=e.style.textAlign),(l=e.getAttribute("name"))&&(t.columns[n].name=l),(l=e.getAttribute("id"))&&(t.columns[n].id=l),(l=e.getAttribute("data-mask"))&&(t.columns[n].mask=l)},c=[],u=e.querySelectorAll(":scope > thead > tr");if(u.length){for(var d=0;d<u.length-1;d++){var f=[];for(r=0;r<u[d].children.length;r++){var p={title:u[d].children[r].textContent,colspan:u[d].children[r].getAttribute("colspan")||1};f.push(p)}c.push(f)}var h=u[u.length-1].children;for(r=0;r<h.length;r++)s(h[r],r)}var m=0,g={},v={},y={},b={},w=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(d=0;d<w.length;d++)if(t.data[m]=[],1!=t.parseTableFirstRowAsHeader||u.length||0!=d){for(r=0;r<w[d].children.length;r++){(O=w[d].children[r].getAttribute("data-formula"))?"="!=O.substr(0,1)&&(O="="+O):O=w[d].children[r].innerHTML,t.data&&Array.isArray(t.data[m])&&t.data[m].push(O);var C=(0,o.t3)([r,d]),x=w[d].children[r].getAttribute("class");x&&(b[C]=x);var E=w[d].children[r].getAttribute("colspan"),A=w[d].children[r].getAttribute("rowspan"),L=E?parseInt(E):0,M=A?parseInt(A):0;(L||M)&&(g[C]=[L||1,M||1,[]]),w[d].children[r].style&&"none"==w[d].children[r].style.display&&(w[d].children[r].style.display="");var I=w[d].children[r].getAttribute("style");I&&(y[C]=I),w[d].children[r].classList.contains("styleBold")&&(y[C]?y[C]+="; font-weight:bold;":y[C]="font-weight:bold;")}w[d].style&&w[d].style.height&&(v[d]={height:w[d].style.height}),m++}else for(r=0;r<w[d].children.length;r++)s(w[d].children[r],r);if(Object.keys(c).length>0&&(t.nestedHeaders=c),Object.keys(y).length>0&&(t.style=y),Object.keys(g).length>0&&(t.mergeCells=g),Object.keys(v).length>0&&(t.rows=Object.keys(v).map(function(e){return{height:parseInt(v[parseInt(e)].height)||void 0}})),Object.keys(b).length>0&&(t.classes=b),(w=e.querySelectorAll("tfoot tr")).length){var T=[];for(d=0;d<w.length;d++){var _=[];for(r=0;r<w[d].children.length;r++)_.push(w[d].children[r].textContent);T.push(_)}Object.keys(T).length>0&&(t.footers=T)}if(1==t.parseTableAutoCellType){var N=[];for(r=0;r<t.columns.length;r++){var S=!0,j=!0;for(N[r]={},d=0;d<t.data.length;d++){var D=Array.isArray(t.data[d])?t.data[d]:[],O=String(D[r]||"");N[r][O]||(N[r][O]=0),N[r][O]++,O.length>25&&(S=!1),10==O.length&&"-"==O.substr(4,1)&&"-"==O.substr(7,1)||(j=!1)}var k=Object.keys(N[r]).length;j?t.columns[r].type="calendar":1==S&&k>1&&k<=.1*t.data.length&&(t.columns[r].type="dropdown",t.columns[r].source=Object.keys(N[r]))}}return t}},32:function(e,t,n){"use strict";n.d(t,{Dh:function(){return u},ZS:function(){return h},tN:function(){return p}});var o=n(988),r=n(898),i=n(655),l=n(195),a=n(745),s=n(106),c=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},u=function(e){var t=this;if(!0!==t.ignoreHistory&&void 0!==t.historyIndex){var n=++t.historyIndex;t.history&&(t.history=t.history.slice(0,n+1),t.history[n]=e)}},d=function(e,t){var n,o,l,a,u,d,f,p,h,m,g,v,y,b,w,C=this,x=t.insertBefore?+(null!==(o=t.rowNumber)&&void 0!==o?o:0):(null!==(n=t.rowNumber)&&void 0!==n?n:0)+1;if(C.options.search,1===e){for(var E=null!==(l=t.numOfRows)&&void 0!==l?l:0,A=x;A<E+x;A++)null===(d=null===(u=null===(a=C.rows[A])||void 0===a?void 0:a.element)||void 0===u?void 0:u.parentNode)||void 0===d||d.removeChild(C.rows[A].element);C.records.splice(x,E),Array.isArray(C.options.data)&&C.options.data.splice(x,E),C.rows.splice(x,E),s.at.call(C,1,x,E+x-1)}else{var L=null!==(p=null===(f=t.rowRecords)||void 0===f?void 0:f.map(function(e){return c([],e,!0)}))&&void 0!==p?p:[];C.records=(0,r.Hh)(C.records,x,L);var M=null!==(m=null===(h=t.rowData)||void 0===h?void 0:h.map(function(e){return c([],e,!0)}))&&void 0!==m?m:[];Array.isArray(C.options.data)&&(C.options.data=(0,r.Hh)(C.options.data,x,M)),C.rows=(0,r.Hh)(C.rows,x,null!==(g=t.rowNode)&&void 0!==g?g:[]);var I=0;for(A=x;A<(null!==(v=t.numOfRows)&&void 0!==v?v:0)+x;A++){var T=null===(b=null===(y=t.rowNode)||void 0===y?void 0:y[I])||void 0===b?void 0:b.element;T&&C.tbody.insertBefore(T,C.tbody.children[A]),I++}}for(A=x;A<C.rows.length;A++)C.rows[A].y=A;for(A=x;A<C.records.length;A++)if(C.records[A])for(var _=0;_<C.records[A].length;_++)C.records[A][_]&&(C.records[A][_].y=A);"number"==typeof C.options.pagination&&C.options.pagination>0&&void 0!==C.pageNumber&&(null===(w=C.page)||void 0===w||w.call(C,C.pageNumber)),i.o8.call(C)},f=function(e,t){var n,o,l,a,s,c,u,d,f,p,h,m,g,v,y,b,w,C,x,E,A,L,M,I,T,_,N,S,j,D,O=this,k=t.insertBefore?null!==(o=t.columnNumber)&&void 0!==o?o:0:(null!==(n=t.columnNumber)&&void 0!==n?n:0)+1;if(1===e){var R=null!==(l=t.numOfColumns)&&void 0!==l?l:0;O.options.columns&&O.options.columns.splice(k,R);for(var H=k;H<R+k;H++)O.headers[H]&&(null===(a=O.headers[H].parentNode)||void 0===a||a.removeChild(O.headers[H])),(null===(s=O.cols[H])||void 0===s?void 0:s.colElement)&&(null===(c=O.cols[H].colElement.parentNode)||void 0===c||c.removeChild(O.cols[H].colElement));if(O.headers.splice(k,R),O.cols.splice(k,R),t.data)for(var P=0;P<t.data.length;P++){for(H=k;H<R+k;H++){var F=null===(u=O.records[P])||void 0===u?void 0:u[H];(null===(d=null==F?void 0:F.element)||void 0===d?void 0:d.parentNode)&&F.element.parentNode.removeChild(F.element)}O.records[P]&&O.records[P].splice(k,R),Array.isArray(O.options.data)&&Array.isArray(O.options.data[P])&&O.options.data[P].splice(k,R)}if(O.options.footers)for(P=0;P<O.options.footers.length;P++)O.options.footers[P]&&O.options.footers[P].splice(k,R)}else{O.options.columns=(0,r.Hh)(null!==(f=O.options.columns)&&void 0!==f?f:[],k,null!==(p=t.columns)&&void 0!==p?p:[]),O.headers=(0,r.Hh)(O.headers,k,null!==(h=t.headers)&&void 0!==h?h:[]),O.cols=(0,r.Hh)(O.cols,k,null!==(m=t.cols)&&void 0!==m?m:[]);var V=0;for(H=k;H<(null!==(g=t.numOfColumns)&&void 0!==g?g:0)+k;H++){var B=null===(v=t.headers)||void 0===v?void 0:v[V];B&&(null===(y=O.headerContainer)||void 0===y||y.insertBefore(B,O.headerContainer.children[H+1]));var q=null===(w=null===(b=t.cols)||void 0===b?void 0:b[V])||void 0===w?void 0:w.colElement;q&&(null===(C=O.colgroupContainer)||void 0===C||C.insertBefore(q,O.colgroupContainer.children[H+1])),V++}if(t.data&&Array.isArray(t.data))for(P=0;P<t.data.length;P++)if(Array.isArray(O.options.data)&&O.options.data[P]&&(O.options.data[P]=(0,r.Hh)(O.options.data[P],k,t.data[P])),O.records[P]&&(O.records[P]=(0,r.Hh)(O.records[P],k,null!==(E=null===(x=t.records)||void 0===x?void 0:x[P])&&void 0!==E?E:[])),void 0!==t.numOfColumns){var U=0;for(H=k;H<t.numOfColumns+k;H++){var Y=null===(A=t.records)||void 0===A?void 0:A[P],W=void 0;Array.isArray(Y)&&Y[U]&&"object"==typeof Y[U]&&"element"in Y[U]&&(W=Y[U].element);var z=null===(M=null===(L=O.rows[P])||void 0===L?void 0:L.element)||void 0===M?void 0:M.children[H+1];W&&z&&(null===(I=O.rows[P])||void 0===I?void 0:I.element)&&O.rows[P].element.insertBefore(W,z),U++}}if(O.options.footers)for(P=0;P<O.options.footers.length;P++)if(O.options.footers[P]){var X=null===(T=t.footers)||void 0===T?void 0:T[P];O.options.footers[P]=(0,r.Hh)(O.options.footers[P],k,null!=X?X:[])}}for(H=k;H<O.cols.length;H++)O.cols[H].x=H;for(P=0;P<O.records.length;P++)if(O.records[P])for(H=k;H<O.records[P].length;H++)O.records[P][H]&&(O.records[P][H].x=H);if(O.options.nestedHeaders&&O.options.nestedHeaders.length>0&&O.options.nestedHeaders[0]&&O.options.nestedHeaders[0][0])for(P=0;P<O.options.nestedHeaders.length;P++){var G=void 0;G=1===e?parseInt(O.options.nestedHeaders[P][O.options.nestedHeaders[P].length-1].colspan)-(null!==(_=t.numOfColumns)&&void 0!==_?_:0):parseInt(O.options.nestedHeaders[P][O.options.nestedHeaders[P].length-1].colspan)+(null!==(N=t.numOfColumns)&&void 0!==N?N:0),O.options.nestedHeaders[P][O.options.nestedHeaders[P].length-1].colspan=G,null===(D=null===(j=null===(S=O.thead)||void 0===S?void 0:S.children[P])||void 0===j?void 0:j.children[O.thead.children[P].children.length-1])||void 0===D||D.setAttribute("colspan",G.toString())}i.o8.call(O)},p=function(){var e,t,n,r,i,l,s,c,u,p,h,m,g,v=this,y=!!(null===(e=v.parent)||void 0===e?void 0:e.ignoreEvents),b=!!v.ignoreHistory;v.parent&&(v.parent.ignoreEvents=!0),v.ignoreHistory=!0;var w,C=[];if(void 0!==v.historyIndex&&v.historyIndex>=0&&v.history)if("insertRow"===(w=v.history[v.historyIndex--]).action)d.call(v,1,w);else if("deleteRow"===w.action)d.call(v,0,w);else if("insertColumn"===w.action)f.call(v,1,w);else if("deleteColumn"===w.action)f.call(v,0,w);else if("moveRow"===w.action)null===(t=v.moveRow)||void 0===t||t.call(v,w.newValue,w.oldValue);else if("moveColumn"===w.action)null===(n=v.moveColumn)||void 0===n||n.call(v,w.newValue,w.oldValue);else if("setMerge"===w.action)null===(r=v.removeMerge)||void 0===r||r.call(v,w.column);else if("setStyle"===w.action)null===(i=v.setStyle)||void 0===i||i.call(v,w.newValue,null,null,!0);else if("setWidth"===w.action)null===(l=v.setWidth)||void 0===l||l.call(v,w.column,w.oldValue);else if("setHeight"===w.action)null===(s=v.setHeight)||void 0===s||s.call(v,w.row,w.oldValue);else if("setHeader"===w.action)null===(c=v.setHeader)||void 0===c||c.call(v,w.column,w.oldValue);else if("setComments"===w.action)null===(u=v.setComments)||void 0===u||u.call(v,w.oldValue);else if("orderBy"===w.action){if(w.rows){for(var x=[],E=0;E<w.rows.length;E++)x[w.rows[E]]=E;a.Th.call(v,w.column,Boolean(w.order)),a.iY.call(v,x)}}else if("setValue"===w.action){if(w.records)for(var A=0;A<w.records.length;A++){var L=w.records[A];if(Array.isArray(L)){var M=L[0];M&&"object"==typeof M&&"x"in M&&"y"in M&&C.push({x:M.x,y:M.y,value:M.oldValue})}else L&&"object"==typeof L&&"x"in L&&"y"in L&&C.push({x:L.x,y:L.y,value:L.oldValue});w.oldStyle&&(null===(p=v.resetStyle)||void 0===p||p.call(v,w.oldStyle,!0))}for(var I=0,T=C;I<T.length;I++)L=T[I],null===(h=v.setValueFromCoords)||void 0===h||h.call(v,L.x,L.y,null!==(m=L.value)&&void 0!==m?m:null,!0);w.selection&&(null===(g=v.updateSelectionFromCoords)||void 0===g||g.call(v,w.selection[0],w.selection[1],w.selection[2],w.selection[3]))}v.parent&&(v.parent.ignoreEvents=y),v.ignoreHistory=b,o.A.call(v,"onundo",v,w)},h=function(){var e,t,n,r,i,s,c,u,p,h,m,g,v,y,b,w=this,C=!!(null===(e=w.parent)||void 0===e?void 0:e.ignoreEvents),x=!!w.ignoreHistory;if(w.parent&&(w.parent.ignoreEvents=!0),w.ignoreHistory=!0,void 0!==w.historyIndex&&w.history&&w.historyIndex<w.history.length-1)if("insertRow"===(b=w.history[++w.historyIndex]).action)d.call(w,0,b);else if("deleteRow"===b.action)d.call(w,1,b);else if("insertColumn"===b.action)f.call(w,0,b);else if("deleteColumn"===b.action)f.call(w,1,b);else if("moveRow"===b.action)null===(t=w.moveRow)||void 0===t||t.call(w,b.oldValue,b.newValue);else if("moveColumn"===b.action)null===(n=w.moveColumn)||void 0===n||n.call(w,b.oldValue,b.newValue);else if("setMerge"===b.action)l.FU.call(w,b.column,b.colspan,b.rowspan,!0);else if("setStyle"===b.action)null===(r=w.setStyle)||void 0===r||r.call(w,b.newValue,null,null,!0);else if("setWidth"===b.action)null===(i=w.setWidth)||void 0===i||i.call(w,b.column,String(b.newValue));else if("setHeight"===b.action)null===(s=w.setHeight)||void 0===s||s.call(w,b.row,b.newValue);else if("setHeader"===b.action)null===(c=w.setHeader)||void 0===c||c.call(w,b.column,String(b.newValue));else if("setComments"===b.action)null===(u=w.setComments)||void 0===u||u.call(w,b.newValue);else if("orderBy"===b.action)a.Th.call(w,b.column,Boolean(b.order)),a.iY.call(w,b.rows);else if("setValue"===b.action){if(b.records){for(var E=0;E<b.records.length;E++){var A=b.records[E];if(Array.isArray(A)){var L=A[0];L&&"object"==typeof L&&"x"in L&&"y"in L&&(null===(p=w.setValueFromCoords)||void 0===p||p.call(w,L.x,L.y,null!==(h=L.oldValue)&&void 0!==h?h:null,!0))}else A&&"object"==typeof A&&"x"in A&&"y"in A&&(null===(m=w.setValueFromCoords)||void 0===m||m.call(w,A.x,A.y,null!==(g=A.oldValue)&&void 0!==g?g:null,!0))}b.oldStyle&&(null===(v=w.resetStyle)||void 0===v||v.call(w,b.oldStyle,!0))}b.selection&&(null===(y=w.updateSelectionFromCoords)||void 0===y||y.call(w,b.selection[0],b.selection[1],b.selection[2],b.selection[3]))}w.parent&&(w.parent.ignoreEvents=C),w.ignoreHistory=x,o.A.call(w,"onredo",w,b)}},87:function(e,t,n){"use strict";n.d(t,{Ar:function(){return p},ll:function(){return f},nK:function(){return d}});var o=n(587),r=n.n(o),i=n(9),l=n(655),a=function(e,t){0!=t.options.editable?e.classList.remove("jtoolbar-disabled"):e.classList.add("jtoolbar-disabled")},s=function(){var e=[],t=this,n=function(){return l.eN.call(t)};e.push({content:"undo",onclick:function(){var e,t=n();null===(e=t.undo)||void 0===e||e.call(t)}}),e.push({content:"redo",onclick:function(){var e,t=n();null===(e=t.redo)||void 0===e||e.call(t)}}),e.push({content:"save",onclick:function(){var e,t=n();t&&(null===(e=t.download)||void 0===e||e.call(t))}}),e.push({type:"divisor"}),e.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(e,t){return'<span style="font-family:'+t+'">'+t+"</span>"},onchange:function(e,t,o,r,i){var l,a,s=n(),c=null===(l=s.getSelected)||void 0===l?void 0:l.call(s,!0);if(Array.isArray(c)){var u=i?r:"";null===(a=s.setStyle)||void 0===a||a.call(s,Object.fromEntries(c.map(function(e){return[e,"font-family: "+u]})))}},updateState:function(e,t,o){a(o,n())}}),e.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e,t){return'<span style="font-size:'+t+'">'+t+"</span>"},onchange:function(e,t,o,r){var i,l,a=n(),s=null===(i=a.getSelected)||void 0===i?void 0:i.call(a,!0);Array.isArray(s)&&(null===(l=a.setStyle)||void 0===l||l.call(a,Object.fromEntries(s.map(function(e){return[e,"font-size: "+r]}))))},updateState:function(e,t,o){a(o,n())}}),e.push({type:"select",options:["left","center","right","justify"],render:function(e,t){return'<i class="material-icons">format_align_'+t+"</i>"},onchange:function(e,t,o,r){var i,l,a=n(),s=null===(i=a.getSelected)||void 0===i?void 0:i.call(a,!0);Array.isArray(s)&&(null===(l=a.setStyle)||void 0===l||l.call(a,Object.fromEntries(s.map(function(e){return[e,"text-align: "+r]}))))},updateState:function(e,t,o){a(o,n())}}),e.push({content:"format_bold",onclick:function(e,t,o){var r,i,l=n(),a=null===(r=l.getSelected)||void 0===r?void 0:r.call(l,!0);Array.isArray(a)&&(null===(i=l.setStyle)||void 0===i||i.call(l,Object.fromEntries(a.map(function(e){return[e,"font-weight:bold"]}))))},updateState:function(e,t,o){a(o,n())}}),e.push({type:"color",content:"format_color_text",k:"color",updateState:function(e,t,o){a(o,n())}}),e.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(e,t,o){a(o,n())}});var o=["top","middle","bottom"];return e.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(e,t){return'<i class="material-icons">'+t+"</i>"},value:1,onchange:function(e,t,r,i,l){var a,s,c=n(),u=null===(a=c.getSelected)||void 0===a?void 0:a.call(c,!0);Array.isArray(u)&&(null===(s=c.setStyle)||void 0===s||s.call(c,Object.fromEntries(u.map(function(e){return[e,"vertical-align: "+o[l]]}))))},updateState:function(e,t,o){a(o,n())}}),e.push({content:"web",tooltip:r().translate("Merge the selected cells"),onclick:function(){var e,t,o=n();if(o.selectedCell&&confirm(r().translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){var l=[Math.min(o.selectedCell[0],o.selectedCell[2]),Math.min(o.selectedCell[1],o.selectedCell[3]),Math.max(o.selectedCell[0],o.selectedCell[2]),Math.max(o.selectedCell[1],o.selectedCell[3])],a=(0,i.getCellNameFromCoords)(l[0],l[1]);if(o.records[l[1]][l[0]].element.getAttribute("data-merged"))null===(e=o.removeMerge)||void 0===e||e.call(o,a);else{var s=l[2]-l[0]+1,c=l[3]-l[1]+1;1===s&&1===c||null===(t=o.setMerge)||void 0===t||t.call(o,a,s,c)}}},updateState:function(e,t,o){a(o,n())}}),e.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(e,t){return'<i class="material-icons">'+t+"</i>"},right:!0,onchange:function(e,t,o,r,l){var a,s=n();if(s.selectedCell){var c=[Math.min(s.selectedCell[0],s.selectedCell[2]),Math.min(s.selectedCell[1],s.selectedCell[3]),Math.max(s.selectedCell[0],s.selectedCell[2]),Math.max(s.selectedCell[1],s.selectedCell[3])],u=r;if(c){var d=t,f=d.thickness||1,p=d.color||"black",h=d.style||"solid";"double"===h&&(f+=2);for(var m={},g=c[0],v=c[1],y=c[2],b=c[3],w=function(e,t,n){var o=["","","",""];o[0]=("border_top"===u||"border_outer"===u)&&n===v||("border_inner"===u||"border_horizontal"===u)&&n>v||"border_all"===u?"border-top: "+f+"px "+h+" "+p:"border-top: ",o[1]="border_all"!==u&&"border_right"!==u&&"border_outer"!==u||t!==y?"border-right: ":"border-right: "+f+"px "+h+" "+p,o[2]="border_all"!==u&&"border_bottom"!==u&&"border_outer"!==u||n!==b?"border-bottom: ":"border-bottom: "+f+"px "+h+" "+p,o[3]=("border_left"===u||"border_outer"===u)&&t===g||("border_inner"===u||"border_vertical"===u)&&t>g||"border_all"===u?"border-left: "+f+"px "+h+" "+p:"border-left: ",m[e]=o.join(";")},C=c[1];C<=c[3];C++)for(var x=c[0];x<=c[2];x++)w((0,i.getCellNameFromCoords)(x,C),x,C),s.records[C][x].element.getAttribute("data-merged")&&w((0,i.getCellNameFromCoords)(c[0],c[1]),x,C);Object.keys(m)&&(null===(a=s.setStyle)||void 0===a||a.call(s,m))}}},onload:function(e,t){var n=e,o=t,i=document.createElement("div"),l=document.createElement("div");i.appendChild(l);var a=r().color(l,{closeOnChange:!1,onchange:function(e,t){e.parentNode&&e.parentNode.children[1]&&(e.parentNode.children[1].style.color=t),o.color=t}}),s=document.createElement("i");s.classList.add("material-icons"),s.innerHTML="color_lens",s.onclick=function(){a.open()},i.appendChild(s),n.children[1].appendChild(i),l=document.createElement("div"),r().picker(l,{type:"select",data:["1","2","3","4","5"],render:function(e){return'<div style="height: '+e+'px; width: 30px; background-color: black;"></div>'},onchange:function(e,t,n,r){o.thickness=r},width:50}),n.children[1].appendChild(l);var c=document.createElement("div");r().picker(c,{type:"select",data:["solid","dotted","dashed","double"],render:function(e){return"double"===e?'<div style="width: 30px; border-top: 3px '+e+' black;"></div>':'<div style="width: 30px; border-top: 2px '+e+' black;"></div>'},onchange:function(e,t,n,r){o.style=r},width:50}),n.children[1].appendChild(c),(l=document.createElement("div")).style.flex="1",n.children[1].appendChild(l)},updateState:function(e,t,o){a(o,n())}}),e.push({type:"divisor"}),e.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(e,n,o){var r,i,l;if(o instanceof HTMLElement){var a=null===(r=o.children)||void 0===r?void 0:r[0];a&&"fullscreen"===a.textContent?(null===(i=t.fullscreen)||void 0===i||i.call(t,!0),a.textContent="fullscreen_exit"):a&&(null===(l=t.fullscreen)||void 0===l||l.call(t,!1),a.textContent="fullscreen")}},updateState:function(e,t,n){!0===e.parent.config.fullscreen?n.children[0].textContent="fullscreen_exit":n.children[0].textContent="fullscreen"}}),e},c=function(e){for(var t=this,n=e.items,o=function(e){n[e].tooltip&&(n[e].title=n[e].tooltip,delete n[e].tooltip),"select"==n[e].type?n[e].options?(n[e].data=n[e].options,delete n[e].options):(n[e].data=n[e].v,delete n[e].v,n[e].k&&!n[e].onchange&&(n[e].onchange=function(o,r,i){var a,s,c=l.eN.call(t),u=null===(a=c.getSelected)||void 0===a?void 0:a.call(c,!0);if(Array.isArray(u)){var d=null==i?"":String(i);null===(s=c.setStyle)||void 0===s||s.call(c,Object.fromEntries(u.map(function(t){return[t,n[e].k+": "+d]})))}})):"color"==n[e].type&&(n[e].type="i",n[e].onclick=function(o,i,a){var s,c=a;if(!c.color){r().color(c,{onchange:function(o,r){var i,a,s=l.eN.call(t),c=null===(i=s.getSelected)||void 0===i?void 0:i.call(s,!0);Array.isArray(c)&&(null===(a=s.setStyle)||void 0===a||a.call(s,Object.fromEntries(c.map(function(t){return[t,n[e].k+": "+r]}))))},onopen:function(e){var t,n=e;(null===(t=n.color)||void 0===t?void 0:t.select)&&n.color.select("")}});var u=c;(null===(s=u.color)||void 0===s?void 0:s.open)&&u.color.open()}})},i=0;i<n.length;i++)o(i)},u=function(e){var t=this,n=document.createElement("div");return n.classList.add("jss_toolbar"),c.call(t,e),"object"==typeof t.plugins&&Object.entries(t.plugins).forEach(function(t){var n=t[1];if("function"==typeof n.toolbar){var o=n.toolbar(e);o&&(e=o)}}),r().toolbar(n,e),n},d=function(e){var t;(null===(t=e.parent.toolbar)||void 0===t?void 0:t.toolbar)&&e.parent.toolbar.toolbar.update(e)},f=function(){var e,t=this;t.config.toolbar&&!t.toolbar&&(Array.isArray(t.config.toolbar)?e={items:t.config.toolbar}:"object"==typeof t.config.toolbar?e=t.config.toolbar:(e={items:s.call(t)},"function"==typeof t.config.toolbar&&(e=t.config.toolbar(e))),t.toolbar=t.element.insertBefore(u.call(t,e),t.element.children[1]))},p=function(){var e,t=this;t.toolbar&&(null===(e=t.toolbar.parentNode)||void 0===e||e.removeChild(t.toolbar),delete t.toolbar)}},106:function(e,t,n){"use strict";n.d(t,{AH:function(){return h},Aq:function(){return u},G9:function(){return g},Jg:function(){return m},Lo:function(){return A},R5:function(){return x},Ub:function(){return E},at:function(){return C},c6:function(){return f},eO:function(){return M},ef:function(){return L},gE:function(){return d},gG:function(){return v},kA:function(){return p},kF:function(){return b},kV:function(){return T},sp:function(){return I},tW:function(){return w}});var o=n(988),r=n(881),i=n(9),l=n(32),a=n(655),s=n(898),c=n(87),u=function(){var e=this;if(e.highlighted&&e.highlighted.length){var t=e.highlighted[e.highlighted.length-1].element,n=parseInt(t.getAttribute("data-x")||"0");if(!e.content)return;var o=e.content.getBoundingClientRect(),i=o.left,l=o.top,a=t.getBoundingClientRect(),s=a.left,u=a.top,d=a.width,f=a.height,p=s-i+e.content.scrollLeft+d-4,h=u-l+e.content.scrollTop+f-4;if(e.corner)if(e.corner.style.top=h+"px",e.corner.style.left=p+"px",null!=e.options.freezeColumns){var m=r.w.call(e);n>e.options.freezeColumns-1&&s-i+d<m?e.corner.style.display="none":0!=e.options.selectionCopy&&(e.corner.style.display="")}else 0!=e.options.selectionCopy&&(e.corner.style.display="")}else e.corner&&(e.corner.style.top="-2000px",e.corner.style.left="-2000px");c.nK.call(e.parent,e)},d=function(e){var t,n=this;if(n.highlighted&&n.highlighted.length){t=1;for(var r=0;r<n.highlighted.length;r++){n.highlighted[r].element.classList.remove("highlight"),n.highlighted[r].element.classList.remove("highlight-left"),n.highlighted[r].element.classList.remove("highlight-right"),n.highlighted[r].element.classList.remove("highlight-top"),n.highlighted[r].element.classList.remove("highlight-bottom"),n.highlighted[r].element.classList.remove("highlight-selected");var i=parseInt(n.highlighted[r].element.getAttribute("data-x")||"0"),l=parseInt(n.highlighted[r].element.getAttribute("data-y")||"0"),a=void 0,s=void 0;if(n.highlighted[r].element.getAttribute("data-merged")){var c=parseInt(n.highlighted[r].element.getAttribute("colspan")||"1"),u=parseInt(n.highlighted[r].element.getAttribute("rowspan")||"1");a=c>0?i+(c-1):i,s=u>0?l+(u-1):l}else a=i,s=l;for(var d=i;d<=a;d++)n.headers[d]&&n.headers[d].classList.remove("selected");for(d=l;d<=s;d++)n.rows[d]&&n.rows[d].element.classList.remove("selected")}}else t=0;return n.highlighted=[],n.selectedCell=void 0,n.corner&&(n.corner.style.top="-2000px",n.corner.style.left="-2000px"),1==e&&1==t&&o.A.call(n,"onblur",n),t},f=function(e,t,n){var o,r,i=parseInt(e.getAttribute("data-x")||"0"),l=parseInt(e.getAttribute("data-y")||"0");t?(o=parseInt(t.getAttribute("data-x")||"0"),r=parseInt(t.getAttribute("data-y")||"0")):(o=i,r=l),h.call(this,i,l,o,r,n)},p=function(){for(var e=document.querySelectorAll(".jss_worksheet .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},h=function(e,t,n,r,i){var l,a=this;if(null==t){if(t=0,r=a.rows.length-1,null==e)return}else null==e&&(e=0,n=(Array.isArray(a.options.data)&&Array.isArray(a.options.data[0])?a.options.data[0].length:1)-1);if(null!=e&&null!=t&&null!=n&&null!=r){null==n&&(n=e),null==r&&(r=t),e>=a.headers.length&&(e=a.headers.length-1),t>=a.rows.length&&(t=a.rows.length-1),n>=a.headers.length&&(n=a.headers.length-1),r>=a.rows.length&&(r=a.rows.length-1);var s,c,d,f,h=null,m=null,g=null,v=null;e<n?(s=e,c=n):(s=n,c=e),t<r?(d=t,f=r):(d=r,f=t);for(var y=s;y<=c;y++)for(var b=d;b<=f;b++)if(a.records[b][y]&&a.records[b][y].element.getAttribute("data-merged")){var w=parseInt(a.records[b][y].element.getAttribute("data-x")||"0"),C=parseInt(a.records[b][y].element.getAttribute("data-y")||"0"),x=parseInt(a.records[b][y].element.getAttribute("colspan")||"1"),E=parseInt(a.records[b][y].element.getAttribute("rowspan")||"1");x>1&&(w<s&&(s=w),w+x>c&&(c=w+x-1)),E&&(C<d&&(d=C),C+E>f&&(f=C+E-1))}for(b=d;b<=f;b++)"none"!=a.rows[b].element.style.display&&(null==g&&(g=b),v=b);for(y=s;y<=c;y++)for(b=d;b<=f;b++)a.options.columns&&a.options.columns[y]&&"hidden"==a.options.columns[y].type||(null==h&&(h=y),m=y);if(null==h&&(h=0),null==m&&(m=0),null==g&&(g=0),null==v&&(v=0),!1===o.A.call(a,"onbeforeselection",a,h,g,m,v,i))return!1;var A=(null===(l=a.resetSelection)||void 0===l?void 0:l.call(a))||0;for(a.selectedCell=[e,t,n,r],a.highlighted||(a.highlighted=[]),a.records[t][e]&&a.records[t][e].element.classList.add("highlight-selected"),y=s;y<=c;y++)for(b=d;b<=f;b++)"none"!=a.rows[b].element.style.display&&"none"!=a.records[b][y].element.style.display&&(a.records[b][y].element.classList.add("highlight"),a.highlighted.push(a.records[b][y]));for(y=h;y<=m;y++)a.options.columns&&a.options.columns[y]&&"hidden"==a.options.columns[y].type||!a.cols[y].colElement.style||"none"==a.cols[y].colElement.style.display||(null!==g&&a.records[g]&&a.records[g][y]&&a.records[g][y].element.classList.add("highlight-top"),null!==v&&a.records[v]&&a.records[v][y]&&a.records[v][y].element.classList.add("highlight-bottom"),a.headers[y].classList.add("selected"));for(b=g;b<=v;b++)a.rows[b]&&"none"!=a.rows[b].element.style.display&&(null!==h&&a.records[b][h].element.classList.add("highlight-left"),null!==m&&a.records[b][m].element.classList.add("highlight-right"),a.rows[b].element.classList.add("selected"));a.selectedContainer=[h,g,m,v],0==A&&(o.A.call(a,"onfocus",a),p()),o.A.call(a,"onselection",a,h,g,m,v,i),u.call(a)}},m=function(e){var t=this;if(!t.selectedCell)return[];for(var n=[],o=Math.min(t.selectedCell[0],t.selectedCell[2]);o<=Math.max(t.selectedCell[0],t.selectedCell[2]);o++)e&&"none"==t.headers[o].style.display||n.push(o);return n},g=function(){var e,t=this;t.selectedCell&&(null===(e=t.updateSelectionFromCoords)||void 0===e||e.call(t,t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]))},v=function(){var e=this;if(e.selection)for(var t=0;t<e.selection.length;t++)e.selection[t].classList.remove("selection"),e.selection[t].classList.remove("selection-left"),e.selection[t].classList.remove("selection-right"),e.selection[t].classList.remove("selection-top"),e.selection[t].classList.remove("selection-bottom");e.selection=[]},y=function(e){var t=""+e;return 1==t.length&&(t="0"+t),t},b=function(e,t){var n,r,i,c,u,d=this,f=null===(n=d.getData)||void 0===n?void 0:n.call(d,!0,!1),p=d.selectedContainer,h=parseInt(e.getAttribute("data-x")||"0"),m=parseInt(e.getAttribute("data-y")||"0"),g=parseInt(t.getAttribute("data-x")||"0"),v=parseInt(t.getAttribute("data-y")||"0"),b=[],w=!1;p&&p[0]==h?(c=m<p[1]?m-p[1]:1,u=0):p?(u=h<p[0]?h-p[0]:1,c=0):(c=0,u=0);for(var C=0,x=0,E=m;E<=v;E++)if(!d.rows[E]||"none"!=d.rows[E].element.style.display){f&&Array.isArray(f)&&null!=f[x]||(x=0),C=0,p&&p[0]!=h&&(u=h<p[0]?h-p[0]:1);for(var A=h;A<=g;A++){if((null===(r=d.records[E])||void 0===r?void 0:r[A])&&!d.records[E][A].element.classList.contains("readonly")&&"none"!=d.records[E][A].element.style.display&&0==w){if(!(null===(i=d.selection)||void 0===i?void 0:i.length)&&""!=(Array.isArray(d.options.data)&&Array.isArray(d.options.data[E])&&d.options.data[E][A]||"")){w=!0;continue}Array.isArray(f)&&null!=f[x]?Array.isArray(f[x])&&null==f[x][C]&&(C=0):C=0;var L="";if(Array.isArray(f)&&Array.isArray(f[x])&&(L=f[x][C]),L&&Array.isArray(f)&&!f[1]&&0!=d.parent.config.autoIncrement)if(!d.options.columns||!d.options.columns[A]||d.options.columns[A].type&&"text"!=d.options.columns[A].type&&"numeric"!=d.options.columns[A].type){if(d.options.columns&&d.options.columns[A]&&"calendar"==d.options.columns[A].type&&("string"==typeof L||"number"==typeof L)){var M=new Date(L);M.setDate(M.getDate()+c),L=M.getFullYear()+"-"+y(M.getMonth()+1)+"-"+y(M.getDate())+" 00:00:00"}}else if("="==(""+L).substr(0,1)){var I=(""+L).match(/([A-Z]+[0-9]+)/g);if(I){for(var T={},_=0;_<I.length;_++){var N=(0,s.vu)(I[_],!0);if(Array.isArray(N)){N[0]+=u,N[1]+=c,N[1]<0&&(N[1]=0);var S=(0,s.t3)([N[0],N[1]]);S!=I[_]&&(T[I[_]]=S)}}T&&"string"==typeof L&&(L=(0,a.yB)(L,T))}}else L==Number(L)&&(L=Number(L)+c);b.push(a.k9.call(d,A,E,L)),a.xF.call(d,A,E,b)}C++,p&&p[0]!=h?u++:p||u++}x++,c++}l.Dh.call(d,{action:"setValue",records:b,selection:d.selectedCell}),a.am.call(d);var j=b.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});o.A.call(d,"onafterchanges",d,j)},w=function(e){var t,n=0;if(!e||0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},C=function(e,t,n){var o,r,i=this;if(1==e){if(i.selectedCell&&(t>=i.selectedCell[1]&&t<=i.selectedCell[3]||n>=i.selectedCell[1]&&n<=i.selectedCell[3]))return void(null===(o=i.resetSelection)||void 0===o||o.call(i))}else if(i.selectedCell&&(t>=i.selectedCell[0]&&t<=i.selectedCell[2]||n>=i.selectedCell[0]&&n<=i.selectedCell[2]))return void(null===(r=i.resetSelection)||void 0===r||r.call(i))},x=function(e){var t=this;if(!t.selectedCell)return[];for(var n=[],o=Math.min(t.selectedCell[1],t.selectedCell[3]);o<=Math.max(t.selectedCell[1],t.selectedCell[3]);o++)e&&"none"==t.rows[o].element.style.display||n.push(o);return n},E=function(){var e,t=this;t.selectedCell||(t.selectedCell=[]),t.selectedCell[0]=0,t.selectedCell[1]=0,t.selectedCell[2]=t.headers.length-1,t.selectedCell[3]=t.records.length-1,null===(e=t.updateSelectionFromCoords)||void 0===e||e.call(t,t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3])},A=function(){var e=this;return e.selectedCell?[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])]:null},L=function(e){var t,n=A.call(this);if(!n)return[];for(var o=[],r=n[1];r<=n[3];r++)for(var l=n[0];l<=n[2];l++)if(e)o.push((0,i.getCellNameFromCoords)(l,r));else{var a=null===(t=this.records[r])||void 0===t?void 0:t[l];a&&o.push(a)}return o},M=function(){var e=this,t=A.call(e);if(!t)return"";var n=(0,i.getCellNameFromCoords)(t[0],t[1]),o=(0,i.getCellNameFromCoords)(t[2],t[3]);return n===o?e.options.worksheetName+"!"+n:e.options.worksheetName+"!"+n+":"+o},I=function(e,t){var n=A.call(this);return!!n&&e>=n[0]&&e<=n[2]&&t>=n[1]&&t<=n[3]},T=function(){var e=A.call(this);return e?[e]:[]}},195:function(e,t,n){"use strict";n.d(t,{D0:function(){return d},FU:function(){return p},Lt:function(){return u},VP:function(){return m},Zp:function(){return h},fd:function(){return f}});var o=n(587),r=n.n(o),i=n(898),l=n(655),a=n(32),s=n(988),c=n(106),u=function(e,t){var n=this,o=[];if(n.options.mergeCells)for(var r=Object.keys(n.options.mergeCells),l=0;l<r.length;l++){var a=(0,i.vu)(r[l],!0);if("string"==typeof a)return o;var s=n.options.mergeCells[r[l]];if(s){var c=s[0],u=a[0],d=a[0]+(c>1?c-1:0);null==t?u<=e&&d>=e&&o.push(r[l]):t?u<e&&d>=e&&o.push(r[l]):u<=e&&d>e&&o.push(r[l])}}return o},d=function(e,t){var n=this,o=[];if(n.options.mergeCells)for(var r=Object.keys(n.options.mergeCells),l=0;l<r.length;l++){var a=(0,i.vu)(r[l],!0);if("string"==typeof a)return[];var s=n.options.mergeCells[r[l]];if(s){var c=s[1],u=a[1],d=a[1]+(c>1?c-1:0);null==t?u<=e&&d>=e&&o.push(r[l]):t?u<e&&d>=e&&o.push(r[l]):u<=e&&d>e&&o.push(r[l])}}return o},f=function(e){var t=this;if(e)return t.options.mergeCells&&t.options.mergeCells[e]&&(i=t.options.mergeCells[e])?[i[0],i[1]]:null;var n={};if(t.options.mergeCells)for(var o=Object.keys(t.options.mergeCells),r=0;r<o.length;r++){var i;(i=t.options.mergeCells[o[r]])&&(n[o[r]]=[i[0],i[1]])}return n},p=function(e,t,n,o){var u,d=this,f=!1;if(e){if("string"!=typeof e)return}else{if(!d.highlighted||!d.highlighted.length)return void alert(r().translate("No cells selected"));var p=d.highlighted[0],h=d.highlighted[d.highlighted.length-1];if(!p||!h)return;var m=p.element.getAttribute("data-x"),g=p.element.getAttribute("data-y"),v=h.element.getAttribute("data-x"),y=h.element.getAttribute("data-y");if(!(m&&g&&v&&y))return;var b=parseInt(m),w=parseInt(g),C=parseInt(v),x=parseInt(y);e=(0,i.t3)([b,w]),t=C-b+1,n=x-w+1}var E=(0,i.vu)(e,!0);if("string"!=typeof E){if(d.options.mergeCells&&d.options.mergeCells[e])d.records[E[1]][E[0]].element.getAttribute("data-merged")&&(f="Cell already merged");else if((!t||t<2)&&(!n||n<2))f="Invalid merged properties";else for(var A=E[1];A<E[1]+(n||0);A++)for(var L=E[0];L<E[0]+(t||0);L++)(0,i.t3)([L,A]),d.records[A]&&d.records[A][L]&&d.records[A][L].element.getAttribute("data-merged")&&(f="There is a conflict with another merged cell");if(f)alert(r().translate(f));else{t&&t>1?d.records[E[1]][E[0]].element.setAttribute("colspan",String(t)):t=1,n&&n>1?d.records[E[1]][E[0]].element.setAttribute("rowspan",String(n)):n=1,d.options.mergeCells||(d.options.mergeCells={}),d.options.mergeCells[e]=[t,n,[]],d.records[E[1]][E[0]].element.setAttribute("data-merged","true"),d.records[E[1]][E[0]].element.style.overflow="hidden";for(var M=[],I=E[1];I<E[1]+n;I++){for(var T=[],_=E[0];_<E[0]+t;_++)E[0]!=_||E[1]!=I?(d.options.data&&d.options.data[I]?(Array.isArray(d.options.data[I]),T.push(d.options.data[I][_])):T.push(""),l.k9.call(d,_,I,"",!0),d.options.mergeCells[e]&&!1!==d.options.mergeCells[e]&&d.records[I]&&d.records[I][_]&&(d.options.mergeCells[e][2].push(d.records[I][_].element),d.records[I][_].element.style.display="none",d.records[I][_].element=d.records[E[1]][E[0]].element)):T.push("");M.push(T)}d.records[E[1]]&&d.records[E[1]][E[0]]&&c.c6.call(d,d.records[E[1]][E[0]].element,null),o||(a.Dh.call(d,{action:"setMerge",column:e,colspan:t,rowspan:n,data:M}),s.A.call(d,"onmerge",d,((u={})[e]=[t,n],u)))}}},h=function(e,t,n){var o=this;if(o.options.mergeCells&&o.options.mergeCells[e]){var r=(0,i.vu)(e,!0);if("string"==typeof r)return;o.records[r[1]]&&o.records[r[1]][r[0]]&&(o.records[r[1]][r[0]].element.removeAttribute("colspan"),o.records[r[1]][r[0]].element.removeAttribute("rowspan"),o.records[r[1]][r[0]].element.removeAttribute("data-merged"));var a=o.options.mergeCells[e];if(!a)return;var s=0,u=0,d=0;for(u=0;u<a[1];u++)for(d=0;d<a[0];d++)(u>0||d>0)&&(a[2]&&a[2][s]&&o.records[r[1]+u]&&o.records[r[1]+u][r[0]+d]&&(o.records[r[1]+u][r[0]+d].element=a[2][s],o.records[r[1]+u][r[0]+d].element.style.display="",t&&t[s]&&l.k9.call(o,r[0]+d,r[1]+u,t[s])),s++);c.c6.call(o,o.records[r[1]][r[0]].element,o.records[r[1]+u-1][r[0]+d-1].element,void 0),n||delete o.options.mergeCells[e]}},m=function(e){var t=this;if(t.options.mergeCells)for(var n=Object.keys(t.options.mergeCells),o=0;o<n.length;o++)h.call(t,n[o],null,e)}},211:function(e,t,n){"use strict";n.d(t,{IQ:function(){return r},hs:function(){return i},iZ:function(){return l}});var o=n(988),r=function(e,t){var n=this;return e?t?n.options.meta&&n.options.meta[e]&&n.options.meta[e][t]?n.options.meta[e][t]:null:n.options.meta&&n.options.meta[e]?n.options.meta[e]:null:n.options.meta},i=function(e){var t=this;if(t.options.meta){for(var n={},o=Object.keys(t.options.meta),r=0;r<o.length;r++){var i=o[r];e[i]?n[e[i]]=t.options.meta[i]:n[i]=t.options.meta[i]}t.options.meta=n}},l=function(e,t,n){var r,i,l=this;if(l.options.meta||(l.options.meta={}),void 0!==t&&void 0!==n){var a=e;l.options.meta[a]||(l.options.meta[a]={}),l.options.meta[a][t]=n,o.A.call(l,"onchangemeta",l,((r={})[a]=((i={})[t]=n,i),r))}else{for(var s=e,c=Object.keys(s),u=0;u<c.length;u++){a=c[u],l.options.meta[a]||(l.options.meta[a]={});for(var d=Object.keys(s[a]),f=0;f<d.length;f++){var p=d[f];l.options.meta[a][p]=s[a][p]}}o.A.call(l,"onchangemeta",l,e)}}},587:function(e){var t;e.exports=(function(){var e={195:function(e){e.exports=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var n,o,r,i,l,a,s,c,u,d,f=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],p=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=new Array(64),m=8;function g(e){return unescape(encodeURIComponent(e))}function v(e){for(var t=[],n=(1<<m)-1,o=e.length*m,r=0;r<o;r+=m)t[r>>5]|=(e.charCodeAt(r/m)&n)<<32-m-r%32;return t}function y(e){for(var t,n="0123456789abcdef",o="",r=4*e.length,i=0;i<r;i+=1)t=e[i>>2]>>8*(3-i%4),o+=n.charAt(t>>4&15)+n.charAt(15&t);return o}function b(e,n){var o,r,i;return o=(65535&e.lowOrder)+(65535&n.lowOrder),i=(65535&(r=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o>>>16)))<<16|65535&o,o=(65535&e.highOrder)+(65535&n.highOrder)+(r>>>16),new t((65535&(r=(e.highOrder>>>16)+(n.highOrder>>>16)+(o>>>16)))<<16|65535&o,i)}function w(e,n,o,r){var i,l,a;return i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder),a=(65535&(l=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(l>>>16),new t((65535&(l=(e.highOrder>>>16)+(n.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(i>>>16)))<<16|65535&i,a)}function C(e,n,o,r,i){var l,a,s;return l=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder)+(65535&i.lowOrder),s=(65535&(a=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(i.lowOrder>>>16)+(l>>>16)))<<16|65535&l,l=(65535&e.highOrder)+(65535&n.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(65535&i.highOrder)+(a>>>16),new t((65535&(a=(e.highOrder>>>16)+(n.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(i.highOrder>>>16)+(l>>>16)))<<16|65535&l,s)}function x(e,n,o){return new t(e.highOrder&n.highOrder^e.highOrder&o.highOrder^n.highOrder&o.highOrder,e.lowOrder&n.lowOrder^e.lowOrder&o.lowOrder^n.lowOrder&o.lowOrder)}function E(e,n,o){return new t(e.highOrder&n.highOrder^~e.highOrder&o.highOrder,e.lowOrder&n.lowOrder^~e.lowOrder&o.lowOrder)}function A(e,n){return n<=32?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function L(e){var n=A(e,28),o=A(e,34),r=A(e,39);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function M(e){var n=A(e,14),o=A(e,18),r=A(e,41);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function I(e){var n=A(e,1),o=A(e,8),r=_(e,7);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function T(e){var n=A(e,19),o=A(e,61),r=_(e,6);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function _(e,n){return n<=32?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var N=(e=g(e)).length*m;(e=v(e))[N>>5]|=128<<24-N%32,e[31+(N+128>>10<<5)]=N;for(var S=0;S<e.length;S+=32){n=f[0],o=f[1],r=f[2],i=f[3],l=f[4],a=f[5],s=f[6],c=f[7];for(var j=0;j<80;j++)h[j]=j<16?new t(e[2*j+S],e[2*j+S+1]):w(T(h[j-2]),h[j-7],I(h[j-15]),h[j-16]),u=C(c,M(l),E(l,a,s),p[j],h[j]),d=b(L(n),x(n,o,r)),c=s,s=a,a=l,l=b(i,u),i=r,r=o,o=n,n=b(u,d);f[0]=b(n,f[0]),f[1]=b(o,f[1]),f[2]=b(r,f[2]),f[3]=b(i,f[3]),f[4]=b(l,f[4]),f[5]=b(a,f[5]),f[6]=b(s,f[6]),f[7]=b(c,f[7])}var D=[];for(S=0;S<f.length;S++)D.push(f[S].highOrder),D.push(f[S].lowOrder);return y(D)}}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var r={};!function(){"use strict";o.d(r,{default:function(){return H}});var e={setDictionary:function(e){document.dictionary||(document.dictionary={});var t=null,n=Object.keys(e);for(t=0;t<n.length;t++)document.dictionary[n[t]]=e[n[t]]},translate:function(e){return"undefined"!=typeof document&&document.dictionary&&document.dictionary[e]||e}},n=function(e,t){if(!0===t)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(e){return null!==e}),setTimeout(function(){window.jSuitesStateControl.push(e)},0);else{var n=window.jSuitesStateControl.indexOf(e);n>=0&&window.jSuitesStateControl.splice(n,1)}},i={two:function(e){return 1==(e=""+e).length&&(e="0"+e),e},focus:function(e){if(e.textContent.length){const t=document.createRange(),n=window.getSelection();let o=e;for(;o.lastChild;)o=o.lastChild;o.nodeType===Node.TEXT_NODE?t.setStart(o,o.length):t.setStart(o,o.childNodes.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},isNumeric:function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},getNode:function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},hash:function(e){var t,n,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)(n=e.charCodeAt(t))>32&&(o=(o<<5)-o+n,o|=0);return o},randomColor:function(e){var t=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var n,o,r=[];for(o=0;o<3;o++)n=parseInt(t.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+-.25*n),255)).toString(16),r.push(("00"+n).substr(n.length));return 1==e?"#"+i.two(r[0].toString(16))+i.two(r[1].toString(16))+i.two(r[2].toString(16)):r},getWindowWidth:function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||o.clientWidth},getWindowHeight:function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||o.clientHeight},getPosition:function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),n=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,n]},click:function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},findElement:function(e,t){var n=!1;return function e(o){o&&!n&&("function"==typeof t?n=t(o):"string"==typeof t&&o.classList&&o.classList.contains(t)&&(n=o)),o.parentNode&&!n&&e(o.parentNode)}(e),n}},l=i;const a=function(e){return"object"==typeof e||"function"==typeof e};function s(e,t,n){if("string"!=typeof e||0===e.length)return;const o=e.split(".");if(0===o.length)return;let r=this;if(void 0===t&&void 0===n){for(let e=0;e<o.length;e++){const t=o[e];if(null==r||!a(r)||!Object.prototype.hasOwnProperty.call(r,t))return;r=r[t]}return r}for(let t=0;t<o.length-1;t++){const n=o[t];if(null==r||!a(r))return console.warn(`Cannot set value: path '${e}' blocked by invalid object at '${n}'`),!1;(!Object.prototype.hasOwnProperty.call(r,n)||null!=r[n]&&a(r[n]))&&Object.prototype.hasOwnProperty.call(r,n)||(r[n]={}),r=r[n]}const i=o[o.length-1];return!(null==r||!a(r)||(!0===n?!Object.prototype.hasOwnProperty.call(r,i)||(delete r[i],0):(r[i]=t,0)))}function c(e,t){var n={options:{}},o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},r=null;for(var i in o)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:n.options[i]=o[i];e.classList.add("jsorting"),e.addEventListener("dragstart",function(t){let o=t.target;if(3===o.nodeType){if("true"!==o.parentNode.getAttribute("draggable"))return t.preventDefault(),void t.stopPropagation();o=o.parentNode}if("true"===o.getAttribute("draggable")){let i=Array.prototype.indexOf.call(o.parentNode.children,o);r={element:o,o:i,d:i},o.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(e,o,t),t.dataTransfer.setDragImage(o,0,0)}}),e.addEventListener("dragover",function(e){if(e.preventDefault(),r&&l(e.target)&&"true"==e.target.getAttribute("draggable")&&r.element!=e.target){if(n.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(r.element,e.target):e.target.parentNode.insertBefore(r.element,e.target.nextSibling),r.d=Array.prototype.indexOf.call(e.target.parentNode.children,r.element)}}),e.addEventListener("dragleave",function(e){e.preventDefault()}),e.addEventListener("dragend",function(t){t.preventDefault(),r&&("function"==typeof n.options.ondragend&&n.options.ondragend(e,r.element,t),r.o<r.d?t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o]):t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o].nextSibling),r.element.style.opacity="",r=null)}),e.addEventListener("drop",function(t){t.preventDefault(),r&&(r.o!==r.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(e,r.o,r.d,r.element,t.target,t),r.element.style.opacity="",r=null)});for(var l=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t},a=0;a<e.children.length;a++)e.children[a].hasAttribute("draggable")||e.children[a].setAttribute("draggable","true");return e.val=function(){for(var t=null,n=[],o=0;o<e.children.length;o++)(t=e.children[o].getAttribute("data-id"))&&n.push(t);return n},e}function u(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,o=function(o){if(null==n){var r=!1,i=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),r=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),r=!0),n=setTimeout(function(){n=null},t.timer),r&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){o()},e.onwheel=function(e){o()},{}}var d,f=((d=function(e,t){if(Array.isArray(e)){var n={instance:[],complete:t};if(e.length>0)for(var o=0;o<e.length;o++)e[o].multiple=n,n.instance.push(d(e[o]));return n}if(e.data||(e.data={}),e.type&&(e.method=e.type),e.method||(e.method="GET"),e.dataType||(e.dataType="json"),e.data){var r=function(e,t){var n=[];if(e){var o=Object.keys(e);if(o.length)for(var i=0;i<o.length;i++){if(t)var l=t+"["+o[i]+"]";else l=o[i];if(e[l]instanceof FileList)n[l]=e[o[i]];else if(null===e[o[i]]||void 0===e[o[i]])n[l]="";else if("object"==typeof e[o[i]])for(var a=r(e[o[i]],l),s=Object.keys(a),c=0;c<s.length;c++)n[s[c]]=a[s[c]];else n[l]=e[o[i]]}}return n},i=r(e.data),l=Object.keys(i);if("GET"==e.method){if(l.length){var a=[];for(o=0;o<l.length;o++)a.push(l[o]+"="+encodeURIComponent(i[l[o]]));e.url.indexOf("?")<0&&(e.url+="?"),e.url+=a.join("&")}}else for(a=new FormData,o=0;o<l.length;o++)if(i[l[o]]instanceof FileList){if(i[l[o]].length)for(var s=0;s<i[l[o]].length;s++)a.append(l[o],i[l[o]][s],i[l[o]][s].name)}else a.append(l[o],i[l[o]])}var c=new XMLHttpRequest;return c.open(e.method,e.url,!0),e.requestedWith?c.setRequestHeader("X-Requested-With",e.requestedWith):!1!==e.requestedWith&&c.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.contentType&&c.setRequestHeader("Content-Type",e.contentType),"POST"===e.method?c.setRequestHeader("Accept","application/json"):"blob"===e.dataType?c.responseType="blob":e.contentType||("json"===e.dataType?c.setRequestHeader("Content-Type","text/json"):"html"===e.dataType&&c.setRequestHeader("Content-Type","text/html")),!0!==e.cache&&(c.setRequestHeader("pragma","no-cache"),c.setRequestHeader("cache-control","no-cache")),!0===e.withCredentials&&(c.withCredentials=!0),"function"==typeof e.beforeSend&&e.beforeSend(c),"function"==typeof d.beforeSend&&d.beforeSend(c),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(c),c.onerror=function(){e.error&&"function"==typeof e.error&&e.error({message:"Network error: Unable to reach the server.",status:0})},c.ontimeout=function(){e.error&&"function"==typeof e.error&&e.error({message:"Request timed out after "+c.timeout+"ms.",status:0})},c.onload=function(){if(c.status>=200&&c.status<300)if("json"===e.dataType)try{var t=JSON.parse(c.responseText);e.success&&"function"==typeof e.success&&e.success(t)}catch(n){e.error&&"function"==typeof e.error&&e.error(n,t)}else t="blob"===e.dataType?c.response:c.responseText,e.success&&"function"==typeof e.success&&e.success(t);else e.error&&"function"==typeof e.error&&e.error(c.responseText,c.status);if(d.queue&&d.queue.length>0&&d.send(d.queue.shift()),d.requests&&d.requests.length){var n=d.requests.indexOf(c);d.requests.splice(n,1),d.requests.length||e.complete&&"function"==typeof e.complete&&e.complete(t),e.group&&d.oncomplete&&"function"==typeof d.oncomplete[e.group]&&(d.pending(e.group)||(d.oncomplete[e.group](),d.oncomplete[e.group]=null)),e.multiple&&e.multiple.instance&&(n=e.multiple.instance.indexOf(c),e.multiple.instance.splice(n,1),e.multiple.instance.length||e.multiple.complete&&"function"==typeof e.multiple.complete&&e.multiple.complete(t))}},c.options=e,c.data=a,!0===e.queue&&d.requests.length>0?d.queue.push(c):d.send(c),c}).send=function(e){e.data?Array.isArray(e.data)?e.send(e.data.join("&")):e.send(e.data):e.send(),d.requests.push(e)},d.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},d.pending=function(e){var t=0,n=d.requests;if(n&&n.length)for(var o=0;o<n.length;o++)e&&e!=n[o].options.group||t++;return t},d.oncomplete={},d.requests=[],d.queue=[],d);var p=function(){const e={loading:{}};return e.loading.show=function(t){e.loading.element||(e.loading.element=document.createElement("div"),e.loading.element.className="jloading"),document.body.appendChild(e.loading.element),t>0&&setTimeout(function(){e.loading.hide()},1e3*t)},e.loading.hide=function(){e.loading.element&&e.loading.element.parentNode&&document.body.removeChild(e.loading.element)},e.slideLeft=function(e,t,n){1==t?(e.classList.add("jslide-left-in"),setTimeout(function(){e.classList.remove("jslide-left-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-left-out"),setTimeout(function(){e.classList.remove("jslide-left-out"),"function"==typeof n&&n()},400))},e.slideRight=function(e,t,n){!0===t?(e.classList.add("jslide-right-in"),setTimeout(function(){e.classList.remove("jslide-right-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-right-out"),setTimeout(function(){e.classList.remove("jslide-right-out"),"function"==typeof n&&n()},400))},e.slideTop=function(e,t,n){!0===t?(e.classList.add("jslide-top-in"),setTimeout(function(){e.classList.remove("jslide-top-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-top-out"),setTimeout(function(){e.classList.remove("jslide-top-out"),"function"==typeof n&&n()},400))},e.slideBottom=function(e,t,n){!0===t?(e.classList.add("jslide-bottom-in"),setTimeout(function(){e.classList.remove("jslide-bottom-in"),"function"==typeof n&&n()},400)):(e.classList.add("jslide-bottom-out"),setTimeout(function(){e.classList.remove("jslide-bottom-out"),"function"==typeof n&&n()},100))},e.fadeIn=function(e,t){e.style.display="",e.classList.add("jfade-in"),setTimeout(function(){e.classList.remove("jfade-in"),"function"==typeof t&&t()},2e3)},e.fadeOut=function(e,t){e.classList.add("jfade-out"),setTimeout(function(){e.style.display="none",e.classList.remove("jfade-out"),"function"==typeof t&&t()},1e3)},e}();var h=function(){var t={now:function(e,t){var n=null,o=null,r=null,i=null,a=null,s=null;return Array.isArray(e)?(n=e[0],o=e[1],r=e[2],i=e[3],a=e[4],s=e[5]):(e||(e=new Date),n=e.getFullYear(),o=e.getMonth()+1,r=e.getDate(),i=e.getHours(),a=e.getMinutes(),s=e.getSeconds()),1==t?l.two(n)+"-"+l.two(o)+"-"+l.two(r):l.two(n)+"-"+l.two(o)+"-"+l.two(r)+" "+l.two(i)+":"+l.two(a)+":"+l.two(s)},toArray:function(e){var t=(n=e.split(-1!==e.indexOf("T")?"T":" "))[1],n=n[0].split("-"),o=parseInt(n[0]),r=parseInt(n[1]),i=parseInt(n[2]),l=0,a=0;return t&&(t=t.split(":"),l=parseInt(t[0]),a=parseInt(t[1])),[o,r,i,l,a,0]}},n=Date.UTC(1900,0,0),o=Date.UTC(1900,1,29),r=864e5;t.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=o&&(t+=r),(t-=n)/r},t.numToDate=function(e){var i=n+e*r;i>=o&&(i-=r);const l=new Date(i);var a=[l.getUTCFullYear(),l.getUTCMonth()+1,l.getUTCDate(),l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds()];return t.now(a)};let i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(t,"weekdays",{get:function(){return i.map(function(t){return e.translate(t)})}}),Object.defineProperty(t,"weekdaysShort",{get:function(){return i.map(function(t){return e.translate(t).substring(0,3)})}}),Object.defineProperty(t,"months",{get:function(){return a.map(function(t){return e.translate(t)})}}),Object.defineProperty(t,"monthsShort",{get:function(){return a.map(function(t){return e.translate(t).substring(0,3)})}}),t}();var m=function(){var e={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},n=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var e=0;this.date[4]&&(e=parseFloat(this.date[4]/60));var t=parseInt(this.date[3])+e;t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=l.two(this.date[0])+"-"+l.two(this.date[1])+"-"+l.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]))):t=l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]);return t},o=function(){var e="";if(this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]){if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var t=h.now(this.date);e=h.dateToNum(t)}}else{if(-1!==this.mask.toLowerCase().indexOf("[h]"))e=parseInt(this.date[3]);else{let t=parseInt(this.date[3]);e=t<13&&-1!==this.values.indexOf("PM")?(t+12)%24:t%24}this.date[4]&&(e+=parseFloat(this.date[4]/60)),this.date[5]&&(e+=parseFloat(this.date[5]/3600)),e/=24}return isNaN(e)&&(e=""),e},r=function(e){return null===e||""===e||void 0===e},i=function(e){return"currency"===e||"percentage"===e||"scientific"===e||"numeric"===e},a=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},s=function(e,t){if(""==e)return"";t||(t=a.call(this));var n=(e=(""+e).split(t))[0].match(/[-]+/g);return n=!(!n||!n.length),e[0]=e[0].match(/[0-9]+/g),e[0]?(n&&e[0].unshift("-"),e[0]=e[0].join("")):n&&(e[0]="-"),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):""},c=function(e,t){if(""===e)return"";var n=a.call(this),o=this.options;if(""===(e=s.call(this,e)))return"";var r=null;if(e[0]&&(r="percent"===o.style?parseFloat(e[0])/100:parseFloat(e[0]+".1")),("-"===e[0]||"-00"===e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var i=new Intl.NumberFormat(this.locale,o).format(r);if(i=i.split(n),"percent"===o.style&&-1!==i[0].indexOf("%")&&(i[0]=i[0].replace("%",""),i[2]="%"),void 0!==i[1]){var l=i[1].replace(/[0-9]*/g,"");l&&(i[2]=l)}return void 0!==e[1]?i[1]=n+e[1]:i[1]="",i.join("")},u=function(e,t){var n=p.call(e);if(n){var o=c.call(this,n,t),r=o.length-n.length,i=f.call(e)+r;p.call(e,o,i,!0)}},d=function(e){var t=s.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},f=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0;return(l=window.getSelection())&&0!==l.rangeCount&&((r=(a=l.getRangeAt(0)).cloneRange()).selectNodeContents(this),r.setEnd(a.endContainer,a.endOffset),n=r.toString().length),n}return this.selectionStart}var o=p.call(this);if(t){for(var r=null,i=0;i<o.length;i++)(o[i].match(/[\-0-9]/g)||"."===o[i]||","===o[i])&&(r=i);null===r&&(r=o.indexOf(" ")),e>=r&&(e=r+1)}if(e>o.length&&(e=o.length),e)if("DIV"==this.tagName){var l=window.getSelection(),a=document.createRange();this.childNodes[0]&&(a.setStart(this.childNodes[0],e),l.removeAllRanges(),l.addRange(a))}else this.selectionStart=e,this.selectionEnd=e},p=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return e=this.innerText,this.value&&this.value.length>e.length&&(e=this.value),e;this.innerText!==e&&(this.innerText=e,t&&f.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&f.call(this,t,n))}},m=h.weekdays,g=h.weekdaysShort,v=h.months,y=h.monthsShort,b={YEAR:function(e,t){var n=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){b.YEAR.call(this,e,4)},YYY:function(e){b.YEAR.call(this,e,3)},YY:function(e){b.YEAR.call(this,e,2)},FIND:function(e,t){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1)this.values[this.index]+=e;else{for(var n=0,o=0,i=(this.values[this.index]+e).toLowerCase(),l=0;l<t.length;l++)0==t[l].toLowerCase().indexOf(i)&&(n=l,o++);if(o>1)this.values[this.index]+=e;else if(1==o){var a=t[n].length-this.values[this.index].length-1;return this.position+=a,this.values[this.index]=t[n],this.index++,n}}},MMM:function(e){var t=b.FIND.call(this,e,y);void 0!==t&&(this.date[1]=t+1)},MON:function(e){b.MMM.call(this,e)},MMMM:function(e){var t=b.FIND.call(this,e,v);void 0!==t&&(this.date[1]=t+1)},MONTH:function(e){b.MMMM.call(this,e)},MMMMM:function(e){r(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<v.length;n++)if(0==v[n][0].toLowerCase().indexOf(t)){this.values[this.index]=v[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){r(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?r(this.values[this.index])?(this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?r(this.values[this.index])?(this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(e)>0?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){r(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){b.FIND.call(this,e,g)},DY:function(e){b.DDD.call(this,e)},DDDD:function(e){b.FIND.call(this,e,m)},DAY:function(e){b.DDDD.call(this,e)},HH12:function(e,t){var n=!1;if(parseInt(e)>=0&&parseInt(e)<10?r(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10?(this.date[3]=this.values[this.index]+=e,this.index++):n=!0:n=!0,1==n){var o=parseInt(this.values[this.index]);o>=0&&o<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(e,t){var n=!1;if(parseInt(e)>=0&&parseInt(e)<10?null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10?(t||"0"!==this.values[this.index]||(this.values[this.index]=""),this.date[3]=this.values[this.index]+=e,this.index++):n=!0:n=!0,1==n){var o=parseInt(this.values[this.index]);o>=0&&o<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(e){b.HH24.call(this,e,1)},H:function(e){b.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){b.N60.call(this,e,4)},SS:function(e){b.N60.call(this,e,5)},"AM/PM":function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),""===this.values[this.index]?e.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":e.match(/p/i)&&(this.values[this.index]+="P"):"A"!==this.values[this.index]&&"P"!==this.values[this.index]||(this.values[this.index]+="M",this.index++)},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.values[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=a.call(this),n=!1;r(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var o=s.call(this,this.values[this.index],t);o&&(this.values[this.index]=o.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(e){b["0{1}(.{1}0+)?"].call(this,e)},"0{1}(.{1}0+)?%":function(e){b["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){b["0{1}(.{1}0+)?"].call(this,e);var t=a.call(this),n=this.tokens[this.index].substr(1,1),o="-"===this.values[this.index][0],r=s.call(this,this.values[this.index],t);if(""!==r){var i=r[0].match(/[0-9]/g);if(i){for(var l=[],c=0,u=(i=i.join("")).length-1;u>=0;u--)l.push(i[u]),++c%3||l.push(n);l=l.reverse(),r[0]=l.join(""),r[0].substr(0,1)==n&&(r[0]=r[0].substr(1))}else r[0]="";this.values[this.index]=r.join(t),o&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){r(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){b["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},w=function(t){if("general"==this.type)var n=[].concat(e.general);else n=[].concat(e.currency,e.datetime,e.percentage,e.scientific,e.numeric,e.text,e.general);var o=new RegExp(n.join("|"),"gi");return t.match(o)},C=function(t){if(this.type)n="text"==this.type?["text"]:"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","scientific","numeric","general"];else var n=Object.keys(e);for(var o=0;o<n.length;o++)for(var r=n[o],i=0;i<e[r].length;i++){var l=new RegExp(e[r][i],"gi");if(t.match(l))return{type:r,method:e[r][i]}}},x=function(e){for(var t=[],n=0;n<e.length;n++){var o=C.call(this,e[n]);o?t.push(o.method):t.push(null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&t[n-1].indexOf("H")>=0||t[n-2]&&t[n-2].indexOf("H")>=0||t[n+1]&&t[n+1].indexOf("S")>=0||t[n+2]&&t[n+2].indexOf("S")>=0)&&(t[n]="MI");return t},E=function(e){var t=C.call(this,e);if(t)var n=t.type;if(n){for(var o=0,r=w.call(this,e),l=0;l<r.length;l++)(t=C.call(this,r[l]))&&i(t.type)&&o++;o>1&&(n="general")}return n},A=function(){"function"==typeof b[this.methods[this.index]]?(b[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},L=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(e,t,n,o,r){return r<0?t+"0."+Array(1-r-n.length).join(0)+n+o:t+n+o+Array(r-o.length+1).join(0)})},M=function(e,t,o){var r=null,s={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(s.input=e.target,s.value=p.call(e.target),s.caret=f.call(e.target),(r=e.target.getAttribute("data-mask"))&&(s.mask=r),(r=e.target.getAttribute("data-type"))&&(s.type=r),e.target.mask?(e.target.mask.options&&(s.options=e.target.mask.options),e.target.mask.locale&&(s.locale=e.target.mask.locale)):(r=e.target.getAttribute("data-locale"))&&(s.locale=r,s.mask&&(s.options.style=s.mask)),e.target.attributes&&e.target.attributes.length)for(var h=0;h<e.target.attributes.length;h++){var m=e.target.attributes[h].name,g=e.target.attributes[h].value;"data"==m.substr(0,4)&&(s.options[m.substr(5)]=g)}}else{if("string"==typeof t)s.mask=t;else for(m=Object.keys(t),h=0;h<m.length;h++)s[m[h]]=t[m[h]];"number"==typeof e&&(a.call(s,s.mask),e=(""+e).replace(".",s.options.decimal)),s.value=e,s.input&&(p.call(s.input,e),l.focus(s.input),s.caret=f.call(s.input))}if("="!=(""+s.value)[0]&&(s.mask||s.locale)){var v;if(s.mask&&(s.mask=s.mask.replace(new RegExp(/\[h]/),"|h|"),s.mask=s.mask.replace(new RegExp(/\[.*?\]/),""),s.mask=s.mask.replace(new RegExp(/\|h\|/),"[h]"),-1!==s.mask.indexOf(";")&&(r=s.mask.split(";"),s.mask=r[0]),-1!==s.mask.indexOf("##")&&((v=s.mask.split(";"))[0]&&("object"==typeof e&&(v[0]=v[0].replace(new RegExp(/_\)/g),""),v[0]=v[0].replace(new RegExp(/_\(/g),"")),v[0]=v[0].replace("*","\t"),v[0]=v[0].replace(new RegExp(/_-/g),""),v[0]=v[0].replace(new RegExp(/_/g),""),v[0]=v[0].replace(new RegExp(/"/g),""),v[0]=v[0].replace("##0.###","##0.000"),v[0]=v[0].replace("##0.##","##0.00"),v[0]=v[0].replace("##0.#","##0.0"),v[0]=v[0].replace("##0,###","##0,000"),v[0]=v[0].replace("##0,##","##0,00"),v[0]=v[0].replace("##0,#","##0,0")),s.mask=v[0]),-1!==s.mask.indexOf("\\")&&((v=s.mask.split(";"))[0]=v[0].replace(new RegExp(/\\/g),""),s.mask=v[0]),s.type||(s.type=E.call(s,s.mask)),s.tokens=w.call(s,s.mask)),"object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(s.locale)if(s.input)u.call(s,s.input,e);else var y=c.call(s,s.value);else{for(s.methods=x.call(s,s.tokens),s.event=e;s.position<s.value.length&&void 0!==s.tokens[s.index];)A.call(s);if(y=s.values.join(""),i(s.type)&&""!==y){for(;void 0!==s.tokens[s.index];)(r=C.call(s,s.tokens[s.index]))&&"general"==r.type&&(s.values[s.index]=s.tokens[s.index]),s.index++;var b=!0}else b=!1;if(y=s.values.join(""),s.input){if((r=y.length-s.value.length)>0)var L=s.caret+r;else L=s.caret;p.call(s.input,y,L,b)}}if(s.input){var I=null;if(i(s.type)){let e=p.call(s.input);s.number=d.call(s,e),I="percentage"==s.type&&-1!==(""+e).indexOf("%")?M.adjustPrecision(s.number/100):s.number}else"datetime"==s.type&&(I=n.call(s),s.date[0]&&s.date[1]&&s.date[2]&&s.input.setAttribute("data-completed",!0));I&&s.input.setAttribute("data-value",I)}if(void 0!==y)return o?s:y}};return M.adjustPrecision=function(e){if("number"==typeof e&&!Number.isInteger(e)){const t=e.toString().split(".");if(t[1]&&t[1].length>10){let n=0;const o=t[1][t[1].length-2];if(0==o||9==o){for(let e=t[1].length-2;e>0;e--){if(!(n>=0&&t[1][e]==o)){n=0;break}if(n++,n>6)break}if(n)return parseFloat(parseFloat(e).toFixed(t[1].length-1))}}}return e},M.getType=E,M.prepare=function(e,t){return t||(t={}),w.call(t,e)},M.apply=function(e){var t=p.call(e.target);1==e.key.length&&(t+=e.key),p.call(e.target,M(t,e.target.getAttribute("data-mask")))},M.run=function(e,t,n){return M(e,{mask:t,decimal:n})},M.extract=function(e,t,n){if(r(e))return e;if("object"!=typeof t)return e;if((t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask){if(-1!==t.mask.indexOf(";")){var i=t.mask.split(";");t.mask=i[0]}t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]")}a.call(t,t.mask);var s=null,c=null;if("percent"==t.type||"percent"==t.options.style?s="percentage":t.mask&&(s=E.call(t,t.mask)),"text"===s){var u={};c=e}else"general"===s?(u=M(e,t,!0),c=e):"datetime"===s?(e instanceof Date&&(e=M.getDateString(e,t.mask)),u=M(e,t,!0),c=l.isNumeric(e)?e:o.call(u)):"scientific"===s?(c=e,"string"==typeof e&&(c=Number(c)),u=t):(c=d.call(t,e),"percentage"===s&&-1!==(""+e).indexOf("%")&&(c/=100),u=t);return u.value=c,!u.type&&s&&(u.type=s),n?u:c},M.render=function(e,n,o,i){if(r(e))return e;if("object"!=typeof n)return e;if((n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),n.mask){if(-1!==n.mask.indexOf(";")){var l=n.mask.split(";");o||(l[0]=l[0].replace(new RegExp(/_\)/g),""),l[0]=l[0].replace(new RegExp(/_\(/g),"")),n.mask=l[0]}n.mask=n.mask.replace(new RegExp(/\[h]/),"|h|"),n.mask=n.mask.replace(new RegExp(/\[.*?\]/),""),n.mask=n.mask.replace(new RegExp(/\|h\|/),"[h]")}var s=null;"percent"==n.type||"percent"==n.options.style?s="percentage":n.mask?s=E.call(n,n.mask):e instanceof Date&&(s="datetime");var c=!1;if("datetime"==s||"calendar"==n.type)(l=M.getDateString(e,n.mask))&&(e=l),n.mask&&o&&(c=!0);else if("text"===s)"number"==typeof e&&(e=e.toString());else if("string"==typeof e&&t.isNumeric(e)&&(e=Number(e)),"percentage"===s&&(e=M.adjustPrecision(100*e)),"number"==typeof e){if(l=null,n.mask&&o){var u=a.call(n,n.mask);if("scientific"===s)if(-1!==n.mask.indexOf(u)){let t=n.mask.split("E");t=t[0].split(u),t=""+t[1].match(/[0-9]+/g),t=t.length,l=e.toExponential(t)}else l=e.toExponential(0);else{if(-1!==n.mask.indexOf(u)){u=(u=""+(u=n.mask.split(u))[1].match(/[0-9]+/g)).length,l=e.toFixed(u);let t=e.toString().split("."),o=t[1];o&&o.length>u&&"5"===o[o.length-1]&&(l=parseFloat(t[0]+"."+o+"1").toFixed(u))}else l=e.toFixed(0);-1!==(""+l).indexOf("e")&&(l=L(l))}}else if(n.locale&&o){if(u=(""+e).split("."),n.options){void 0===u[1]&&(u[1]="");var d=u[1].length;if(n.options.minimumFractionDigits>d)for(var f=0;f<n.options.minimumFractionDigits-d;f++)u[1]+="0"}l=u[1].length?u.join("."):u[0],d=u[1].length,n.options&&n.options.maximumFractionDigits<d&&(l=parseFloat(l).toFixed(n.options.maximumFractionDigits))}else l=L(e);null!==l&&(e=l,a.call(n,n.mask),n.options.decimal&&(e=e.replace(".",n.options.decimal)))}else n.mask&&o&&(c=!0);if(c){var p=n.mask.length-e.length;if(p>0)for(f=0;f<p;f++)e+=" "}if("scientific"===s){if(o)return e;e=L(e)}if("numeric"===s&&!1===i&&"string"==typeof e)return e;if(e=M(e,n),o&&"numeric"===s){var h=n.mask.match(new RegExp(/^[0]+$/gm));if(h&&1===h.length){var m=h[0].length;if(m>3)for(e=""+e;e.length<m;)e="0"+e}}return e},M.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},M.extractDateFromString=function(e,t){var n=M(e,{mask:t},!0);if(e>0&&Number(e)==e&&(n.values.join("")!==n.value||"numeric"==n.type)){var o=new Date(Math.round(86400*(e-25569)*1e3));return o.getFullYear()+"-"+l.two(o.getMonth())+"-"+l.two(o.getDate())+" 00:00:00"}var r=!1;return n.values&&n.values.length===n.tokens.length&&n.values[n.values.length-1].length>=n.tokens[n.tokens.length-1].length&&(r=!0),n.date[0]&&n.date[1]&&(n.date[2]||r)?(n.date[2]||(n.date[2]=1),n.date[0]+"-"+l.two(n.date[1])+"-"+l.two(n.date[2])+" "+l.two(n.date[3])+":"+l.two(n.date[4])+":"+l.two(n.date[5])):""},M.getDateString=function(e,t){if(t||(t={}),t&&"object"==typeof t)if(t.format)var n=t.format;else t.mask&&(n=t.mask);else n=t;if(n||(n="YYYY-MM-DD"),n.indexOf("[h]")>=0){var o=0;if(e&&l.isNumeric(e)&&(o=parseFloat(24*Number(e)),n.indexOf("mm")>=0)){if((d=(""+o).split("."))[1]){var r=60*parseFloat("0."+d[1]);r=parseFloat(r.toFixed(2))}else r=0;o=parseInt(d[0])+":"+l.two(r)}return o}e instanceof Date?e=h.now(e):e&&l.isNumeric(e)&&(e=h.numToDate(e));for(var i=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),a=n.match(i),s=0;s<a.length;s++)"MM"==a[s].toUpperCase()&&(a[s-1]&&a[s-1].toUpperCase().indexOf("H")>=0||a[s-2]&&a[s-2].toUpperCase().indexOf("H")>=0||a[s+1]&&a[s+1].toUpperCase().indexOf("S")>=0||a[s+2]&&a[s+2].toUpperCase().indexOf("S")>=0)&&(a[s]="mi");var c={tokens:a};if(e){var u=-1!==(r=""+e).indexOf("T")?"T":" ",d=0,f=0,p=0;(r=r.split(u))[1]&&(f=(d=r[1].split(":"))[1]?d[1]:0,p=d[2]?d[2]:0,d=d[0]?d[0]:0),r=r[0].split("-");let t=new Date(r[0],r[1],0).getDate();if(r[0]&&r[1]&&r[2]&&r[0]>0&&r[1]>0&&r[1]<13&&r[2]>0&&r[2]<=t){c.data=[r[0],r[1],r[2],d,f,p],c.value=[];var m=new Date(c.data[0],c.data[1]-1,c.data[2],c.data[3],c.data[4],c.data[5]),g=function(e){var t=this.tokens[e],n=t.toUpperCase(),o=null;"YYYY"===n?o=this.data[0]:"YYY"===n?o=this.data[0].substring(1,4):"YY"===n?o=this.data[0].substring(2,4):"Y"===n?o=this.data[0].substring(3,4):"MON"===t?o=h.months[m.getMonth()].substr(0,3).toUpperCase():"mon"===t?o=h.months[m.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?o=h.months[m.getMonth()].toUpperCase():"month"===t?o=h.months[m.getMonth()].toLowerCase():"MMMMM"===n?o=h.months[m.getMonth()].substr(0,1):"MMMM"===n||"Month"===t?o=h.months[m.getMonth()]:"MMM"===n||"Mon"==t?o=h.months[m.getMonth()].substr(0,3):"MM"===n?o=l.two(this.data[1]):"M"===n?o=m.getMonth()+1:"DAY"===t?o=h.weekdays[m.getDay()].toUpperCase():"day"===t?o=h.weekdays[m.getDay()].toLowerCase():"DDDD"===n||"Day"==t?o=h.weekdays[m.getDay()]:"DDD"===n?o=h.weekdays[m.getDay()].substr(0,3):"DD"===n?o=l.two(this.data[2]):"D"===n?o=parseInt(this.data[2]):"Q"===n?o=Math.floor((m.getMonth()+3)/3):"HH24"===n||"HH"===n?((o=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(o-=12),o=l.two(o)):"HH12"===n?o=this.data[3]>12?l.two(this.data[3]-12):l.two(this.data[3]):"H"===n?(o=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(o-=12,o=l.two(o)):"MI"===n?o=l.two(this.data[4]):"SS"===n?o=l.two(this.data[5]):"MS"===n?o=m.getMilliseconds():"AM/PM"===n?o=this.data[3]>=12?"PM":"AM":"WD"===n&&(o=h.weekdays[m.getDay()]),this.value[e]=null===o?this.tokens[e]:o};for(s=0;s<c.tokens.length;s++)g.call(c,s);e=c.value.join("")}else e=""}return e},M}();var g=function(){var t=function(o,r){if(o.calendar)return o.calendar.setOptions(r,!0);var i={type:"calendar",options:{},date:null,setOptions:function(n,r){var a={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:h.monthsShort,monthsFull:h.months,weekdays:h.weekdays,textDone:e.translate("Done"),textReset:e.translate("Reset"),textUpdate:e.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var s in a)n&&n.hasOwnProperty(s)?i.options[s]=n[s]:void 0!==i.options[s]&&!0!==r||(i.options[s]=a[s]);if(0==i.options.resetButton?d.style.display="none":d.style.display="",i.options.readonly?o.setAttribute("readonly","readonly"):o.removeAttribute("readonly"),i.options.placeholder?o.setAttribute("placeholder",i.options.placeholder):o.removeAttribute("placeholder"),l.isNumeric(i.options.value)&&i.options.value>0&&(i.options.value=t.numToDate(i.options.value),i.options.dataType="numeric"),d.innerHTML=i.options.textReset,f.innerHTML=i.options.textDone,A.innerHTML=i.options.textUpdate,i.options.format&&o.setAttribute("data-mask",i.options.format.toLowerCase()),!i.options.value&&i.options.today)var c=t.now();else c=i.options.value;return c&&(i.options.value=null,i.setValue(c)),i},open:function(e){if(!u.classList.contains("jcalendar-focus")&&!u.classList.contains("jcalendar-inline")){if(t.current=i,n(i,!0),i.getDays(),"year-month-picker"==i.options.type&&i.getMonths(),i.options.time&&(L.value=i.date[3],M.value=i.date[4]),u.classList.add("jcalendar-focus"),l.getWindowWidth()<800||i.options.fullscreen)u.classList.add("jcalendar-fullsize"),p.slideBottom(g,1);else{u.classList.remove("jcalendar-fullsize");var r=o.getBoundingClientRect(),a=g.getBoundingClientRect();if(i.options.position)m.style.position="fixed",window.innerHeight<r.bottom+a.height?m.style.top=r.top-(a.height+2)+"px":m.style.top=r.top+r.height+2+"px",m.style.left=r.left+"px";else if(window.innerHeight<r.bottom+a.height?((s=-1*(r.height+a.height+2))+r.top<0&&(s=-1*(r.top+r.height)),m.style.top=s+"px"):m.style.top="2px",window.innerWidth<r.left+a.width){var s=window.innerWidth-(r.left+a.width+20);m.style.left=s+"px"}else m.style.left="0px"}"function"==typeof i.options.onopen&&i.options.onopen(o)}},close:function(e,r){if(!0!==i.options.autoSelect&&void 0===r&&(r=!1),u.classList.contains("jcalendar-focus")){if(!1!==r){var l=u.querySelector(".jcalendar-selected");if("string"==typeof r)var a=r;else a=!l||l.classList.contains("jcalendar-disabled")?i.options.value:i.getValue();i.setValue(a)}else{let e=i.options.value||"";i.options.value=null,i.setValue(e)}e||"function"!=typeof i.options.onclose||i.options.onclose(o),u.classList.remove("jcalendar-focus"),n(i,!1),t.current=null}return i.options.value},prev:function(){"years"==i.options.mode?(i.date[0]=i.date[0]-12,i.getYears()):"months"==i.options.mode?(i.date[0]=parseInt(i.date[0])-1,i.getMonths()):(i.date[1]<2?(i.date[0]=i.date[0]-1,i.date[1]=12):i.date[1]=i.date[1]-1,i.getDays())},next:function(){"years"==i.options.mode?(i.date[0]=parseInt(i.date[0])+12,i.getYears()):"months"==i.options.mode?(i.date[0]=parseInt(i.date[0])+1,i.getMonths()):(i.date[1]>11?(i.date[0]=parseInt(i.date[0])+1,i.date[1]=1):i.date[1]=parseInt(i.date[1])+1,i.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return i.setValue(e),e},setValue:function(n){n||(n=""+n);var r=n,l=i.options.value;if(l!=r){if(r){i.setLabel(r,i.options),(s=r.split(" "))[1]||(s[1]="00:00:00");var a=s[1].split(":"),s=s[0].split("-"),c=parseInt(s[0]),u=parseInt(s[1]),d=parseInt(s[2]),f=parseInt(a[0]),p=parseInt(a[1]);i.date=[c,u,d,f,p,0],n=i.setLabel(r,i.options);var h=t.now(new Date(c,u-1,d),!0);if(i.options.validRange){if(!i.options.validRange[0]||h>=i.options.validRange[0])var m=!0;else m=!1;if(!i.options.validRange[1]||h<=i.options.validRange[1])var g=!0;else g=!1;m&&g?(o.classList.remove("jcalendar_warning"),o.title=""):(o.classList.add("jcalendar_warning"),o.title=e.translate("Date outside the valid range"))}else o.classList.remove("jcalendar_warning"),o.title=""}else{i.date=null;n="";o.classList.remove("jcalendar_warning"),o.title=""}i.options.value=r,"function"==typeof i.options.onchange&&i.options.onchange(o,r,l),o.value!=n&&(o.value=n,"function"==typeof o.oninput&&o.oninput({type:"input",target:o,value:o.value}))}i.date&&(i.getDays(),"year-month-picker"==i.options.type&&i.getMonths())},getValue:function(){return i.date?i.options.time?l.two(i.date[0])+"-"+l.two(i.date[1])+"-"+l.two(i.date[2])+" "+l.two(i.date[3])+":"+l.two(i.date[4])+":"+l.two(0):l.two(i.date[0])+"-"+l.two(i.date[1])+"-"+l.two(i.date[2])+" "+l.two(0)+":"+l.two(0)+":"+l.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var n=u.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(i.date[1]=t,i.date[2]=1):i.date[2]=e.innerText,i.options.time?(i.date[3]=L.value,i.date[4]=M.value):i.close(null,!0)}c()},reset:function(){i.setValue(""),i.date=null,i.close(!1,!1)},getDays:function(){i.options.mode="days";var e=new Date,n=i.date&&l.isNumeric(i.date[0])?i.date[0]:parseInt(e.getFullYear()),o=i.date&&l.isNumeric(i.date[1])?i.date[1]:parseInt(e.getMonth())+1,r=i.date&&l.isNumeric(i.date[2])?i.date[2]:parseInt(e.getDate()),a=i.date&&l.isNumeric(i.date[3])?i.date[3]:parseInt(e.getHours()),s=i.date&&l.isNumeric(i.date[4])?i.date[4]:parseInt(e.getMinutes());i.date=[n,o,r,a,s,0],v.innerHTML=n,y.innerHTML=i.options.months[o-1];var u=e.getMonth()==o-1&&e.getFullYear()==n,d=e.getDate(),f=(e=new Date(n,o,0,0,0)).getDate(),p=(e=new Date(n,o-1,0,0,0)).getDay()+1;p-=m=i.options.startingDay||0,w.innerHTML="",(C=document.createElement("tr")).setAttribute("align","center"),w.appendChild(C);for(var h=0;h<7;h++)(E=document.createElement("td")).classList.add("jcalendar-weekday"),E.innerHTML=i.options.weekdays[m].substr(0,1),C.appendChild(E),++m>6&&(m=0);for(var m=0,g=0,b=0;b<6;b++){var C;for((C=document.createElement("tr")).setAttribute("align","center"),C.style.height="34px",h=0;h<7;h++){var E;if((E=document.createElement("td")).classList.add("jcalendar-set-day"),m>=p&&m<p+f){g++,E.innerHTML=g,g==r&&E.classList.add("jcalendar-selected"),u&&d==g&&(E.style.fontWeight="bold");var A=t.now(new Date(n,o-1,g),!0);if(i.options.validRange){if(!i.options.validRange[0]||A>=i.options.validRange[0])var L=!0;else L=!1;if(!i.options.validRange[1]||A<=i.options.validRange[1])var M=!0;else M=!1;L&&M||E.classList.add("jcalendar-disabled")}}C.appendChild(E),m++}w.appendChild(C)}i.options.time?x.style.display="":x.style.display="none",c()},getMonths:function(){i.options.mode="months";var e=i.options.months,t=(i.options.value,new Date),n=parseInt(t.getFullYear()),o=parseInt(t.getMonth())+1,r=i.date&&l.isNumeric(i.date[0])?i.date[0]:n,a=i.date&&l.isNumeric(i.date[1])?i.date[1]:o;v.innerHTML=i.date[0],y.innerHTML=e[a-1];var s=document.createElement("table");s.setAttribute("width","100%");for(var u=null,d=0;d<12;d++){d%4||((u=document.createElement("tr")).setAttribute("align","center"),s.appendChild(u));var f=document.createElement("td");if(f.classList.add("jcalendar-set-month"),f.setAttribute("data-value",d+1),f.innerText=e[d],i.options.validRange){var p=r+"-"+l.two(d+1);if(!i.options.validRange[0]||p>=i.options.validRange[0].substr(0,7))var h=!0;else h=!1;if(!i.options.validRange[1]||p<=i.options.validRange[1].substr(0,7))var m=!0;else m=!1;h&&m||f.classList.add("jcalendar-disabled")}d+1==a&&f.classList.add("jcalendar-selected"),n==r&&d+1==o&&(f.style.fontWeight="bold"),u.appendChild(f)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.children[0].children[0].appendChild(s),c()},getYears:function(){i.options.mode="years";for(var e=new Date,t=e.getFullYear(),n=i.date&&l.isNumeric(i.date[0])?i.date[0]:parseInt(e.getFullYear()),o=[],r=0;r<25;r++)o[r]=parseInt(i.date[0])+(r-12);var a=document.createElement("table");for(a.setAttribute("width","100%"),r=0;r<25;r++){if(!(r%5)){var s=document.createElement("tr");s.setAttribute("align","center"),a.appendChild(s)}var u=document.createElement("td");u.classList.add("jcalendar-set-year"),u.innerText=o[r],n==o[r]&&u.classList.add("jcalendar-selected"),t==o[r]&&(u.style.fontWeight="bold"),s.appendChild(u)}w.innerHTML='<tr><td colspan="7"></td></tr>',w.firstChild.firstChild.appendChild(a),c()},setLabel:function(e,n){return t.getDateString(e,n)},fromFormatted:function(e,n){return t.extractDateFromString(e,n)}},a=function(e){if(l.findElement(e.target,"jcalendar-container")){var t=e.target.className;if("jcalendar-prev"==t)i.prev();else if("jcalendar-next"==t)i.next();else if("jcalendar-month"==t)i.getMonths();else if("jcalendar-year"==t)i.getYears();else if("jcalendar-set-year"==t)i.date[0]=e.target.innerText,"year-month-picker"==i.options.type?i.getMonths():i.getDays();else if(e.target.classList.contains("jcalendar-set-month")){var n=parseInt(e.target.getAttribute("data-value"));"year-month-picker"==i.options.type?i.update(e.target,n):(i.date[1]=n,i.getDays())}else"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?i.close(null,!0):"jcalendar-backdrop"==t?i.close(!1,!1):"jcalendar-reset"==t?i.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&i.update(e.target)}else i.close(!1,!1)},s=function(e){if(e.target.value&&e.target.value.length>3){var n=t.extractDateFromString(e.target.value,i.options.format);n&&i.setValue(n)}},c=function(){var e=u.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(A.setAttribute("disabled","disabled"),L.setAttribute("disabled","disabled"),M.setAttribute("disabled","disabled")):(A.removeAttribute("disabled"),L.removeAttribute("disabled"),M.removeAttribute("disabled")),"function"==typeof i.options.onupdate&&i.options.onupdate(o,i.getValue())},u=null,d=null,f=null,m=null,g=null,v=null,y=null,b=null,w=null,C=null,x=null,E=null,A=null,L=null,M=null;return function(){"INPUT"==o.tagName&&o.value&&(r.value=o.value),(d=document.createElement("div")).className="jcalendar-reset",(f=document.createElement("div")).className="jcalendar-confirm",(C=document.createElement("div")).className="jcalendar-controls",C.style.borderBottom="1px solid #ddd",C.appendChild(d),C.appendChild(f),(m=document.createElement("div")).className="jcalendar-container",(g=document.createElement("div")).className="jcalendar-content",m.appendChild(g),"DIV"==o.tagName?(u=o).classList.add("jcalendar-inline"):(g.appendChild(C),(u=document.createElement("div")).className="jcalendar"),u.classList.add("jcalendar-container"),u.appendChild(m);var e=document.createElement("div");e.className="jcalendar-table",g.appendChild(e);var n=document.createElement("td");n.setAttribute("colspan","2"),n.className="jcalendar-prev",(v=document.createElement("span")).className="jcalendar-year",(y=document.createElement("span")).className="jcalendar-month";var c=document.createElement("td");c.className="jcalendar-header",c.setAttribute("colspan","3"),c.appendChild(y),c.appendChild(v);var h=document.createElement("td");h.setAttribute("colspan","2"),h.className="jcalendar-next";var I=document.createElement("thead"),T=document.createElement("tr");T.appendChild(n),T.appendChild(c),T.appendChild(h),I.appendChild(T),b=document.createElement("table"),w=document.createElement("tbody"),b.setAttribute("cellpadding","0"),b.setAttribute("cellspacing","0"),b.appendChild(I),b.appendChild(w),e.appendChild(b),(L=document.createElement("select")).className="jcalendar-select",L.onchange=function(){i.date[3]=this.value,"function"==typeof i.options.onupdate&&i.options.onupdate(o,i.getValue())};for(var _=0;_<24;_++)(N=document.createElement("option")).value=_,N.innerHTML=l.two(_),L.appendChild(N);for((M=document.createElement("select")).className="jcalendar-select",M.onchange=function(){i.date[4]=this.value,"function"==typeof i.options.onupdate&&i.options.onupdate(o,i.getValue())},_=0;_<60;_++){var N;(N=document.createElement("option")).value=_,N.innerHTML=l.two(_),M.appendChild(N)}var S=document.createElement("div");S.className="jcalendar-controls",(x=document.createElement("div")).className="jcalendar-time",x.style.maxWidth="140px",x.appendChild(L),x.appendChild(M),(A=document.createElement("button")).setAttribute("type","button"),A.className="jcalendar-update",(E=document.createElement("div")).style.flexGrow="10",E.appendChild(A),S.appendChild(x),"INPUT"==o.tagName&&S.appendChild(E),g.appendChild(S);var j=document.createElement("div");j.className="jcalendar-backdrop",u.appendChild(j),o.addEventListener("keyup",s),u.addEventListener("swipeleft",function(e){p.slideLeft(b,0,function(){i.next(),p.slideRight(b,1)}),e.preventDefault(),e.stopPropagation()}),u.addEventListener("swiperight",function(e){p.slideRight(b,0,function(){i.prev(),p.slideLeft(b,1)}),e.preventDefault(),e.stopPropagation()}),"ontouchend"in document.documentElement==1?(u.addEventListener("touchend",a),o.addEventListener("touchend",i.open)):(u.addEventListener("mouseup",a),o.addEventListener("mouseup",i.open)),t.hasEvents||(t.hasEvents=!0,document.addEventListener("keydown",t.keydown)),i.setOptions(r),"INPUT"==o.tagName?(o.parentNode.insertBefore(u,o.nextSibling),o.setAttribute("autocomplete","off"),o.classList.add("jcalendar-input"),o.value=i.setLabel(i.getValue(),i.options)):(i.getDays(),i.options.time&&(L.value=i.date[3],M.value=i.date[4])),1==i.options.opened&&i.open(),0==i.options.controls&&m.classList.add("jcalendar-hide-controls"),o.change=i.setValue,o.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},o.calendar=u.calendar=i}(),i};return t.keydown=function(e){var n=null;(n=t.current)&&(13==e.which?n.close(!1,!0):27==e.which&&n.close(!1,!1))},t.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"}),-1===e.indexOf("GMT")&&-1===e.indexOf("Z")&&(e+=" GMT");var n=new Date,o=new Date(e),r=parseInt((n-o)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==r)var i=t.justNow;else i=r<90?t.xMinutesAgo.format(r):r<1440?t.xHoursAgo.format(Math.round(r/60)):r<20160?t.xDaysAgo.format(Math.round(r/1440)):r<43200?t.xWeeksAgo.format(Math.round(r/10080)):r<1036800?t.xMonthsAgo.format(Math.round(r/43200)):t.xYearsAgo.format(Math.round(r/525600));return i},t.prettifyAll=function(){for(var e=document.querySelectorAll(".prettydate"),n=0;n<e.length;n++)e[n].getAttribute("data-date")?e[n].innerHTML=t.prettify(e[n].getAttribute("data-date")):e[n].innerHTML&&(e[n].setAttribute("title",e[n].innerHTML),e[n].setAttribute("data-date",e[n].innerHTML),e[n].innerHTML=t.prettify(e[n].innerHTML))},t.now=h.now,t.toArray=h.toArray,t.dateToNum=h.dateToNum,t.numToDate=h.numToDate,t.weekdays=h.weekdays,t.months=h.months,t.weekdaysShort=h.weekdaysShort,t.monthsShort=h.monthsShort,t.extractDateFromString=m.extractDateFromString,t.getDateString=m.getDateString,t}();var v=function(){var e={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},t=function(t){return e[t]?e[t]:e.material};return t.get=function(t){return e[t]?e[t]:e},t.set=function(t,n){e[t]=n},t}();function b(e,t){var n={options:{}},o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var r in o)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=o[r];e.classList.add("jtabs");var i=null,a=null,s=null;const u=function(e){n.options.animation&&setTimeout(function(){let t=n.headers.children[e].getBoundingClientRect();"modern"===n.options.palette?(s.style.width=t.width-4+"px",s.style.left=n.headers.children[e].offsetLeft+2+"px"):(s.style.width=t.width+"px",s.style.left=n.headers.children[e].offsetLeft+"px"),"bottom"===n.options.position?s.style.top="0px":s.style.bottom="0px"},50)};var d=function(e){"function"==typeof n.headers.scrollTo?n.headers.scrollTo({left:e,behavior:"smooth"}):n.headers.scrollLeft=e,e<=1?i.classList.add("disabled"):i.classList.remove("disabled"),e>=n.headers.scrollWidth-n.headers.offsetWidth?a.classList.add("disabled"):a.classList.remove("disabled"),n.headers.scrollWidth<=n.headers.offsetWidth?(i.style.display="none",a.style.display="none"):(i.style.display="",a.style.display="")};if(n.setBorder=u,n.open=function(t){if(Array.from(n.content.children),n.content.children[t]){for(var o=null,r=0;r<n.headers.children.length;r++)n.headers.children[r].classList.contains("jtabs-selected")&&(o=r),n.headers.children[r].classList.remove("jtabs-selected"),n.headers.children[r].removeAttribute("aria-selected"),n.content.children[r]&&n.content.children[r].classList.remove("jtabs-selected");if(n.headers.children[t].classList.add("jtabs-selected"),n.headers.children[t].setAttribute("aria-selected","true"),n.content.children[t]&&n.content.children[t].classList.add("jtabs-selected"),o!=t&&"function"==typeof n.options.onchange&&n.content.children[t]&&n.options.onchange(e,n,t,n.headers.children[t],n.content.children[t]),1==n.options.hideHeaders&&n.headers.children.length<3&&0==n.options.allowCreate)n.headers.parentNode.style.display="none";else{n.headers.parentNode.style.display="";var i=n.headers.children[t].offsetLeft,l=i+n.headers.children[t].offsetWidth,a=n.headers.scrollLeft,s=a+n.headers.offsetWidth;a<=i&&s>=l||d(i-1),u(t)}}},n.selectIndex=function(e){var t=Array.prototype.indexOf.call(n.headers.children,e);return t>=0&&n.open(t),t},n.rename=function(e,t){t||(t=prompt("New title",n.headers.children[e].innerText)),n.headers.children[e].innerText=t,u(n.getActive())},n.create=function(t,o){if("function"==typeof n.options.onbeforecreate){var r=n.options.onbeforecreate(e,t);if(!1===r)return!1;t=r}var i=n.appendElement(t);return"function"==typeof n.options.oncreate&&n.options.oncreate(e,i),u(n.getActive()),i},n.remove=function(e){return n.deleteElement(e)},n.nextNumber=function(){for(var e=0,t=0;t<n.headers.children.length;t++){var o=n.headers.children[t].innerText.match(/[0-9].*/);o>e&&(e=parseInt(o))}return e?e++:e=1,e},n.deleteElement=function(t){let o=n.getActive();if(!n.headers.children[t])return!1;if(n.headers.removeChild(n.headers.children[t]),n.content.removeChild(n.content.children[t]),o===t)n.open(0);else{let e=n.getActive()||0;u(e)}"function"==typeof n.options.ondelete&&n.options.ondelete(e,t)},n.appendElement=function(e,t,o,r){if(e||(e=prompt("Title?","")),e){let s=l.guid(),c=l.guid();var i=document.createElement("div");i.setAttribute("id",c),i.setAttribute("role","tabpanel"),i.setAttribute("aria-labelledby",s);var a=document.createElement("div");if(a.setAttribute("id",s),a.setAttribute("role","tab"),a.setAttribute("aria-controls",c),a.innerHTML=e,a.content=i,void 0===r)n.content.appendChild(i),n.headers.insertBefore(a,n.headers.lastChild);else{let e=n.content.children[r];e?n.content.insertBefore(i,e):n.content.appendChild(i),e=n.headers.children[r]||n.headers.lastChild,n.headers.insertBefore(a,e)}return n.options.allowChangePosition&&a.setAttribute("draggable","true"),!1!==o&&n.selectIndex(a),"function"==typeof t&&t(i,a),i}},n.getActive=function(){for(var e=0;e<n.headers.children.length;e++)if(n.headers.children[e].classList.contains("jtabs-selected"))return e;return!1},n.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t),n.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),n.content.replaceChild(t,n.content.children[e]),u()},n.updatePosition=function(e,t,o,r){if(e>t?n.content.insertBefore(n.content.children[e],n.content.children[t]):n.content.insertBefore(n.content.children[e],n.content.children[t].nextSibling),!1!==r)n.open(t);else{const e=n.getActive();t<e&&n.setBorder(e)}o||"function"!=typeof n.options.onchangeposition||n.options.onchangeposition(n.headers,e,t)},n.move=function(e,t,o,r){e>t?n.headers.insertBefore(n.headers.children[e],n.headers.children[t]):n.headers.insertBefore(n.headers.children[e],n.headers.children[t].nextSibling),n.updatePosition(e,t,o,r)},n.setBorder=u,n.init=function(){e.innerHTML="",n.headers=document.createElement("div"),n.content=document.createElement("div"),n.headers.classList.add("jtabs-headers"),n.headers.setAttribute("role","tablist"),n.content.classList.add("jtabs-content"),n.content.setAttribute("role","region"),n.content.setAttribute("aria-label","Tab Panels"),n.options.palette?e.classList.add("jtabs-modern"):e.classList.remove("jtabs-modern"),n.options.padding&&(n.content.style.padding=parseInt(n.options.padding)+"px");var t=document.createElement("div");t.className="jtabs-headers-container",t.appendChild(n.headers),n.options.maxWidth&&(t.style.maxWidth=parseInt(n.options.maxWidth)+"px");var o=document.createElement("div");if(o.className="jtabs-controls",o.setAttribute("draggable","false"),t.appendChild(o),"bottom"==n.options.position?(e.appendChild(n.content),e.appendChild(t)):(e.appendChild(t),e.appendChild(n.content)),1==n.options.allowCreate){var r=document.createElement("div");r.className="jtabs-add",r.onclick=function(){n.create()},o.appendChild(r)}(i=document.createElement("div")).className="jtabs-prev",i.onclick=function(){d(n.headers.scrollLeft-n.headers.offsetWidth)},o.appendChild(i),(a=document.createElement("div")).className="jtabs-next",a.onclick=function(){d(n.headers.scrollLeft+n.headers.offsetWidth)},o.appendChild(a);for(var l=0;l<n.options.data.length;l++){if(n.options.data[l].titleElement)var u=n.options.data[l].titleElement;else u=document.createElement("div");if(n.options.data[l].icon){var f=document.createElement("div"),p=document.createElement("i");p.classList.add("material-icons"),p.innerHTML=n.options.data[l].icon,f.appendChild(p),u.appendChild(f)}if(n.options.data[l].title){var h=document.createTextNode(n.options.data[l].title);u.appendChild(h)}if(n.options.data[l].width&&(u.style.width=n.options.data[l].width),n.options.data[l].contentElement)var m=n.options.data[l].contentElement;else(m=document.createElement("div")).innerHTML=n.options.data[l].content;n.headers.appendChild(u),n.content.appendChild(m)}(s=document.createElement("div")).className="jtabs-border",n.headers.appendChild(s),n.options.animation&&e.classList.add("jtabs-animation"),n.headers.addEventListener("click",function(t){if(t.target.parentNode.classList.contains("jtabs-headers"))var o=t.target;else o="I"==t.target.tagName?t.target.parentNode.parentNode:t.target.parentNode;var r=n.selectIndex(o);"function"==typeof n.options.onclick&&n.options.onclick(e,n,r,n.headers.children[r],n.content.children[r])}),n.headers.addEventListener("contextmenu",function(e){n.selectIndex(e.target)}),n.headers.children.length&&n.open(0),d(0),1==n.options.allowChangePosition&&c(n.headers,{direction:1,ondrop:function(e,t,o){n.updatePosition(t,o)}}),"function"==typeof n.options.onload&&n.options.onload(e,n)},e.children[0]&&e.children[0].children.length)for(var p=0;p<e.children[0].children.length;p++){var h=n.options.data&&n.options.data[p]?n.options.data[p]:{};e.children[1]&&e.children[1].children[p]?(h.titleElement=e.children[0].children[p],h.contentElement=e.children[1].children[p]):h.contentElement=e.children[0].children[p],n.options.data[p]=h}var m=!1;if(n.options.data)for(p=0;p<n.options.data.length;p++)n.options.data[p].url&&(f({url:n.options.data[p].url,type:"GET",dataType:"text/html",index:p,success:function(e){n.options.data[this.index].content=e},complete:function(){n.init()}}),m=!0);return m||n.init(),e.tabs=n,n}function w(e,t){if(e.color)return e.color.setOptions(t,!0);var o={type:"color",options:{}},r=null,i=null,a=null,s=null,c=null,u=null,d=null;o.setOptions=function(t,n){var r={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var i in t||(t={}),t&&!t.palette&&(t.palette=v()),r)t&&t.hasOwnProperty(i)?o.options[i]=t[i]:void 0!==o.options[i]&&!0!==n||(o.options[i]=r[i]);return s&&(s.innerHTML=o.options.resetLabel),c&&(c.innerHTML=o.options.doneLabel),o.options.palette&&d&&d.updateContent(0,y()),"string"==typeof o.options.value&&(e.value=o.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value)),o.options.placeholder?e.setAttribute("placeholder",o.options.placeholder):e.getAttribute("placeholder")&&e.removeAttribute("placeholder"),o},o.select=function(e){var t=r.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),o.values[e]&&o.values[e].classList.add("jcolor-selected"),o.options.value=e},o.open=function(){if(!r.classList.contains("jcolor-focus")){n(o,!0),r.classList.add("jcolor-focus"),o.options.value&&o.select(o.options.value),a.style.marginTop="",a.style.marginLeft="";var t=a.getBoundingClientRect(),s=l.getWindowWidth(),c=l.getWindowHeight();if(s<800||1==o.options.fullscreen?(a.classList.add("jcolor-fullscreen"),p.slideBottom(a,1),i.style.display="block"):(a.classList.contains("jcolor-fullscreen")&&(a.classList.remove("jcolor-fullscreen"),i.style.display=""),o.options.position?a.style.position="fixed":a.style.position="",t.left+t.width>s&&(a.style.marginLeft=-1*(t.left+t.width-(s-20))+"px"),t.top+t.height>c&&(a.style.marginTop=-1*(t.top+t.height-(c-20))+"px")),"function"==typeof o.options.onopen&&o.options.onopen(e,o),d.setBorder(d.getActive()),o.options.value){var u=g(o.options.value);M.forEach(function(e,t){e.value=u[t],e.dispatchEvent(new Event("input"))})}}},o.close=function(t){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),i.style.display="",t||"function"!=typeof o.options.onclose||o.options.onclose(e,o),n(o,!1)),o.options.value},o.setValue=function(t){t||(t=""),t!=o.options.value&&(o.options.value=t,L=t,o.select(t),"function"==typeof o.options.onchange&&o.options.onchange(e,t,o),e.value!=o.options.value&&(e.value=o.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value),"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),1==o.options.closeOnChange&&o.close())},o.getValue=function(){return o.options.value};var f=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},h=function(e,t,n){return"#"+f(e)+f(t)+f(n)},m=function(e){return parseInt("0x"+e)},g=function(e){return[m(e.substr(1,2)),m(e.substr(3,2)),m(e.substr(5,2))]},y=function(){var e=document.createElement("div");e.className="jcolor-grid",o.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<o.options.palette.length;n++){for(var r=document.createElement("tr"),i=0;i<o.options.palette[n].length;i++){var l=document.createElement("td"),a=o.options.palette[n][i];a.length<7&&"#"!==a.substr(0,1)&&(a="#"+a),l.style.backgroundColor=a,l.setAttribute("data-value",a),l.innerHTML="",r.appendChild(l),o.options.value==a&&l.classList.add("jcolor-selected"),o.values[a]=l}t.appendChild(r)}return e.appendChild(t),e},w=document.createElement("canvas");w.width=200,w.height=160;var C=w.getContext("2d"),x=function(){var e=u.firstChild.getBoundingClientRect();w.width=e.width-14,E()},E=function(){var e=C.createLinearGradient(0,0,w.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),C.fillStyle=e,C.fillRect(0,0,w.width,w.height),(e=C.createLinearGradient(0,0,0,w.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),C.fillStyle=e,C.fillRect(0,0,w.width,w.height)},A=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(w),n.appendChild(t),e.appendChild(n);var o=function(n,o,r){if(1===n){var i=e.getBoundingClientRect(),l=o-i.left,a=r-i.top;l<0&&(l=0),a<0&&(a=0),l>i.width&&(l=i.width),a>i.height&&(a=i.height),t.style.left=l+"px",t.style.top=a+"px";var s=C.getImageData(l,a,1,1).data;L=h(s[0],s[1],s[2])}};return e.addEventListener("mousedown",function(e){o(e.buttons,e.clientX,e.clientY)}),e.addEventListener("mousemove",function(e){o(e.buttons,e.clientX,e.clientY)}),e.addEventListener("touchmove",function(e){o(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}),e},L="",M=[],I=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var o=document.createElement("label");o.innerText=e;var r=document.createElement("div");r.className="jcolor-sliders-input-subcontainer";var i=document.createElement("input");i.type="range",i.min=0,i.max=255,i.value=0,i.setAttribute("aria-label","Color value"),i.setAttribute("aria-valuemin","0"),i.setAttribute("aria-valuemax","255"),i.setAttribute("aria-valuenow","0"),n.appendChild(o),r.appendChild(i);var l=document.createElement("div");return l.innerText=i.value,i.addEventListener("input",function(){l.innerText=i.value}),r.appendChild(l),n.appendChild(r),t.appendChild(n),i};M=[n("Red"),n("Green"),n("Blue")],e.appendChild(t);var o=document.createElement("div");o.className="jcolor-sliders-final-color";var r=document.createElement("div");r.style.visibility="hidden",r.innerText="a",o.appendChild(r);return M.forEach(function(e){e.addEventListener("input",function(){var e;e=h(parseInt(M[0].value),parseInt(M[1].value),parseInt(M[2].value)),r.innerText=e,r.style.color=e,r.style.removeProperty("visibility"),L=e,function(){if(""!==L)for(var e=0;e<M.length;e++){var t=g(L);t[e]=0;var n="linear-gradient(90deg, rgb(";n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",M[e].style.backgroundImage=n}}()})}),e.appendChild(o),e};return o.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};if(e)return/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&e.length?"#"+t(e[1])+t(e[2])+t(e[3]):""},function(){o.setOptions(t),"INPUT"==e.tagName&&(e.classList.add("jcolor-input"),e.readOnly=!0),(r=document.createElement("div")).className="jcolor",(i=document.createElement("div")).className="jcolor-backdrop",r.appendChild(i),(a=document.createElement("div")).className="jcolor-content";var n=document.createElement("div");n.className="jcolor-controls",a.appendChild(n),(s=document.createElement("div")).className="jcolor-reset",s.innerHTML=o.options.resetLabel,n.appendChild(s),(c=document.createElement("div")).className="jcolor-close",c.innerHTML=o.options.doneLabel,n.appendChild(c),u=document.createElement("div"),a.appendChild(u),d=b(u,{animation:!0,data:[{title:"Grid",contentElement:y()},{title:"Spectrum",contentElement:A()},{title:"Sliders",contentElement:I()}],onchange:function(e,t,n){if(1===n)x();else{var r=""!==L?L:o.getValue();if(2===n&&r){var i=g(r);M.forEach(function(e,t){e.value=i[t],e.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(a),"INPUT"==e.tagName?e.parentNode.insertBefore(r,e.nextSibling):e.appendChild(r),r.addEventListener("click",function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&o.setValue(t)}else e.target.classList.contains("jcolor-reset")?(o.setValue(""),o.close()):e.target.classList.contains("jcolor-close")?(d.getActive()>0&&o.setValue(L),o.close()):e.target.classList.contains("jcolor-backdrop")?o.close():o.open()}),e.addEventListener("mouseup",function(e){o.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&1==d.getActive()&&x()}),1==o.options.opened&&o.open(),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.color=o,r.color=o}(),o}var C=function(){var t=function(o,r){var i={type:"contextmenu",options:{}},l={items:null,onclick:null};for(var a in l)r&&r.hasOwnProperty(a)?i.options[a]=r[a]:i.options[a]=l[a];function s(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){c=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&c.setAttribute("title",e.tooltip),e.icon&&c.setAttribute("data-icon",e.icon),e.id&&(c.id=e.id),e.disabled?c.className="jcontextmenu-disabled":e.onclick&&(c.method=e.onclick,c.addEventListener("mousedown",function(e){e.preventDefault()}),c.addEventListener("mouseup",function(e){this.method(this,e)})),c.appendChild(t),e.submenu){var n=document.createElement("span");n.innerHTML="&#9658;",c.appendChild(n),c.classList.add("jcontexthassubmenu");var o=document.createElement("div");o.classList.add("jcontextmenu"),o.setAttribute("tabindex","900");for(var r=e.submenu,i=0;i<r.length;i++){var l=s(r[i]);o.appendChild(l)}c.appendChild(o)}else if(e.shortcut){var a=document.createElement("span");a.innerHTML=e.shortcut,c.appendChild(a)}}else var c=document.createElement("hr");return c}return o.classList.add("jcontextmenu"),i.open=function(e,r){if(r&&(i.options.items=r,i.create(r)),t.current&&t.current.close(),n(i,!0),o.classList.add("jcontextmenu-focus"),t.current=i,i.options.items&&i.options.items.length>0||o.children.length){if(e.target)if(e.changedTouches&&e.changedTouches[0])l=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY;else var l=e.clientX,a=e.clientY;else l=e.x,a=e.y;var s=o.getBoundingClientRect();if(window.innerHeight<a+s.height){var c=a-s.height;c<0&&(c=0),o.style.top=c+"px"}else o.style.top=a+"px";window.innerWidth<l+s.width?l-s.width>0?o.style.left=l-s.width+"px":o.style.left="10px":o.style.left=l+"px"}},i.isOpened=function(){return!!o.classList.contains("jcontextmenu-focus")},i.close=function(){o.classList.contains("jcontextmenu-focus")&&o.classList.remove("jcontextmenu-focus"),n(i,!1)},i.create=function(t){o.innerHTML="";var n=function(){var t=document.createElement("div");t.classList.add("header"),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()});var n=document.createElement("a");n.classList.add("title"),n.innerHTML=e.translate("Menu"),t.appendChild(n);var o=document.createElement("a");return o.classList.add("close"),o.innerHTML=e.translate("close"),o.addEventListener("click",function(e){i.close()}),t.appendChild(o),t}();o.appendChild(n);for(var r=0;r<t.length;r++){var l=s(t[r]);o.appendChild(l)}},"function"==typeof i.options.onclick&&o.addEventListener("click",function(e){i.options.onclick(i,e)}),i.options.items&&i.create(i.options.items),window.addEventListener("mousewheel",function(){i.close()}),o.contextmenu=i,i};return t}();var E=function(){var t=function(o,r){if(o.dropdown)return o.dropdown.setOptions(r,!0);var i={type:"dropdown",options:{}},a=function(e,t){e&&e.length&&(!1!==i.options.sortResults&&("function"==typeof i.options.sortResults?e.sort(i.options.sortResults):e.sort(s)),i.setData(e)),"function"==typeof i.options.onload&&i.options.onload(o,i,e,t),t&&d(t),null==t&&(i.options.value=""),o.value=i.options.value,1==i.options.opened&&i.open()},s=function(e,t){var n,o;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?o=t:t.text?o=t.text:t.name&&(o=t.name),"string"==typeof n||"string"==typeof o?("string"!=typeof n&&(n=""+n),"string"!=typeof o&&(o=""+o),n.localeCompare(o)):n-o},c=function(){i.value={};for(var e=0;e<i.items.length;e++)1==i.items[e].selected&&(i.items[e].element&&i.items[e].element.classList.remove("jdropdown-selected"),i.items[e].selected=null);i.options.value="",o.value=""},d=function(e){if(c(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)i.value[e[t]]=""}else void 0!==i.value[""]&&(i.value[""]="");for(t=0;t<i.items.length;t++)void 0!==i.value[h(t)]&&(i.items[t].element&&i.items[t].element.classList.add("jdropdown-selected"),i.items[t].selected=!0,i.value[h(t)]=m(t));i.options.value=Object.keys(i.value).join(";"),i.header.value=i.getText()},h=function(e,t){if(i.options.format)n="id";else var n="value";return i.items[e]?void 0!==t?i.items[e].data[n]=t:i.items[e].data[n]:""},m=function(e,t){if(i.options.format)n="name";else var n="text";return i.items[e]?void 0!==t?i.items[e].data[n]=t:i.items[e].data[n]:""},g=function(){return Object.keys(i.value)},v=function(){for(var e=[],t=Object.keys(i.value),n=0;n<t.length;n++)e.push(i.value[t[n]]);return e};i.setOptions=function(e,t){e||(e={});var n={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var r in n)e&&e.hasOwnProperty(r)?i.options[r]=e[r]:void 0!==i.options[r]&&!0!==t||(i.options[r]=n[r]);return 1!=i.options.remoteSearch&&"searchbar"!==i.options.type||(i.options.autocomplete=!0),1==i.options.newOptions?i.header.classList.add("jdropdown-add"):i.header.classList.remove("jdropdown-add"),1==i.options.autocomplete?i.header.removeAttribute("readonly"):i.header.setAttribute("readonly","readonly"),i.options.placeholder?i.header.setAttribute("placeholder",i.options.placeholder):i.header.removeAttribute("placeholder"),o.classList.remove("jdropdown-searchbar"),o.classList.remove("jdropdown-picker"),o.classList.remove("jdropdown-list"),"searchbar"==i.options.type?o.classList.add("jdropdown-searchbar"):"list"==i.options.type?o.classList.add("jdropdown-list"):"picker"==i.options.type?o.classList.add("jdropdown-picker"):l.getWindowWidth()<800?i.options.autocomplete?(o.classList.add("jdropdown-searchbar"),i.options.type="searchbar"):(o.classList.add("jdropdown-picker"),i.options.type="picker"):(i.options.width?(o.style.width=i.options.width,o.style.minWidth=i.options.width):(o.style.removeProperty("width"),o.style.removeProperty("min-width")),o.classList.add("jdropdown-default"),i.options.type="default"),"searchbar"==i.options.type?y.appendChild(C):b.insertBefore(C,b.firstChild),i.options.url&&!e.data?f({url:i.options.url,method:"GET",dataType:"json",success:function(e){e&&a(e,i.options.value)}}):a(i.options.data,i.options.value),i};var y=null,b=null,w=null,C=null,x=null,E=null,A=null;i.getUrl=function(){return i.options.url},i.setUrl=function(e,t){i.options.url=e,f({url:i.options.url,method:"GET",dataType:"json",success:function(e){i.setData(e),"function"==typeof t&&t(i)}})},i.setId=function(e,t){if(i.options.format)n="id";else var n="value";"object"==typeof e?e[n]=t:i.items[e].data[n]=t};const L=function(t,n){if(!t){let n=1==i.options.autocomplete?i.header.value:"";if(!(t=prompt(e.translate("Add A New Option"),n)))return!1}if(n||(n=l.guid()),i.options.format)o={id:n,name:t};else var o={value:n,text:t};if("function"==typeof i.options.onbeforeinsert){let e=i.options.onbeforeinsert(i,o);if(!1===e)return!1;e&&(o=e)}i.options.data.push(o);var r=i.createItem(o);return w.appendChild(r.element),"function"==typeof i.options.oninsert&&i.options.oninsert(i,o,r),"none"==w.style.display&&(w.style.display=""),i.results&&i.results.push(r),o};i.add=function(e,t){return"function"==typeof i.options.prompt?i.options.prompt.call(i,L):L(e,t)},i.createItem=function(e,t,n){i.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var o={};if(o.element=document.createElement("div"),o.element.className="jdropdown-item",o.element.indexValue=i.items.length,o.data=e,t&&(o.group=t),e.id&&o.element.setAttribute("id",e.id),1==e.disabled&&o.element.setAttribute("data-disabled",!0),e.tooltip&&o.element.setAttribute("title",e.tooltip),e.image){var r=document.createElement("img");r.className="jdropdown-image",r.src=e.image,e.title||r.classList.add("jdropdown-image-small"),o.element.appendChild(r)}else if(e.icon){var l=document.createElement("span");l.className="jdropdown-icon material-icons",l.innerText=e.icon,e.title||l.classList.add("jdropdown-icon-small"),e.color&&(l.style.color=e.color),o.element.appendChild(l)}else if(e.color){var a=document.createElement("div");a.className="jdropdown-color",a.style.backgroundColor=e.color,o.element.appendChild(a)}if(i.options.format)s=e.name;else var s=e.text;var c=document.createElement("div");if(c.className="jdropdown-description",c.textContent=s||"&nbsp;",e.title){var u=document.createElement("div");u.className="jdropdown-title",u.innerText=e.title,c.appendChild(u)}if(i.options.format)d=e.id;else var d=e.value;return i.value[d]&&(o.element.classList.add("jdropdown-selected"),o.selected=!0),i.items.push(o),o.element.appendChild(c),o},i.appendData=function(e){if(e.length){for(var t=[],n=[],o=0;o<e.length;o++)e[o].group?(n[e[o].group]||(n[e[o].group]=[]),n[e[o].group].push(o)):t.push(o);var r=0,l=Object.keys(n);if(l.length>0)for(o=0;o<l.length;o++){var a=document.createElement("div");a.className="jdropdown-group";var s=document.createElement("div");s.className="jdropdown-group-name",s.textContent=l[o];var c=document.createElement("i");c.className="jdropdown-group-arrow jdropdown-group-arrow-down",s.appendChild(c);var u=document.createElement("div");u.className="jdropdown-group-items";for(var d=0;d<n[l[o]].length;d++){var f=i.createItem(e[n[l[o]][d]],a,l[o]);(0==i.options.lazyLoading||r<200)&&(u.appendChild(f.element),r++)}a.appendChild(s),a.appendChild(u),i.groups.push(a),u.children.length>0&&w.appendChild(a)}if(t.length)for(o=0;o<t.length;o++)f=i.createItem(e[t[o]]),(0==i.options.lazyLoading||r<200)&&(w.appendChild(f.element),r++)}},i.setData=function(e){if(c(),w.textContent="",i.header.value="",i.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(i.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});i.appendData(e),i.options.data=e}else i.options.data=[];i.close()},i.getData=function(){return i.options.data},i.getPosition=function(e){for(var t=0;t<i.items.length;t++)if(h(t)==e)return t;return!1},i.getText=function(e){var t=v();return e?t:t.join("; ")},i.getValue=function(e){var t=g();return e?t:t.join(";")};var M=function(e){o.value!=i.options.value&&(o.value=i.options.value,"function"==typeof o.oninput&&o.oninput({type:"input",target:o,value:o.value})),"function"==typeof i.options.onchange&&i.options.onchange(o,i,e,i.options.value)};i.setValue=function(e){var t=i.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(d(e),M(t))},i.resetSelected=function(){i.setValue(null)},i.selectIndex=function(e,t){if(e=parseInt(e),i.items&&i.items[e]&&(!0===t||!0!==i.items[e].data.disabled))if(i.setCursor(e,!1),i.options.multiple){var n=i.options.value;i.items[e].selected?(i.items[e].element.classList.remove("jdropdown-selected"),i.items[e].selected=!1,delete i.value[h(e)]):(i.items[e].element.classList.add("jdropdown-selected"),i.items[e].selected=!0,i.value[h(e)]=m(e)),i.options.value=Object.keys(i.value).join(";"),0==i.options.autocomplete&&(i.header.value=v().join("; ")),M(n)}else i.items[e].selected?!1!==i.options.allowEmpty&&i.setValue(null):i.setValue(h(e)),i.close()},i.selectItem=function(e){i.selectIndex(e.indexValue)};var I=function(e,t){for(var n=0;n<t.length;n++)if(i.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1};return i.find=function(e){if(i.search==e.trim())return!1;if(i.search=e,i.setCursor(),i.groups.length)for(var t=0;t<i.groups.length;t++)i.groups[t].lastChild.textContent="";if(w.textContent="",1==i.options.remoteSearch){i.results=null;let t={url:i.options.url,method:"GET",data:{q:e},dataType:"json",success:function(e){i.items=[];var t=Object.keys(i.value);if(t.length)for(var n=0;n<t.length;n++)I(t[n],e)||(i.options.format?e.unshift({id:t[n],name:i.value[t[n]]}):e.unshift({value:t[n],text:i.value[t[n]]}));i.appendData(e),e.length?w.style.display="":w.style.display="none","function"==typeof i.options.onsearch&&i.options.onsearch(i,e)}};if("function"==typeof i.options.onbeforesearch){let e=i.options.onbeforesearch(i,t);if(!1===e)return;"object"==typeof e&&(t=e)}f(t)}else{e=new RegExp(e,"gi");var n=[];for(t=0;t<i.items.length;t++){var o=m(t),r=i.items[t].data.title||"",l=i.items[t].data.group||"",a=i.items[t].data.synonym||"";a&&(a=a.join(" ")),(null==e||1==i.items[t].selected||o.toString().match(e)||r.match(e)||l.match(e)||a.match(e))&&n.push(i.items[t])}if(n.length){w.style.display="",i.results=n;var s=n.length||0;for(1==i.options.lazyLoading&&s>200&&(s=200),t=0;t<s;t++)i.results[t].group?(i.results[t].group.parentNode||w.appendChild(i.results[t].group),i.results[t].group.lastChild.appendChild(i.results[t].element)):w.appendChild(i.results[t].element)}else w.style.display="none",i.results=null}1==i.options.autofocus&&i.first()},i.open=function(){if(!o.classList.contains("jdropdown-focus")){t.current=i,n(i,!0),o.classList.add("jdropdown-focus"),l.getWindowWidth()<800&&(null!=i.options.type&&"picker"!=i.options.type||p.slideBottom(b,1)),1==i.options.autocomplete&&(i.header.value=i.search,i.header.focus());var e=g();if(e[0]){var r=i.getPosition(e[0]);!1!==r&&i.setCursor(r)}if(!i.options.type||"default"==i.options.type){var a=o.getBoundingClientRect(),s=b.getBoundingClientRect();i.options.position?(b.style.position="fixed",window.innerHeight<a.bottom+s.height?(b.style.top="",b.style.bottom=window.innerHeight-a.top+1+"px"):(b.style.top=a.bottom+"px",b.style.bottom=""),b.style.left=a.left+"px"):window.innerHeight<a.bottom+s.height?(b.style.top="",b.style.bottom=a.height+1+"px"):(b.style.top="",b.style.bottom=""),b.style.minWidth=a.width+"px",i.options.maxWidth&&(b.style.maxWidth=i.options.maxWidth),i.items.length||1!=i.options.autocomplete?w.style.display="":w.style.display="none"}}"function"==typeof i.options.onopen&&i.options.onopen(o)},i.close=function(e){return o.classList.contains("jdropdown-focus")&&(i.header.value=i.getText(),i.setCursor(),e||"function"!=typeof i.options.onclose||i.options.onclose(o),i.header.blur&&i.header.blur(),o.classList.remove("jdropdown-focus"),n(i,!1),t.current=null),i.getValue()},i.setCursor=function(e,t){if(null!=i.currentIndex&&i.items&&i.items[i.currentIndex]&&i.items[i.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)i.currentIndex=null;else if(e=parseInt(e),i.items[e].element.parentNode&&(i.items[e].element.classList.add("jdropdown-cursor"),i.currentIndex=e,!1!==t&&i.items[i.currentIndex].element)){w.scrollTop;var n=i.items[i.currentIndex].element;w.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},i.resetCursor=i.setCursor,i.updateCursor=i.setCursor,i.reset=function(){i.setCursor(),i.setValue(null)},i.first=function(){!0===i.options.lazyLoading&&i.loadFirst();var e=w.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;i.setCursor(t)}},i.last=function(){!0===i.options.lazyLoading&&i.loadLast();var e=w.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;i.setCursor(t)}},i.next=function(e){var t=null;if(e){if(1==e.length){var n=i.currentIndex||-1;e=e.toLowerCase();var o=null,r=null,l=w.querySelectorAll(".jdropdown-item");if(l.length){for(var a=0;a<l.length;a++)if(l[a].indexValue>n&&(o=i.items[l[a].indexValue])&&(r=o.element.innerText[0])&&e==(r=r.toLowerCase())){t=l[a].indexValue;break}i.setCursor(t)}}}else if(null==i.currentIndex||null==i.currentIndex)i.first();else{var s=i.items[i.currentIndex].element,c=s.nextElementSibling;c?(c.classList.contains("jdropdown-group")&&(c=c.lastChild.firstChild),t=c.indexValue):s.parentNode.classList.contains("jdropdown-group-items")&&((c=s.parentNode.parentNode.nextElementSibling)&&(c.classList.contains("jdropdown-group")?c=c.lastChild.firstChild:c.classList.contains("jdropdown-item")?t=c.indexValue:c=null),c&&(t=c.indexValue)),null!==t&&i.setCursor(t)}},i.prev=function(){var e=null;if(null===i.currentIndex)i.first();else{var t=i.items[i.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&i.setCursor(e)},i.loadFirst=function(){if(i.results)var e=i.results;else e=i.items;var t=e.length||0;1==i.options.lazyLoading&&t>200&&(t=200),w.textContent="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||w.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):w.appendChild(e[n].element);w.scrollTop=0},i.loadLast=function(){if(i.results)var e=i.results;else e=i.items;var t=e.length;if(t>200){t-=200,w.textContent="";for(var n=t;n<e.length;n++)e[n].group?(e[n].group.parentNode||w.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):w.appendChild(e[n].element);w.scrollTop=w.scrollHeight}},i.loadUp=function(){var e=!1;if(i.results)var t=i.results;else t=i.items;var n=w.querySelectorAll(".jdropdown-item")[0].indexValue;n=i.items[n];var o=t.indexOf(n)-1;if(o>0){for(var r=0;o>0&&t[o]&&r<200;)t[o].group?(t[o].group.parentNode||w.insertBefore(t[o].group,w.firstChild),t[o].group.lastChild.insertBefore(t[o].element,t[o].group.lastChild.firstChild)):w.insertBefore(t[o].element,w.firstChild),o--,r++;e=!0}return e},i.loadDown=function(){var e=!1;if(i.results)var t=i.results;else t=i.items;var n=w.querySelectorAll(".jdropdown-item"),o=n[n.length-1].indexValue;o=i.items[o];var r=t.indexOf(o)+1;if(r<t.length){for(var l=0;r<t.length&&t[r]&&l<200;)t[r].group?(t[r].group.parentNode||w.appendChild(t[r].group),t[r].group.lastChild.appendChild(t[r].element)):w.appendChild(t[r].element),r++,l++;e=!0}return e},function(){if(r||(r={}),"SELECT"==o.tagName){var e=t.extractFromDom(o,r);o=e.el,r=e.options}!r.placeholder&&o.getAttribute("placeholder")&&(r.placeholder=o.getAttribute("placeholder")),i.value={},i.items=[],i.groups=[],i.search="",i.results=null,o.classList.add("jdropdown"),(y=document.createElement("div")).className="jdropdown-container-header",i.header=document.createElement("input"),i.header.className="jdropdown-header jss_object",i.header.type="text",i.header.setAttribute("autocomplete","off"),i.header.onfocus=function(){"function"==typeof i.options.onfocus&&i.options.onfocus(o)},i.header.onblur=function(){"function"==typeof i.options.onblur&&i.options.onblur(o)},i.header.onkeyup=function(e){1!=i.options.autocomplete||A?i.options.autocomplete||i.next(e.key):(i.search!=i.header.value.trim()&&(A=setTimeout(function(){i.find(i.header.value.trim()),A=null},400)),o.classList.contains("jdropdown-focus")||i.open())},t.hasEvents||(t.hasEvents=!0,document.addEventListener("keydown",t.keydown)),(b=document.createElement("div")).className="jdropdown-container",(w=document.createElement("div")).className="jdropdown-content",(C=document.createElement("div")).className="jdropdown-close",C.textContent="Done",(x=document.createElement("div")).className="jdropdown-reset",x.textContent="x",x.onclick=function(){i.reset(),i.close()},(E=document.createElement("div")).className="jdropdown-backdrop",y.appendChild(i.header),b.appendChild(w),o.appendChild(y),o.appendChild(b),o.appendChild(E),i.setOptions(r),"ontouchsend"in document.documentElement==1?o.addEventListener("touchsend",t.mouseup):o.addEventListener("mouseup",t.mouseup),1==i.options.lazyLoading&&u(w,{loadUp:i.loadUp,loadDown:i.loadDown}),w.onwheel=function(e){e.stopPropagation()},o.change=i.setValue,o.val=function(e){if(void 0===e)return i.getValue(!!i.options.multiple);i.setValue(e)},o.dropdown=i}(),i};return t.keydown=function(e){var n=null;if(n=t.current)if(13==e.which||9==e.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==e.which)null==n.currentIndex?n.first():n.currentIndex>0&&n.prev(),e.preventDefault();else if(40==e.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),e.preventDefault();else if(36==e.which)n.first(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(35==e.which)n.last(),e.target.classList.contains("jdropdown-header")||e.preventDefault();else if(27==e.which)n.close();else if(33==e.which){if(null==n.currentIndex)n.first();else if(n.currentIndex>0)for(var o=0;o<7;o++)n.prev();e.preventDefault()}else if(34==e.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(o=0;o<7;o++)n.next();e.preventDefault()}},t.mouseup=function(e){var t=l.findElement(e.target,"jdropdown");if(t){var n=t.dropdown;if(e.target.classList.contains("jdropdown-header"))if(t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")){var o=t.getBoundingClientRect();if(e.changedTouches&&e.changedTouches[0]){var r=e.changedTouches[0].clientX;e.changedTouches[0].clientY}else r=e.clientX,e.clientY;o.width-(r-o.left)<30?e.target.classList.contains("jdropdown-add")?n.add():n.close():0==n.options.autocomplete&&n.close()}else n.open();else if(e.target.classList.contains("jdropdown-group-name")){var i=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var a=0;a<i.length;a++)"none"!=i[a].style.display&&n.selectItem(i[a])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?n.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?n.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?n.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&n.close()}},t.extractFromDom=function(e,t){var n=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var o=0;o<e.children.length;o++)if("OPTGROUP"==e.children[o].tagName)for(var r=0;r<e.children[o].children.length;r++)t.data.push({value:e.children[o].children[r].value,text:e.children[o].children[r].textContent,group:e.children[o].getAttribute("label")});else t.data.push({value:e.children[o].value,text:e.children[o].textContent})}t&&null!=t.onchange||(t.onchange=function(e,o,r,i){1==t.multiple?obj.items[o].classList.contains("jdropdown-selected")?n.options[o].setAttribute("selected","selected"):n.options[o].removeAttribute("selected"):n.value=i});var i=document.createElement("div");return e.parentNode.insertBefore(i,e),e.style.display="none",{el:e=i,options:t}},t}();function A(e,t){if(e.picker)return e.picker.setOptions(t,!0);var o={type:"picker",options:{}},r=null,i=null,a=function(e){return e instanceof Element||e instanceof HTMLDocument};return o.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};for(var l in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(l)?o.options[l]=e[l]:void 0!==o.options[l]&&!0!==t||(o.options[l]=n[l]);return!1===o.options.header?r.style.display="none":r.style.display="",o.options.width?r.style.width=parseInt(o.options.width)+"px":r.style.width="",o.options.height?(i.style.maxHeight=o.options.height+"px",i.style.overflow="scroll"):i.style.overflow="",o.options.columns>0&&(o.options.grid?(i.classList.add("jpicker-grid"),i.style.gridTemplateColumns="repeat("+o.options.grid+", 1fr)"):(i.classList.add("jpicker-columns"),i.style.width=o.options.width?o.options.width:36*o.options.columns+"px")),isNaN(parseInt(o.options.value))&&(o.options.value=0),function(){i.innerHTML="";for(var e=Object.keys(o.options.data),t=0;t<e.length;t++){var n=document.createElement("div");n.classList.add("jpicker-item"),n.setAttribute("role","option"),n.k=e[t],n.v=o.options.data[e[t]];var r=o.getLabel(e[t],n);a(r)?n.appendChild(r):n.innerHTML=r,i.appendChild(n)}}(),o.setValue(o.options.value),o},o.getValue=function(){return o.options.value},o.setValue=function(t,n){if(o.setLabel(t),o.options.value=String(t),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),i.children[t]&&"generic"!==i.children[t].getAttribute("type")&&o.close(),n&&"function"==typeof o.options.onchange){var r=o.options.data[t];o.options.onchange(e,o,r,r,t,n)}},o.getLabel=function(e,t){var n=o.options.data[e]||null;return"function"==typeof o.options.render&&(n=o.options.render(n,t)),n},o.setLabel=function(e){var t;t=o.options.content?'<i class="material-icons">'+o.options.content+"</i>":o.getLabel(e,null),a(t)?(r.innerHTML="",r.appendChild(t)):r.innerHTML=t},o.open=function(){if(!e.classList.contains("jpicker-focus")){n(o,!0),e.classList.add("jpicker-focus"),e.focus();var t,l=0;i.style.marginLeft="";var a=r.getBoundingClientRect(),s=i.getBoundingClientRect();t=window.innerHeight<a.bottom+s.height||o.options.bottom?-1*(s.height+4):a.height+4,!0===o.options.right&&(l=-1*s.width+a.width),s.left+l<0&&(l=l+s.left+10),s.left+s.width>window.innerWidth&&(l=-1*(10+s.left+s.width-window.innerWidth)),i.style.marginTop=parseInt(t)+"px",i.style.marginLeft=parseInt(l)+"px","function"==typeof o.options.onopen&&o.options.onopen(e,o)}},o.close=function(){e.classList.contains("jpicker-focus")&&(e.classList.remove("jpicker-focus"),n(o,!1),"function"==typeof o.options.onclose&&o.options.onclose(e,o))},function(){let n=l.guid();e.classList.add("jpicker"),e.setAttribute("role","combobox"),e.setAttribute("aria-haspopup","listbox"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-controls",n),e.setAttribute("tabindex","0"),e.onmousedown=function(t){e.classList.contains("jpicker-focus")||o.open()},(r=document.createElement("div")).classList.add("jpicker-header"),(i=document.createElement("div")).setAttribute("id",n),i.setAttribute("role","listbox"),i.classList.add("jpicker-content"),i.onclick=function(e){var t=l.findElement(e.target,"jpicker-item");t&&t.parentNode===i&&o.setValue(t.k,e)},e.appendChild(r),e.appendChild(i),e.value=t.value||0,o.setOptions(t),"function"==typeof o.options.onload&&o.options.onload(e,o),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.picker=o}(),o}function L(e,t){var o={type:"toolbar",options:{}},r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var i in r)t&&t.hasOwnProperty(i)?o.options[i]=t[i]:o.options[i]=r[i];!e&&t.app&&t.app.el&&(e=document.createElement("div"),t.app.el.appendChild(e));var a=document.createElement("div");a.classList.add("jtoolbar-item"),a.classList.add("jtoolbar-arrow");var s=document.createElement("div");s.classList.add("jtoolbar-floating"),a.appendChild(s),o.selectItem=function(e){for(var t=c.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},o.hide=function(){p.slideBottom(e,0,function(){e.style.display="none"})},o.show=function(){e.style.display="",p.slideBottom(e,1)},o.get=function(){return e},o.setBadge=function(e,t){c.children[e].children[1].firstChild.innerHTML=t},o.destroy=function(){toolbar.remove(),e.innerHTML=""},o.update=function(t,n){for(var r=0;r<c.children.length;r++)"function"==typeof(i=c.children[r]).updateState&&i.updateState(e,o,i,t,n);for(r=0;r<s.children.length;r++){var i;"function"==typeof(i=s.children[r]).updateState&&i.updateState(e,o,i,t,n)}},o.create=function(t){c.innerHTML="";for(var n=0;n<t.length;n++){var r=document.createElement("div");if(r.classList.add("jtoolbar-item"),t[n].width&&(r.style.width=parseInt(t[n].width)+"px"),t[n].k&&(r.k=t[n].k),t[n].tooltip&&(r.setAttribute("title",t[n].tooltip),r.setAttribute("aria-label",t[n].tooltip)),t[n].id&&r.setAttribute("id",t[n].id),t[n].updateState&&(r.updateState=t[n].updateState),t[n].active&&r.classList.add("jtoolbar-active"),t[n].disabled&&r.classList.add("jtoolbar-disabled"),"select"==t[n].type||"dropdown"==t[n].type)A(r,t[n]);else if("divisor"==t[n].type)r.classList.add("jtoolbar-divisor");else if("label"==t[n].type)r.classList.add("jtoolbar-label"),r.innerHTML=t[n].content;else{var i=document.createElement("i");if(void 0===t[n].class)i.classList.add("material-icons");else for(var l=t[n].class.split(" "),a=0;a<l.length;a++)i.classList.add(l[a]);if(i.innerHTML=t[n].content?t[n].content:"",r.setAttribute("role","button"),r.appendChild(i),1==o.options.badge){var s=document.createElement("div");s.classList.add("jbadge");var u=document.createElement("div");u.innerHTML=t[n].badge?t[n].badge:"",s.appendChild(u),r.appendChild(s)}if(t[n].title)if(1==o.options.title){var d=document.createElement("span");d.innerHTML=t[n].title,r.appendChild(d)}else r.setAttribute("title",t[n].title);o.options.app&&t[n].route&&(r.route=t[n].route,r.onclick=function(){o.options.app.pages(this.route)},o.options.app.pages(t[n].route,{toolbarItem:r,closed:!0})),"function"==typeof t[n].render&&t[n].render(r,t[n])}t[n].onclick&&(r.onclick=t[n].onclick.bind(t[n],e,o,r)),c.appendChild(r)}setTimeout(function(){o.refresh()},0)},o.open=function(){a.classList.add("jtoolbar-arrow-selected"),e.getBoundingClientRect(),s.getBoundingClientRect().bottom>window.innerHeight||o.options.bottom?s.style.bottom="0":s.style.removeProperty("bottom"),s.style.right="0",a.children[0].focus(),n(o,!0)},o.close=function(){a.classList.remove("jtoolbar-arrow-selected"),n(o,!1)},o.refresh=function(){if(1==o.options.responsive){var t=e.parentNode.getBoundingClientRect();o.options.maxWidth||(o.options.maxWidth=t.width);var n=parseInt(o.options.maxWidth);for(a.parentNode&&a.parentNode.removeChild(a);s.firstChild;)c.appendChild(s.firstChild);if(n<c.offsetWidth)for(n-=50;c.lastChild&&n<c.offsetWidth;)s.insertBefore(c.lastChild,s.firstChild);s.children.length>0&&c.appendChild(a)}},o.setReadonly=function(t){t=t?"add":"remove",e.classList[t]("jtoolbar-disabled")},e.onclick=function(e){var t=l.findElement(e.target,"jtoolbar-item");t&&o.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&o.open()},window.addEventListener("resize",function(){o.refresh()}),e.classList.add("jtoolbar"),e.innerHTML="",1==o.options.container&&e.classList.add("jtoolbar-container");var c=document.createElement("div");return e.appendChild(c),o.options.app&&e.classList.add("jtoolbar-mobile"),o.create(o.options.items),e.toolbar=o,o}var M=function(){var e=function(t,n){var o={type:"editor",options:{}},r={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];var a=null,s=null,c=[];o.el=t,"function"==typeof o.options.onclick&&(t.onclick=function(e){o.options.onclick(t,o,e)}),t.classList.add("jeditor-container");var u=document.createElement("div");u.className="jsnippet",u.setAttribute("contenteditable",!1);var d=document.createElement("div");if(d.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)f({url:o.options.url,dataType:"html",success:function(t){o.editor.innerHTML=t,e.setCursor(o.editor,"initial"==o.options.focus)}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var p=0;p<t.children.length;p++)o.editor.appendChild(t.children[p]);t.innerHTML="";var h=function(e){"function"==typeof o.options.onchange&&o.options.onchange(t,o,e),o.options.value=o.getData(),t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},m=function(){var e=null;if(e=u.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}};o.appendSnippet=function(e){u.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var r=document.createElement("div");if(r.className="jsnippet-"+t[n],r.setAttribute("data-k",t[n]),u.appendChild(r),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var i=0;i<e.image.length;i++){var l=document.createElement("img");l.src=e.image[i],r.appendChild(l)}}else r.innerHTML=e[t[n]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(u)},o.setData=function(t){o.editor.innerHTML="object"==typeof t?t.content:t,o.options.focus&&e.setCursor(o.editor,!0),c=[]},o.getFiles=function(){for(var e=o.editor.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)c[e[n].src]&&t.push(c[e[n].src]);return t},o.getText=function(){return o.editor.innerText},o.getData=function(e){if(e){if(d={content:""},u.innerHTML){d.snippet={};for(var t=0;t<u.children.length;t++){var n=u.children[t].getAttribute("data-k");if(n)if("image"==n){d.snippet.image||(d.snippet.image=[]);for(var r=0;r<u.children[t].children.length;r++)d.snippet.image.push(u.children[t].children[r].getAttribute("src"))}else d.snippet[n]=u.children[t].innerHTML}}var i=Object.keys(c);if(i.length)for(d.files=[],t=0;t<i.length;t++)d.files.push(c[i[t]]);var l=document.createElement("div");l.innerHTML=o.editor.innerHTML;var a=l.querySelector(".jsnippet");a&&a.remove();var s=l.innerHTML;s=(s=(s=s.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),d.content=s.trim(),O("getData",d)}else var d=o.editor.innerHTML;return d},o.reset=function(){o.editor.innerHTML="",u.innerHTML="",c=[]},o.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob(function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",c[n.src]={file:n.src,extension:"pdf",content:e.result},document.execCommand("insertHtml",!1,n.outerHTML)})}},o.addImage=function(e,t){if(o.options.acceptImages)if(e||(e=""),"data"==e.substr(0,4)||o.options.remoteParser){if("data"==e.substr(0,4))n=(n=(n=e.split(";"))[0].split("/"))[1];else{var n=e.substr(e.lastIndexOf(".")+1);e=o.options.remoteParser+e}var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toBlob(function(i){var l,a=document.createElement("img");a.src=window.URL.createObjectURL(i),a.classList.add("jfile"),a.setAttribute("tabindex","900"),a.setAttribute("width",r.width),a.setAttribute("height",r.height),c[a.src]={file:a.src,extension:n,content:e.toDataURL()},o.options.dropAsSnippet||t?(l=a,u.innerHTML||o.appendSnippet({}),u.children[0].appendChild(l),m(),c[a.src].snippet=!0):document.execCommand("insertHtml",!1,a.outerHTML),h()})},r.src=e}else console.error("remoteParser not defined in your initialization")},o.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>o.options.maxFileSize)alert("The file is too big");else{var r=e[n].type.split("/");(r="image"==r[0]?1:"pdf"==r[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=r,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",function(e){2==e.target.type?1==o.options.acceptFiles&&o.addPdf(e.target):o.addImage(e.target.result)},!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",S),o.editor.removeEventListener("mousedown",j),o.editor.removeEventListener("mousemove",D),o.editor.removeEventListener("keyup",_),o.editor.removeEventListener("keydown",N),o.editor.removeEventListener("dragstart",x),o.editor.removeEventListener("dragenter",E),o.editor.removeEventListener("dragover",A),o.editor.removeEventListener("drop",M),o.editor.removeEventListener("paste",C),o.editor.removeEventListener("blur",I),o.editor.removeEventListener("focus",T),t.editor=null,t.classList.remove("jeditor-container"),d.remove(),u.remove(),o.editor.remove()},o.upload=function(){l.click(o.file)};const g=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],v=["width","height","align","border","src","tabindex"],y=["color","font-weight","font-size","background","background-color","margin"],b=function(e){if(e.tagName&&-1===g.indexOf(e.tagName.toLowerCase())&&e.innerText&&(e.innerHTML=e.innerText),e.attributes&&e.attributes.length){let t=null,n=e.getAttribute("style");if(n){t=[];let e=n.split(";");for(let n=0;n<e.length;n++){let o=e[n].trim().split(":");if(y.indexOf(o[0].trim())>=0){let e=o.shift();o=o.join(":"),t.push(e+":"+o)}}}"IMG"===e.tagName.toUpperCase()&&(o.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),o.addImage(e.src)):e.parentNode.removeChild(e));let r=[];for(let t=0;t<e.attributes.length;t++)r.push(e.attributes[t].name);r.length&&r.forEach(function(t){-1===v.indexOf(t)?e.removeAttribute(t):e.attributes&&e.attributes[p]&&-1!==e.attributes[p].value.indexOf("<")&&e.attributes[p].value.replace("<","&#60;")}),e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(let t=e.children.length;t>0;t--)b(e.children[t-1])};var w=function(e){var t=window.getSelection(),n=document.createRange();n.selectNode(e),t.addRange(n)},C=function(e){if(1==o.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),r=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),r=window.clipboardData.files);if(r.length)o.addFile(r);else if(t){var i=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");b(t);var n=document.createElement("div");return n.innerHTML=t.firstChild.innerHTML,n}(t);document.execCommand("insertHtml",!1,i.innerHTML)}else t=n.split("\r\n"),e.target.innerText?(t=t.map(function(e){return"<div>"+e+"</div>"}),document.execCommand("insertText",!1,t.join(""))):t.map(function(e){var t=document.createElement("div");t.innerText=e,o.editor.appendChild(t)});e.preventDefault()}},x=function(e){s&&s.e&&e.preventDefault()},E=function(e){s||0==o.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},A=function(e){s||0==o.options.dropZone||(a&&clearTimeout(a),a=setTimeout(function(){t.classList.remove("jeditor-dragging")},100),e.preventDefault())},M=function(e){if(s||0==o.options.dropZone);else{var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),r.anchorNode.parentNode.focus();var i=(e.originalEvent||e).dataTransfer.getData("text/html"),l=(e.originalEvent||e).dataTransfer.getData("text/plain"),a=(e.originalEvent||e).dataTransfer.files;a.length?o.addFile(a):l&&function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("img");if(n.length)for(var r=0;r<n.length;r++)o.addImage(n[r].src)}(i),t.classList.remove("jeditor-dragging"),e.preventDefault()}},I=function(e){O("onevent",e),h(e),"function"==typeof o.options.onblur&&o.options.onblur(t,o,e)},T=function(e){"function"==typeof o.options.onfocus&&o.options.onfocus(t,o,e)},_=function(e){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),"function"==typeof o.options.onkeyup&&o.options.onkeyup(t,o,e)},N=function(e){if(O("onevent",e),"Delete"==e.key&&"IMG"==e.target.tagName){var n=e.target.parentNode;w(e.target),n.classList.contains("jsnippet-image")&&m()}"function"==typeof o.options.onkeydown&&o.options.onkeydown(t,o,e)},S=function(e){if(s&&s.e&&(s.e.classList.remove("resizing"),1==s.e.changed)){var t=s.e.cloneNode();t.width=parseInt(s.e.style.width)||s.e.getAttribute("width"),t.height=parseInt(s.e.style.height)||s.e.getAttribute("height"),s.e.style.width="",s.e.style.height="",w(s.e),document.execCommand("insertHtml",!1,t.outerHTML)}s=!1},j=function(e){var t=function(t){var n=t.getBoundingClientRect();n.width-(e.clientX-n.left)<40&&e.clientY-n.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var n=e.target.getBoundingClientRect();s={e:e.target,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:e.target.style.cursor},e.target.getAttribute("width")||e.target.setAttribute("width",n.width),e.target.getAttribute("height")||e.target.setAttribute("height",n.height);var o=window.getSelection();if(o.rangeCount)for(var r=0;r<o.rangeCount;r++)o.removeRange(o.getRangeAt(r));e.target.classList.add("resizing")}else s=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),s=!0},D=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==o.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&s&&s.d){if("e-resize"==s.d||"ne-resize"==s.d||"se-resize"==s.d)if(s.e.style.width=s.w+(e.clientX-s.x),e.shiftKey){var n=(e.clientX-s.x)*(s.h/s.w);s.e.style.height=s.h+n}else n=null;n||"s-resize"!=s.d&&"se-resize"!=s.d&&"sw-resize"!=s.d||e.shiftKey||(s.e.style.height=s.h+(e.clientY-s.y)),s.e.changed=!0}},O=function(e,t){if(o.options.extensions){var n=Object.keys(o.options.extensions);if(n.length)for(var r=0;r<n.length;r++)o.options.extensions[n[r]]&&"function"==typeof o.options.extensions[n[r]][e]&&o.options.extensions[n[r]][e].call(o,t)}};if(document.addEventListener("mouseup",S),document.addEventListener("mousemove",D),o.editor.addEventListener("mousedown",j),o.editor.addEventListener("keyup",_),o.editor.addEventListener("keydown",N),o.editor.addEventListener("dragstart",x),o.editor.addEventListener("dragenter",E),o.editor.addEventListener("dragover",A),o.editor.addEventListener("drop",M),o.editor.addEventListener("paste",C),o.editor.addEventListener("focus",T),o.editor.addEventListener("blur",I),t.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var k={container:!0,responsive:!0,items:o.options.toolbar};else k=!0===o.options.toolbar?{container:!0,responsive:!0,items:[]}:o.options.toolbar;k.items&&k.items.length||(k.items=e.getDefaultToolbar(o)),o.options.toolbarOnTop?(t.classList.add("toolbar-on-top"),t.insertBefore(d,t.firstChild)):(o.editor.style.padding="15px",t.appendChild(d)),L(d,k),d.addEventListener("click",function(){o.editor.focus()})}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},t.appendChild(o.file),o.options.focus&&e.setCursor(o.editor,"initial"==o.options.focus),t.change=o.setData,t.val=function(e){if(void 0===e){var n="true"!==t.getAttribute("data-html");return o.getData(n)}o.setData(e)},function(){if(o.options.extensions){var e=Object.keys(o.options.extensions);if(e.length)for(var n=0;n<e.length;n++)o.options.extensions[e[n]]&&"function"==typeof o.options.extensions[e[n]]&&(o.options.extensions[e[n]]=o.options.extensions[e[n]](t,o))}}(),t.editor=o,"function"==typeof o.options.onload&&o.options.onload(t,o,o.editor),o};return e.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),o=n.getRangeAt(0);if(1==t)var r=o.startContainer,i=0;else i=(r=o.endContainer).length;o.setStart(r,i),o.setEnd(r,i),n.removeAllRanges(),n.addRange(o)},e.getDefaultToolbar=function(e){var t=function(e,t,n){n.color||(w(n,{onchange:function(e,t){"color"===n.k?document.execCommand("foreColor",!1,t):document.execCommand("backColor",!1,t)}}),n.color.open())},n=[];return n.push({content:"undo",onclick:function(){document.execCommand("undo")}}),n.push({content:"redo",onclick:function(){document.execCommand("redo")}}),n.push({type:"divisor"}),e.options.toolbarOnTop&&(n.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,n,o,r){document.execCommand("fontName",!1,o)}}),n.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,n,o,r){document.execCommand("fontSize",!1,parseInt(r)+1)}}),n.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(e){return'<i class="material-icons">'+e+"</i>"},onchange:function(e,t,n,o,r){document.execCommand(["JustifyLeft","justifyCenter","justifyRight","justifyFull"][r])}}),n.push({type:"divisor"}),n.push({content:"format_color_text",k:"color",onclick:t}),n.push({content:"format_color_fill",k:"background-color",onclick:t})),n.push({content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({type:"divisor"}),n.push({content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),e.options.toolbarOnTop&&(n.push({type:"divisor"}),n.push({content:"photo",onclick:function(){e.upload()}}),n.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(e,t){t&&(t.onmouseover=this.onmouseover,e=e.split("x"),t.setAttribute("data-x",e[0]),t.setAttribute("data-y",e[1]));var n=document.createElement("div");return t.style.margin="1px",t.style.border="1px solid #ddd",n},onmouseover:function(e){for(var t=parseInt(e.target.getAttribute("data-x")),n=parseInt(e.target.getAttribute("data-y")),o=0;o<e.target.parentNode.children.length;o++){var r=e.target.parentNode.children[o],i=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y"));i<=t&&l<=n?(r.style.backgroundColor="#cae1fc",r.style.borderColor="#2977ff"):(r.style.backgroundColor="",r.style.borderColor="#ddd")}},onchange:function(e,t,n){n=n.split("x");for(var o=document.createElement("table"),r=document.createElement("tbody"),i=0;i<=n[1];i++){for(var l=document.createElement("tr"),a=0;a<=n[0];a++){var s=document.createElement("td");s.innerHTML="",l.appendChild(s)}r.appendChild(l)}o.appendChild(r),o.setAttribute("width","100%"),o.setAttribute("cellpadding","6"),o.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,o.outerHTML)}})),n},e}();var I=function(){var e=function(t,n){var o={options:{}},r={type:"big",title:"Untitled",width:510,height:472};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(e.elements.indexOf(o.container),1),o.updatePosition(),t.remove()},o.updatePosition=function(){for(var t=0;t<e.elements.length;t++){var n=e.elements[t],o=e.elements[t-1];n.style.right=t*(o?o.offsetWidth:n.offsetWidth)*1.01+"px"}},o.init=function(){(function(){for(var e=document.createElement("div");t.children[0];)e.appendChild(t.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=t.innerHTML;e.children[0];)o.content.appendChild(e.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),t.innerHTML="",t.appendChild(o.container)})(),o.container&&o.container.addEventListener("click",function(e){var t=e.target.getBoundingClientRect();if(e.target.classList.contains("jfloating")){if(e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY;else n=e.clientX,r=e.clientY;t.width-(n-t.left)<50&&r-t.top<50?setTimeout(function(){o.close()},100):o.setState()}}),o.container.classList.add("jfloating-"+o.options.type),e.elements.push(o.container),o.updatePosition(),t.floating=o},o.init(),o};return e.elements=[],e}();var T=function(){const e=function(e){return!isNaN(e)&&null!==e&&("string"!=typeof e||""!==e.trim())},t={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},n={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},o={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},r=function(e,t){return"function"==typeof r[t.type]?!(!t.allowBlank||void 0!==e&&""!==e&&null!==e)||r[t.type].call(this,e,t):null};r.url=function(e){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)},r.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},r.required=function(e){return!(!e||!e.trim())},r.empty=function(e){return null==e||"string"==typeof e&&!e.toString().trim()},r["not exist"]=r.empty,r.notEmpty=function(e){return!r.empty(e)},r.exist=r.notEmpty,r.number=function(n,o){if(!e(n))return!1;if(!o||!o.criteria)return!0;if(!t[o.criteria])return!1;let r=o.value.map(function(e){return parseFloat(e)});return t[o.criteria](n,r)},r.login=function(e){let t=new RegExp(/^[a-zA-Z0-9._-]+$/);return!(!e||!t.test(e))},r.list=function(e,t){let n,o=typeof e;return("string"===o||"number"===o)&&(n="string"==typeof t.value[0]?t.source?t.source:t.value[0].split(","):t.value[0],!!Array.isArray(n)&&n.findIndex(function(t){return t==e})>-1)};const i=function(){let e=new Date;return e.setHours(0,0,0,0),e},l={"one year ago":function(){let e=i();return e.setFullYear(e.getFullYear()-1),e},"one month ago":function(){let e=i();return e.setMonth(e.getMonth()-1),e},"one week ago":function(){let e=i();return e.setDate(e.getDate()-7),e},yesterday:function(){let e=i();return e.setDate(e.getDate()-1),e},today:i,tomorrow:function(){let e=i();return e.setDate(e.getDate()+1),e}};return r.date=function(t,o){if(e(t)&&t>0&&t<1e6&&(t=h.numToDate(t)),"Invalid Date"==new Date(t))return!1;if(!o||!o.criteria)return!0;if(!n[o.criteria])return!1;let r=o.value.map(function(e){return"string"==typeof e&&l[e]?l[e]().getTime():new Date(e).getTime()});return n[o.criteria](new Date(t).getTime(),r)},r.text=function(e,t){if(null==e)e="";else if("string"!=typeof e)return!1;return!t||!t.criteria||!!o[t.criteria]&&o[t.criteria](e,t.value)},r.textLength=function(e,t){let n;return n="string"==typeof e?e.length:null!=e&&"function"==typeof e.toString?e.toString().length:0,r.number(n,t)},r.time=function(n,o){if(!e(n))return!1;if(!o||!o.criteria)return!0;if(!t[o.criteria])return!1;let r=o.value.map(function(e){return parseInt(parseFloat(e)*10**17)/10**17});return t[o.criteria](parseInt(parseFloat(n)*10**17)/10**17,r)},r}();var _=function(){var e=function(t,n){var o={options:{}},r={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){alert(t)}};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=t.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=T.email),o.options.validations.length||(o.options.validations.length=T.length),o.options.validations.required||(o.options.validations.required=T.required),o.setUrl=function(e){o.options.url=e},o.load=function(){f({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof o.options.onbeforeload){var r=o.options.onbeforeload(t,n);r&&(n=r)}e.setElements(t,n),"function"==typeof o.options.onload&&o.options.onload(t,n)}})},o.save=function(){var n=o.validate();if(n)o.options.onerror(t,n);else{var r=e.getElements(t,!0);if("function"==typeof o.options.onbeforesave&&!1===(r=o.options.onbeforesave(t,r)))return;f({url:o.options.url,method:"POST",dataType:"json",data:r,success:function(e){"function"==typeof o.options.onsave&&o.options.onsave(t,r,e)}})}},o.remove=function(){if("function"==typeof o.options.onbeforeremove&&!1===o.options.onbeforeremove(t,o))return!1;f({url:o.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof o.options.onremove&&o.options.onremove(t,o,e),o.reset()}})};return o.validateElement=function(n){var r=!1,i=e.getValue(n),l=n.getAttribute("data-validation");return"function"!=typeof o.options.validations[l]||o.options.validations[l](i,n)?n.classList.contains("error")&&function(e){var n=!1;e.classList.remove("error"),e.removeAttribute("title");for(var r=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++)r[i].getAttribute("data-validation")&&r[i].classList.contains("error")&&(n=!0);o.options.submitButton&&(n?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))}(n):r=function(e){e.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(n),r},o.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},o.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),r=0;r<n.length;r++)if(n[r].getAttribute("data-validation")){var i=o.validateElement(n[r]);i&&e.push(i)}return e.length>0&&e.join("<br>")},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(e.getElements(t))},o.getHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},o.isChanged=function(){var e=o.setHash();return o.options.currentHash!=e},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(e){o.options.ignore=!!e},setTimeout(function(){o.options.currentHash=o.setHash()},1e3),t.addEventListener("keyup",function(e){e.target.getAttribute("data-validation")&&o.validateElement(e.target)}),e.hasEvents||(window.addEventListener("beforeunload",function(e){if(o.isChanged()&&0==o.options.ignore){var t=o.options.message?o.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}}),e.hasEvents=!0),t.form=o,o};return e.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var n=e.querySelectorAll("options[selected]"),o=0;o<n.length;o++)t.push(n[o].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.getElements=function(t,n){for(var o={},r=null,i=t.querySelectorAll("input, select, textarea, div[name]"),l=0;l<i.length;l++)(r=i[l].getAttribute("name"))&&(o[r]=e.getValue(i[l])||"");return 1==n?o:JSON.stringify(o)},e.setElements=function(e,t){for(var n=null,o=null,r=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++){var l=r[i].getAttribute("type");if(n=r[i].getAttribute("name")){if(o=null,(n=n.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var a=s.call(t,n)||"";void 0!==a&&(o=a)}else void 0!==t[n]&&(o=t[n]);null!==o&&("checkbox"==l||"radio"==l?r[i].checked=!!o:"file"==l||("function"==typeof r[i].val?r[i].val(o):r[i].value=o))}}},e}();var N=function(){var e=function(){var e=null;document.addEventListener("keydown",function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()}),document.addEventListener("mouseup",function(t){let n=t.composedPath();var o=l.findElement(n[0],"jmodal");if(o){var r=o.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else i=t.clientX,a=t.clientY;r.width-(i-r.left)<50&&a-r.top<50&&o.parentNode.modal.close()}e&&(e.element.style.cursor="auto",e=null)}),document.addEventListener("mousedown",function(t){let n=t.composedPath();var o=l.findElement(n[0],"jmodal");if(o){var r=o.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY;else i=t.clientX,a=t.clientY;r.width-(i-r.left)<50&&a-r.top<50||a-r.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e={left:r.left,top:r.top,x:t.clientX,y:t.clientY,width:r.width,height:r.height,element:o})}}),document.addEventListener("mousemove",function(t){if(e){if((t=t||window.event).buttons)var n=t.buttons;else n=t.button?t.button:t.which;n?(e.element.style.top=e.top+(t.clientY-e.y)+e.height/2+"px",e.element.style.left=e.left+(t.clientX-e.x)+e.width/2+"px",e.element.style.cursor="move"):e.element.style.cursor="auto"}})};return function(t,n){var o={options:{}},r={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];!o.options.title&&t.getAttribute("title")&&(o.options.title=t.getAttribute("title"));for(var a=document.createElement("div");t.children[0];)a.appendChild(t.children[0]);for(o.title=document.createElement("div"),o.title.className="jmodal_title",o.options.icon&&o.title.setAttribute("data-icon",o.options.icon),o.content=document.createElement("div"),o.content.className="jmodal_content",o.content.innerHTML=t.innerHTML;a.children[0];)o.content.appendChild(a.children[0]);if(o.container=document.createElement("div"),o.container.className="jmodal",o.container.appendChild(o.title),o.container.appendChild(o.content),o.options.padding&&(o.content.style.padding=o.options.padding),o.options.width&&(o.container.style.width=o.options.width),o.options.height&&(o.container.style.height=o.options.height),o.options.title){var s=document.createElement("h4");s.innerText=o.options.title,o.title.appendChild(s)}if(t.innerHTML="",t.style.display="none",t.appendChild(o.container),o.options.backdrop){var c=document.createElement("div");c.className="jmodal_backdrop",c.onclick=function(){o.close()},t.appendChild(c)}return o.open=function(){t.style.display="block";var e=o.container.getBoundingClientRect();l.getWindowWidth()<e.width?(o.container.style.top="",o.container.style.left="",o.container.classList.add("jmodal_fullscreen"),p.slideBottom(o.container,1)):o.options.backdrop&&(c.style.display="block"),"function"==typeof o.options.onopen&&o.options.onopen(t,o)},o.resetPosition=function(){o.container.style.top="",o.container.style.left=""},o.isOpen=function(){return"none"!=t.style.display},o.close=function(){o.isOpen()&&(t.style.display="none",o.options.backdrop&&(c.style.display=""),o.container.classList.remove("jmodal_fullscreen"),"function"==typeof o.options.onclose&&o.options.onclose(t,o))},o.options.url?f({url:o.options.url,method:"GET",dataType:"text/html",success:function(e){o.content.innerHTML=e,o.options.closed||o.open(),"function"==typeof o.options.onload&&o.options.onload(o)}}):(o.options.closed||o.open(),"function"==typeof o.options.onload&&o.options.onload(o)),t.modal=o,e(),e=function(){},o}}();var S=function(){var e=function(e){var t={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var o in n)e&&e.hasOwnProperty(o)?t.options[o]=e[o]:t.options[o]=n[o];var r=document.createElement("div");r.className="jnotification",t.options.error&&r.classList.add("jnotification-error");var i=document.createElement("div");i.className="jnotification-container",r.appendChild(i);var a=document.createElement("div");a.className="jnotification-header",i.appendChild(a);var s=document.createElement("div");if(s.className="jnotification-image",a.appendChild(s),t.options.icon){var c=document.createElement("img");c.src=t.options.icon,s.appendChild(c)}var u=document.createElement("div");if(u.className="jnotification-name",u.innerHTML=t.options.name,a.appendChild(u),1==t.options.closeable){var d=document.createElement("div");d.className="jnotification-close",d.onclick=function(){t.hide()},a.appendChild(d)}var f=document.createElement("div");f.className="jnotification-date",a.appendChild(f);var h=document.createElement("div");if(h.className="jnotification-content",i.appendChild(h),t.options.title){var m=document.createElement("div");m.className="jnotification-title",m.innerHTML=t.options.title,h.appendChild(m)}var g=document.createElement("div");if(g.className="jnotification-message",g.innerHTML=t.options.message,h.appendChild(g),t.show=function(){document.body.appendChild(r),l.getWindowWidth()>800?p.fadeIn(r):p.slideTop(r,1)},t.hide=function(){l.getWindowWidth()>800?p.fadeOut(r,function(){r.parentNode&&(r.parentNode.removeChild(r),v&&clearTimeout(v))}):p.slideTop(r,0,function(){r.parentNode&&(r.parentNode.removeChild(r),v&&clearTimeout(v))})},t.show(),1==t.options.autoHide)var v=setTimeout(function(){t.hide()},t.options.timeout);return l.getWindowWidth()<800&&r.addEventListener("swipeup",function(e){t.hide(),e.preventDefault(),e.stopPropagation()}),t};return e.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e}();function j(e,t){if(e.search)return e.search;var n=null,o=function(t){if("function"==typeof a.options.onsearch){var n=a.options.onsearch(a,t);n&&(t=n)}if(s.innerHTML="",t.length){e.style.display="block";for(var o=t.length<11?t.length:10,r=0;r<o;r++){if("string"==typeof t[r])var i=t[r],l=t[r];else!(i=t[r].text)&&t[r].name&&(i=t[r].name),!(l=t[r].value)&&t[r].id&&(l=t[r].id);var c=document.createElement("div");c.setAttribute("data-value",l),c.setAttribute("data-text",i),c.className="jsearch_item",t[r].id&&c.setAttribute("id",t[r].id),a.options.forceSelect&&0==r&&c.classList.add("selected");var u=document.createElement("img");t[r].image?u.src=t[r].image:u.style.display="none",c.appendChild(u);var d=document.createElement("div");d.innerHTML=i,c.appendChild(d),s.appendChild(c)}}else e.style.display=""},r=function(e){if(e!=a.terms)if(a.terms=e,n=a.options.forceSelect?0:null,Array.isArray(a.options.data)){var t=a.options.data.filter(function(t){return function(t){if("string"==typeof t){if((""+t).toLowerCase().search(e.toLowerCase())>=0)return!0}else for(var n in t)if((""+t[n]).toLowerCase().search(e.toLowerCase())>=0)return!0;return!1}(t)});o(t)}else f({url:a.options.data+e,method:"GET",dataType:"json",success:function(e){o(e)}})},i=null,a=function(e){i&&clearTimeout(i),i=setTimeout(function(){r(e)},500)};null===t.forceSelect&&(t.forceSelect=!0),a.options={data:t.data||null,input:t.input||null,searchByNode:t.searchByNode||null,onselect:t.onselect||null,forceSelect:t.forceSelect,onsearch:t.onsearch||null,onbeforesearch:t.onbeforesearch||null},a.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),o=e.getAttribute("data-value"),r=e.children[0].src||"";"function"==typeof a.options.onselect&&a.options.onselect(a,n,o,t,r),a.close()},a.open=function(){e.style.display="block"},a.close=function(){i&&clearTimeout(i),a.terms="",s.innerHTML="",e.style.display=""},a.isOpened=function(){return!!e.style.display},a.keydown=function(e){a.isOpened()&&("Enter"==e.key?null!==n&&s.children[n]?(a.selectIndex(s.children[n]),e.preventDefault()):a.close():"ArrowUp"===e.key?(null!==n&&s.children[0]&&(s.children[n].classList.remove("selected"),a.options.forceSelect||0!==n?(n=Math.max(0,n-1),s.children[n].classList.add("selected")):n=null),e.preventDefault()):"ArrowDown"===e.key&&(null==n?n=-1:s.children[n].classList.remove("selected"),n<9&&s.children[n+1]&&n++,s.children[n].classList.add("selected"),e.preventDefault()))},a.keyup=function(e){if(!a.options.searchByNode&&a.options.input)if("DIV"===a.options.input.tagName)var t=a.options.input.innerText;else t=a.options.input.value;else{var n=l.getNode();n&&(t=n.innerText)}if("function"==typeof a.options.onbeforesearch){var o=a.options.onbeforesearch(a,t);if(o)t=o;else if(!1===o)return}a(t)},a.blur=function(e){a.close()},a.options.input&&(a.options.input.addEventListener("keyup",a.keyup),a.options.input.addEventListener("keydown",a.keydown),a.options.input.addEventListener("blur",a.blur));var s=document.createElement("div");return s.classList.add("jsearch_container"),s.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;a.selectIndex(t),e.preventDefault()},e.appendChild(s),e.classList.add("jsearch"),e.search=a,a}function D(t,n){var o={options:{}},r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];1==o.options.multiple&&t.setAttribute("data-multiple",!0),t.content=[],t.classList.add("jupload"),1==o.options.input&&t.classList.add("input"),o.add=function(e){if(0==o.options.multiple&&(t.content=[],t.innerText=""),"image"==o.options.type){var n=document.createElement("img");n.setAttribute("src",e.file),n.setAttribute("tabindex",-1),t.getAttribute("name")||(n.className="jfile",n.content=e),t.appendChild(n)}else{if(e.name)var r=e.name;else r=e.file;var i=document.createElement("div");i.innerText=r||o.options.type,i.classList.add("jupload-item"),i.setAttribute("tabindex",-1),t.appendChild(i)}e.content&&(e.file=l.guid()),t.content.push(e),"function"==typeof o.options.onchange&&o.options.onchange(t,e)},o.addFromFile=function(t){if(t.type.split("/")[0]==o.options.type){var n=new FileReader;n.addEventListener("load",function(e){var n={file:e.srcElement.result,extension:t.name.substr(t.name.lastIndexOf(".")+1),name:t.name,size:t.size,lastmodified:t.lastModified,content:e.srcElement.result};o.add(n)}),n.readAsDataURL(t)}else alert(e.translate("This extension is not allowed"))},o.addFromUrl=function(e){if("data"==e.substr(0,4)||o.options.remoteParser)if("data"==e.substr(0,4))if((n=(n=e.split(";"))[0].split("/"))[0].replace("data:","")==o.options.type){var t={file:e,name:"",extension:n[1],content:e};o.add(t)}else alert(o.options.text.extensionNotAllowed);else{var n=e.substr(e.lastIndexOf(".")+1);e=o.options.remoteParser+e,f({url:e,type:"GET",dataType:"blob",success:function(e){}})}else console.error("remoteParser not defined in your initialization")};var a=o.options.type+"/"+o.options.extension,s=document.createElement("input");s.type="file",s.setAttribute("accept",a),s.onchange=function(){for(var e=0;e<this.files.length;e++)o.addFromFile(this.files[e])},1==o.options.multiple&&s.setAttribute("multiple",!0);var c=null;return t.addEventListener("click",function(e){c=null,t.children.length&&e.target!==t?e.target.parentNode==t&&(c=e.target):l.click(s)}),t.addEventListener("dblclick",function(e){l.click(s)}),t.addEventListener("dragenter",function(e){t.style.border="1px dashed #000"}),t.addEventListener("dragleave",function(e){t.style.border="1px solid #eee"}),t.addEventListener("dragstop",function(e){t.style.border="1px solid #eee"}),t.addEventListener("dragover",function(e){e.preventDefault()}),t.addEventListener("keydown",function(e){if(c&&46==e.which){var n=Array.prototype.indexOf.call(t.children,c);n>=0&&(t.content.splice(n,1),c.remove(),c=null)}}),t.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var n=(e.originalEvent||e).dataTransfer.getData("text/html");if((e.originalEvent||e).dataTransfer.files.length)for(var r=0;r<e.dataTransfer.files.length;r++)o.addFromFile(e.dataTransfer.files[r]);else if(n){0==o.options.multiple&&(t.innerText="");var i=document.createElement("div");i.innerHTML=n;var l=i.querySelectorAll("img");if(l.length)for(r=0;r<l.length;r++)o.addFromUrl(l[r].src)}return t.style.border="1px solid #eee",!1}),t.val=function(e){if(void 0===e)return t.content&&t.content.length?t.content:null;if(t.innerText="",t.content=[],e)if(Array.isArray(e))for(var n=0;n<e.length;n++)"string"==typeof e[n]?o.add({file:e[n]}):o.add(e[n]);else"string"==typeof e&&o.add({file:e})},t.upload=t.image=o,o}var O=o(195),k=o.n(O),R={...e,...l,version:"5.12.0",setExtensions:function(e){if("object"==typeof e)for(var t=Object.keys(e),n=0;n<t.length;n++)R[t[n]]=e[t[n]]},tracking:n,path:s,sorting:c,lazyLoading:u,ajax:f,animation:p,calendar:g,color:w,contextmenu:C,dropdown:E,editor:M,floating:I,form:_,mask:m,modal:N,notification:S,palette:v,picker:A,progressbar:function(e,t){var n={options:{}},o={value:0,onchange:null,width:null};for(var r in o)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=o[r];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",n.options.value);var i=document.createElement("div");i.style.width=n.options.value+"%",i.style.color="#fff",e.appendChild(i),n.options.width&&(e.style.width=n.options.width),n.setValue=function(t){t=parseInt(t),n.options.value=t,i.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},n.getValue=function(){return n.options.value};var l=function(t){if(t.which){var o=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var r=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else r=t.clientX,t.clientY;n.setValue(Math.round((r-o.left)/o.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",l),e.addEventListener("touchend",l)):(e.addEventListener("mousedown",l),e.addEventListener("mousemove",l)),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.progressbar=n,n},rating:function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,o){var r={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var i in r)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:void 0!==n.options[i]&&!0!==o||(n.options[i]=r[i]);e.innerHTML="";for(var l=0;l<n.options.number;l++){var a=document.createElement("div");a.setAttribute("data-index",l+1),a.setAttribute("title",n.options.tooltip[l]),e.appendChild(a)}if(n.options.value)for(l=0;l<n.options.number;l++)l<n.options.value&&e.children[l].classList.add("jrating-selected");return n},setValue:function(t){for(var o=0;o<n.options.number;o++)o<t?e.children[o].classList.add("jrating-selected"):(e.children[o].classList.remove("jrating-over"),e.children[o].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==n.options.value?n.setValue(0):n.setValue(t))}),e.addEventListener("mouseover",function(t){for(var o=t.target.getAttribute("data-index"),r=0;r<n.options.number;r++)r<o?e.children[r].classList.add("jrating-over"):e.children[r].classList.remove("jrating-over")}),e.addEventListener("mouseout",function(t){for(var o=0;o<n.options.number;o++)e.children[o].classList.remove("jrating-over")}),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},search:j,slider:function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=parseInt(n.options.height)+"px"),n.options.width&&(e.style.width=parseInt(n.options.width)+"px"),n.options.grid){e.classList.add("jslider-grid");var o=e.children.length;o>4&&e.setAttribute("data-total",o-4),e.setAttribute("data-number",o>4?4:o)}var r=document.createElement("div");if(r.classList.add("jslider-counter"),e.children.length>0)for(var i=0;i<e.children.length;i++){n.options.items.push(e.children[i]);var l=document.createElement("div");l.onclick=function(){var e=Array.prototype.slice.call(r.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},r.appendChild(l)}var a=document.createElement("div");a.className="jslider-caption";var s=document.createElement("div"),c=document.createElement("div");c.className="jslider-close",c.innerHTML="",c.onclick=function(){n.close()},s.appendChild(a),s.appendChild(c)}n.updateCounter=function(e){for(var t=0;t<r.children.length;t++)if(r.children[t].classList.contains("jslider-counter-focus")){r.children[t].classList.remove("jslider-counter-focus");break}r.children[e].classList.add("jslider-counter-focus")},n.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(s),e.appendChild(r);var o=n.options.items.indexOf(t);n.updateCounter(o);for(var i=0;i<e.children.length;i++)e.children[i].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),s.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";r.remove(),s.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)};var u=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?n.next():t<40&&n.prev()}};return"ontouchend"in document.documentElement==1?e.addEventListener("touchend",u):e.addEventListener("mouseup",u),e.addEventListener("swipeleft",function(e){n.next(),e.preventDefault(),e.stopPropagation()}),e.addEventListener("swiperight",function(e){n.prev(),e.preventDefault(),e.stopPropagation()}),e.addEventListener("keydown",function(e){27==e.which&&n.close()}),e.slider=n,n},tabs:b,tags:function(t,n){if(t.tags)return t.tags.setOptions(n,!0);var o={type:"tags",options:{}},r=function(){return!!(o.options.limit&&t.children.length>=o.options.limit)},i=null,a=null;o.setOptions=function(e,n){var r={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var l in r)e&&e.hasOwnProperty(l)?o.options[l]=e[l]:void 0!==o.options[l]&&!0!==n||(o.options[l]=r[l]);return o.options.placeholder?t.setAttribute("data-placeholder",o.options.placeholder):t.removeAttribute("data-placeholder"),t.placeholder=o.options.placeholder,o.setValue(o.options.value),d(),o.options.search?a||(a=document.createElement("div"),t.parentNode.insertBefore(a,t.nextSibling),i=j(a,{data:o.options.search,onselect:function(e,t,n){o.selectIndex(t,n)}})):a&&(i=null,a.remove(),a=null),o},o.add=function(n,a){if("function"==typeof o.options.onbeforechange){var d=o.options.onbeforechange(t,o,o.options.value,n);if(!1===d)return!1;null!=d&&(n=d)}if(i&&i.close(),r())"function"==typeof o.options.onlimit?o.options.onlimit(o,o.options.limit):alert(e.translate("You reach the limit number of entries")+" "+o.options.limit);else{var f=l.getNode();if(!(f&&f.parentNode&&f.parentNode.classList.contains("jtags")&&f.nextSibling)||f.nextSibling.innerText&&f.nextSibling.innerText.trim()){if(t.lastChild&&(t.lastChild.innerText.trim()||t.removeChild(t.lastChild)),n&&"string"!=typeof n){for(var p=0;p<=n.length;p++)if(!r()){if(n[p]&&"string"!=typeof n[p])h=n[p].text,m=n[p].value;else var h=n[p]||"",m=null;g=c(h,m)}}else var g=c(n,n,f);u()}else g=f.nextSibling;a&&s(g)}},o.setLimit=function(e){for(o.options.limit=e,t.children.length;t.children.length>e;)t.removeChild(t.lastChild)},o.remove=function(e){e.parentNode.removeChild(e),t.children.length?u():o.add("",!0),"function"==typeof o.options.onremoveitem&&o.options.onremoveitem(t,o,e)},o.getData=function(){for(var e=[],n=0;n<t.children.length;n++){var o=t.children[n].innerText.replace("\n",""),r=t.children[n].getAttribute("data-value");r||(r=o),(o||r)&&e.push({text:o,value:r})}return e},o.getValue=function(e){var n=null;if(null!=e)(n=t.children[e].getAttribute("data-value"))||(n=t.children[e].innerText.replace("\n",""));else{for(var r=[],i=0;i<t.children.length;i++)(n=t.children[i].innerText.replace("\n",""))&&r.push(o.getValue(i));n=r.join(",")}return n},o.setValue=function(e){if(e){if(t.value!=e)if(Array.isArray(e))o.add(e);else{var n=(""+e).trim(),r=p(n);t.innerHTML="",o.add(r)}}else o.reset()},o.reset=function(){t.classList.add("jtags-empty"),t.innerHTML="<div></div>",u()},o.isValid=function(){for(var e=0,n=0;n<t.children.length;n++)t.children[n].classList.contains("jtags_error")&&e++;return 0==e},o.selectIndex=function(e,t){var n=l.getNode();n&&(n.innerText=e,t&&n.setAttribute("data-value",t),n.classList.remove("jtags_error"),r()||o.add("",!0))},o.search=function(e){e.innerText},o.destroy=function(){t.removeEventListener("mouseup",y),t.removeEventListener("keydown",m),t.removeEventListener("keyup",g),t.removeEventListener("paste",v),t.removeEventListener("focus",b),t.removeEventListener("blur",w),t.parentNode.removeChild(t)};var s=function(e){if(t.children.length){var n=document.createRange(),o=window.getSelection();e||(e=t.childNodes[t.childNodes.length-1]),n.setStart(e,e.length),n.collapse(!0),o.removeAllRanges(),o.addRange(n),t.scrollLeft=t.scrollWidth}},c=function(e,n,o){var r=document.createElement("div");return r.textContent=e||"",n&&r.setAttribute("data-value",n),o&&o.parentNode.classList.contains("jtags")?t.insertBefore(r,o.nextSibling):t.appendChild(r),r},u=function(){var e=o.getValue();e!=o.options.value&&(o.options.value=e,"function"==typeof o.options.onchange&&o.options.onchange(t,o,o.options.value),t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))),d()},d=function(){for(var e=0;e<t.children.length;e++)"DIV"===t.children[e].tagName&&(o.getValue(e)?(t.children[e].classList.add("jtags_label"),"function"==typeof o.options.validation&&o.getValue(e)?o.options.validation(t.children[e],t.children[e].innerText,t.children[e].getAttribute("data-value"))?t.children[e].classList.remove("jtags_error"):t.children[e].classList.add("jtags_error"):t.children[e].classList.remove("jtags_error")):t.children[e].classList.remove("jtags_label"));f()},f=function(){t.innerText.trim()?t.classList.remove("jtags-empty"):t.children.length&&"BR"!==t.children[0].tagName||(t.innerHTML="",s(c()))},p=function(e){var t=[],n="";if(e=e.trim()){for(var o=0;o<e.length;o++)","==e[o]||";"==e[o]||"\n"==e[o]?n&&(t.push(n.trim()),n=""):n+=e[o];n&&t.push(n)}return t},h=0,m=function(e){h=window.getSelection().anchorOffset,f(),"Tab"===e.key||";"===e.key||","===e.key?(window.getSelection().anchorOffset>1&&(r()?"function"==typeof o.options.onlimit&&o.options.onlimit(o,o.options.limit):o.add("",!0)),e.preventDefault()):"Enter"==e.key?i&&i.isOpened()||(window.getSelection().anchorOffset>1&&(r()||o.add("",!0)),e.preventDefault()):"Backspace"==e.key&&1==t.children.length&&window.getSelection().anchorOffset<1&&e.preventDefault(),i&&i.keydown(e),f()},g=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==h&&o.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():i&&i.keyup(e);d()},v=function(e){if(e.clipboardData||e.originalEvent.clipboardData)var n=(e.originalEvent||e).clipboardData.getData("text/plain");else window.clipboardData&&(n=window.clipboardData.getData("Text"));var r=p(n);if("function"==typeof o.options.onbeforepaste){var i=o.options.onbeforepaste(t,o,r);if(!1===i)return e.preventDefault(),!1;i&&(r=i)}r.length>1?(o.add(r,!0),e.preventDefault()):r[0]&&(document.execCommand("insertText",!1,r[0]),e.preventDefault())},y=function(e){if(e.target.parentNode&&e.target.parentNode.classList.contains("jtags")&&(e.target.classList.contains("jtags_label")||e.target.classList.contains("jtags_error"))){var n=e.target.getBoundingClientRect();n.width-(e.clientX-n.left)<16&&o.remove(e.target)}e.target==t&&s()},b=function(){t.classList.contains("jtags-focus")||(t.children.length&&!o.getValue(t.children.length-1)||r()||c(""),"function"==typeof o.options.onfocus&&o.options.onfocus(t,o,o.getValue()),t.classList.add("jtags-focus"))},w=function(){if(t.classList.contains("jtags-focus")){i&&i.close();for(var e=0;e<t.children.length-1;e++)o.getValue(e)||t.removeChild(t.children[e]);u(),t.classList.remove("jtags-focus"),"function"==typeof o.options.onblur&&o.options.onblur(t,o,o.getValue())}};return"touchend"in document.documentElement==1?t.addEventListener("touchend",y):t.addEventListener("mouseup",y),t.addEventListener("keydown",m),t.addEventListener("keyup",g),t.addEventListener("paste",v),t.addEventListener("focus",b),t.addEventListener("blur",w),t.setAttribute("contenteditable",!0),t.classList.add("jtags"),o.setOptions(n),"function"==typeof o.options.onload&&o.options.onload(t,o),t.change=o.setValue,t.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},t.tags=o,o},toolbar:L,upload:D,validations:T};R.image=D,R.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},R.tracker=_,R.loading=p.loading,R.sha512=k();"undefined"!=typeof document&&function(){if(void 0!==window.jSuitesStateControl)return;window.jSuitesStateControl=[];const e=function(t,n){return!(!t[n.type]||t[n.type]!=n)||!(!t.component||t.component!=n)||!!t.parentNode&&e(t.parentNode,n)};let t=15,n=!1,o={x:null,y:null},r=document.createElement("div");r.classList.add("jtooltip");const i=function(e){return e&&(e.shadowRoot||e.tagName&&e.tagName.includes("-"))},l=function(e){let t,n,o=e.path||e.composedPath&&e.composedPath();return o?(n=o[0],n&&i(n)&&!n.shadowRoot&&e.toElement&&(n=e.toElement)):(t=e.target&&i(e.target)?e.target.shadowRoot:document,n=t.elementFromPoint(x,y)),n};let a,s=["n","ne","e","se","s","sw","w","nw","rotate"];s.forEach(function(e,t){s[t]=document.createElement("div"),s[t].classList.add("jpanel-action"),"rotate"===e?s[t].setAttribute("data-action","rotate"):(s[t].setAttribute("data-action","resize"),s[t].setAttribute("data-position",e+"-resize"))});const c=function(e){let t=l(e),n=R.findElement(t,"jpanel");n&&!n.classList.contains("readonly")&&n.classList.contains("jpanel-controls")?(n.append(...s),n.classList.contains("jpanel-rotate")||s[s.length-1].remove(),a=n):u(e)},u=function(e){a&&(s.forEach(function(e){e.remove()}),a=null)};document.addEventListener("focusin",c),document.addEventListener("mouseup",function(e){n&&n.e&&("function"==typeof n.e.refresh&&o.actioned&&n.e.refresh(),n.e.style.cursor=""),o={x:null,y:null},n=!1}),document.addEventListener("mousedown",function(t){if(t.changedTouches&&t.changedTouches[0])var o=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY;else o=t.clientX,r=t.clientY;let i=l(t),a=i&&"DIV"===i.tagName&&i.getAttribute("contentEditable"),s=R.findElement(i,"jpanel");if(!s||s.classList.contains("readonly")||a)n=!1;else{let e=s.getBoundingClientRect(),t=0;s.style.rotate&&(t=parseFloat(s.style.rotate));let l="move";i.getAttribute("data-action")?l=i.getAttribute("data-action"):s.style.cursor?l="resize":s.style.cursor="move",n={action:l,a:t,e:s,x:o,y:r,l:e.left,t:e.top,b:e.bottom,r:e.right,w:e.width,h:e.height,d:s.style.cursor,actioned:!1},s.style.width||(s.style.width=e.width+"px"),s.style.height||(s.style.height=e.height+"px")}(function(t){let n=window.jSuitesStateControl;if(n&&n.length>0)for(let o=0;o<n.length;o++)n[o]&&!e(t,n[o])&&n[o].close()})(i),c(t)}),document.addEventListener("mousemove",function(e){if(n){let t=e.clientX||e.pageX,l=e.clientY||e.pageY;if(null==o.x&&null==o.y&&(o.x=t,o.y=l),"move"===n.action){var r=t-o.x,i=l-o.y,a=n.e.offsetTop+i,s=n.e.offsetLeft+r;n.e.style.top=a+"px",n.e.style.left=s+"px","function"==typeof n.e.refresh&&(o.actioned=!0,n.e.refresh("position",a,s))}else if("rotate"===n.action){let e=function(e,t,n,o,r,i){const l=n-e,a=o-t,s=r-e,c=i-t;let u=Math.atan2(a,l),d=Math.atan2(c,s)-u;return d*=180/Math.PI,d<0&&(d+=360),d}(n.l+n.w/2,n.t+n.h/2,n.x,n.y,t,l);e+=n.a%360,e=2*Math.round(e/2),n.e.style.rotate=`${e}deg`,"function"==typeof n.e.refresh&&(o.actioned=!0,n.e.refresh("rotate",e))}else if("resize"===n.action){let r=null,i=null,a=null,s=null;"e-resize"==n.d||"ne-resize"==n.d||"se-resize"==n.d?(a=n.e.offsetWidth+(t-o.x),e.shiftKey&&(s=n.e.offsetHeight+(t-o.x)*(n.e.offsetHeight/n.e.offsetWidth))):"w-resize"!==n.d&&"nw-resize"!=n.d&&"sw-resize"!=n.d||(i=n.e.offsetLeft+(t-o.x),a=n.e.offsetLeft+n.e.offsetWidth-i,e.shiftKey&&(s=n.e.offsetHeight-(t-o.x)*(n.e.offsetHeight/n.e.offsetWidth))),"s-resize"==n.d||"se-resize"==n.d||"sw-resize"==n.d?s||(s=n.e.offsetHeight+(l-o.y)):"n-resize"!==n.d&&"ne-resize"!=n.d&&"nw-resize"!=n.d||(r=n.e.offsetTop+(l-o.y),s=n.e.offsetTop+n.e.offsetHeight-r),r&&(n.e.style.top=r+"px"),i&&(n.e.style.left=i+"px"),a&&(n.e.style.width=a+"px"),s&&(n.e.style.height=s+"px"),"function"==typeof n.e.refresh&&(o.actioned=!0,n.e.refresh("dimensions",a,s))}o.x=t,o.y=l}else{let n=l(e),o=R.findElement(n,"jpanel");if(o)if(o.classList.contains("jpanel-controls")){let e=n.getAttribute("data-position");o.style.cursor=e||""}else if(o.getAttribute("tabindex")){let n=o.getBoundingClientRect();e.clientY-n.top<t?n.width-(e.clientX-n.left)<t?o.style.cursor="ne-resize":e.clientX-n.left<t?o.style.cursor="nw-resize":o.style.cursor="n-resize":n.height-(e.clientY-n.top)<t?n.width-(e.clientX-n.left)<t?o.style.cursor="se-resize":e.clientX-n.left<t?o.style.cursor="sw-resize":o.style.cursor="s-resize":n.width-(e.clientX-n.left)<t?o.style.cursor="e-resize":e.clientX-n.left<t?o.style.cursor="w-resize":o.style.cursor=""}}}),document.addEventListener("mouseover",function(e){var t=l(e).getAttribute("data-tooltip");if(t){if(r.innerText=t,e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;else n=e.clientX,o=e.clientY;r.style.top=o+"px",r.style.left=n+"px",document.body.appendChild(r)}else r.innerText&&(r.innerText="",document.body.removeChild(r))}),document.addEventListener("keydown",function(e){let t=document.activeElement;t&&"Delete"===e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation());let n=window.jSuitesStateControl;n&&n.length>0&&(t=n[n.length-1],t&&"Escape"===e.key&&"function"==typeof t.isOpened&&"function"==typeof t.close&&t.isOpened()&&(t.close(),e.preventDefault(),e.stopImmediatePropagation()))}),document.addEventListener("contextmenu",function(e){var t=document.activeElement;if(t&&"function"==typeof t.contextmenu)t.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation();else if(t=R.findElement(e.target,function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")}),t){var n=document.querySelector("#"+t);n?(n.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+t)}}),document.addEventListener("input",function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&R.mask(e)})}();var H=R}(),t=r.default}(),t)},655:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{$O:function(){return getWorksheetActive},$x:function(){return parseValue},C6:function(){return showIndex},Em:function(){return executeFormula},P9:function(){return createCell},Rs:function(){return updateScroll},TI:function(){return hideIndex},Xr:function(){return getCellFromCoords},Y5:function(){return fullscreen},am:function(){return updateTable},dw:function(){return isFormula},eN:function(){return getWorksheetInstance},hG:function(){return updateResult},ju:function(){return createNestedHeader},k9:function(){return updateCell},o8:function(){return updateTableReferences},p9:function(){return getLabel},rS:function(){return getMask},tT:function(){return getCell},xF:function(){return updateFormulaChain},yB:function(){return updateFormula}});var jsuites__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(587),jsuites__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jsuites__WEBPACK_IMPORTED_MODULE_0__),_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(834),_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1__),_dispatch__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(988),_selection__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(106),_helpers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9),_meta__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(211),_freeze__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(881),_pagination__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(986),_footer__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(685),_internalHelpers__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(898);function getCellValue(e,t,n){return e&&e[t]?(Array.isArray(e[t]),e[t][n]||""):""}var updateTable=function(){var e=this;if(e.options.minSpareRows&&e.options.minSpareRows>0){for(var t=0,n=e.rows.length-1;n>=0;n--){for(var o=!1,r=0;r<e.headers.length;r++)getCellValue(e.options.data,n,r)&&(o=!0);if(o)break;t++}e.options.minSpareRows&&e.options.minSpareRows-t>0&&"function"==typeof e.insertRow&&e.insertRow(e.options.minSpareRows-t)}if(e.options.minSpareCols&&e.options.minSpareCols>0){var i=0;for(r=e.headers.length-1;r>=0;r--){var l=!1;for(n=0;n<e.rows.length;n++)getCellValue(e.options.data,n,r)&&(l=!0);if(l)break;i++}e.options.minSpareCols-i>0&&"function"==typeof e.insertColumn&&e.insertColumn(e.options.minSpareCols-i)}e.options.footers&&_footer__WEBPACK_IMPORTED_MODULE_8__.e.call(e),setTimeout(function(){_selection__WEBPACK_IMPORTED_MODULE_3__.Aq.call(e)},0)},parseNumber=function(e,t){var n=this,o=t&&n.options.columns&&n.options.columns[t]&&n.options.columns[t].decimal?n.options.columns[t].decimal:".",r=(""+e).split(o),i=r[0].match(/[+-]?[0-9]/g),l=i?i.join(""):"",a="";if(r[1]){var s=r[1].match(/[0-9]*/g);a=s?s.join(""):""}return l&&Number.isInteger(Number(l))?Number(a?l+"."+a:l+".00"):null},executeFormula=function(expression,x,y){var obj=this,formulaResults={},formulaLoopProtection={},execute=function(expression,x,y){var parentId=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([x,y]);if(formulaLoopProtection.hasOwnProperty(parentId))return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var n=[],o=e[t].split(":"),r=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(o[0],!0),i=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(o[1],!0),l=void 0,a=void 0;r[0]<=i[0]?(l=r[0],a=i[0]):(l=i[0],a=r[0]);var s=void 0,c=void 0;r[1]<=i[1]?(s=r[1],c=i[1]):(s=i[1],c=r[1]);for(var u=s;u<=c;u++)for(var d=l;d<=a;d++)n.push((0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([d,u]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula&&!obj.formula[tokens[i]]&&(obj.formula[tokens[i]]=[]),obj.formula&&obj.formula[tokens[i]]&&obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(tokens[i],!0),value=void 0;if(value=getCellValue(obj.options.data,position[1],position[0]),"="==(""+value).substr(0,1)&&(void 0!==formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(String(value),position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&0!=obj.parent.config.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=parseNumber.call(obj,value,position[0]);0!=obj.parent.config.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+String(value||"")+'"'}}var ret=_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(obj,"onbeforeformula",obj,expression,x,y);if(!1===ret)return expression;ret&&(expression=String(ret));var res=void 0;try{res=_jspreadsheet_formula__WEBPACK_IMPORTED_MODULE_1___default()(expression.substr(1),formulaExpressions,x,y),"function"==typeof res&&(res="#ERROR")}catch(e){res="#ERROR",!0===obj.parent.config.debugFormulas&&console.log(expression.substr(1),formulaExpressions,e)}return res};return execute(expression,x,y)},parseValue=function(e,t,n,o){var r=this;"="==(""+n).substr(0,1)&&0!=r.parent.config.parseFormulas&&(n=executeFormula.call(r,String(n),e,t));var i=r.options.columns&&r.options.columns[e];if(i&&!isFormula(n)){var l=null;if(l=getMask(i)){n&&n==Number(n)&&(n=Number(n));var a=jsuites__WEBPACK_IMPORTED_MODULE_0___default().mask.render("string"==typeof n||"number"==typeof n?n:String(n),l,!0);if(o&&l&&"object"==typeof l&&"mask"in l&&"string"==typeof l.mask){var s=l.mask.split(";");s[1]&&(s[1].match(new RegExp("\\[Red\\]","gi"))&&("number"==typeof n&&n<0?o.classList.add("red"):o.classList.remove("red")),s[1].match(new RegExp("\\(","gi"))&&"number"==typeof n&&n<0&&(a="("+a+")"))}a&&(n=a)}}return n},getDropDownValue=function(e,t){var n=this,o=[];if(n.options.columns&&n.options.columns[e]&&n.options.columns[e].source){for(var r={},i=n.options.columns[e].source,l=0;l<i.length;l++)if("object"==typeof i[l]){var a=i[l];r[a.id]=a.name}else r[i[l]]=i[l];var s=Array.isArray(t)?t:(""+t).split(";");for(l=0;l<s.length;l++)"object"==typeof s[l]?o.push(r[s[l].id]):r[s[l]]&&o.push(r[s[l]])}else console.error("Invalid column");return o.length>0?o.join("; "):""},validDate=function(e){var t=String(e);if("-"==t.substr(4,1)&&"-"==t.substr(7,1))return!0;var n=t.split("-");return 4==n[0].length&&Number(n[0]).toString()==n[0]&&2==n[1].length&&Number(n[1]).toString()==n[1]},stripScript=function(e){var t,n=new Option;n.innerHTML=e;for(var o=n.getElementsByTagName("script"),r=0;r<o.length;r++)null===(t=o[r].parentNode)||void 0===t||t.removeChild(o[r]);return n.innerHTML},createCell=function(e,t,n){var o=this,r=document.createElement("td");if(r.setAttribute("data-x",e.toString()),r.setAttribute("data-y",t.toString()),"none"===o.headers[e].style.display&&(r.style.display="none"),"="==(""+n).substr(0,1)&&1==o.options.secureFormulas){var i=secureFormula(""+n);i!=n&&(n=i)}if(o.options.columns&&o.options.columns[e]&&"object"==typeof o.options.columns[e].type)!0===o.parent.config.parseHTML?r.innerHTML=String(n):r.textContent=String(n),"function"==typeof o.options.columns[e].type.createCell&&o.options.columns[e].type.createCell(r,n,e,t,o,o.options.columns[e]);else if(o.options.columns&&o.options.columns[e]&&"hidden"==o.options.columns[e].type)r.style.display="none",r.textContent=String(n);else if(o.options.columns&&o.options.columns[e]&&("checkbox"==o.options.columns[e].type||"radio"==o.options.columns[e].type)){var l=document.createElement("input");l.type=o.options.columns[e].type,l.name="c"+e,l.checked=1==n||1==n||"true"==n,l.onclick=function(){"function"==typeof o.setValue&&o.setValue((0,_helpers__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(e)+(t+1),this.checked)},1!=o.options.columns[e].readOnly&&0!=o.options.editable||l.setAttribute("disabled","disabled"),r.appendChild(l),o.options.data&&Array.isArray(o.options.data)&&o.options.data[t]&&(o.options.data[t][e]=l.checked)}else if(o.options.columns&&o.options.columns[e]&&"calendar"==o.options.columns[e].type){var a=null;if(!validDate(n)){var s=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.extractDateFromString(String(n),o.options.columns[e].options&&o.options.columns[e].options.format||"YYYY-MM-DD");s&&(a=s)}var c=a||new Date(String(n));r.textContent=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.getDateString(c,o.options.columns[e].options&&o.options.columns[e].options.format||"YYYY-MM-DD")}else if(o.options.columns&&o.options.columns[e]&&"dropdown"==o.options.columns[e].type)r.classList.add("jss_dropdown"),r.textContent=String(getDropDownValue.call(o,e,String(n)));else if(o.options.columns&&o.options.columns[e]&&"color"==o.options.columns[e].type)if("square"==o.options.columns[e].render){var u=document.createElement("div");u.className="color",u.style.backgroundColor=String(n),r.appendChild(u)}else r.style.color=String(n),r.textContent=String(n);else if(o.options.columns&&o.options.columns[e]&&"image"==o.options.columns[e].type){if(n&&"data:image"==String(n).substr(0,10)){var d=document.createElement("img");d.src=String(n),r.appendChild(d)}}else o.options.columns&&o.options.columns[e]&&"html"==o.options.columns[e].type||!0===o.parent.config.parseHTML?r.innerHTML=stripScript(String(parseValue.call(this,e,t,n,r))):r.textContent=String(parseValue.call(this,e,t,n,r));o.options.columns&&o.options.columns[e]&&1==o.options.columns[e].readOnly&&(r.className="readonly");var f=o.options.columns&&o.options.columns[e]&&o.options.columns[e].align||o.options.defaultColAlign||"center";return r.style.textAlign=String(f),o.options.columns&&o.options.columns[e]&&0==o.options.columns[e].wordWrap||!(1==o.options.wordWrap||o.options.columns&&o.options.columns[e]&&1==o.options.columns[e].wordWrap||r.innerHTML.length>200)||(r.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(n||r.innerHTML?o.records[t]&&o.records[t][e-1]&&(o.records[t][e-1].element.style.overflow="hidden"):o.options.columns&&e==o.options.columns.length-1&&(r.style.overflow="hidden")),_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(o,"oncreatecell",o,r,e,t,n),r},updateCell=function(e,t,n,o){var r,i=this;if(i.records[t]&&i.records[t][e]&&1==i.records[t][e].element.classList.contains("readonly")&&!o)r={x:e,y:t,col:e,row:t};else{if("="==(""+n).substr(0,1)&&1==i.options.secureFormulas){var l=secureFormula(""+n);l!=n&&(n=l)}var a=i.records[t]&&i.records[t][e]?_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(i,"onbeforechange",i,i.records[t][e].element,e,t,n):void 0;if(null!=a&&(n=a),i.options.columns&&i.options.columns[e]&&"object"==typeof i.options.columns[e].type&&i.options.columns[e].type&&"function"==typeof i.options.columns[e].type.updateCell&&i.records[t]&&i.records[t][e]){var s=i.options.columns[e].type.updateCell(i.records[t][e].element,n,""+e,""+t,i,i.options.columns[e]);void 0!==s&&(n=s)}r={x:e,y:t,col:e,row:t,value:n,oldValue:i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]?i.options.data[t][e]:void 0};var c=i.options.columns&&i.options.columns[e]&&"object"==typeof i.options.columns[e].type?i.options.columns[e].type:null;if(c)i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=n),"function"==typeof c.setValue&&i.records[t]&&i.records[t][e]&&c.setValue(i.records[t][e].element,n);else if(i.options.columns&&i.options.columns[e]&&("checkbox"==i.options.columns[e].type||"radio"==i.options.columns[e].type)){if("radio"==i.options.columns[e].type&&i.options.data&&Array.isArray(i.options.data))for(var u=0;u<i.options.data.length;u++)i.options.data[u]&&(i.options.data[u][e]=!1);if(i.records[t]&&i.records[t][e]){var d=i.records[t][e].element.children[0];d.checked=1==n||1==n||"true"==n||"TRUE"==n,i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=d.checked)}}else if(i.options.columns&&i.options.columns[e]&&"dropdown"==i.options.columns[e].type){if(i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=n),i.records[t]&&i.records[t][e]){var f=null!==n&&"boolean"!=typeof n?getDropDownValue.call(i,e,n):null;i.records[t][e].element.textContent=null!==f?String(f):null}}else if(i.options.columns&&i.options.columns[e]&&"calendar"==i.options.columns[e].type){var p=null;if(!validDate(n)){var h=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.extractDateFromString(String(n),i.options.columns[e].options&&i.options.columns[e].options.format||"YYYY-MM-DD");h&&(p=h)}if(i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=n),i.records[t]&&i.records[t][e]){var m=p||new Date(String(n));i.records[t][e].element.textContent=jsuites__WEBPACK_IMPORTED_MODULE_0___default().calendar.getDateString(m,i.options.columns[e].options&&i.options.columns[e].options.format||"YYYY-MM-DD")}}else if(i.options.columns&&i.options.columns[e]&&"color"==i.options.columns[e].type)if(i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=n),"square"==i.options.columns[e].render&&i.records[t]&&i.records[t][e]){var g=document.createElement("div");g.className="color",g.style.backgroundColor=String(n),i.records[t][e].element.textContent="",i.records[t][e].element.appendChild(g)}else i.records[t]&&i.records[t][e]&&(i.records[t][e].element.style.color=String(n),i.records[t][e].element.textContent=String(n));else if(i.options.columns&&i.options.columns[e]&&"image"==i.options.columns[e].type){if(n=""+n,i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=n),i.records[t]&&i.records[t][e]&&(i.records[t][e].element.innerHTML="",n&&"data:image"==String(n).substr(0,10))){var v=document.createElement("img");v.src=String(n),i.records[t][e].element.appendChild(v)}}else{if(i.options.data&&Array.isArray(i.options.data)&&i.options.data[t]&&(i.options.data[t][e]=n),i.options.columns&&i.options.columns[e]&&"html"==i.options.columns[e].type&&i.records[t]&&i.records[t][e]){var y=parseValue.call(i,e,t,n,i.records[t][e].element);i.records[t][e].element.innerHTML=stripScript(String(y))}else!0===i.parent.config.parseHTML&&i.records[t]&&i.records[t][e]?(y=parseValue.call(i,e,t,n,i.records[t][e].element),i.records[t][e].element.innerHTML=stripScript(String(y))):i.records[t]&&i.records[t][e]&&(y=parseValue.call(i,e,t,n,i.records[t][e].element),i.records[t][e].element.textContent=String(y));i.options.columns&&i.options.columns[e]&&0==i.options.columns[e].wordWrap||!(1==i.options.wordWrap||i.options.columns&&i.options.columns[e]&&1==i.options.columns[e].wordWrap||i.records[t][e].element.innerHTML.length>200)?i.records[t][e].element.style.whiteSpace="":i.records[t][e].element.style.whiteSpace="pre-wrap"}e>0&&(i.records[t][e-1].element.style.overflow=n?"hidden":""),i.options.columns&&i.options.columns[e]&&"function"==typeof i.options.columns[e].render&&i.options.columns[e].render(i.records[t]&&i.records[t][e]?i.records[t][e].element:null,n,""+e,""+t,i,i.options.columns[e]),_dispatch__WEBPACK_IMPORTED_MODULE_2__.A.call(i,"onchange",i,i.records[t]&&i.records[t][e]?i.records[t][e].element:null,e,t,n,r.oldValue)}return r},isFormula=function(e){var t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},secureFormula=function(e){for(var t="",n=0,o=0;o<e.length;o++)'"'==e[o]&&(n=0==n?1:0),t+=1==n?e[o]:e[o].toUpperCase();return t},chainLoopProtection={},updateFormulaChain=function(e,t,n){var o=this,r=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([e,t]);if(o.formula&&o.formula[r]&&o.formula[r].length>0)if(chainLoopProtection.hasOwnProperty(r))o.records[t]&&o.records[t][e]&&(o.records[t][e].element.innerHTML="#ERROR"),o.formula&&(o.formula[r]=[]);else{chainLoopProtection[r]=!0;for(var i=0;i<o.formula[r].length;i++){var l=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(o.formula[r][i],!0),a="";o.options.data&&Array.isArray(o.options.data)&&o.options.data[l[1]]&&Array.isArray(o.options.data[l[1]])&&"number"==typeof l[0]&&l[0]<o.options.data[l[1]].length&&void 0!==o.options.data[l[1]][l[0]]&&(a=""+o.options.data[l[1]][l[0]]),"="==a.substr(0,1)?n.push(updateCell.call(o,l[0],l[1],a,!0)):o.formula&&delete o.formula[Object.keys(o.formula)[i]],updateFormulaChain.call(o,l[0],l[1],n)}}chainLoopProtection={}},updateFormula=function(e,t){for(var n=/[A-Z]/,o=/[0-9]/,r="",i=null,l=null,a="",s=0;s<e.length;s++)n.exec(e[s])?(i=1,l=0,a+=e[s]):o.exec(e[s])?(l=i?1:0,a+=e[s]):(i&&l&&(a=t[a]?t[a]:a),r+=a,r+=e[s],i=0,l=0,a="");return a&&(i&&l&&(a=t[a]?t[a]:a),r+=a),r},updateFormulas=function(e){var t=this;if(t.options.data&&Array.isArray(t.options.data)&&t.options.data.length>0&&Array.isArray(t.options.data[0]))for(var n=0;n<t.options.data.length;n++)for(var o=0;o<t.options.data[0].length;o++)if("="==(s=""+t.options.data[n][o]).substr(0,1)){var r=updateFormula(s,e);r!=s&&(t.options.data[n][o]=r)}var i={},l=t.formula?Object.keys(t.formula):[];for(n=0;n<l.length;n++){var a=l[n],s=t.formula[a];for(e[a]&&(a=e[a]),i[a]=[],o=0;o<s.length;o++){var c=s[o];e[c]&&(c=e[c]),i[a].push(c)}}t.formula=i},updateTableReferences=function(){var e=this;if(!e.skipUpdateTableReferences){for(var t=0;t<e.headers.length;t++)null!==(s=e.headers[t].getAttribute("data-x"))&&parseInt(s)!==t&&(e.headers[t].setAttribute("data-x",t.toString()),e.headers[t].getAttribute("title")||(e.headers[t].innerHTML=(0,_helpers__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(t)));for(var n=0;n<e.rows.length;n++)e.rows[n]&&null!==(c=e.rows[n].element.getAttribute("data-y"))&&parseInt(c)!==n&&(e.rows[n].element.setAttribute("data-y",n.toString()),e.rows[n].element.children[0].setAttribute("data-y",n.toString()),e.rows[n].element.children[0].innerHTML=(n+1).toString());var o={},r={},i=function(t,n,r,i){if(t!=r&&e.records[i][r].element.setAttribute("data-x",r.toString()),n!=i&&e.records[i][r].element.setAttribute("data-y",i.toString()),t!=r||n!=i){var l=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([t,n]),a=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([r,i]);o[l]=a}};for(n=0;n<e.records.length;n++)for(t=0;t<e.records[0].length;t++)if(e.records[n][t]){var l=e.records[n][t].element.getAttribute("data-x"),a=e.records[n][t].element.getAttribute("data-y"),s=null!==l?parseInt(l):null,c=null!==a?parseInt(a):null;if(e.records[n][t].element.getAttribute("data-merged")){if(null!==s&&null!==c){var u=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([s,c]),d=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.t3)([t,n]);if(null==r[u])if(u==d)r[u]=!1;else{var f=t-s,p=n-c;r[u]=[d,f,p]}}}else null!==s&&null!==c&&i(s,c,t,n)}var h=Object.keys(r);if(h.length)for(t=0;t<h.length;t++){var m=r[h[t]];if(!1!==m&&null!=m){var g=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(h[t],!0);if(Array.isArray(g)&&g.length>=2&&i(s="number"==typeof g[0]?g[0]:parseInt(g[0]),c="number"==typeof g[1]?g[1]:parseInt(g[1]),s+m[1],c+m[2]),u=h[t],d=m[0],e.options.mergeCells&&!1!==e.options.mergeCells[u]&&null!==e.options.mergeCells[u]&&void 0!==e.options.mergeCells[u]){var v=e.options.mergeCells[u];for(s=void 0,c=void 0,n=0;n<v[2].length;n++)s=parseInt(v[2][n].getAttribute("data-x")||"0"),c=parseInt(v[2][n].getAttribute("data-y")||"0"),v[2][n].setAttribute("data-x",(s+m[1]).toString()),v[2][n].setAttribute("data-y",(c+m[2]).toString());e.options.mergeCells[d]=v,delete e.options.mergeCells[u]}}}updateFormulas.call(e,o),_meta__WEBPACK_IMPORTED_MODULE_5__.hs.call(e,o),_selection__WEBPACK_IMPORTED_MODULE_3__.G9.call(e),updateTable.call(e)}},updateScroll=function(e){var t=this;if(t.content){var n=t.content.getBoundingClientRect(),o=n.left,r=n.top,i=n.width,l=n.height,a=t.selectedCell&&t.records[t.selectedCell[3]]&&t.records[t.selectedCell[3]][t.selectedCell[2]]?t.records[t.selectedCell[3]][t.selectedCell[2]].element:null;if(a){var s,c,u=a.getBoundingClientRect(),d=u.left,f=u.top,p=u.width,h=u.height;0==e||1==e?(s=d-o+t.content.scrollLeft,c=f-r+t.content.scrollTop-2):(s=d-o+t.content.scrollLeft+p,c=f-r+t.content.scrollTop+h),c>t.content.scrollTop+30&&c<t.content.scrollTop+l||(c<t.content.scrollTop+30?t.content.scrollTop=c-h:t.content.scrollTop=c-(l-2));var m=_freeze__WEBPACK_IMPORTED_MODULE_6__.w.call(t);s>t.content.scrollLeft+m&&s<t.content.scrollLeft+i||(s<t.content.scrollLeft+30?(t.content.scrollLeft=s,t.content.scrollLeft<50&&(t.content.scrollLeft=0)):s<t.content.scrollLeft+m?t.content.scrollLeft=s-m-1:t.content.scrollLeft=s-(i-20))}}},updateResult=function(){var e,t=this,n=0;for(e=1==t.options.lazyLoading?100:t.options.pagination&&"number"==typeof t.options.pagination&&t.options.pagination>0?t.options.pagination:t.results?t.results.length:t.rows.length;t.tbody.firstChild;)t.tbody.removeChild(t.tbody.firstChild);for(var o=0;o<t.rows.length;o++)!t.results||t.results.indexOf(o)>-1?(n<e&&(t.tbody.appendChild(t.rows[o].element),n++),t.rows[o].element.style.display=""):t.rows[o].element.style.display="none";return t.options.pagination&&"number"==typeof t.options.pagination&&t.options.pagination>0&&_pagination__WEBPACK_IMPORTED_MODULE_7__.IV.call(t),_selection__WEBPACK_IMPORTED_MODULE_3__.Aq.call(t),e},getCell=function(e,t){if("string"==typeof e){var n=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(e,!0);Array.isArray(n)&&n.length>=2&&(e="number"==typeof n[0]?n[0]:parseInt(String(n[0]))||0,t="number"==typeof n[1]?n[1]:parseInt(String(n[1]))||0)}var o="number"==typeof e?e:parseInt(String(e))||0,r="number"==typeof t?t:parseInt(String(t))||0;return this.records[r][o].element},getCellFromCoords=function(e,t){return this.records[t][e].element},getLabel=function(e,t){if("string"==typeof e){var n=(0,_internalHelpers__WEBPACK_IMPORTED_MODULE_9__.vu)(e,!0);Array.isArray(n)&&n.length>=2&&(e="number"==typeof n[0]?n[0]:parseInt(String(n[0]))||0,t="number"==typeof n[1]?n[1]:parseInt(String(n[1]))||0)}var o="number"==typeof e?e:parseInt(String(e))||0,r="number"==typeof t?t:parseInt(String(t))||0;return this.records[r][o].element.innerHTML},fullscreen=function(e){var t=this;null==e&&(e=!t.config.fullscreen),t.config.fullscreen!=e&&(t.config.fullscreen=e,1==e?t.element.classList.add("fullscreen"):t.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(e){var t=this,n=document.createElement("tr");n.classList.add("jss_nested");var o=document.createElement("td");o.classList.add("jss_selectall"),n.appendChild(o),e.element=n;for(var r=0,i=0;i<e.length;i++){e[i].colspan||(e[i].colspan=1),e[i].title||(e[i].title=""),e[i].id||(e[i].id="");for(var l=e[i].colspan,a="number"==typeof l?l:parseInt(String(l||1))||1,s=[],c=0;c<a;c++)t.options.columns&&t.options.columns[r]&&"hidden"==t.options.columns[r].type&&a++,s.push(r),r++;var u=document.createElement("td");u.setAttribute("data-column",s.join(",")),u.setAttribute("colspan",String(e[i].colspan||1)),u.setAttribute("align",e[i].align||"center"),e[i].id&&u.setAttribute("id",String(e[i].id)),u.textContent=e[i].title||"",n.appendChild(u)}return n},getWorksheetActive=function(){var e=this.parent?this.parent:this;return e.element.tabs?e.element.tabs.getActive():0},getWorksheetInstance=function(e){var t=void 0!==e?e:getWorksheetActive.call(this);return this.worksheets[t]}},685:function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var o=n(655),r=function(e){var t,n,r,i,l,a=this;if(e&&(a.options.footers=e),a.options.footers){a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot));for(var s=null!==(t=a.options.columns)&&void 0!==t?t:[],c=0;c<a.options.footers.length;c++){var u=void 0;if(a.tfoot.children[c])u=a.tfoot.children[c];else{u=document.createElement("tr");var d=document.createElement("td");u.appendChild(d),a.tfoot.appendChild(u)}for(var f=0;f<a.headers.length;f++){if(a.options.footers[c][f]||(a.options.footers[c][f]=""),d=void 0,null===(n=a.tfoot.children[c])||void 0===n?void 0:n.children[f+1])d=a.tfoot.children[c].children[f+1];else{d=document.createElement("td"),u.appendChild(d);var p=(null===(r=s[f])||void 0===r?void 0:r.align)||a.options.defaultColAlign||"center";d.style.textAlign=p}d.textContent=String(o.$x.call(a,+a.records.length+f,c,a.options.footers[c][f],d)),d.style.display=null!==(l=null===(i=a.cols[f])||void 0===i?void 0:i.colElement.style.display)&&void 0!==l?l:""}}}}},745:function(e,t,n){"use strict";n.d(t,{My:function(){return f},Th:function(){return u},iY:function(){return d}});var o=n(587),r=n.n(o),i=n(32),l=n(988),a=n(655),s=n(894),c=n(752),u=function(e,t){for(var n=this,o=0;o<n.headers.length;o++)n.headers[o].classList.remove("arrow-up"),n.headers[o].classList.remove("arrow-down");t?n.headers[e].classList.add("arrow-up"):n.headers[e].classList.add("arrow-down")},d=function(e){for(var t,n,o,r=this,i=[],l=0;l<e.length;l++)r.options.data&&(i[l]=r.options.data[e[l]]);r.options.data&&(r.options.data=i);var u=[];for(l=0;l<e.length;l++){u[l]=r.records[e[l]];for(var d=0;d<u[l].length;d++)u[l][d].y=l}r.records=u;var f=[];for(l=0;l<e.length;l++)f[l]=r.rows[e[l]],f[l].y=l;if(r.rows=f,a.o8.call(r),r.results&&r.results.length)(null===(t=r.searchInput)||void 0===t?void 0:t.value)?null===(n=r.search)||void 0===n||n.call(r,r.searchInput.value):c.F8.call(r);else if(r.results=null,r.pageNumber=0,"number"==typeof r.options.pagination&&r.options.pagination>0)null===(o=r.page)||void 0===o||o.call(r,0);else if(1==r.options.lazyLoading)s.wu.call(r,0);else for(l=0;l<r.rows.length;l++)r.tbody.appendChild(r.rows[l].element)},f=function(e,t){var n,o=this;if(e>=0){if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0){if(!confirm(r().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;null===(n=o.destroyMerge)||void 0===n||n.call(o)}var a;a=null==t?!!o.headers[e]&&o.headers[e].classList.contains("arrow-down"):!!t;var s=[];if(o.options.columns&&o.options.columns[e]&&("numeric"===o.options.columns[e].type||"color"===o.options.columns[e].type)){if(o.options.data)for(var c=0;c<o.options.data.length;c++)o.options.data[c]&&(Array.isArray(o.options.data[c])?s[c]=[c,Number(o.options.data[c][e])]:s[c]=[c,Number(o.options.data[c][Object.keys(o.options.data[c])[e]])])}else if(o.options.columns&&o.options.columns[e]&&("calendar"==o.options.columns[e].type||"checkbox"==o.options.columns[e].type||"radio"==o.options.columns[e].type)){if(o.options.data)for(c=0;c<o.options.data.length;c++)o.options.data[c]&&(Array.isArray(o.options.data[c])?s[c]=[c,o.options.data[c][e]]:s[c]=[c,o.options.data[c][Object.keys(o.options.data[c])[e]]])}else if(o.options.data)for(c=0;c<o.options.data.length;c++)if(o.records[c]&&o.records[c][e]&&o.records[c][e].element){var f=o.records[c][e].element.textContent;s[c]=[c,f?f.toLowerCase():""]}"function"!=typeof o.parent.config.sorting&&(o.parent.config.sorting=function(e){return function(t,n){var o=t[1],r=n[1],i=null!=o?o:"",l=null!=r?r:"";return e?""===i&&""!==l?1:""!==i&&""===l||i>l?-1:i<l?1:0:""===i&&""!==l?1:""!==i&&""===l?-1:i>l?1:i<l?-1:0}}),s=s.sort(o.parent.config.sorting(a));var p=[];for(c=0;c<s.length;c++)p[c]=s[c][0];return i.Dh.call(o,{action:"orderBy",rows:p,column:e,order:a}),u.call(o,e,a),d.call(o,p),l.A.call(o,"onsort",o,e,a,p.map(function(e){return e})),!0}return!1}},752:function(e,t,n){"use strict";n.d(t,{F8:function(){return s},N$:function(){return a},dr:function(){return c}});var o=n(587),r=n.n(o),i=n(655),l=n(106),a=function(e){var t,n,o,i,a,u,d,f,p,h,m=this;if(m.options.filters){var g=parseInt(e);null===(t=m.resetSelection)||void 0===t||t.call(m);var v=[];if("checkbox"==(null===(o=(null!==(n=m.options.columns)&&void 0!==n?n:[])[g])||void 0===o?void 0:o.type))v.push({id:"true",name:"True"}),v.push({id:"false",name:"False"});else{for(var y={},b=!1,w=null!==(i=m.options.data)&&void 0!==i?i:[],C=0;C<w.length;C++){var x=Array.isArray(w[C])?w[C]:[],E=Array.isArray(x)?x[g]:void 0,A=null===(u=null===(a=m.records[C])||void 0===a?void 0:a[g])||void 0===u?void 0:u.element.innerHTML;null!=E&&A?y[String(E)]=A:b=!0}var L=Object.keys(y);for(v=[],C=0;C<L.length;C++)v.push({id:L[C],name:y[L[C]]});b&&v.push({id:"",name:"(Blanks)"})}var M=document.createElement("div"),I=null===(d=m.filter)||void 0===d?void 0:d.children[g+1];I&&(I.innerHTML="",I.appendChild(M),I.style.paddingLeft="0px",I.style.paddingRight="0px",I.style.overflow="initial");var T=null!==(f=m.filters)&&void 0!==f?f:{},_={data:v,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==T[e]?T[e]:null,width:100,position:1==m.options.tableOverflow||1==(null===(h=null===(p=m.parent)||void 0===p?void 0:p.config)||void 0===h?void 0:h.fullscreen),onclose:function(e,t){var n;c.call(m);var o=t,r=o.getValue(!0);T[g]=r;var i=null===(n=m.filter)||void 0===n?void 0:n.children[g+1];i&&(i.innerHTML=o.getText(),i.style.paddingLeft="",i.style.paddingRight="",i.style.overflow=""),s.call(m,g),l.G9.call(m)}};r().dropdown(M,_)}else console.log("Jspreadsheet: filters not enabled.")},s=function(e){var t,n,o,r,l=this,a=null!==(t=l.filters)&&void 0!==t?t:{};if(!e)for(var s=null!==(o=null===(n=l.filter)||void 0===n?void 0:n.children)&&void 0!==o?o:[],c=0;c<s.length;c++)a[c]&&(e=c);var u=function(e,t,n){for(var o,r,i,a=null!==(o=l.options.data)&&void 0!==o?o:[],s=""+(Array.isArray(a[n])?a[n]:[])[t],c=""+(null===(i=null===(r=l.records[n])||void 0===r?void 0:r[t])||void 0===i?void 0:i.element.innerHTML),u=0;u<e.length;u++)if(e[u]==s||e[u]==c)return!0;return!1},d=a[e];l.results=[];for(var f=null!==(r=l.options.data)&&void 0!==r?r:[],p=0;p<f.length;p++)u(d,e,p)&&l.results.push(p);l.results.length||(l.results=null),i.hG.call(l)},c=function(){var e,t,n,o=this;if(o.options.filters)for(var r=null!==(t=null===(e=o.filter)||void 0===e?void 0:e.children)&&void 0!==t?t:[],l=null!==(n=o.filters)&&void 0!==n?n:{},a=0;a<r.length;a++){var s=r[a];s&&(s.innerHTML="&nbsp;"),l[a]=null}o.results=null,i.hG.call(o)}},834:function(e){var t;e.exports=(function(){var e={765:function(e,t){var n;n=function(e){e.version="1.0.2";var t=Math;function n(e,t){for(var n=0,o=0;n<e.length;++n)o=t*o+e[n];return o}function o(e,t,n,o,r){if(0===t)return n;if(1===t)return o;for(var i=2/e,l=o,a=1;a<t;++a)l=o*a*i+r*n,n=o,o=l;return l}function r(e,t,n,r,i){return function(n,l){if(r){if(0===n)return 1==r?-1/0:1/0;if(n<0)return NaN}return 0===l?e(n):1===l?t(n):l<0?NaN:o(n,l|=0,e(n),t(n),i)}}var i,l,a,s,c,u,d,f,p,h,m,g,v,y=function(){var e=.636619772,r=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function s(o){var s=0,c=0,u=0,d=o*o;if(o<8)s=(c=n(r,d))/(u=n(i,d));else{var f=o-.785398164;c=n(l,d=64/d),u=n(a,d),s=t.sqrt(e/o)*(t.cos(f)*c-t.sin(f)*u*8/o)}return s}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),f=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(o){var r=0,i=0,l=0,a=o*o,s=t.abs(o)-2.356194491;return Math.abs(o)<8?r=(i=o*n(c,a))/(l=n(u,a)):(i=n(d,a=64/a),l=n(f,a),r=t.sqrt(e/t.abs(o))*(t.cos(s)*i-t.sin(s)*l*8/t.abs(o)),o<0&&(r=-r)),r}return function e(n,r){if(r=Math.round(r),!isFinite(n))return isNaN(n)?n:0;if(r<0)return(r%2?-1:1)*e(n,-r);if(n<0)return(r%2?-1:1)*e(-n,r);if(0===r)return s(n);if(1===r)return p(n);if(0===n)return 0;var i=0;if(n>r)i=o(n,r,s(n),p(n),-1);else{for(var l=!1,a=0,c=0,u=1,d=0,f=2/n,h=2*t.floor((r+t.floor(t.sqrt(40*r)))/2);h>0;h--)d=h*f*u-a,a=u,u=d,t.abs(u)>1e10&&(u*=1e-10,a*=1e-10,i*=1e-10,c*=1e-10),l&&(c+=u),l=!l,h==r&&(i=a);i/=c=2*c-u}return i}}(),b=(i=.636619772,l=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),a=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),u=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),d=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),r(function(e){var o=0,r=0,u=0,d=e*e,f=e-.785398164;return e<8?o=(r=n(l,d))/(u=n(a,d))+i*y(e,0)*t.log(e):(r=n(s,d=64/d),u=n(c,d),o=t.sqrt(i/e)*(t.sin(f)*r+t.cos(f)*u*8/e)),o},function(e){var o=0,r=0,l=0,a=e*e,s=e-2.356194491;return e<8?o=(r=e*n(u,a))/(l=n(d,a))+i*(y(e,1)*t.log(e)-1/e):(r=n(f,a=64/a),l=n(p,a),o=t.sqrt(i/e)*(t.sin(s)*r+t.cos(s)*l*8/e)),o},0,1,-1)),w=(h=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),m=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),g=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),v=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(o,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?n(h,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(m,3.75/t.abs(e))}(o);if(1===r)return function(e){return e<3.75?e*n(g,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(v,3.75/t.abs(e))}(o);if(r<0)return NaN;if(0===t.abs(o))return 0;if(o==1/0)return 1/0;var i,l=0,a=2/t.abs(o),s=0,c=1,u=0;for(i=2*t.round((r+t.round(t.sqrt(40*r)))/2);i>0;i--)u=i*a*c+s,s=c,c=u,t.abs(c)>1e10&&(c*=1e-10,s*=1e-10,l*=1e-10),i==r&&(l=s);return l*=e(o,0)/c,o<0&&r%2?-l:l}),C=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return r(function(r){return r<=2?-t.log(r/2)*w(r,0)+n(e,r*r/4):t.exp(-r)/t.sqrt(r)*n(o,2/r)},function(e){return e<=2?t.log(e/2)*w(e,1)+1/e*n(i,e*e/4):t.exp(-e)/t.sqrt(e)*n(l,2/e)},0,2,1)}();e.besselj=y,e.bessely=b,e.besseli=w,e.besselk=C},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},162:function(e){var t;e.exports=(t=function(e,t){var n=Array.prototype.concat,o=Array.prototype.slice,r=Object.prototype.toString;function i(t,n){var o=t>n?t:n;return e.pow(10,17-~~(e.log(o>0?o:-o)*e.LOG10E))}var l=Array.isArray||function(e){return"[object Array]"===r.call(e)};function a(e){return"[object Function]"===r.call(e)}function s(e){return"number"==typeof e&&e-e==0}function c(){return new c._init(arguments)}function u(){return 0}function d(){return 1}function f(e,t){return e===t?1:0}c.fn=c.prototype,c._init=function(e){if(l(e[0]))if(l(e[0][0])){a(e[1])&&(e[0]=c.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=a(e[1])?c.map(e[0],e[1]):e[0],this.length=1;else if(s(e[0]))this[0]=c.seq.apply(null,e),this.length=1;else{if(e[0]instanceof c)return c(e[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:i,isArray:l,isFunction:a,isNumber:s,toVector:function(e){return n.apply([],e)}},c._random_fn=e.random,c.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");c._random_fn=e},c.extend=function(e){var t,n;if(1===arguments.length){for(n in e)c[n]=e[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},c.rows=function(e){return e.length||1},c.cols=function(e){return e[0].length||1},c.dimensions=function(e){return{rows:c.rows(e),cols:c.cols(e)}},c.row=function(e,t){return l(t)?t.map(function(t){return c.row(e,t)}):e[t]},c.rowa=function(e,t){return c.row(e,t)},c.col=function(e,t){if(l(t)){var n=c.arange(e.length).map(function(){return new Array(t.length)});return t.forEach(function(t,o){c.arange(e.length).forEach(function(r){n[r][o]=e[r][t]})}),n}for(var o=new Array(e.length),r=0;r<e.length;r++)o[r]=[e[r][t]];return o},c.cola=function(e,t){return c.col(e,t).map(function(e){return e[0]})},c.diag=function(e){for(var t=c.rows(e),n=new Array(t),o=0;o<t;o++)n[o]=[e[o][o]];return n},c.antidiag=function(e){for(var t=c.rows(e)-1,n=new Array(t),o=0;t>=0;t--,o++)n[o]=[e[o][t]];return n},c.transpose=function(e){var t,n,o,r,i,a=[];for(l(e[0])||(e=[e]),n=e.length,o=e[0].length,i=0;i<o;i++){for(t=new Array(n),r=0;r<n;r++)t[r]=e[r][i];a.push(t)}return 1===a.length?a[0]:a},c.map=function(e,t,n){var o,r,i,a,s;for(l(e[0])||(e=[e]),r=e.length,i=e[0].length,a=n?e:new Array(r),o=0;o<r;o++)for(a[o]||(a[o]=new Array(i)),s=0;s<i;s++)a[o][s]=t(e[o][s],o,s);return 1===a.length?a[0]:a},c.cumreduce=function(e,t,n){var o,r,i,a,s;for(l(e[0])||(e=[e]),r=e.length,i=e[0].length,a=n?e:new Array(r),o=0;o<r;o++)for(a[o]||(a[o]=new Array(i)),i>0&&(a[o][0]=e[o][0]),s=1;s<i;s++)a[o][s]=t(a[o][s-1],e[o][s]);return 1===a.length?a[0]:a},c.alter=function(e,t){return c.map(e,t,!0)},c.create=function(e,t,n){var o,r,i=new Array(e);for(a(t)&&(n=t,t=e),o=0;o<e;o++)for(i[o]=new Array(t),r=0;r<t;r++)i[o][r]=n(o,r);return i},c.zeros=function(e,t){return s(t)||(t=e),c.create(e,t,u)},c.ones=function(e,t){return s(t)||(t=e),c.create(e,t,d)},c.rand=function(e,t){return s(t)||(t=e),c.create(e,t,c._random_fn)},c.identity=function(e,t){return s(t)||(t=e),c.create(e,t,f)},c.symmetric=function(e){var t,n,o=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<o;t++)for(n=0;n<o;n++)if(e[n][t]!==e[t][n])return!1;return!0},c.clear=function(e){return c.alter(e,u)},c.seq=function(e,t,n,o){a(o)||(o=!1);var r,l=[],s=i(e,t),c=(t*s-e*s)/((n-1)*s),u=e;for(r=0;u<=t&&r<n;u=(e*s+c*s*++r)/s)l.push(o?o(u,r):u);return l},c.arange=function(e,n,o){var r,i=[];if(o=o||1,n===t&&(n=e,e=0),e===n||0===o)return[];if(e<n&&o<0)return[];if(e>n&&o>0)return[];if(o>0)for(r=e;r<n;r+=o)i.push(r);else for(r=e;r>n;r+=o)i.push(r);return i},c.slice=function(){function e(e,n,o,r){var i,l=[],a=e.length;if(n===t&&o===t&&r===t)return c.copy(e);if(r=r||1,(n=(n=n||0)>=0?n:a+n)===(o=(o=o||e.length)>=0?o:a+o)||0===r)return[];if(n<o&&r<0)return[];if(n>o&&r>0)return[];if(r>0)for(i=n;i<o;i+=r)l.push(e[i]);else for(i=n;i>o;i+=r)l.push(e[i]);return l}return function(t,n){var o,r;return s((n=n||{}).row)?s(n.col)?t[n.row][n.col]:e(c.rowa(t,n.row),(o=n.col||{}).start,o.end,o.step):s(n.col)?e(c.cola(t,n.col),(r=n.row||{}).start,r.end,r.step):(r=n.row||{},o=n.col||{},e(t,r.start,r.end,r.step).map(function(t){return e(t,o.start,o.end,o.step)}))}}(),c.sliceAssign=function(n,o,r){var i,l;if(s(o.row)){if(s(o.col))return n[o.row][o.col]=r;o.col=o.col||{},o.col.start=o.col.start||0,o.col.end=o.col.end||n[0].length,o.col.step=o.col.step||1,i=c.arange(o.col.start,e.min(n.length,o.col.end),o.col.step);var a=o.row;return i.forEach(function(e,t){n[a][e]=r[t]}),n}if(s(o.col)){o.row=o.row||{},o.row.start=o.row.start||0,o.row.end=o.row.end||n.length,o.row.step=o.row.step||1,l=c.arange(o.row.start,e.min(n[0].length,o.row.end),o.row.step);var u=o.col;return l.forEach(function(e,t){n[e][u]=r[t]}),n}return r[0].length===t&&(r=[r]),o.row.start=o.row.start||0,o.row.end=o.row.end||n.length,o.row.step=o.row.step||1,o.col.start=o.col.start||0,o.col.end=o.col.end||n[0].length,o.col.step=o.col.step||1,l=c.arange(o.row.start,e.min(n.length,o.row.end),o.row.step),i=c.arange(o.col.start,e.min(n[0].length,o.col.end),o.col.step),l.forEach(function(e,t){i.forEach(function(o,i){n[e][o]=r[t][i]})}),n},c.diagonal=function(e){var t=c.zeros(e.length,e.length);return e.forEach(function(e,n){t[n][n]=e}),t},c.copy=function(e){return e.map(function(e){return s(e)?e:e.map(function(e){return e})})};var p=c.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?o.call(this):o.call(this)[0]},p.map=function(e,t){return c(c.map(this,e,t))},p.cumreduce=function(e,t){return c(c.cumreduce(this,e,t))},p.alter=function(e){return c.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t){var n,o=this;return t?(setTimeout(function(){t.call(o,p[e].call(o))}),this):(n=c[e](this),l(n)?c(n):n)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t,n){var o=this;return n?(setTimeout(function(){n.call(o,p[e].call(o,t))}),this):c(c[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(){return c(c[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),c}(Math),function(e,t){var n=e.utils.isFunction;function o(e,t){return e-t}function r(e,n,o){return t.max(n,t.min(e,o))}e.sum=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,o=e.mean(t),r=0,i=t.length;--i>=0;)r+=(n=t[i]-o)*n;return r},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],o=0;o<e.length;o++)t[e[o]]||(t[e[o]]=!0,n.push(e[o]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){var o=n.map(t.log),r=e.mean(o);return t.exp(r)},e.median=function(e){var t=e.length,n=e.slice().sort(o);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(e,t){return e+t})},e.cumprod=function(t){return e.cumreduce(t,function(e,t){return e*t})},e.diff=function(e){var t,n=[],o=e.length;for(t=1;t<o;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){var t,n=[],r={};for(t=0;t<e.length;t++)r[s=e[t]]?r[s]++:(r[s]=1,n.push(s));var i=n.sort(o),l={},a=1;for(t=0;t<i.length;t++){var s,c=r[s=i[t]],u=(a+(a+c-1))/2;l[s]=u,a+=c}return e.map(function(e){return l[e]})},e.mode=function(e){var t,n=e.length,r=e.slice().sort(o),i=1,l=0,a=0,s=[];for(t=0;t<n;t++)r[t]===r[t+1]?i++:(i>l?(s=[r[t]],l=i,a=0):i===l&&(s.push(r[t]),a++),i=1);return 0===a?s[0]:s},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.pooledvariance=function(t){return t.reduce(function(t,n){return t+e.sumsqerr(n)},0)/(t.reduce(function(e,t){return e+t.length},0)-t.length)},e.deviation=function(t){for(var n=e.mean(t),o=t.length,r=new Array(o),i=0;i<o;i++)r[i]=t[i]-n;return r},e.stdev=function(n,o){return t.sqrt(e.variance(n,o))},e.pooledstdev=function(n){return t.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var o=e.mean(n),r=[],i=n.length-1;i>=0;i--)r.push(t.abs(n[i]-o));return e.mean(r)},e.meddev=function(n){for(var o=e.median(n),r=[],i=n.length-1;i>=0;i--)r.push(t.abs(n[i]-o));return e.median(r)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var n=e.length,r=e.slice().sort(o);return[r[t.round(n/4)-1],r[t.round(n/2)-1],r[t.round(3*n/4)-1]]},e.quantiles=function(e,n,i,l){var a,s,c,u,d,f=e.slice().sort(o),p=[n.length],h=e.length;for(void 0===i&&(i=3/8),void 0===l&&(l=3/8),a=0;a<n.length;a++)c=h*(s=n[a])+(i+s*(1-i-l)),u=t.floor(r(c,1,h-1)),d=r(c-u,0,1),p[a]=(1-d)*f[u-1]+d*f[u];return p},e.percentile=function(e,t,n){var r=e.slice().sort(o),i=t*(r.length+(n?1:-1))+(n?0:1),l=parseInt(i),a=i-l;return l+1<r.length?r[l-1]+a*(r[l]-r[l-1]):r[l-1]},e.percentileOfScore=function(e,t,n){var o,r,i=0,l=e.length,a=!1;for("strict"===n&&(a=!0),r=0;r<l;r++)o=e[r],(a&&o<t||!a&&o<=t)&&i++;return i/l},e.histogram=function(n,o){o=o||4;var r,i=e.min(n),l=(e.max(n)-i)/o,a=n.length,s=[];for(r=0;r<o;r++)s[r]=0;for(r=0;r<a;r++)s[t.min(t.floor((n[r]-i)/l),o-1)]+=1;return s},e.covariance=function(t,n){var o,r=e.mean(t),i=e.mean(n),l=t.length,a=new Array(l);for(o=0;o<l;o++)a[o]=(t[o]-r)*(n[o]-i);return e.sum(a)/(l-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(t,n){return t=e.rank(t),n=e.rank(n),e.corrcoeff(t,n)},e.stanMoment=function(n,o){for(var r=e.mean(n),i=e.stdev(n),l=n.length,a=0,s=0;s<l;s++)a+=t.pow((n[s]-r)/i,o);return a/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var o=0;o<t.length;o++)!function(t){i[t]=function(o,r){var l=[],a=0,s=this;if(n(o)&&(r=o,o=!1),r)return setTimeout(function(){r.call(s,i[t].call(s,o))}),this;if(this.length>1){for(s=!0===o?this:this.transpose();a<s.length;a++)l[a]=e[t](s[a]);return l}return e[t](this[0],o)}}(t[o])}("cumsum cumprod".split(" ")),function(t){for(var o=0;o<t.length;o++)!function(t){i[t]=function(o,r){var l=[],a=0,s=this;if(n(o)&&(r=o,o=!1),r)return setTimeout(function(){r.call(s,i[t].call(s,o))}),this;if(this.length>1){for("sumrow"!==t&&(s=!0===o?this:this.transpose());a<s.length;a++)l[a]=e[t](s[a]);return!0===o?e[t](e.utils.toVector(l)):l}return e[t](this[0],o)}}(t[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var o=0;o<t.length;o++)!function(t){i[t]=function(){var o,r=[],l=0,a=this,s=Array.prototype.slice.call(arguments);if(n(s[s.length-1])){o=s[s.length-1];var c=s.slice(0,s.length-1);return setTimeout(function(){o.call(a,i[t].apply(a,c))}),this}o=void 0;var u=function(n){return e[t].apply(a,[n].concat(s))};if(this.length>1){for(a=a.transpose();l<a.length;l++)r[l]=u(a[l]);return r}return u(this[0])}}(t[o])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,t){e.gammaln=function(e){var n,o,r,i=0,l=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(o=n=e)+5.5,r-=(n+.5)*t.log(r);i<6;i++)a+=l[i]/++o;return t.log(2.5066282746310007*a/n)-r},e.loggam=function(e){var n,o,r,i,l,a,s,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=e,s=0,1==e||2==e)return 0;for(e<=7&&(n=e+(s=t.floor(7-e))),o=1/(n*n),r=2*t.PI,l=c[9],a=8;a>=0;a--)l*=o,l+=c[a];if(i=l/n+.5*t.log(r)+(n-.5)*t.log(n)-n,e<=7)for(a=1;a<=s;a++)i-=t.log(n-1),n-=1;return i},e.gammafn=function(e){var n,o,r,i,l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,c=0,u=0,d=0,f=e;if(e>171.6243769536076)return 1/0;if(f<=0){if(!(i=f%1+36e-17))return 1/0;s=(1&f?-1:1)*t.PI/t.sin(t.PI*i),f=1-f}for(r=f,o=f<1?f++:(f-=c=(0|f)-1)-1,n=0;n<8;++n)d=(d+l[n])*o,u=u*o+a[n];if(i=d/u+1,r<f)i/=r;else if(r>f)for(n=0;n<c;++n)i*=f,f++;return s&&(i=s/i),i},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,o){var r,i=e.gammaln(n),l=n,a=1/n,s=a,c=o+1-n,u=1/1e-30,d=1/c,f=d,p=1,h=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(o<0||n<=0)return NaN;if(o<n+1){for(;p<=h;p++)a+=s*=o/++l;return a*t.exp(-o+n*t.log(o)-i)}for(;p<=h;p++)f*=(d=1/(d=(r=-p*(p-n))*d+(c+=2)))*(u=c+r/u);return 1-f*t.exp(-o+n*t.log(o)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,o){return n>170||o>170?t.exp(e.combinationln(n,o)):e.factorial(n)/e.factorial(o)/e.factorial(n-o)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,o){if(!(n<=0||o<=0))return n+o>170?t.exp(e.betaln(n,o)):e.gammafn(n)*e.gammafn(o)/e.gammafn(n+o)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,o){var r,i,l,a,s=1e-30,c=1,u=n+o,d=n+1,f=n-1,p=1,h=1-u*e/d;for(t.abs(h)<s&&(h=s),a=h=1/h;c<=100&&(h=1+(i=c*(o-c)*e/((f+(r=2*c))*(n+r)))*h,t.abs(h)<s&&(h=s),p=1+i/p,t.abs(p)<s&&(p=s),a*=(h=1/h)*p,h=1+(i=-(n+c)*(u+c)*e/((n+r)*(d+r)))*h,t.abs(h)<s&&(h=s),p=1+i/p,t.abs(p)<s&&(p=s),a*=l=(h=1/h)*p,!(t.abs(l-1)<3e-7));c++);return a},e.gammapinv=function(n,o){var r,i,l,a,s,c,u=0,d=o-1,f=e.gammaln(o);if(n>=1)return t.max(100,o+100*t.sqrt(o));if(n<=0)return 0;for(o>1?(s=t.log(d),c=t.exp(d*(s-1)-f),a=n<.5?n:1-n,r=(2.30753+.27061*(i=t.sqrt(-2*t.log(a))))/(1+i*(.99229+.04481*i))-i,n<.5&&(r=-r),r=t.max(.001,o*t.pow(1-1/(9*o)-r/(3*t.sqrt(o)),3))):r=n<(i=1-o*(.253+.12*o))?t.pow(n/i,1/o):1-t.log(1-(n-i)/(1-i));u<12;u++){if(r<=0)return 0;if((r-=i=(l=(e.lowRegGamma(o,r)-n)/(i=o>1?c*t.exp(-(r-d)+d*(t.log(r)-s)):t.exp(-r+d*t.log(r)-f)))/(1-.5*t.min(1,l*((o-1)/r-1))))<=0&&(r=.5*(r+i)),t.abs(i)<1e-8*r)break}return r},e.erf=function(e){var n,o,r,i,l=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=l.length-1,s=!1,c=0,u=0;for(e<0&&(e=-e,s=!0),o=4*(n=2/(2+e))-2;a>0;a--)r=c,c=o*c-u+l[a],u=r;return i=n*t.exp(-e*e+.5*(l[0]+o*c)-u),s?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var o,r,i,l,a=0;if(n>=2)return-100;if(n<=0)return 100;for(l=n<1?n:2-n,o=-.70711*((2.30753+.27061*(i=t.sqrt(-2*t.log(l/2))))/(1+i*(.99229+.04481*i))-i);a<2;a++)o+=(r=e.erfc(o)-l)/(1.1283791670955126*t.exp(-o*o)-o*r);return n<1?o:-o},e.ibetainv=function(n,o,r){var i,l,a,s,c,u,d,f,p,h,m=o-1,g=r-1,v=0;if(n<=0)return 0;if(n>=1)return 1;for(o>=1&&r>=1?(a=n<.5?n:1-n,u=(2.30753+.27061*(s=t.sqrt(-2*t.log(a))))/(1+s*(.99229+.04481*s))-s,n<.5&&(u=-u),d=(u*u-3)/6,f=2/(1/(2*o-1)+1/(2*r-1)),p=u*t.sqrt(d+f)/f-(1/(2*r-1)-1/(2*o-1))*(d+5/6-2/(3*f)),u=o/(o+r*t.exp(2*p))):(i=t.log(o/(o+r)),l=t.log(r/(o+r)),u=n<(s=t.exp(o*i)/o)/(p=s+(c=t.exp(r*l)/r))?t.pow(o*p*n,1/o):1-t.pow(r*p*(1-n),1/r)),h=-e.gammaln(o)-e.gammaln(r)+e.gammaln(o+r);v<10;v++){if(0===u||1===u)return u;if((u-=s=(c=(e.ibeta(u,o,r)-n)/(s=t.exp(m*t.log(u)+g*t.log(1-u)+h)))/(1-.5*t.min(1,c*(m/u-g/(1-u)))))<=0&&(u=.5*(u+s)),u>=1&&(u=.5*(u+s+1)),t.abs(s)<1e-8*u&&v>0)break}return u},e.ibeta=function(n,o,r){var i=0===n||1===n?0:t.exp(e.gammaln(o+r)-e.gammaln(o)-e.gammaln(r)+o*t.log(n)+r*t.log(1-n));return!(n<0||n>1)&&(n<(o+1)/(o+r+2)?i*e.betacf(n,o,r)/o:1-i*e.betacf(1-n,r,o)/r)},e.randn=function(n,o){var r,i,l,a,s;if(o||(o=n),n)return e.create(n,o,function(){return e.randn()});do{r=e._random_fn(),i=1.7156*(e._random_fn()-.5),s=(l=r-.449871)*l+(a=t.abs(i)+.386595)*(.196*a-.25472*l)}while(s>.27597&&(s>.27846||i*i>-4*t.log(r)*r*r));return i/r},e.randg=function(n,o,r){var i,l,a,s,c,u,d=n;if(r||(r=o),n||(n=1),o)return(u=e.zeros(o,r)).alter(function(){return e.randg(n)}),u;n<1&&(n+=1),i=n-1/3,l=1/t.sqrt(9*i);do{do{s=1+l*(c=e.randn())}while(s<=0);s*=s*s,a=e._random_fn()}while(a>1-.331*t.pow(c,4)&&t.log(a)>.5*c*c+i*(1-s+t.log(s)));if(n==d)return i*s;do{a=e._random_fn()}while(0===a);return t.pow(a,1/d)*i*s},function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e.map(this,function(n){return e[t](n)}))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(t,Math),function(e,t){function n(e,n,o,r){for(var i,l=0,a=1,s=1,c=1,u=0,d=0;t.abs((s-d)/s)>r;)d=s,a=c+(i=-(n+u)*(n+o+u)*e/(n+2*u)/(n+2*u+1))*a,s=(l=s+i*l)+(i=(u+=1)*(o-u)*e/(n+2*u-1)/(n+2*u))*s,l/=c=a+i*c,a/=c,s/=c,c=1;return s/n}function o(n,o,r){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],l=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],a=.5*n;if(a>=8)return 1;var s,c=2*e.normal.cdf(a,0,1,1,0)-1;c=c>=t.exp(-50/r)?t.pow(c,r):0;for(var u=a,d=(8-a)/(s=n>3?2:3),f=u+d,p=0,h=r-1,m=1;m<=s;m++){for(var g=0,v=.5*(f+u),y=.5*(f-u),b=1;b<=12;b++){var w,C=v+y*(6<b?i[(w=12-b+1)-1]:-i[(w=b)-1]),x=C*C;if(x>60)break;var E=2*e.normal.cdf(C,0,1,1,0)*.5-2*e.normal.cdf(C,n,1,1,0)*.5;E>=t.exp(-30/h)&&(g+=E=l[w-1]*t.exp(-.5*x)*t.pow(E,h))}p+=g*=2*y*r/t.sqrt(2*t.PI),u=f,f+=d}return(c+=p)<=t.exp(-30/o)?0:(c=t.pow(c,o))>=1?1:c}!function(t){for(var n=0;n<t.length;n++)!function(t){e[t]=function e(t,n,o){return this instanceof e?(this._a=t,this._b=n,this._c=o,this):new e(t,n,o)},e.fn[t]=function(n,o,r){var i=e[t](n,o,r);return i.data=this,i},e[t].prototype.sample=function(n){var o=this._a,r=this._b,i=this._c;return n?e.alter(n,function(){return e[t].sample(o,r,i)}):e[t].sample(o,r,i)},function(n){for(var o=0;o<n.length;o++)!function(n){e[t].prototype[n]=function(o){var r=this._a,i=this._b,l=this._c;return o||0===o||(o=this.data),"number"!=typeof o?e.fn.map.call(o,function(o){return e[t][n](o,r,i,l)}):e[t][n](o,r,i,l)}}(n[o])}("pdf cdf inv".split(" ")),function(n){for(var o=0;o<n.length;o++)!function(n){e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}}(n[o])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,o,r){return n>1||n<0?0:1==o&&1==r?1:o<512&&r<512?t.pow(n,o-1)*t.pow(1-n,r-1)/e.betafn(o,r):t.exp((o-1)*t.log(n)+(r-1)*t.log(1-n)-e.betaln(o,r))},cdf:function(t,n,o){return t>1||t<0?1*(t>1):e.ibeta(t,n,o)},inv:function(t,n,o){return e.ibetainv(t,n,o)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var o=e.randg(t);return o/(o+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,o,r){var i;return n<0?0:o<=2?0===n&&o<2?1/0:0===n&&2===o?1:1/e.betafn(o/2,r/2)*t.pow(o/r,o/2)*t.pow(n,o/2-1)*t.pow(1+o/r*n,-(o+r)/2):(i=o*n/(r+n*o),o*(r/(r+n*o))/2*e.binomial.pdf((o-2)/2,(o+r-2)/2,i))},cdf:function(t,n,o){return t<0?0:e.ibeta(n*t/(n*t+o),n/2,o/2)},inv:function(t,n,o){return o/(n*(1/e.ibetainv(t,n/2,o/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){return 2*e.randg(t/2)/t/(2*e.randg(n/2)/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,o){return o<0?0:o/(t.pow(e-n,2)+t.pow(o,2))/t.PI},cdf:function(e,n,o){return t.atan((e-n)/o)/t.PI+.5},inv:function(e,n,o){return n+o*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(n,o){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*o+n}}),e.extend(e.chisquare,{pdf:function(n,o){return n<0?0:0===n&&2===o?.5:t.exp((o/2-1)*t.log(n)-n/2-o/2*t.log(2)-e.gammaln(o/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,o,r){return n<0?0:0===n&&1===o?1/r:t.exp((o-1)*t.log(n)-n/r-e.gammaln(o)-o*t.log(r))},cdf:function(t,n,o){return t<0?0:e.lowRegGamma(n,t/o)},inv:function(t,n,o){return e.gammapinv(t,n)*o},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,o,r){return n<=0?0:t.exp(-(o+1)*t.log(n)-r/n-e.gammaln(o)+o*t.log(r))},cdf:function(t,n,o){return t<=0?0:1-e.lowRegGamma(n,o/t)},inv:function(t,n,o){return o/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,o){return 0===e&&1===n?o:1===e&&1===o?n:t.exp(t.log(n)+t.log(o)+(n-1)*t.log(e)+(o-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,o){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),o)},inv:function(e,n,o){return t.pow(1-t.pow(1-e,1/o),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,o){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(o)-t.pow(t.log(e)-n,2)/(2*o*o))},cdf:function(n,o,r){return n<0?0:.5+.5*e.erf((t.log(n)-o)/t.sqrt(2*r*r))},inv:function(n,o,r){return t.exp(-1.4142135623730951*r*e.erfcinv(2*n)+o)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,o){return t.exp(e.randn()*o+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,o,r){return t.abs(r)<1e-14?e.studentt.pdf(n,o):t.abs(n)<1e-14?t.exp(e.gammaln((o+1)/2)-r*r/2-.5*t.log(t.PI*o)-e.gammaln(o/2)):o/n*(e.noncentralt.cdf(n*t.sqrt(1+2/o),o+2,r)-e.noncentralt.cdf(n,o,r))},cdf:function(n,o,r){var i=1e-14;if(t.abs(r)<i)return e.studentt.cdf(n,o);var l=!1;n<0&&(l=!0,r=-r);for(var a=e.normal.cdf(-r,0,1),s=i+1,c=s,u=n*n/(n*n+o),d=0,f=t.exp(-r*r/2),p=t.exp(-r*r/2-.5*t.log(2)-e.gammaln(1.5))*r;d<200||c>i||s>i;)c=s,d>0&&(f*=r*r/(2*d),p*=r*r/(2*(d+.5))),a+=.5*(s=f*e.beta.cdf(u,d+.5,o/2)+p*e.beta.cdf(u,d+1,o/2)),d++;return l?1-a:a}}),e.extend(e.normal,{pdf:function(e,n,o){return t.exp(-.5*t.log(2*t.PI)-t.log(o)-t.pow(e-n,2)/(2*o*o))},cdf:function(n,o,r){return.5*(1+e.erf((n-o)/t.sqrt(2*r*r)))},inv:function(t,n,o){return-1.4142135623730951*o*e.erfcinv(2*t)+n},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,o){return e<n?0:o*t.pow(n,o)/t.pow(e,o+1)},cdf:function(e,n,o){return e<n?0:1-t.pow(n/e,o)},inv:function(e,n,o){return n/t.pow(1-e,1/o)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,o){return o=o>1e100?1e100:o,1/(t.sqrt(o)*e.betafn(.5,o/2))*t.pow(1+n*n/o,-(o+1)/2)},cdf:function(n,o){var r=o/2;return e.ibeta((n+t.sqrt(n*n+o))/(2*t.sqrt(n*n+o)),r,r)},inv:function(n,o){var r=e.ibetainv(2*t.min(n,1-n),.5*o,.5);return r=t.sqrt(o*(1-r)/r),n>.5?r:-r},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,o){return e<0||n<0||o<0?0:o/n*t.pow(e/n,o-1)*t.exp(-t.pow(e/n,o))},cdf:function(e,n,o){return e<0?0:1-t.exp(-t.pow(e/n,o))},inv:function(e,n,o){return n*t.pow(-t.log(1-e),1/o)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(n,o){return n*t.pow(-t.log(e._random_fn()),1/o)},variance:function(n,o){return n*n*e.gammafn(1+2/o)-t.pow(e.weibull.mean(n,o),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*e._random_fn()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,o,r){return 0===r||1===r?o*r===n?1:0:e.combination(o,n)*t.pow(r,n)*t.pow(1-r,o-n)},cdf:function(o,r,i){var l,a=1e-10;if(o<0)return 0;if(o>=r)return 1;if(i<0||i>1||r<=0)return NaN;var s=i,c=(o=t.floor(o))+1,u=r-o,d=c+u,f=t.exp(e.gammaln(d)-e.gammaln(u)-e.gammaln(c)+c*t.log(s)+u*t.log(1-s));return l=s<(c+1)/(d+2)?f*n(s,c,u,a):1-f*n(1-s,u,c,a),t.round(1/a*(1-l))/(1/a)}}),e.extend(e.negbin,{pdf:function(n,o,r){return n===n>>>0&&(n<0?0:e.combination(n+o-1,o-1)*t.pow(1-r,n)*t.pow(r,o))},cdf:function(t,n,o){var r=0,i=0;if(t<0)return 0;for(;i<=t;i++)r+=e.negbin.pdf(i,n,o);return r}}),e.extend(e.hypgeom,{pdf:function(n,o,r,i){if(n!=n|0)return!1;if(n<0||n<r-(o-i))return 0;if(n>i||n>r)return 0;if(2*r>o)return 2*i>o?e.hypgeom.pdf(o-r-i+n,o,o-r,o-i):e.hypgeom.pdf(i-n,o,o-r,i);if(2*i>o)return e.hypgeom.pdf(r-n,o,r,o-i);if(r<i)return e.hypgeom.pdf(n,o,i,r);for(var l=1,a=0,s=0;s<n;s++){for(;l>1&&a<i;)l*=1-r/(o-a),a++;l*=(i-s)*(r-s)/((s+1)*(o-r-i+s+1))}for(;a<i;a++)l*=1-r/(o-a);return t.min(1,t.max(0,l))},cdf:function(n,o,r,i){if(n<0||n<r-(o-i))return 0;if(n>=i||n>=r)return 1;if(2*r>o)return 2*i>o?e.hypgeom.cdf(o-r-i+n,o,o-r,o-i):1-e.hypgeom.cdf(i-n-1,o,o-r,i);if(2*i>o)return 1-e.hypgeom.cdf(r-n-1,o,r,o-i);if(r<i)return e.hypgeom.cdf(n,o,i,r);for(var l=1,a=1,s=0,c=0;c<n;c++){for(;l>1&&s<i;){var u=1-r/(o-s);a*=u,l*=u,s++}l+=a*=(i-c)*(r-c)/((c+1)*(o-r-i+c+1))}for(;s<i;s++)l*=1-r/(o-s);return t.min(1,t.max(0,l))}}),e.extend(e.poisson,{pdf:function(n,o){return o<0||n%1!=0||n<0?0:t.pow(o,n)*t.exp(-o)/e.factorial(n)},cdf:function(t,n){var o=[],r=0;if(t<0)return 0;for(;r<=t;r++)o.push(e.poisson.pdf(r,n));return e.sum(o)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(n){var o=1,r=0,i=t.exp(-n);do{r++,o*=e._random_fn()}while(o>i);return r-1},sampleLarge:function(n){var o,r,i,l,a,s,c,u,d,f,p=n;for(l=t.sqrt(p),a=t.log(p),s=.02483*(c=.931+2.53*l)-.059,u=1.1239+1.1328/(c-3.4),d=.9277-3.6224/(c-2);;){if(r=t.random()-.5,i=t.random(),f=.5-t.abs(r),o=t.floor((2*s/f+c)*r+p+.43),f>=.07&&i<=d)return o;if(!(o<0||f<.013&&i>f)&&t.log(i)+t.log(u)-t.log(s/(f*f)+c)<=o*a-p-e.loggam(o+1))return o}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,n,o){return n<=t||o<t||o>n?NaN:e<t||e>n?0:e<o?2*(e-t)/((n-t)*(o-t)):e===o?2/(n-t):2*(n-e)/((n-t)*(n-o))},cdf:function(e,n,o,r){return o<=n||r<n||r>o?NaN:e<=n?0:e>=o?1:e<=r?t.pow(e-n,2)/((o-n)*(r-n)):1-t.pow(o-e,2)/((o-n)*(o-r))},inv:function(e,n,o,r){return o<=n||r<n||r>o?NaN:e<=(r-n)/(o-n)?n+(o-n)*t.sqrt(e*((r-n)/(o-n))):n+(o-n)*(1-t.sqrt((1-e)*(1-(r-n)/(o-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,o){return o<=(e+n)/2?n-t.sqrt((n-e)*(n-o))/t.sqrt(2):o>(e+n)/2?e+t.sqrt((n-e)*(o-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(n,o,r){var i=e._random_fn();return i<(r-n)/(o-n)?n+t.sqrt(i*(o-n)*(r-n)):o-t.sqrt((1-i)*(o-n)*(o-r))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.arcsine,{pdf:function(e,n,o){return o<=n?NaN:e<=n||e>=o?0:2/t.PI*t.pow(t.pow(o-n,2)-t.pow(2*e-n-o,2),-.5)},cdf:function(e,n,o){return e<n?0:e<o?2/t.PI*t.asin(t.sqrt((e-n)/(o-n))):1},inv:function(e,n,o){return n+(.5-.5*t.cos(t.PI*e))*(o-n)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,o){return(n+o)/2+(o-n)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,n){return n<=e?NaN:t.pow(n-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,n,o){return o<=0?0:t.exp(-t.abs(e-n)/o)/(2*o)},cdf:function(e,n,o){return o<=0?0:e<n?.5*t.exp((e-n)/o):1-.5*t.exp(-(e-n)/o)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(n,o){var r,i=e._random_fn()-.5;return n-o*((r=i)/t.abs(r))*t.log(1-2*t.abs(i))}}),e.extend(e.tukey,{cdf:function(n,r,i){var l=r,a=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],s=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||l<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return o(n,1,l);var c,u=.5*i,d=u*t.log(i)-i*t.log(2)-e.gammaln(u),f=u-1,p=.25*i;c=i<=100?1:i<=800?.5:i<=5e3?.25:.125,d+=t.log(c);for(var h=0,m=1;m<=50;m++){for(var g=0,v=(2*m-1)*c,y=1;y<=16;y++){var b,w;8<y?(b=y-8-1,w=d+f*t.log(v+a[b]*c)-(a[b]*c+v)*p):(b=y-1,w=d+f*t.log(v-a[b]*c)+(a[b]*c-v)*p),w>=-30&&(g+=o(8<y?n*t.sqrt(.5*(a[b]*c+v)):n*t.sqrt(.5*(-a[b]*c+v)),1,l)*s[b]*t.exp(w))}if(m*c>=1&&g<=1e-14)break;h+=g}if(g>1e-14)throw new Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(n,o,r){if(r<2||o<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,l=function(e,n,o){var r=.5-.5*e,i=t.sqrt(t.log(1/(r*r))),l=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);o<120&&(l+=(l*l*l+l)/o/4);var a=.8832-.2368*l;return o<120&&(a+=-1.214/o+1.208*l/o),l*(a*t.log(n-1)+1.4142)}(n,o,r),a=e.tukey.cdf(l,o,r)-n;i=a>0?t.max(0,l-1):l+1;for(var s,c=e.tukey.cdf(i,o,r)-n,u=1;u<50;u++)if(s=i-c*(i-l)/(c-a),a=c,l=i,s<0&&(s=0,c=-n),c=e.tukey.cdf(s,o,r)-n,i=s,t.abs(i-l)<1e-4)return s;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var n,o,r=Array.prototype.push,i=e.utils.isArray;function l(t){return i(t)||t instanceof e}e.extend({add:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.map(t,function(e,t,o){return e+n[t][o]})):e.map(t,function(e){return e+n})},subtract:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.map(t,function(e,t,o){return e-n[t][o]||0})):e.map(t,function(e){return e-n})},divide:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.multiply(t,e.inv(n))):e.map(t,function(e){return e/n})},multiply:function(t,n){var o,r,i,a,s,c,u,d;if(void 0===t.length&&void 0===n.length)return t*n;if(s=t.length,c=t[0].length,u=e.zeros(s,i=l(n)?n[0].length:c),d=0,l(n)){for(;d<i;d++)for(o=0;o<s;o++){for(a=0,r=0;r<c;r++)a+=t[o][r]*n[r][d];u[o][d]=a}return 1===s&&1===d?u[0][0]:u}return e.map(t,function(e){return e*n})},outer:function(t,n){return e.multiply(t.map(function(e){return[e]}),[n])},dot:function(t,n){l(t[0])||(t=[t]),l(n[0])||(n=[n]);for(var o,r,i=1===t[0].length&&1!==t.length?e.transpose(t):t,a=1===n[0].length&&1!==n.length?e.transpose(n):n,s=[],c=0,u=i.length,d=i[0].length;c<u;c++){for(s[c]=[],o=0,r=0;r<d;r++)o+=i[c][r]*a[c][r];s[c]=o}return 1===s.length?s[0]:s},pow:function(n,o){return e.map(n,function(e){return t.pow(e,o)})},exp:function(n){return e.map(n,function(e){return t.exp(e)})},log:function(n){return e.map(n,function(e){return t.log(e)})},abs:function(n){return e.map(n,function(e){return t.abs(e)})},norm:function(e,n){var o=0,r=0;for(isNaN(n)&&(n=2),l(e[0])&&(e=e[0]);r<e.length;r++)o+=t.pow(t.abs(e[r]),n);return t.pow(o,1/n)},angle:function(n,o){return t.acos(e.dot(n,o)/(e.norm(n)*e.norm(o)))},aug:function(e,t){var n,o=[];for(n=0;n<e.length;n++)o.push(e[n].slice());for(n=0;n<o.length;n++)r.apply(o[n],t[n]);return o},inv:function(t){for(var n,o=t.length,r=t[0].length,i=e.identity(o,r),l=e.gauss_jordan(t,i),a=[],s=0;s<o;s++)for(a[s]=[],n=r;n<l[0].length;n++)a[s][n-r]=l[s][n];return a},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,o=0;o<t.length;o++){for(var r=[],i=1;i<t.length;i++){r[i-1]=[];for(var l=0;l<t.length;l++)l<o?r[i-1][l]=t[i][l]:l>o&&(r[i-1][l-1]=t[i][l])}var a=o%2?-1:1;n+=e(r)*t[0][o]*a}return n},gauss_elimination:function(n,o){var r,i,l,a,s=0,c=0,u=n.length,d=n[0].length,f=1,p=0,h=[];for(r=(n=e.aug(n,o))[0].length,s=0;s<u;s++){for(i=n[s][s],c=s,a=s+1;a<d;a++)i<t.abs(n[a][s])&&(i=n[a][s],c=a);if(c!=s)for(a=0;a<r;a++)l=n[s][a],n[s][a]=n[c][a],n[c][a]=l;for(c=s+1;c<u;c++)for(f=n[c][s]/n[s][s],a=s;a<r;a++)n[c][a]=n[c][a]-f*n[s][a]}for(s=u-1;s>=0;s--){for(p=0,c=s+1;c<=u-1;c++)p+=h[c]*n[s][c];h[s]=(n[s][r-1]-p)/n[s][s]}return h},gauss_jordan:function(n,o){var r,i,l,a=e.aug(n,o),s=a.length,c=a[0].length,u=0;for(i=0;i<s;i++){var d=i;for(l=i+1;l<s;l++)t.abs(a[l][i])>t.abs(a[d][i])&&(d=l);var f=a[i];for(a[i]=a[d],a[d]=f,l=i+1;l<s;l++)for(u=a[l][i]/a[i][i],r=i;r<c;r++)a[l][r]-=a[i][r]*u}for(i=s-1;i>=0;i--){for(u=a[i][i],l=0;l<i;l++)for(r=c-1;r>i-1;r--)a[l][r]-=a[i][r]*a[l][i]/u;for(a[i][i]/=u,r=s;r<c;r++)a[i][r]/=u}return a},triaUpSolve:function(t,n){var o,r=t[0].length,i=e.zeros(1,r)[0],l=!1;return null!=n[0].length&&(n=n.map(function(e){return e[0]}),l=!0),e.arange(r-1,-1,-1).forEach(function(l){o=e.arange(l+1,r).map(function(e){return i[e]*t[l][e]}),i[l]=(n[l]-e.sum(o))/t[l][l]}),l?i.map(function(e){return[e]}):i},triaLowSolve:function(t,n){var o,r=t[0].length,i=e.zeros(1,r)[0],l=!1;return null!=n[0].length&&(n=n.map(function(e){return e[0]}),l=!0),e.arange(r).forEach(function(r){o=e.arange(r).map(function(e){return t[r][e]*i[e]}),i[r]=(n[r]-e.sum(o))/t[r][r]}),l?i.map(function(e){return[e]}):i},lu:function(t){var n,o=t.length,r=e.identity(o),i=e.zeros(t.length,t[0].length);return e.arange(o).forEach(function(e){i[0][e]=t[0][e]}),e.arange(1,o).forEach(function(l){e.arange(l).forEach(function(o){n=e.arange(o).map(function(e){return r[l][e]*i[e][o]}),r[l][o]=(t[l][o]-e.sum(n))/i[o][o]}),e.arange(l,o).forEach(function(o){n=e.arange(l).map(function(e){return r[l][e]*i[e][o]}),i[l][o]=t[n.length][o]-e.sum(n)})}),[r,i]},cholesky:function(n){var o,r=n.length,i=e.zeros(n.length,n[0].length);return e.arange(r).forEach(function(l){o=e.arange(l).map(function(e){return t.pow(i[l][e],2)}),i[l][l]=t.sqrt(n[l][l]-e.sum(o)),e.arange(l+1,r).forEach(function(t){o=e.arange(l).map(function(e){return i[l][e]*i[t][e]}),i[t][l]=(n[l][t]-e.sum(o))/i[l][l]})}),i},gauss_jacobi:function(n,o,r,i){for(var l,a,s,c,u=0,d=0,f=n.length,p=[],h=[],m=[];u<f;u++)for(p[u]=[],h[u]=[],m[u]=[],d=0;d<f;d++)u>d?(p[u][d]=n[u][d],h[u][d]=m[u][d]=0):u<d?(h[u][d]=n[u][d],p[u][d]=m[u][d]=0):(m[u][d]=n[u][d],p[u][d]=h[u][d]=0);for(s=e.multiply(e.multiply(e.inv(m),e.add(p,h)),-1),a=e.multiply(e.inv(m),o),l=r,c=e.add(e.multiply(s,r),a),u=2;t.abs(e.norm(e.subtract(c,l)))>i;)l=c,c=e.add(e.multiply(s,l),a),u++;return c},gauss_seidel:function(n,o,r,i){for(var l,a,s,c,u,d=0,f=n.length,p=[],h=[],m=[];d<f;d++)for(p[d]=[],h[d]=[],m[d]=[],l=0;l<f;l++)d>l?(p[d][l]=n[d][l],h[d][l]=m[d][l]=0):d<l?(h[d][l]=n[d][l],p[d][l]=m[d][l]=0):(m[d][l]=n[d][l],p[d][l]=h[d][l]=0);for(c=e.multiply(e.multiply(e.inv(e.add(m,p)),h),-1),s=e.multiply(e.inv(e.add(m,p)),o),a=r,u=e.add(e.multiply(c,r),s),d=2;t.abs(e.norm(e.subtract(u,a)))>i;)a=u,u=e.add(e.multiply(c,a),s),d+=1;return u},SOR:function(n,o,r,i,l){for(var a,s,c,u,d,f=0,p=n.length,h=[],m=[],g=[];f<p;f++)for(h[f]=[],m[f]=[],g[f]=[],a=0;a<p;a++)f>a?(h[f][a]=n[f][a],m[f][a]=g[f][a]=0):f<a?(m[f][a]=n[f][a],h[f][a]=g[f][a]=0):(g[f][a]=n[f][a],h[f][a]=m[f][a]=0);for(u=e.multiply(e.inv(e.add(g,e.multiply(h,l))),e.subtract(e.multiply(g,1-l),e.multiply(m,l))),c=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(h,l))),o),l),s=r,d=e.add(e.multiply(u,r),c),f=2;t.abs(e.norm(e.subtract(d,s)))>i;)s=d,d=e.add(e.multiply(u,s),c),f++;return d},householder:function(n){for(var o,r,i,l,a=n.length,s=n[0].length,c=0,u=[],d=[];c<a-1;c++){for(o=0,l=c+1;l<s;l++)o+=n[l][c]*n[l][c];for(o=(n[c+1][c]>0?-1:1)*t.sqrt(o),r=t.sqrt((o*o-n[c+1][c]*o)/2),(u=e.zeros(a,1))[c+1][0]=(n[c+1][c]-o)/(2*r),i=c+2;i<a;i++)u[i][0]=n[i][c]/(2*r);d=e.subtract(e.identity(a,s),e.multiply(e.multiply(u,e.transpose(u)),2)),n=e.multiply(d,e.multiply(n,d))}return n},QR:(n=e.sum,o=e.arange,function(r){var i,l,a,s=r.length,c=r[0].length,u=e.zeros(c,c);for(r=e.copy(r),l=0;l<c;l++){for(u[l][l]=t.sqrt(n(o(s).map(function(e){return r[e][l]*r[e][l]}))),i=0;i<s;i++)r[i][l]=r[i][l]/u[l][l];for(a=l+1;a<c;a++)for(u[l][a]=n(o(s).map(function(e){return r[e][l]*r[e][a]})),i=0;i<s;i++)r[i][a]=r[i][a]-r[i][l]*u[l][a]}return[r,u]}),lstsq:function(t,n){var o=!1;void 0===n[0].length&&(n=n.map(function(e){return[e]}),o=!0);var r=e.QR(t),i=r[0],l=r[1],a=t[0].length,s=e.slice(i,{col:{end:a}}),c=function(t){var n=(t=e.copy(t)).length,o=e.identity(n);return e.arange(n-1,-1,-1).forEach(function(n){e.sliceAssign(o,{row:n},e.divide(e.slice(o,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach(function(r){var i=e.multiply(t[r][n],-1),l=e.slice(t,{row:r}),a=e.multiply(e.slice(t,{row:n}),i);e.sliceAssign(t,{row:r},e.add(l,a));var s=e.slice(o,{row:r}),c=e.multiply(e.slice(o,{row:n}),i);e.sliceAssign(o,{row:r},e.add(s,c))})}),o}(e.slice(l,{row:{end:a}})),u=e.transpose(s);void 0===u[0].length&&(u=[u]);var d=e.multiply(e.multiply(c,u),n);return void 0===d.length&&(d=[[d]]),o?d.map(function(e){return e[0]}):d},jacobi:function(n){for(var o,r,i,l,a,s,c,u=1,d=n.length,f=e.identity(d,d),p=[];1===u;){for(a=n[0][1],i=0,l=1,o=0;o<d;o++)for(r=0;r<d;r++)o!=r&&a<t.abs(n[o][r])&&(a=t.abs(n[o][r]),i=o,l=r);for(s=n[i][i]===n[l][l]?n[i][l]>0?t.PI/4:-t.PI/4:t.atan(2*n[i][l]/(n[i][i]-n[l][l]))/2,(c=e.identity(d,d))[i][i]=t.cos(s),c[i][l]=-t.sin(s),c[l][i]=t.sin(s),c[l][l]=t.cos(s),f=e.multiply(f,c),n=e.multiply(e.multiply(e.inv(c),n),c),u=0,o=1;o<d;o++)for(r=1;r<d;r++)o!=r&&t.abs(n[o][r])>.001&&(u=1)}for(o=0;o<d;o++)p.push(n[o][o]);return[f,p]},rungekutta:function(e,t,n,o,r,i){var l,a,s;if(2===i)for(;o<=n;)r+=((l=t*e(o,r))+(a=t*e(o+t,r+l)))/2,o+=t;if(4===i)for(;o<=n;)r+=((l=t*e(o,r))+2*(a=t*e(o+t/2,r+l/2))+2*(s=t*e(o+t/2,r+a/2))+t*e(o+t,r+s))/6,o+=t;return r},romberg:function(e,n,o,r){for(var i,l,a,s,c,u=0,d=(o-n)/2,f=[],p=[],h=[];u<r/2;){for(c=e(n),a=n,s=0;a<=o;a+=d,s++)f[s]=a;for(i=f.length,a=1;a<i-1;a++)c+=(a%2!=0?4:2)*e(f[a]);c=d/3*(c+e(o)),h[u]=c,d/=2,u++}for(l=h.length,i=1;1!==l;){for(a=0;a<l-1;a++)p[a]=(t.pow(4,i)*h[a+1]-h[a])/(t.pow(4,i)-1);l=p.length,h=p,p=[],i++}return h},richardson:function(e,n,o,r){function i(e,t){for(var n,o=0,r=e.length;o<r;o++)e[o]===t&&(n=o);return n}for(var l,a,s,c,u,d=t.abs(o-e[i(e,o)+1]),f=0,p=[],h=[];r>=d;)l=i(e,o+r),a=i(e,o),p[f]=(n[l]-2*n[a]+n[2*a-l])/(r*r),r/=2,f++;for(c=p.length,s=1;1!=c;){for(u=0;u<c-1;u++)h[u]=(t.pow(4,s)*p[u+1]-p[u])/(t.pow(4,s)-1);c=h.length,p=h,h=[],s++}return p},simpson:function(e,t,n,o){for(var r,i=(n-t)/o,l=e(t),a=[],s=t,c=0,u=1;s<=n;s+=i,c++)a[c]=s;for(r=a.length;u<r-1;u++)l+=(u%2!=0?4:2)*e(a[u]);return i/3*(l+e(n))},hermite:function(e,t,n,o){for(var r,i=e.length,l=0,a=0,s=[],c=[],u=[],d=[];a<i;a++){for(s[a]=1,r=0;r<i;r++)a!=r&&(s[a]*=(o-e[r])/(e[a]-e[r]));for(c[a]=0,r=0;r<i;r++)a!=r&&(c[a]+=1/(e[a]-e[r]));u[a]=(1-2*(o-e[a])*c[a])*(s[a]*s[a]),d[a]=(o-e[a])*(s[a]*s[a]),l+=u[a]*t[a]+d[a]*n[a]}return l},lagrange:function(e,t,n){for(var o,r,i=0,l=0,a=e.length;l<a;l++){for(r=t[l],o=0;o<a;o++)l!=o&&(r*=(n-e[o])/(e[l]-e[o]));i+=r}return i},cubic_spline:function(t,n,o){for(var r,i,l=t.length,a=0,s=[],c=[],u=[],d=[],f=[],p=[];a<l-1;a++)d[a]=t[a+1]-t[a];for(u[0]=0,a=1;a<l-1;a++)u[a]=3/d[a]*(n[a+1]-n[a])-3/d[a-1]*(n[a]-n[a-1]);for(a=1;a<l-1;a++)s[a]=[],c[a]=[],s[a][a-1]=d[a-1],s[a][a]=2*(d[a-1]+d[a]),s[a][a+1]=d[a],c[a][0]=u[a];for(i=e.multiply(e.inv(s),c),r=0;r<l-1;r++)f[r]=(n[r+1]-n[r])/d[r]-d[r]*(i[r+1][0]+2*i[r][0])/3,p[r]=(i[r+1][0]-i[r][0])/(3*d[r]);for(r=0;r<l&&!(t[r]>o);r++);return n[r-=1]+(o-t[r])*f[r]+e.sq(o-t[r])*i[r]+(o-t[r])*e.sq(o-t[r])*p[r]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,o,r,i,l,a=t.length,s=t[0].length,c=0,u=[],d=[],f=[],p=[],h=[],m=[],g=[];for(c=0;c<a;c++)u[c]=e.sum(t[c])/s;for(c=0;c<s;c++)for(h[c]=[],n=0;n<a;n++)h[c][n]=t[n][c]-u[n];for(h=e.transpose(h),c=0;c<a;c++)for(m[c]=[],n=0;n<a;n++)m[c][n]=e.dot([h[c]],[h[n]])/(s-1);for(l=(r=e.jacobi(m))[0],d=r[1],g=e.transpose(l),c=0;c<d.length;c++)for(n=c;n<d.length;n++)d[c]<d[n]&&(o=d[c],d[c]=d[n],d[n]=o,f=g[c],g[c]=g[n],g[n]=f);for(i=e.transpose(h),c=0;c<a;c++)for(p[c]=[],n=0;n<i.length;n++)p[c][n]=e.dot([g[c]],[i[n]]);return[t,d,g,p]}}),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(n,o){var r=this;return o?(setTimeout(function(){o.call(r,e.fn[t].call(r,n))},15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var n=[].slice,o=e.utils.isNumber,r=e.utils.isArray;function i(e,n,o,r){if(e>1||o>1||e<=0||o<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*n+o*r)/(n+r);return(e-o)/t.sqrt(i*(1-i)*(1/n+1/r))}e.extend({zscore:function(){var t=n.call(arguments);return o(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var o,i=n.call(arguments);return r(i[1])?(o=e.zscore(i[0],i[1],i[3]),1===i[2]?e.normal.cdf(-t.abs(o),0,1):2*e.normal.cdf(-t.abs(o),0,1)):i.length>2?(o=e.zscore(i[0],i[1],i[2]),1===i[3]?e.normal.cdf(-t.abs(o),0,1):2*e.normal.cdf(-t.abs(o),0,1)):(o=i[0],1===i[1]?e.normal.cdf(-t.abs(o),0,1):2*e.normal.cdf(-t.abs(o),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,o,r){var i=t.abs(this.zscore(n,r));return 1===o?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var o=n.call(arguments);return 4===o.length?(o[0]-o[1])/(o[2]/t.sqrt(o[3])):(o[0]-e.mean(o[1]))/(e.stdev(o[1],!0)/t.sqrt(o[1].length))},ttest:function(){var r,i=n.call(arguments);return 5===i.length?(r=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-r,i[3]-1):2*e.studentt.cdf(-r,i[3]-1)):o(i[1])?(r=t.abs(i[0]),1==i[2]?e.studentt.cdf(-r,i[1]-1):2*e.studentt.cdf(-r,i[1]-1)):(r=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-r,i[1].length-1):2*e.studentt.cdf(-r,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,o){return 1===o?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var o,r,i,l,a,s,c,u,d=n.call(arguments);if(1===d.length){for(a=new Array(d[0].length),c=0;c<d[0].length;c++)a[c]=d[0][c];d=a}for(r=new Array,c=0;c<d.length;c++)r=r.concat(d[c]);for(i=e.mean(r),o=0,c=0;c<d.length;c++)o+=d[c].length*t.pow(e.mean(d[c])-i,2);for(o/=d.length-1,s=0,c=0;c<d.length;c++)for(l=e.mean(d[c]),u=0;u<d[c].length;u++)s+=t.pow(d[c][u]-l,2);return o/(s/(r.length-d.length))},anovaftest:function(){var t,r,i,l,a=n.call(arguments);if(o(a[0]))return 1-e.centralF.cdf(a[0],a[1],a[2]);var s=e.anovafscore(a);for(t=a.length-1,i=0,l=0;l<a.length;l++)i+=a[l].length;return r=i-t-1,1-e.centralF.cdf(s,t,r)},ftest:function(t,n,o){return 1-e.centralF.cdf(t,n,o)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var r,i,l,a,s,c=n.call(arguments);return o(c[0])?(r=c[0],i=c[1],l=c[2],a=c[3],s=c[4]):(r=e.mean(c[0]),i=e.mean(c[1]),l=c[0].length,a=c[1].length,s=c[2]),t.abs(r-i)/(s*t.sqrt((1/l+1/a)/2))},qtest:function(){var t,o=n.call(arguments);3===o.length?(t=o[0],o=o.slice(1)):7===o.length?(t=e.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(t=e.qscore(o[0],o[1],o[2]),o=o.slice(3));var r=o[0],i=o[1];return 1-e.tukey.cdf(t,i,r-i)},tukeyhsd:function(t){for(var n=e.pooledstdev(t),o=t.map(function(t){return e.mean(t)}),r=t.reduce(function(e,t){return e+t.length},0),i=[],l=0;l<t.length;++l)for(var a=l+1;a<t.length;++a){var s=e.qtest(o[l],o[a],t[l].length,t[a].length,n,r,t.length);i.push([[l,a],s])}return i}}),e.extend({normalci:function(){var o,r=n.call(arguments),i=new Array(2);return o=4===r.length?t.abs(e.normal.inv(r[1]/2,0,1)*r[2]/t.sqrt(r[3])):t.abs(e.normal.inv(r[1]/2,0,1)*e.stdev(r[2])/t.sqrt(r[2].length)),i[0]=r[0]-o,i[1]=r[0]+o,i},tci:function(){var o,r=n.call(arguments),i=new Array(2);return o=4===r.length?t.abs(e.studentt.inv(r[1]/2,r[3]-1)*r[2]/t.sqrt(r[3])):t.abs(e.studentt.inv(r[1]/2,r[2].length-1)*e.stdev(r[2],!0)/t.sqrt(r[2].length)),i[0]=r[0]-o,i[1]=r[0]+o,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,n,o,r){var l=i(t,n,o,r);return e.ztest(l,1)},twoSidedDifferenceOfProportions:function(t,n,o,r){var l=i(t,n,o,r);return e.ztest(l,2)}})}(t,Math),t.models=function(){function e(e,n){var o=e.length,r=n[0].length-1,i=o-r-1,l=t.lstsq(n,e),a=t.multiply(n,l.map(function(e){return[e]})).map(function(e){return e[0]}),s=t.subtract(e,a),c=t.mean(e),u=t.sum(a.map(function(e){return Math.pow(e-c,2)})),d=t.sum(e.map(function(e,t){return Math.pow(e-a[t],2)})),f=u+d;return{exog:n,endog:e,nobs:o,df_model:r,df_resid:i,coef:l,predict:a,resid:s,ybar:c,SST:f,SSE:u,SSR:d,R2:u/f}}return{ols:function(n,o){var r=e(n,o),i=function(n){var o,r,i=(o=n.exog,r=o[0].length,t.arange(r).map(function(n){var i=t.arange(r).filter(function(e){return e!==n});return e(t.col(o,n).map(function(e){return e[0]}),t.col(o,i))})),l=Math.sqrt(n.SSR/n.df_resid),a=i.map(function(e){var t=e.SST,n=e.R2;return l/Math.sqrt(t*(1-n))}),s=n.coef.map(function(e,t){return(e-0)/a[t]}),c=s.map(function(e){var o=t.studentt.cdf(e,n.df_resid);return 2*(o>.5?1-o:o)}),u=t.studentt.inv(.975,n.df_resid),d=n.coef.map(function(e,t){var n=u*a[t];return[e-n,e+n]});return{se:a,t:s,p:c,sigmaHat:l,interval95:d}}(r),l=function(e){var n,o,r,i=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:i,pvalue:1-(n=i,o=e.df_model,r=e.df_resid,t.beta.cdf(n/(r/o+n),o/2,r/2))}}(r),a=1-(1-r.R2)*((r.nobs-1)/r.df_resid);return r.t=i,r.f=l,r.adjust_R2=a,r}}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=[1].concat(arguments[n]);return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),n=0;n<arguments[0].length;n++)e[n]=[1].concat(arguments[0][n]);return t(e)},buildjxmatrix:function(e){for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=e[o];return t.builddxmatrix(n)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,n){var o,r,i,l,a;if(e.cols()==n.rows()){if(n.rows()>1){for(l=[],o=0;o<e.rows();o++)for(l[o]=[],r=0;r<n.cols();r++){for(a=0,i=0;i<e.cols();i++)a+=e.toArray()[o][i]*n.toArray()[i][r];l[o][r]=a}return t(l)}for(l=[],o=0;o<e.rows();o++)for(l[o]=[],r=0;r<n.cols();r++){for(a=0,i=0;i<e.cols();i++)a+=e.toArray()[o][i]*n.toArray()[r];l[o][r]=a}return t(l)}},regress:function(e,n){var o=t.xtranspxinv(e),r=e.transpose(),i=t.matrixmult(t(o),r);return t.matrixmult(i,n)},regresst:function(e,n,o){var r=t.regress(e,n),i={anova:{}},l=t.jMatYBar(e,r);i.yBar=l;var a=n.mean();i.anova.residuals=t.residuals(n,l),i.anova.ssr=t.ssr(l,a),i.anova.msr=i.anova.ssr/(e[0].length-1),i.anova.sse=t.sse(n,l),i.anova.mse=i.anova.sse/(n.length-(e[0].length-1)-1),i.anova.sst=t.sst(n,a),i.anova.mst=i.anova.sst/(n.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=t.anovaftest(i.anova.fratio,e[0].length-1,n.length-(e[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(e[0].length);for(var s,c,u,d=t.xtranspxinv(e),f=0;f<r.length;f++)s=Math.sqrt(i.anova.mse*Math.abs(d[f][f])),c=Math.abs(r[f]/s),u=t.ttest(c,n.length-e[0].length-1,o),i.stats[f]=[r[f],s,c,u];return i.regress=r,i},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var n=t.matrixmult(e.transpose(),e);return t.inv(n)},jMatYBar:function(e,n){var o=t.matrixmult(e,n);return new t(o)},residuals:function(e,n){return t.matrixsubtract(e,n)},ssr:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},sse:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t[o],2);return n},sst:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},matrixsubtract:function(e,n){for(var o=new Array(e.length),r=0;r<e.length;r++){o[r]=new Array(e[r].length);for(var i=0;i<e[r].length;i++)o[r][i]=e[r][i]-n[r][i]}return t(o)}}),t.jStat=t,t)},960:function(e,t,n){const o=n(592);e.exports=function(e){function t(e,t){const n=t.split(".");let o=e;for(const e of n){if(null==o)return;o=o[e]}return o}for(let n=0;n<Object.keys(o).length;n++){let r,i=Object.keys(o)[n],l=[];if("object"==typeof o[i]){l=Object.keys(o[i]),r=Object.values(o[i]);for(let e=0;e<r.length;e++)if("object"==typeof r[e]){let t=l[e];o[i][t]&&(l=[...l,...Object.keys(o[i][t]).map(e=>t+"."+e)],l.splice(l.indexOf(t),1))}}if(l.length<1)e[i]=o[i];else for(let n=0;n<l.length;n++)"function"==typeof t(o[i],l[n])&&(e[i]=t(o[i],l[n]))}let n=function(e){return"number"==typeof e&&(e=parseInt(e)),e},r=null,i=null,l=null;e.TABLE=function(){return l},e.COLUMN=e.COL=function(){return l.tracking&&l.tracking.push(c.getColumnNameFromCoords(n(r),n(i))),n(r)+1},e.ROW=function(){return l.tracking&&l.tracking.push(c.getColumnNameFromCoords(n(r),n(i))),n(i)+1},e.CELL=function(){return c.getColumnNameFromCoords(r,i)},e.VALUE=function(e,t,o){return l.getValueFromCoords(n(e)-1,n(t)-1,o)},e.THISROWCELL=function(e){return l.getValueFromCoords(n(e)-1,n(i))};const a=function(e,t){for(let n=0;n<e.length;n++){let o=c.getTokensFromRange(e[n]);t=t.replace(e[n],"["+o.join(",")+"]")}return t},s=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},c=function(e,t,n,o,c){l=c,r=n,i=o;let u="",d={};if(t)if(t.size){let e,n=null;t.forEach(function(t,n){e=n.replace(/!/g,"."),-1!==e.indexOf(".")&&(e=e.split("."),d[e[0]]=!0)}),e=Object.keys(d);for(let t=0;t<e.length;t++)u+="var "+e[t]+" = {};";t.forEach(function(o,r){e=r.replace(/!/g,"."),null===o||s(o)||(n=o.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),n&&n.length&&(o=updateRanges(n,o))),e.indexOf(".")>0?u+=e+" = "+t.get(r)+";\n":u+="var "+e+" = "+o+";\n"})}else{let e=Object.keys(t);if(e.length){let n,o={};for(let t=0;t<e.length;t++)if(n=e[t].replace(/\!/g,"."),n.indexOf(".")>0){let e=e.split(".");o[e[0]]={}}n=Object.keys(o);for(let e=0;e<n.length;e++)u+="var "+n[e]+" = {};";for(let o=0;o<e.length;o++){if(n=e[o].replace(/!/g,"."),null!==t[e[o]]&&!s(t[e[o]])){let n=t[e[o]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);n&&n.length&&(t[e[o]]=a(n,t[e[o]]))}n.indexOf(".")>0?u+=n+" = "+t[e[o]]+";\n":u+="var "+n+" = "+t[e[o]]+";\n"}}}let f=(e=function(e){let t="",n=0,o=["=","!",">","<"];for(let r=0;r<e.length;r++)'"'===e[r]&&(n=0===n?1:0),1===n?t+=e[r]:(t+=e[r].toUpperCase(),r>0&&"="===e[r]&&-1===o.indexOf(e[r-1])&&-1===o.indexOf(e[r+1])&&(t+="="));return t=t.replace(/\^/g,"**"),t=t.replace(/<>/g,"!="),t=t.replace(/&/g,"+"),t=t.replace(/\$/g,""),t}(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);f&&f.length&&(e=a(f,e));let p=new Function(u+"; return "+e)();return null===p&&(p=0),p};return c.getColumnNameFromCoords=function(e,t){return o="",(n=parseInt(e))>701?(o+=String.fromCharCode(64+parseInt(n/676)),o+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(o+=String.fromCharCode(64+parseInt(n/26))),o+String.fromCharCode(65+n%26)+(parseInt(t)+1);var n,o},c.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);var r=parseInt(/[0-9]+$/.exec(e))||null;return r>0&&r--,[n,r]}},c.getRangeFromTokens=function(e){e=e.filter(function(e){return"#REF!"!=e});for(var t="",n="",o=0;o<e.length;o++)e[o].indexOf(".")>=0?t=".":e[o].indexOf("!")>=0&&(t="!"),t&&(n=e[o].split(t),e[o]=n[1],n=n[0]+t);return e.sort(function(e,t){var n=Helpers.getCoordsFromColumnName(e),o=Helpers.getCoordsFromColumnName(t);return n[1]>o[1]?1:n[1]<o[1]?-1:n[0]>o[0]?1:n[0]<o[0]?-1:0}),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},c.getTokensFromRange=function(e){if(e.indexOf(".")>0){var t=e.split(".");e=t[1],t=t[0]+"."}else e.indexOf("!")>0?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=c.getCoordsFromColumnName(e[0]),o=c.getCoordsFromColumnName(e[1]);if(n[0]<=o[0])var r=n[0],i=o[0];else r=o[0],i=n[0];if(null===n[1]&&null==o[1])for(var l=null,a=null,s=Object.keys(vars),u=0;u<s.length;u++){var d=c.getCoordsFromColumnName(s[u]);d[0]===n[0]&&(null===l||d[1]<l)&&(l=d[1]),d[0]===o[0]&&(null===a||d[1]>a)&&(a=d[1])}else n[1]<=o[1]?(l=n[1],a=o[1]):(l=o[1],a=n[1]);for(var f=[],p=l;p<=a;p++){var h=[];for(u=r;u<=i;u++)h.push(t+c.getColumnNameFromCoords(u,p));f.push(h)}return f},c.setFormula=function(t){let n=Object.keys(t);for(let o=0;o<n.length;o++)"function"==typeof t[n[o]]&&(e[n[o]]=t[n[o]])},c.basic=!0,c}("undefined"==typeof window?n.g:window)},592:function(e,t,n){"use strict";var o=n(162),r=n(765);const i=new Error("#NULL!"),l=new Error("#DIV/0!"),a=new Error("#VALUE!"),s=new Error("#REF!"),c=new Error("#NAME?"),u=new Error("#NUM!"),d=new Error("#N/A"),f=new Error("#ERROR!"),p=new Error("#GETTING_DATA");var h=Object.freeze({__proto__:null,data:p,div0:l,error:f,na:d,name:c,nil:i,num:u,ref:s,value:a});function m(e){const t=[];return g(e,e=>{t.push(e)}),t}function g(e,t){let n=-1;const o=e.length;for(;++n<o&&!1!==t(e[n],n,e););return e}function v(e){let t,n=e.length;for(;n--;)if(t=e[n],"number"!=typeof t)if(!0!==t)if(!1!==t){if("string"==typeof t){const o=j(t);e[n]=o instanceof Error?0:o}}else e[n]=0;else e[n]=1;return e}function y(e,t){if(!e)return a;e.every(e=>Array.isArray(e))&&0!==e.length||(e=[[...e]]),e.map((t,n)=>{t.map((t,o)=>{t||(e[n][o]=0)})});const n=e.reduce((t,n,o)=>n.length>e[t].length?o:t,0),o=e[n].length;return e.map(e=>[...e,...Array(o-e.length).fill(t||0)])}function b(){let e;if(1===arguments.length){const n=arguments[0];e=null!=(t=n)&&"number"==typeof t.length&&"string"!=typeof t?m.apply(null,arguments):[n]}else e=Array.from(arguments);for(var t;!C(e);)e=w(e);return e}function w(e){return e&&e.reduce?e.reduce((e,t)=>{const n=Array.isArray(e),o=Array.isArray(t);return n&&o?e.concat(t):n?(e.push(t),e):o?[e].concat(t):[e,t]}):[e]}function C(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function x(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function E(e){return e?e[0].map((t,n)=>e.map(e=>e[n])):a}function A(e,t){let n=null;return g(e,(e,o)=>{if(e[0]===t)return n=o,!1}),null==n?a:n}function L(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function M(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function I(e){const t=1e14;return Math.round(e*t)/t}function T(){return b.apply(null,arguments).filter(e=>"number"==typeof e)}function _(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||a}function N(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?u:function(e){e<60&&(e+=1);const t=Math.floor(e-25569),n=new Date(86400*t*1e3),o=e-Math.floor(e)+1e-7;let r=Math.floor(86400*o);const i=r%60;r-=i;const l=Math.floor(r/3600),a=Math.floor(r/60)%60;let s=n.getUTCDate(),c=n.getUTCMonth();return e>=60&&e<61&&(s=29,c=1),new Date(n.getUTCFullYear(),c,s,l,a,i)}(t)}return"string"!=typeof e||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?a:e}function S(e){let t,n=e.length;for(;n--;){if(t=N(e[n]),t===a)return t;e[n]=t}return e}function j(e){return e instanceof Error?e:null==e?0:("boolean"==typeof e&&(e=+e),isNaN(e)||""===e?a:parseFloat(e))}function D(e){let t,n;if(!e||0===(t=e.length))return a;for(;t--;){if(e[t]instanceof Error)return e[t];if(n=j(e[t]),n instanceof Error)return n;e[t]=n}return e}function O(e){return e instanceof Error?e:null==e?"":e.toString()}function k(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return!0;return!1}function R(e){return null!=e}const H=[">",">=","<","<=","=","<>"],P="operator",F="literal",V=[P,F],B=P,q=F;function U(e,t){if(-1===V.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function Y(e){return function(e){let t="";const n=[];for(let o=0;o<e.length;o++){const r=e[o];0===o&&H.indexOf(r)>=0?n.push(U(r,B)):t+=r}return t.length>0&&n.push(U(function(e){return"string"!=typeof e||/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e}(t),q)),n.length>0&&n[0].type!==B&&n.unshift(U("=",B)),n}(function(e){const t=e.length,n=[];let o=0,r="",i="";for(;o<t;){const t=e.charAt(o);switch(t){case">":case"<":case"=":i+=t,r.length>0&&(n.push(r),r="");break;default:i.length>0&&(n.push(i),i=""),r+=t}o++}return r.length>0&&n.push(r),i.length>0&&n.push(i),n}(e))}const W=function(e){const t=[];let n;for(let o=0;o<e.length;o++){const r=e[o];switch(r.type){case B:n=r.value;break;case q:t.push(r.value)}}return function(e,t){let n=!1;switch(t){case">":n=e[0]>e[1];break;case">=":n=e[0]>=e[1];break;case"<":n=e[0]<e[1];break;case"<=":n=e[0]<=e[1];break;case"=":n=e[0]==e[1];break;case"<>":n=e[0]!=e[1]}return n}(t,n)},z={};function X(e){return[a,s,l,u,c,i].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function G(e){return X(e)||e===d}function K(e){return!0===e||!1===e}function $(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function Z(e){return"string"==typeof e}function J(){const e=[];for(let t=0;t<arguments.length;++t){let n=!1;const o=arguments[t];for(let t=0;t<e.length&&(n=e[t]===o,!n);++t);n||e.push(o)}return e}function Q(e,t,n,o){if(!t||!n)return d;o=!(0===o||!1===o);let r=d;const i="number"==typeof e;let l=!1;for(let a=0;a<t.length;a++){const c=t[a];if(c[0]===e){r=n<c.length+1?c[n-1]:s;break}!l&&(i&&o&&c[0]<=e||o&&"string"==typeof c[0]&&c[0].localeCompare(e)<0)&&(r=n<c.length+1?c[n-1]:s),i&&c[0]>e&&(l=!0)}return r}function ee(){const e=b(arguments).filter(R);if(0===e.length)return l;const t=L.apply(void 0,e);if(t)return t;const n=T(e),o=n.length;let r,i=0,a=0;for(let e=0;e<o;e++)i+=n[e],a+=1;return r=i/a,isNaN(r)&&(r=u),r}function te(){const e=b(arguments).filter(R);if(0===e.length)return l;const t=L.apply(void 0,e);if(t)return t;const n=e,o=n.length;let r,i=0,a=0;for(let e=0;e<o;e++){const t=n[e];"number"==typeof t&&(i+=t),!0===t&&i++,null!==t&&a++}return r=i/a,isNaN(r)&&(r=u),r}z.TYPE=e=>{switch(e){case i:return 1;case l:return 2;case a:return 3;case s:return 4;case c:return 5;case u:return 6;case d:return 7;case p:return 8}return d};const ne={DIST:function(e,t,n,r,i,l){return arguments.length<4?a:(i=void 0===i?0:i,l=void 0===l?1:l,M(e=j(e),t=j(t),n=j(n),i=j(i),l=j(l))?a:(e=(e-i)/(l-i),r?o.beta.cdf(e,t,n):o.beta.pdf(e,t,n)))},INV:(e,t,n,r,i)=>(r=void 0===r?0:r,i=void 0===i?1:i,M(e=j(e),t=j(t),n=j(n),r=j(r),i=j(i))?a:o.beta.inv(e,t,n)*(i-r)+r)},oe={DIST:(e,t,n,r)=>M(e=j(e),t=j(t),n=j(n),r=j(r))?a:r?o.binomial.cdf(e,t,n):o.binomial.pdf(e,t,n)};oe.DIST.RANGE=(e,t,n,o)=>{if(o=void 0===o?n:o,M(e=j(e),t=j(t),n=j(n),o=j(o)))return a;let r=0;for(let i=n;i<=o;i++)r+=Be(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return r},oe.INV=(e,t,n)=>{if(M(e=j(e),t=j(t),n=j(n)))return a;let r=0;for(;r<=e;){if(o.binomial.cdf(r,e,t)>=n)return r;r++}};const re={DIST:(e,t,n)=>M(e=j(e),t=j(t))?a:n?o.chisquare.cdf(e,t):o.chisquare.pdf(e,t)};re.DIST.RT=(e,t)=>!e|!t?d:e<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?a:1-o.chisquare.cdf(e,t),re.INV=(e,t)=>M(e=j(e),t=j(t))?a:o.chisquare.inv(e,t),re.INV.RT=(e,t)=>!e|!t?d:e<0||e>1||t<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?a:o.chisquare.inv(1-e,t),re.TEST=function(e,t){if(2!==arguments.length)return d;if(!(e instanceof Array&&t instanceof Array))return a;if(e.length!==t.length)return a;if(e[0]&&t[0]&&e[0].length!==t[0].length)return a;const n=e.length;let o,r,i;for(r=0;r<n;r++)e[r]instanceof Array||(o=e[r],e[r]=[],e[r].push(o)),t[r]instanceof Array||(o=t[r],t[r]=[],t[r].push(o));const l=e[0].length,s=1===l?n-1:(n-1)*(l-1);let c=0;const u=Math.PI;for(r=0;r<n;r++)for(i=0;i<l;i++)c+=Math.pow(e[r][i]-t[r][i],2)/t[r][i];return Math.round(1e6*function(e,t){let n=Math.exp(-.5*e);t%2==1&&(n*=Math.sqrt(2*e/u));let o=t;for(;o>=2;)n=n*e/o,o-=2;let r=n,i=t;for(;r>1e-10*n;)i+=2,r=r*e/i,n+=r;return 1-n}(c,s))/1e6};const ie={};function le(){return T(b(arguments)).length}function ae(){const e=b(arguments);return e.length-se(e)}function se(){const e=b(arguments);let t,n=0;for(let o=0;o<e.length;o++)t=e[o],null!=t&&""!==t||n++;return n}ie.NORM=(e,t,n)=>M(e=j(e),t=j(t),n=j(n))?a:o.normalci(1,e,t,n)[1]-1,ie.T=(e,t,n)=>M(e=j(e),t=j(t),n=j(n))?a:o.tci(1,e,t,n)[1]-1;const ce={P:(e,t)=>{if(M(e=D(b(e)),t=D(b(t))))return a;const n=o.mean(e),r=o.mean(t);let i=0;const l=e.length;for(let o=0;o<l;o++)i+=(e[o]-n)*(t[o]-r);return i/l},S:(e,t)=>M(e=D(b(e)),t=D(b(t)))?a:o.covariance(e,t)},ue={DIST:(e,t,n)=>M(e=j(e),t=j(t))?a:n?o.exponential.cdf(e,t):o.exponential.pdf(e,t)},de={};function fe(e,t,n){if(M(e=j(e),t=D(b(t)),n=D(b(n))))return a;const r=o.mean(n),i=o.mean(t),l=n.length;let s=0,c=0;for(let e=0;e<l;e++)s+=(n[e]-r)*(t[e]-i),c+=Math.pow(n[e]-r,2);const u=s/c;return i-u*r+u*e}function pe(e){return(e=j(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?u:o.gammafn(e)}function he(e){return(e=j(e))instanceof Error?e:o.gammaln(e)}de.DIST=(e,t,n,r)=>M(e=j(e),t=j(t),n=j(n))?a:r?o.centralF.cdf(e,t,n):o.centralF.pdf(e,t,n),de.DIST.RT=function(e,t,n){return 3!==arguments.length?d:e<0||t<1||n<1?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:1-o.centralF.cdf(e,t,n)},de.INV=(e,t,n)=>M(e=j(e),t=j(t),n=j(n))?a:e<=0||e>1?u:o.centralF.inv(e,t,n),de.INV.RT=function(e,t,n){return 3!==arguments.length?d:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:o.centralF.inv(1-e,t,n)},de.TEST=(e,t)=>{if(!e||!t)return d;if(!(e instanceof Array&&t instanceof Array))return d;if(e.length<2||t.length<2)return l;const n=(e,t)=>{let n=0;for(let o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},o=Ke(e)/e.length,r=Ke(t)/t.length;return n(e,o)/(e.length-1)/(n(t,r)/(t.length-1))},pe.DIST=function(e,t,n,r){return 4!==arguments.length?d:e<0||t<=0||n<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:r?o.gamma.cdf(e,t,n,!0):o.gamma.pdf(e,t,n,!1)},pe.INV=function(e,t,n){return 3!==arguments.length?d:e<0||e>1||t<=0||n<=0?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?a:o.gamma.inv(e,t,n)},he.PRECISE=function(e){return 1!==arguments.length?d:e<=0?u:"number"!=typeof e?a:o.gammaln(e)};const me={};function ge(e,t){return M(e=D(b(e)),t=j(t))?e:t<0||e.length<t?a:e.sort((e,t)=>t-e)[t-1]}function ve(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;const n=o.mean(e),r=o.mean(t),i=t.length;let l=0,s=0;for(let o=0;o<i;o++)l+=(t[o]-r)*(e[o]-n),s+=Math.pow(t[o]-r,2);const c=l/s;return[c,n-c*r]}me.DIST=(e,t,n,o,r)=>{if(M(e=j(e),t=j(t),n=j(n),o=j(o)))return a;function i(e,t,n,o){return Be(n,e)*Be(o-n,t-e)/Be(o,t)}return r?function(e,t,n,o){let r=0;for(let l=0;l<=e;l++)r+=i(l,t,n,o);return r}(e,t,n,o):i(e,t,n,o)};const ye={};function be(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;const n=T(e);return 0===n.length?0:Math.max.apply(Math,n)}function we(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;const n=v(e);let r=o.median(n);return isNaN(r)&&(r=u),r}function Ce(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;const n=T(e);return 0===n.length?0:Math.min.apply(Math,n)}ye.DIST=(e,t,n,r)=>M(e=j(e),t=j(t),n=j(n))?a:r?o.lognormal.cdf(e,t,n):o.lognormal.pdf(e,t,n),ye.INV=(e,t,n)=>M(e=j(e),t=j(t),n=j(n))?a:o.lognormal.inv(e,t,n);const xe={MULT:function(){const e=D(b(arguments));if(e instanceof Error)return e;const t=e.length,n={};let o,r=[],i=0;for(let l=0;l<t;l++)o=e[l],n[o]=n[o]?n[o]+1:1,n[o]>i&&(i=n[o],r=[]),n[o]===i&&(r[r.length]=o);return r},SNGL:function(){const e=D(b(arguments));return e instanceof Error?e:xe.MULT(e).sort((e,t)=>e-t)[0]}},Ee={DIST:(e,t,n,r)=>M(e=j(e),t=j(t),n=j(n))?a:r?o.negbin.cdf(e,t,n):o.negbin.pdf(e,t,n)},Ae={};function Le(e,t){if(M(t=D(b(t)),e=D(b(e))))return a;const n=o.mean(e),r=o.mean(t),i=e.length;let l=0,s=0,c=0;for(let o=0;o<i;o++)l+=(e[o]-n)*(t[o]-r),s+=Math.pow(e[o]-n,2),c+=Math.pow(t[o]-r,2);return l/Math.sqrt(s*c)}Ae.DIST=(e,t,n,r)=>M(e=j(e),t=j(t),n=j(n))?a:n<=0?u:r?o.normal.cdf(e,t,n):o.normal.pdf(e,t,n),Ae.INV=(e,t,n)=>M(e=j(e),t=j(t),n=j(n))?a:o.normal.inv(e,t,n),Ae.S={},Ae.S.DIST=(e,t)=>(e=j(e))instanceof Error?a:t?o.normal.cdf(e,0,1):o.normal.pdf(e,0,1),Ae.S.INV=e=>(e=j(e))instanceof Error?a:o.normal.inv(e,0,1);const Me={EXC:(e,t)=>{if(M(e=D(b(e)),t=j(t)))return a;const n=(e=e.sort((e,t)=>e-t)).length;if(t<1/(n+1)||t>1-1/(n+1))return u;const o=t*(n+1)-1,r=Math.floor(o);return I(o===r?e[o]:e[r]+(o-r)*(e[r+1]-e[r]))},INC:(e,t)=>{if(M(e=D(b(e)),t=j(t)))return a;const n=t*((e=e.sort((e,t)=>e-t)).length-1),o=Math.floor(n);return I(n===o?e[n]:e[o]+(n-o)*(e[o+1]-e[o]))}},Ie={EXC:(e,t,n)=>{if(n=void 0===n?3:n,M(e=D(b(e)),t=j(t),n=j(n)))return a;e=e.sort((e,t)=>e-t);const o=J.apply(null,e),r=e.length,i=o.length,l=Math.pow(10,n);let s=0,c=!1,u=0;for(;!c&&u<i;)t===o[u]?(s=(e.indexOf(o[u])+1)/(r+1),c=!0):t>=o[u]&&(t<o[u+1]||u===i-1)&&(s=(e.indexOf(o[u])+1+(t-o[u])/(o[u+1]-o[u]))/(r+1),c=!0),u++;return Math.floor(s*l)/l},INC:(e,t,n)=>{if(n=void 0===n?3:n,M(e=D(b(e)),t=j(t),n=j(n)))return a;e=e.sort((e,t)=>e-t);const o=J.apply(null,e),r=e.length,i=o.length,l=Math.pow(10,n);let s=0,c=!1,u=0;for(;!c&&u<i;)t===o[u]?(s=e.indexOf(o[u])/(r-1),c=!0):t>=o[u]&&(t<o[u+1]||u===i-1)&&(s=(e.indexOf(o[u])+(t-o[u])/(o[u+1]-o[u]))/(r-1),c=!0),u++;return Math.floor(s*l)/l}},Te={DIST:(e,t,n)=>M(e=j(e),t=j(t))?a:n?o.poisson.cdf(e,t):o.poisson.pdf(e,t)},_e={EXC:(e,t)=>{if(M(e=D(b(e)),t=j(t)))return a;switch(t){case 1:return Me.EXC(e,.25);case 2:return Me.EXC(e,.5);case 3:return Me.EXC(e,.75);default:return u}},INC:(e,t)=>{if(M(e=D(b(e)),t=j(t)))return a;switch(t){case 1:return Me.INC(e,.25);case 2:return Me.INC(e,.5);case 3:return Me.INC(e,.75);default:return u}}},Ne={};function Se(){const e=D(b(arguments));if(e instanceof Error)return e;const t=o.mean(e),n=e.length;let r=0;for(let o=0;o<n;o++)r+=Math.pow(e[o]-t,3);return n*r/((n-1)*(n-2)*Math.pow(o.stdev(e,!0),3))}function je(e,t){return M(e=D(b(e)),t=j(t))?e:e.sort((e,t)=>e-t)[t-1]}Ne.AVG=(e,t,n)=>{if(M(e=j(e),t=D(b(t))))return a;const o=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e,r=(t=(t=b(t)).sort(o)).length;let i=0;for(let n=0;n<r;n++)t[n]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},Ne.EQ=(e,t,n)=>{if(M(e=j(e),t=D(b(t))))return a;const o=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e;return(t=t.sort(o)).indexOf(e)+1},Se.P=function(){const e=D(b(arguments));if(e instanceof Error)return e;const t=o.mean(e),n=e.length;let r=0,i=0;for(let o=0;o<n;o++)i+=Math.pow(e[o]-t,3),r+=Math.pow(e[o]-t,2);return i/=n,r/=n,i/Math.pow(r,1.5)};const De={P:function(){const e=ke.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},S:function(){const e=ke.S.apply(this,arguments);return Math.sqrt(e)}},Oe={DIST:(e,t,n)=>1!==n&&2!==n?u:1===n?Oe.DIST.RT(e,t):Oe.DIST["2T"](e,t)};Oe.DIST["2T"]=function(e,t){return 2!==arguments.length?d:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?a:2*(1-o.studentt.cdf(e,t))},Oe.DIST.RT=function(e,t){return 2!==arguments.length?d:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?a:1-o.studentt.cdf(e,t)},Oe.INV=(e,t)=>M(e=j(e),t=j(t))?a:o.studentt.inv(e,t),Oe.INV["2T"]=(e,t)=>(e=j(e),t=j(t),e<=0||e>1||t<1?u:M(e,t)?a:Math.abs(o.studentt.inv(e/2,t))),Oe.TEST=(e,t)=>{if(M(e=D(b(e)),t=D(b(t))))return a;const n=o.mean(e),r=o.mean(t);let i,l=0,s=0;for(i=0;i<e.length;i++)l+=Math.pow(e[i]-n,2);for(i=0;i<t.length;i++)s+=Math.pow(t[i]-r,2);l/=e.length-1,s/=t.length-1;const c=Math.abs(n-r)/Math.sqrt(l/e.length+s/t.length);return Oe.DIST["2T"](c,e.length+t.length-2)};const ke={};function Re(){const e=b(arguments),t=e.length;let n=0,o=0;const r=te(e);for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-r,2):!0===t?Math.pow(1-r,2):Math.pow(0-r,2),null!==t&&o++}return n/(o-1)}function He(){const e=b(arguments),t=e.length;let n=0,o=0;const r=te(e);let i;for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-r,2):!0===t?Math.pow(1-r,2):Math.pow(0-r,2),null!==t&&o++}return i=n/o,isNaN(i)&&(i=u),i}ke.P=function(){const e=T(b(arguments)),t=e.length;let n=0;const o=ee(e);let r;for(let r=0;r<t;r++)n+=Math.pow(e[r]-o,2);return r=n/t,isNaN(r)&&(r=u),r},ke.S=function(){const e=T(b(arguments)),t=e.length;let n=0;const o=ee(e);for(let r=0;r<t;r++)n+=Math.pow(e[r]-o,2);return n/(t-1)};const Pe={DIST:(e,t,n,o)=>M(e=j(e),t=j(t),n=j(n))?a:o?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},Fe={};function Ve(e,t,n){const o=L(e=j(e),t=j(t),n=j(n));if(o)return o;if(0===t)return 0;t=Math.abs(t);const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.ceil(e/t)*t,r):0===n?-Ge(Math.floor(Math.abs(e)/t)*t,r):-Ge(Math.ceil(Math.abs(e)/t)*t,r)}function Be(e,t){return L(e=j(e),t=j(t))||(e<t?u:Ue(e)/(Ue(t)*Ue(e-t)))}Fe.TEST=(e,t,n)=>{if(M(e=D(b(e)),t=j(t)))return a;n=n||De.S(e);const o=e.length;return 1-Ae.S.DIST((ee(e)-t)/(n/Math.sqrt(o)),!0)},Ve.MATH=Ve,Ve.PRECISE=Ve;const qe=[];function Ue(e){if((e=j(e))instanceof Error)return e;const t=Math.floor(e);return 0===t||1===t?1:(qe[t]>0||(qe[t]=Ue(t-1)*t),qe[t])}function Ye(e,t){const n=L(e=j(e),t=j(t));if(n)return n;if(0===t)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return u;t=Math.abs(t);const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,o):-Ge(Math.ceil(Math.abs(e)/t),o)}Ye.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=void 0===t?0:t;const o=L(e=j(e),t=j(t),n=j(n));if(o)return o;if(0===t)return 0;t=t?Math.abs(t):1;const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,r):0===n||void 0===n?-Ge(Math.ceil(Math.abs(e)/t)*t,r):-Ge(Math.floor(Math.abs(e)/t)*t,r)},Ye.PRECISE=Ye.MATH;const We={CEILING:Ve};function ze(e,t){const n=L(e=j(e),t=j(t));if(n)return n;if(0===e&&0===t)return u;const o=Math.pow(e,t);return isNaN(o)?u:o}function Xe(){const e=b(arguments).filter(e=>null!=e);if(0===e.length)return 0;const t=D(e);if(t instanceof Error)return t;let n=1;for(let e=0;e<t.length;e++)n*=t[e];return n}function Ge(e,t){return L(e=j(e),t=j(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function Ke(){let e=0;return g(m(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if("number"==typeof t)e+=t;else if("string"==typeof t){const n=parseFloat(t);!isNaN(n)&&(e+=n)}else if(Array.isArray(t)){const n=Ke.apply(null,t);n instanceof Error?e=n:e+=n}}),e}var $e=Object.freeze({__proto__:null,ADD:function(e,t){return 2!==arguments.length?d:L(e=j(e),t=j(t))||e+t},DIVIDE:function(e,t){return 2!==arguments.length?d:L(e=j(e),t=j(t))||(0===t?l:e/t)},EQ:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e===t)},GT:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(k(e,t)?(e=O(e),t=O(t)):(e=j(e),t=j(t)),L(e,t)||e>t)},GTE:function(e,t){return 2!==arguments.length?d:(k(e,t)?(e=O(e),t=O(t)):(e=j(e),t=j(t)),L(e,t)||e>=t)},LT:function(e,t){return 2!==arguments.length?d:(k(e,t)?(e=O(e),t=O(t)):(e=j(e),t=j(t)),L(e,t)||e<t)},LTE:function(e,t){return 2!==arguments.length?d:(k(e,t)?(e=O(e),t=O(t)):(e=j(e),t=j(t)),L(e,t)||e<=t)},MINUS:function(e,t){return 2!==arguments.length?d:L(e=j(e),t=j(t))||e-t},MULTIPLY:function(e,t){return 2!==arguments.length?d:L(e=j(e),t=j(t))||e*t},NE:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e!==t)},POW:function(e,t){return 2!==arguments.length?d:ze(e,t)}});const Ze=new Date(Date.UTC(1900,0,1)),Je=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Qe=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],et=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function tt(e,t,n){n=n.toUpperCase(),e=N(e),t=N(t);const o=e.getFullYear(),r=e.getMonth(),i=e.getDate(),l=t.getFullYear(),a=t.getMonth(),s=t.getDate();let c;switch(n){case"Y":c=Math.floor(ut(e,t));break;case"D":c=ot(t,e);break;case"M":c=a-r+12*(l-o),s<i&&c--;break;case"MD":i<=s?c=s-i:(0===a?(e.setFullYear(l-1),e.setMonth(12)):(e.setFullYear(l),e.setMonth(a-1)),c=ot(t,e));break;case"YM":c=a-r+12*(l-o),s<i&&c--,c%=12;break;case"YD":a>r||a===r&&s<i?e.setFullYear(l):e.setFullYear(l-1),c=ot(t,e)}return c}function nt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function ot(e,t){return e=N(e),t=N(t),e instanceof Error?e:t instanceof Error?t:dt(nt(e))-dt(nt(t))}function rt(e,t,n){if(n=_(n||"false"),e=N(e),t=N(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;const o=e.getMonth();let r,i,l=t.getMonth();if(n)r=31===e.getDate()?30:e.getDate(),i=31===t.getDate()?30:t.getDate();else{const n=new Date(e.getFullYear(),o+1,0).getDate(),a=new Date(t.getFullYear(),l+1,0).getDate();r=e.getDate()===n?30:e.getDate(),t.getDate()===a?r<30?(l++,i=1):i=30:i=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(l-o)+(i-r)}function it(e){if((e=N(e))instanceof Error)return e;(e=nt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function lt(e,t,n){return lt.INTL(e,t,1,n)}function at(e,t,n){return at.INTL(e,t,1,n)}function st(e){return 1===new Date(e,1,29).getMonth()}function ct(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function ut(e,t,n){if((e=N(e))instanceof Error)return e;if((t=N(t))instanceof Error)return t;n=n||0;let o=e.getDate();const r=e.getMonth()+1,i=e.getFullYear();let l=t.getDate();const a=t.getMonth()+1,s=t.getFullYear();switch(n){case 0:return 31===o&&31===l?(o=30,l=30):31===o?o=30:30===o&&31===l&&(l=30),(l+30*a+360*s-(o+30*r+360*i))/360;case 1:{const n=(e,t)=>{const n=e.getFullYear(),o=new Date(n,2,1);if(st(n)&&e<o&&t>=o)return!0;const r=t.getFullYear(),i=new Date(r,2,1);return st(r)&&t>=i&&e<i};let c=365;if(i===s||i+1===s&&(r>a||r===a&&o>=l))return(i===s&&st(i)||n(e,t)||1===a&&29===l)&&(c=366),ct(e,t)/c;const u=s-i+1,d=(new Date(s+1,0,1)-new Date(i,0,1))/1e3/60/60/24/u;return ct(e,t)/d}case 2:return ct(e,t)/360;case 3:return ct(e,t)/365;case 4:return(l+30*a+360*s-(o+30*r+360*i))/360}}function dt(e){const t=e>-22038912e5?2:1;return Math.ceil((e-Ze)/864e5)+t}function ft(e){return 0===(e=j(e))?a:e instanceof Error?e:String.fromCharCode(e)}function pt(e){if(M(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=a),t}function ht(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;let n=0;for(;(n=e.indexOf(!0))>-1;)e[n]="TRUE";let o=0;for(;(o=e.indexOf(!1))>-1;)e[o]="FALSE";return e.join("")}lt.INTL=(e,t,n,o)=>{if((e=N(e))instanceof Error)return e;if((t=N(t))instanceof Error)return t;let r=!1;const i=[],l=[1,2,3,4,5,6,0],s=new RegExp("^[0|1]{7}$");if(void 0===n)n=et[1];else if("string"==typeof n&&s.test(n)){r=!0,n=n.split("");for(let e=0;e<n.length;e++)"1"===n[e]&&i.push(l[e])}else n=et[n];if(!(n instanceof Array))return a;void 0===o?o=[]:o instanceof Array||(o=[o]);for(let e=0;e<o.length;e++){const t=N(o[e]);if(t instanceof Error)return t;o[e]=t}const c=Math.round((t-e)/864e5)+1;let u=c;const d=e;for(let e=0;e<c;e++){const e=(new Date).getTimezoneOffset()>0?d.getUTCDay():d.getDay();let t=r?i.includes(e):e===n[0]||e===n[1];for(let e=0;e<o.length;e++){const n=o[e];if(n.getDate()===d.getDate()&&n.getMonth()===d.getMonth()&&n.getFullYear()===d.getFullYear()){t=!0;break}}t&&u--,d.setDate(d.getDate()+1)}return u},at.INTL=(e,t,n,o)=>{if((e=N(e))instanceof Error)return e;if((t=j(t))instanceof Error)return t;if(t<0)return u;if(!((n=void 0===n?et[1]:et[n])instanceof Array))return a;void 0===o?o=[]:o instanceof Array||(o=[o]);for(let e=0;e<o.length;e++){const t=N(o[e]);if(t instanceof Error)return t;o[e]=t}let r=0;for(;r<t;){e.setDate(e.getDate()+1);const t=e.getDay();if(t!==n[0]&&t!==n[1]){for(let t=0;t<o.length;t++){const n=o[t];if(n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()){r--;break}}r++}}return e};const mt=ht;function gt(e,t=2,n=!1){if(e=j(e),isNaN(e))return a;if(t=j(t),isNaN(t))return a;if(t<0){const n=Math.pow(10,-t);e=Math.round(e/n)*n}else e=e.toFixed(t);if(n)e=e.toString().replace(/,/g,"");else{const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),e=t.join(".")}return e}function vt(e,t){return L(e,t)||(e=O(e),(t=j(t))instanceof Error?t:new Array(t+1).join(e))}const yt=ft,bt=pt;function wt(e){return/^[01]{1,10}$/.test(e)}function Ct(e,t,n){if(M(e=j(e),t=j(t)))return e;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return a;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();{const o=t>0?"+":"";return e.toString()+o+(1===t?n:t.toString()+n)}}function xt(e,t){return t=void 0===t?0:t,M(e=j(e),t=j(t))?a:o.erf(e)}function Et(e){return isNaN(e)?a:o.erfc(e)}function At(e){const t=Nt(e),n=Lt(e);return M(t,n)?a:Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}function Lt(e){if(void 0===e||!0===e||!1===e)return a;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const o=e.substring(e.length-1,e.length),r="i"===o||"j"===o;return t>=0||n>=0?r?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:-Number(e.substring(n+1,e.length-1)):u:r?isNaN(e.substring(0,e.length-1))?u:e.substring(0,e.length-1):isNaN(e)?u:0}function Mt(e){const t=Nt(e),n=Lt(e);return M(t,n)?a:0===t&&0===n?l:0===t&&n>0?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&t>0?0:0===n&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI}function It(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,o)}function Tt(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,o)}function _t(e,t){const n=Nt(e),o=Lt(e),r=Nt(t),i=Lt(t);if(M(n,o,r,i))return a;const l=e.substring(e.length-1),s=t.substring(t.length-1);let c="i";if(("j"===l||"j"===s)&&(c="j"),0===r&&0===i)return u;const d=r*r+i*i;return Ct((n*r+o*i)/d,(o*r-n*i)/d,c)}function Nt(e){if(void 0===e||!0===e||!1===e)return a;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const o=e.substring(e.length-1,e.length),r="i"===o||"j"===o;return t>=0||n>=0?r?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:Number(e.substring(0,n)):u:r?isNaN(e.substring(0,e.length-1))?u:0:isNaN(e)?u:e}function St(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,o)}function jt(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,o)}xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Et.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Dt=ne.DIST,Ot=ne.INV,kt=oe.DIST,Rt=Ve.MATH,Ht=Ve.PRECISE,Pt=re.DIST,Ft=re.DIST.RT,Vt=re.INV,Bt=re.INV.RT,qt=re.TEST,Ut=ce.P,Yt=ce.P,Wt=ce.S,zt=oe.INV,Xt=Et.PRECISE,Gt=xt.PRECISE,Kt=ue.DIST,$t=de.DIST,Zt=de.DIST.RT,Jt=de.INV,Qt=de.INV.RT,en=Ye.MATH,tn=Ye.PRECISE,nn=de.TEST,on=pe.DIST,rn=pe.INV,ln=he.PRECISE,an=me.DIST,sn=ye.INV,cn=ye.DIST,un=ye.INV,dn=xe.MULT,fn=xe.SNGL,pn=Ee.DIST,hn=lt.INTL,mn=Ae.DIST,gn=Ae.INV,vn=Ae.S.DIST,yn=Ae.S.INV,bn=Me.EXC,wn=Me.INC,Cn=Ie.EXC,xn=Ie.INC,En=Te.DIST,An=_e.EXC,Ln=_e.INC,Mn=Ne.AVG,In=Ne.EQ,Tn=Se.P,_n=De.P,Nn=De.S,Sn=Oe.DIST,jn=Oe.DIST.RT,Dn=Oe.INV,On=Oe.TEST,kn=ke.P,Rn=ke.S,Hn=Pe.DIST,Pn=at.INTL,Fn=Fe.TEST;function Vn(e){const t=[];return g(e,e=>{e&&t.push(e)}),t}function Bn(e,t){const n={};for(let t=1;t<e[0].length;++t)n[t]=!0;let o=t[0].length;for(let e=1;e<t.length;++e)t[e].length>o&&(o=t[e].length);for(let r=1;r<e.length;++r)for(let i=1;i<e[r].length;++i){let l=!1,a=!1;for(let n=0;n<t.length;++n){const s=t[n];if(s.length<o)continue;const c=s[0];if(e[r][0]===c){a=!0;for(let t=1;t<s.length;++t)if(!l)if(void 0===s[t]||"*"===s[t])l=!0;else{const n=Y(s[t]+""),o=[U(e[r][i],q)].concat(n);l=W(o)}}}a&&(n[i]=n[i]&&l)}const r=[];for(let t=0;t<e[0].length;++t)n[t]&&r.push(t-1);return r}function qn(e){return e&&e.getTime&&!isNaN(e.getTime())}function Un(e){return e instanceof Date?e:new Date(e)}function Yn(e,t,n,o,r){if(o=o||0,r=r||0,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return a;let i;if(0===e)i=o+n*t;else{const l=Math.pow(1+e,t);i=1===r?o*l+n*(1+e)*(l-1)/e:o*l+n*(l-1)/e}return-i}function Wn(e,t,n,o,r,i){if(r=r||0,i=i||0,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r),i=j(i)))return a;const l=Xn(e,n,o,r,i);return(1===t?1===i?0:-o:1===i?Yn(e,t-2,l,o,1)-l:Yn(e,t-1,l,o,0))*e}function zn(){const e=D(b(arguments));if(e instanceof Error)return e;const t=e[0];let n=0;for(let o=1;o<e.length;o++)n+=e[o]/Math.pow(1+t,o);return n}function Xn(e,t,n,o,r){if(o=o||0,r=r||0,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return a;let i;if(0===e)i=(n+o)/t;else{const l=Math.pow(1+e,t);i=1===r?(o*e/(l-1)+n*e/(1-1/l))/(1+e):o*e/(l-1)+n*e/(1-1/l)}return-i}const Gn={errors:h,symbols:$e};t.ABS=function(e){return(e=j(e))instanceof Error?e:Math.abs(e)},t.ACCRINT=function(e,t,n,o,r,i,l){return e=Un(e),t=Un(t),n=Un(n),qn(e)&&qn(t)&&qn(n)?o<=0||r<=0||-1===[1,2,4].indexOf(i)||-1===[0,1,2,3,4].indexOf(l)||n<=e?u:(r=r||0)*o*ut(e,n,l=l||0):a},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.ACOS=function(e){if((e=j(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=u),t},t.ACOSH=function(e){if((e=j(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=u),t},t.ACOT=function(e){return(e=j(e))instanceof Error?e:Math.atan(1/e)},t.ACOTH=function(e){if((e=j(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=u),t},t.AGGREGATE=function(e,t,n,o){if(M(e=j(e),j(e)))return a;switch(e){case 1:return ee(n);case 2:return le(n);case 3:return ae(n);case 4:return be(n);case 5:return Ce(n);case 6:return Xe(n);case 7:return De.S(n);case 8:return De.P(n);case 9:return Ke(n);case 10:return ke.S(n);case 11:return ke.P(n);case 12:return we(n);case 13:return xe.SNGL(n);case 14:return ge(n,o);case 15:return je(n,o);case 16:return Me.INC(n,o);case 17:return _e.INC(n,o);case 18:return Me.EXC(n,o);case 19:return _e.EXC(n,o)}},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.AND=function(){const e=b(arguments);let t=a;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===a&&(t=!0),e[n]||(t=!1))}return t},t.ARABIC=function(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return a;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},t.ASC=function(){throw new Error("ASC is not implemented")},t.ASIN=function(e){if((e=j(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=u),t},t.ASINH=function(e){return(e=j(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},t.ATAN=function(e){return(e=j(e))instanceof Error?e:Math.atan(e)},t.ATAN2=function(e,t){return L(e=j(e),t=j(t))||Math.atan2(e,t)},t.ATANH=function(e){if((e=j(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=u),t},t.AVEDEV=function(){const e=b(arguments).filter(R);if(0===e.length)return u;const t=D(e);return t instanceof Error?t:o.sum(o(t).subtract(o.mean(t)).abs()[0])/t.length},t.AVERAGE=ee,t.AVERAGEA=te,t.AVERAGEIF=function(e,t,n){if(arguments.length<=1)return d;if(n=D(b(n=n||e).filter(R)),e=b(e),n instanceof Error)return n;let o=0,r=0;const i=void 0===t||"*"===t,l=i?null:Y(t+"");for(let t=0;t<e.length;t++){const a=e[t];if(i)r+=n[t],o++;else{const e=[U(a,q)].concat(l);W(e)&&(r+=n[t],o++)}}return r/o},t.AVERAGEIFS=function(){const e=m(arguments),t=(e.length-1)/2,n=b(e[0]);let o=0,r=0;for(let i=0;i<n.length;i++){let l=!1;for(let n=0;n<t;n++){const t=e[2*n+1][i],o=e[2*n+2];let r=!1;if(void 0===o||"*"===o)r=!0;else{const e=Y(o+""),n=[U(t,q)].concat(e);r=W(n)}if(!r){l=!1;break}l=!0}l&&(r+=n[i],o++)}const i=r/o;return isNaN(i)?0:i},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.BASE=function(e,t,n){const o=L(e=j(e),t=j(t),n=j(n));if(o)return o;if(0===t)return u;const r=e.toString(t);return new Array(Math.max(n+1-r.length,0)).join("0")+r},t.BESSELI=function(e,t){return M(e=j(e),t=j(t))?a:r.besseli(e,t)},t.BESSELJ=function(e,t){return M(e=j(e),t=j(t))?a:r.besselj(e,t)},t.BESSELK=function(e,t){return M(e=j(e),t=j(t))?a:r.besselk(e,t)},t.BESSELY=function(e,t){return M(e=j(e),t=j(t))?a:r.bessely(e,t)},t.BETA=ne,t.BETADIST=Dt,t.BETAINV=Ot,t.BIN2DEC=function(e){if(!wt(e))return u;const t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!wt(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);const o=parseInt(e,2).toString(16);return void 0===t?o:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:u},t.BIN2OCT=function(e,t){if(!wt(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);const o=parseInt(e,2).toString(8);return void 0===t?o:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:u},t.BINOM=oe,t.BINOMDIST=kt,t.BITAND=function(e,t){return M(e=j(e),t=j(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e&t},t.BITLSHIFT=function(e,t){return M(e=j(e),t=j(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return M(e=j(e),t=j(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e|t},t.BITRSHIFT=function(e,t){return M(e=j(e),t=j(t))?a:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return M(e=j(e),t=j(t))?a:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e^t},t.CEILING=Ve,t.CEILINGMATH=Rt,t.CEILINGPRECISE=Ht,t.CELL=function(){throw new Error("CELL is not implemented")},t.CHAR=ft,t.CHIDIST=Pt,t.CHIDISTRT=Ft,t.CHIINV=Vt,t.CHIINVRT=Bt,t.CHISQ=re,t.CHITEST=qt,t.CHOOSE=function(){if(arguments.length<2)return d;const e=arguments[0];return e<1||e>254||arguments.length<e+1?a:arguments[e]},t.CLEAN=function(e){return M(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},t.CODE=pt,t.COLUMN=function(e,t){return 2!==arguments.length?d:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?o.col(e,t):void 0:a},t.COLUMNS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:o.cols(e):a},t.COMBIN=Be,t.COMBINA=function(e,t){return L(e=j(e),t=j(t))||(e<t?u:0===e&&0===t?1:Be(e+t-1,e-1))},t.COMPLEX=Ct,t.CONCAT=mt,t.CONCATENATE=ht,t.CONFIDENCE=ie,t.CONVERT=function(e,t,n){if((e=j(e))instanceof Error)return e;const o=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],r={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let l,a=null,s=null,c=t,u=n,f=1,p=1;for(let e=0;e<o.length;e++)l=null===o[e][2]?[]:o[e][2],(o[e][1]===c||l.indexOf(c)>=0)&&(a=o[e]),(o[e][1]===u||l.indexOf(u)>=0)&&(s=o[e]);if(null===a){const e=r[t.substring(0,2)];let n=i[t.substring(0,1)];"da"===t.substring(0,2)&&(n=["dekao",10,"da"]),e?(f=e[2],c=t.substring(2)):n&&(f=n[1],c=t.substring(n[2].length));for(let e=0;e<o.length;e++)l=null===o[e][2]?[]:o[e][2],(o[e][1]===c||l.indexOf(c)>=0)&&(a=o[e])}if(null===s){const e=r[n.substring(0,2)];let t=i[n.substring(0,1)];"da"===n.substring(0,2)&&(t=["dekao",10,"da"]),e?(p=e[2],u=n.substring(2)):t&&(p=t[1],u=n.substring(t[2].length));for(let e=0;e<o.length;e++)l=null===o[e][2]?[]:o[e][2],(o[e][1]===u||l.indexOf(u)>=0)&&(s=o[e])}return null===a||null===s||a[3]!==s[3]?d:e*a[6]*f/(s[6]*p)},t.CORREL=function(e,t){return M(e=D(b(e)),t=D(b(t)))?a:o.corrcoeff(e,t)},t.COS=function(e){return(e=j(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=j(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=j(e))instanceof Error?e:0===e?l:1/Math.tan(e)},t.COTH=function(e){if((e=j(e))instanceof Error)return e;if(0===e)return l;const t=Math.exp(2*e);return(t+1)/(t-1)},t.COUNT=le,t.COUNTA=ae,t.COUNTBLANK=se,t.COUNTIF=function(e,t){if(e=b(e),void 0===t||"*"===t)return e.length;let n=0;const o=Y(t+"");for(let t=0;t<e.length;t++){const r=[U(e[t],q)].concat(o);W(r)&&n++}return n},t.COUNTIFS=function(){const e=m(arguments),t=new Array(b(e[0]).length);for(let e=0;e<t.length;e++)t[e]=!0;for(let n=0;n<e.length;n+=2){const o=b(e[n]),r=e[n+1];if(void 0!==r&&"*"!==r){const e=Y(r+"");for(let n=0;n<o.length;n++){const r=[U(o[n],q)].concat(e);t[n]=t[n]&&W(r)}}}let n=0;for(let e=0;e<t.length;e++)t[e]&&n++;return n},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.COVAR=Ut,t.COVARIANCE=ce,t.COVARIANCEP=Yt,t.COVARIANCES=Wt,t.CRITBINOM=zt,t.CSC=function(e){return(e=j(e))instanceof Error?e:0===e?l:1/Math.sin(e)},t.CSCH=function(e){return(e=j(e))instanceof Error?e:0===e?l:2/(Math.exp(e)-Math.exp(-e))},t.CUMIPMT=function(e,t,n,o,r,i){if(M(e=j(e),t=j(t),n=j(n)))return a;if(e<=0||t<=0||n<=0)return u;if(o<1||r<1||o>r)return u;if(0!==i&&1!==i)return u;const l=Xn(e,t,n,0,i);let s=0;1===o&&(0===i&&(s=-n),o++);for(let t=o;t<=r;t++)s+=1===i?Yn(e,t-2,l,n,1)-l:Yn(e,t-1,l,n,0);return s*=e,s},t.CUMPRINC=function(e,t,n,o,r,i){if(M(e=j(e),t=j(t),n=j(n)))return a;if(e<=0||t<=0||n<=0)return u;if(o<1||r<1||o>r)return u;if(0!==i&&1!==i)return u;const l=Xn(e,t,n,0,i);let s=0;1===o&&(s=0===i?l+n*e:l,o++);for(let t=o;t<=r;t++)s+=i>0?l-(Yn(e,t-2,l,n,1)-l)*e:l-Yn(e,t-1,l,n,0)*e;return s},t.DATE=function(e,t,n){let o;return M(e=j(e),t=j(t),n=j(n))?o=a:(o=new Date(e,t-1,n),o.getFullYear()<0&&(o=u)),o},t.DATEDIF=tt,t.DATEVALUE=function(e){if("string"!=typeof e)return a;const t=Date.parse(e);return isNaN(t)?a:new Date(e)},t.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);let i=0;return g(o,e=>{i+=r[e]}),0===o.length?l:i/o.length},t.DAY=function(e){const t=N(e);return t instanceof Error?t:t.getDate()},t.DAYS=ot,t.DAYS360=rt,t.DB=function(e,t,n,o,r){if(r=void 0===r?12:r,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return a;if(e<0||t<0||n<0||o<0)return u;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(r))return u;if(o>n)return u;if(t>=e)return 0;const i=(1-Math.pow(t/e,1/n)).toFixed(3),l=e*i*r/12;let s=l,c=0;const d=o===n?n-1:o;for(let t=2;t<=d;t++)c=(e-s)*i,s+=c;return 1===o?l:o===n?(e-s)*i:c},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);const i=[];return g(o,e=>{i.push(r[e])}),le(i)},t.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);const i=[];return g(o,e=>{i.push(r[e])}),ae(i)},t.DDB=function(e,t,n,o,r){if(r=void 0===r?2:r,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return a;if(e<0||t<0||n<0||o<0||r<=0)return u;if(o>n)return u;if(t>=e)return 0;let i=0,l=0;for(let a=1;a<=o;a++)l=Math.min(r/n*(e-i),e-t-i),i+=l;return l},t.DEC2BIN=function(e,t){if((e=j(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return u;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:u},t.DEC2HEX=function(e,t){if((e=j(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return u;if(e<0)return(1099511627776+e).toString(16);const n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:u},t.DEC2OCT=function(e,t){if((e=j(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return u;if(e<0)return(1073741824+e).toString(8);const n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=n.length?vt("0",t-n.length)+n:u},t.DECIMAL=function(e,t){return arguments.length<1?a:L(e=j(e),t=j(t))||(0===t?u:parseInt(e,t))},t.DEGREES=function(e){return(e=j(e))instanceof Error?e:180*e/Math.PI},t.DELTA=function(e,t){return t=void 0===t?0:t,M(e=j(e),t=j(t))?a:e===t?1:0},t.DEVSQ=function(){const e=D(b(arguments));if(e instanceof Error)return e;const t=o.mean(e);let n=0;for(let o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},t.DGET=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];return r=x("string"==typeof t?e[A(e,t)]:e[t]),0===o.length?a:o.length>1?u:r[o[0]]},t.DISC=function(e,t,n,o,r){if(M(e=N(e),t=N(t),n=j(n),o=j(o),r=(r=j(r))||0))return a;if(n<=0||o<=0)return u;if(e>=t)return a;let i,l;switch(r){case 0:i=360,l=rt(e,t,!1);break;case 1:case 3:i=365,l=tt(e,t,"D");break;case 2:i=360,l=tt(e,t,"D");break;case 4:i=360,l=rt(e,t,!0);break;default:return u}return(o-n)/o*i/l},t.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);let i=r[o[0]];return g(o,e=>{i<r[e]&&(i=r[e])}),i},t.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);let i=r[o[0]];return g(o,e=>{i>r[e]&&(i=r[e])}),i},t.DOLLAR=function(e,t=2){if(e=j(e),isNaN(e))return a;const n={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},o=(e=Ge(e,t)).toLocaleString("en-US",n);return e<0?"$("+o.slice(2)+")":o},t.DOLLARDE=function(e,t){if(M(e=j(e),t=j(t)))return a;if(t<0)return u;if(t>=0&&t<1)return l;t=parseInt(t,10);let n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const o=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*o)/o,n},t.DOLLARFR=function(e,t){if(M(e=j(e),t=j(t)))return a;if(t<0)return u;if(t>=0&&t<1)return l;t=parseInt(t,10);let n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,n},t.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);let i=[];g(o,e=>{i.push(r[e])}),i=Vn(i);let l=1;return g(i,e=>{l*=e}),l},t.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);let i=[];return g(o,e=>{i.push(r[e])}),i=Vn(i),De.S(i)},t.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);let i=[];return g(o,e=>{i.push(r[e])}),i=Vn(i),De.P(i)},t.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);const i=[];return g(o,e=>{i.push(r[e])}),Ke(i)},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);const i=[];return g(o,e=>{i.push(r[e])}),ke.S(i)},t.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return a;const o=Bn(e,n);let r=[];if("string"==typeof t){const n=A(e,t);r=x(e[n])}else r=x(e[t]);const i=[];return g(o,e=>{i.push(r[e])}),ke.P(i)},t.EDATE=function(e,t){return(e=N(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},t.EFFECT=function(e,t){return M(e=j(e),t=j(t))?a:e<=0||t<1?u:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.EOMONTH=function(e,t){return(e=N(e))instanceof Error?e:isNaN(t)?a:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},t.ERF=xt,t.ERFC=Et,t.ERFCPRECISE=Xt,t.ERFPRECISE=Gt,t.ERROR=z,t.EVEN=function(e){return(e=j(e))instanceof Error?e:Ve(e,-2,-1)},t.EXACT=function(e,t){return 2!==arguments.length?d:L(e,t)||(e=O(e))===O(t)},t.EXP=function(e){return arguments.length<1?d:arguments.length>1?f:(e=j(e))instanceof Error?e:e=Math.exp(e)},t.EXPON=ue,t.EXPONDIST=Kt,t.F=de,t.FACT=Ue,t.FACTDOUBLE=function e(t){if((t=j(t))instanceof Error)return t;const n=Math.floor(t);return n<=0?1:n*e(n-2)},t.FALSE=function(){return!1},t.FDIST=$t,t.FDISTRT=Zt,t.FIND=function(e,t,n){if(arguments.length<2)return d;e=O(e),n=void 0===n?0:n;const o=(t=O(t)).indexOf(e,n-1);return-1===o?a:o+1},t.FINV=Jt,t.FINVRT=Qt,t.FISHER=function(e){return(e=j(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=j(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.FIXED=gt,t.FLOOR=Ye,t.FLOORMATH=en,t.FLOORPRECISE=tn,t.FORECAST=fe,t.FREQUENCY=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;const n=e.length,o=t.length,r=[];for(let i=0;i<=o;i++){r[i]=0;for(let l=0;l<n;l++)0===i?e[l]<=t[0]&&(r[0]+=1):i<o?e[l]>t[i-1]&&e[l]<=t[i]&&(r[i]+=1):i===o&&e[l]>t[o-1]&&(r[o]+=1)}return r},t.FTEST=nn,t.FV=Yn,t.FVSCHEDULE=function(e,t){if(M(e=j(e),t=D(b(t))))return a;const n=t.length;let o=e;for(let e=0;e<n;e++)o*=1+t[e];return o},t.GAMMA=pe,t.GAMMADIST=on,t.GAMMAINV=rn,t.GAMMALN=he,t.GAMMALNPRECISE=ln,t.GAUSS=function(e){return(e=j(e))instanceof Error?e:o.normal.cdf(e,0,1)-.5},t.GCD=function(){const e=D(b(arguments));if(e instanceof Error)return e;const t=e.length,n=e[0];let o=n<0?-n:n;for(let n=1;n<t;n++){const t=e[n];let r=t<0?-t:t;for(;o&&r;)o>r?o%=r:r%=o;o+=r}return o},t.GEOMEAN=function(){const e=D(b(arguments));return e instanceof Error?e:o.geomean(e)},t.GESTEP=function(e,t){return M(t=t||0,e=j(e))?e:e>=t?1:0},t.GROWTH=function(e,t,n,o){if((e=D(e))instanceof Error)return e;let r;if(void 0===t)for(t=[],r=1;r<=e.length;r++)t.push(r);if(void 0===n)for(n=[],r=1;r<=e.length;r++)n.push(r);if(M(t=D(t),n=D(n)))return a;void 0===o&&(o=!0);const i=e.length;let l,s,c=0,u=0,d=0,f=0;for(r=0;r<i;r++){const n=t[r],o=Math.log(e[r]);c+=n,u+=o,d+=n*o,f+=n*n}c/=i,u/=i,d/=i,f/=i,o?(l=(d-c*u)/(f-c*c),s=u-l*c):(l=d/f,s=0);const p=[];for(r=0;r<n.length;r++)p.push(Math.exp(s+l*n[r]));return p},t.HARMEAN=function(){const e=D(b(arguments));if(e instanceof Error)return e;const t=e.length;let n=0;for(let o=0;o<t;o++)n+=1/e[o];return t/n},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()),o=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(o<-512||o>511)return u;if(n)return"1"+vt("0",9-(512+o).toString(2).length)+(512+o).toString(2);const r=o.toString(2);return void 0===t?r:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:u},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return u;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);const o=n.toString(8);return void 0===t?o:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:u},t.HLOOKUP=function(e,t,n,o){return Q(e,E(t),n,o)},t.HOUR=function(e){return(e=N(e))instanceof Error?e:e.getHours()},t.HYPGEOM=me,t.HYPGEOMDIST=an,t.IF=function(e,t,n){return e instanceof Error?e:(null==(t=!(arguments.length>=2)||t)&&(t=0),null==(n=3===arguments.length&&n)&&(n=0),e?t:n)},t.IFERROR=function(e,t){return G(e)?t:e},t.IFNA=function(e,t){return e===d?t:e},t.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return d},t.IMABS=At,t.IMAGINARY=Lt,t.IMARGUMENT=Mt,t.IMCONJUGATE=function(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",0!==n?Ct(t,-n,o):e},t.IMCOS=It,t.IMCOSH=Tt,t.IMCOT=function(e){return M(Nt(e),Lt(e))?a:_t(It(e),St(e))},t.IMCSC=function(e){return!0===e||!1===e?a:M(Nt(e),Lt(e))?u:_t("1",St(e))},t.IMCSCH=function(e){return!0===e||!1===e?a:M(Nt(e),Lt(e))?u:_t("1",jt(e))},t.IMDIV=_t,t.IMEXP=function(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);o="i"===o||"j"===o?o:"i";const r=Math.exp(t);return Ct(r*Math.cos(n),r*Math.sin(n),o)},t.IMLN=function(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),o)},t.IMLOG10=function(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),o)},t.IMLOG2=function(e){const t=Nt(e),n=Lt(e);if(M(t,n))return a;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",Ct(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),o)},t.IMPOWER=function(e,t){if(M(t=j(t),Nt(e),Lt(e)))return a;let n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";const o=Math.pow(At(e),t),r=Mt(e);return Ct(o*Math.cos(t*r),o*Math.sin(t*r),n)},t.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return a;for(let t=1;t<arguments.length;t++){const n=Nt(e),o=Lt(e),r=Nt(arguments[t]),i=Lt(arguments[t]);if(M(n,o,r,i))return a;e=Ct(n*r-o*i,n*i+o*r)}return e},t.IMREAL=Nt,t.IMSEC=function(e){return!0===e||!1===e||M(Nt(e),Lt(e))?a:_t("1",It(e))},t.IMSECH=function(e){return M(Nt(e),Lt(e))?a:_t("1",Tt(e))},t.IMSIN=St,t.IMSINH=jt,t.IMSQRT=function(e){if(M(Nt(e),Lt(e)))return a;let t=e.substring(e.length-1);t="i"===t||"j"===t?t:"i";const n=Math.sqrt(At(e)),o=Mt(e);return Ct(n*Math.cos(o/2),n*Math.sin(o/2),t)},t.IMSUB=function(e,t){const n=Nt(e),o=Lt(e),r=Nt(t),i=Lt(t);if(M(n,o,r,i))return a;const l=e.substring(e.length-1),s=t.substring(t.length-1);let c="i";return("j"===l||"j"===s)&&(c="j"),Ct(n-r,o-i,c)},t.IMSUM=function(){if(!arguments.length)return a;const e=b(arguments);let t=e[0];for(let n=1;n<e.length;n++){const o=Nt(t),r=Lt(t),i=Nt(e[n]),l=Lt(e[n]);if(M(o,r,i,l))return a;t=Ct(o+i,r+l)}return t},t.IMTAN=function(e){return!0===e||!1===e||M(Nt(e),Lt(e))?a:_t(St(e),It(e))},t.INDEX=function(e,t,n){const o=L(e,t,n);if(o)return o;if(!Array.isArray(e))return a;const r=e.length>0&&!Array.isArray(e[0]);return r&&!n?(n=t,t=1):(n=n||1,t=t||1),n<0||t<0?a:r&&1===t&&n<=e.length?e[n-1]:t<=e.length&&n<=e[t-1].length?e[t-1][n-1]:s},t.INFO=function(){throw new Error("INFO is not implemented")},t.INT=function(e){return(e=j(e))instanceof Error?e:Math.floor(e)},t.INTERCEPT=function(e,t){return M(e=D(e),t=D(t))?a:e.length!==t.length?d:fe(0,e,t)},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=Wn,t.IRR=function(e,t){if(t=t||0,M(e=D(b(e)),t=j(t)))return a;const n=(e,t,n)=>{const o=n+1;let r=e[0];for(let n=1;n<e.length;n++)r+=e[n]/Math.pow(o,(t[n]-t[0])/365);return r},o=(e,t,n)=>{const o=n+1;let r=0;for(let n=1;n<e.length;n++){const i=(t[n]-t[0])/365;r-=i*e[n]/Math.pow(o,i+1)}return r},r=[];let i=!1,l=!1;for(let t=0;t<e.length;t++)r[t]=0===t?0:r[t-1]+365,e[t]>0&&(i=!0),e[t]<0&&(l=!0);if(!i||!l)return u;let s,c,d,f=t=void 0===t?.1:t,p=!0;do{d=n(e,r,f),s=f-d/o(e,r,f),c=Math.abs(s-f),f=s,p=c>1e-10&&Math.abs(d)>1e-10}while(p);return f},t.ISBLANK=function(e){return null===e},t.ISERR=X,t.ISERROR=G,t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=K,t.ISNA=function(e){return e===d},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=$,t.ISO=We,t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISOWEEKNUM=it,t.ISPMT=function(e,t,n,o){return M(e=j(e),t=j(t),n=j(n),o=j(o))?a:o*e*(t/n-1)},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=Z,t.KURT=function(){const e=D(b(arguments));if(e instanceof Error)return e;const t=o.mean(e),n=e.length;let r=0;for(let o=0;o<n;o++)r+=Math.pow(e[o]-t,4);return r/=Math.pow(o.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))},t.LARGE=ge,t.LCM=function(){const e=D(b(arguments));if(e instanceof Error)return e;for(var t,n,o,r,i=1;void 0!==(o=e.pop());){if(0===o)return 0;for(;o>1;){if(o%2){for(t=3,n=Math.floor(Math.sqrt(o));t<=n&&o%t;t+=2);r=t<=n?t:o}else r=2;for(o/=r,i*=r,t=e.length;t;e[--t]%r==0&&1==(e[t]/=r)&&e.splice(t,1));}}return i},t.LEFT=function(e,t){return L(e,t)||(e=O(e),(t=j(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?a:e.substring(0,t))},t.LEN=function(e){return 0===arguments.length?f:e instanceof Error?e:Array.isArray(e)?a:O(e).length},t.LINEST=ve,t.LN=function(e){return(e=j(e))instanceof Error?e:0===e?u:Math.log(e)},t.LOG=function(e,t){return L(e=j(e),t=j(t))||(0===e||0===t?u:Math.log(e)/Math.log(t))},t.LOG10=function(e){return(e=j(e))instanceof Error?e:0===e?u:Math.log(e)/Math.log(10)},t.LOGEST=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;if(e.length!==t.length)return a;for(let t=0;t<e.length;t++)e[t]=Math.log(e[t]);const n=ve(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n},t.LOGINV=sn,t.LOGNORM=ye,t.LOGNORMDIST=cn,t.LOGNORMINV=un,t.LOOKUP=function(e,t,n){t=b(t),n=n?b(n):t;const o="number"==typeof e;let r=d;for(let i=0;i<t.length;i++){if(t[i]===e)return n[i];if(o&&t[i]<=e||"string"==typeof t[i]&&t[i].localeCompare(e)<0)r=n[i];else if(o&&t[i]>e)return r}return r},t.LOWER=function(e){return 1!==arguments.length?a:M(e=O(e))?e:e.toLowerCase()},t.MATCH=function(e,t,n){if(!e||!t)return d;if(2===arguments.length&&(n=1),!((t=b(t))instanceof Array))return d;if(-1!==n&&0!==n&&1!==n)return d;let o,r;for(let i=0;i<t.length;i++)if(1===n){if(t[i]===e)return i+1;t[i]<e&&(r?t[i]>r&&(o=i+1,r=t[i]):(o=i+1,r=t[i]))}else if(0===n){if("string"==typeof e&&"string"==typeof t[i]){const n=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+n+"$").test(t[i].toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===n){if(t[i]===e)return i+1;t[i]>e&&(r?t[i]<r&&(o=i+1,r=t[i]):(o=i+1,r=t[i]))}return o||d},t.MAX=be,t.MAXA=function(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;let n=v(e);return n=n.map(e=>null==e?0:e),0===n.length?0:Math.max.apply(Math,n)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MEDIAN=we,t.MID=function(e,t,n){if(null==t)return a;if(M(t=j(t),n=j(n))||"string"!=typeof e)return n;const o=t-1,r=o+n;return e.substring(o,r)},t.MIN=Ce,t.MINA=function(){const e=b(arguments),t=L.apply(void 0,e);if(t)return t;let n=v(e);return n=n.map(e=>null==e?0:e),0===n.length?0:Math.min.apply(Math,n)},t.MINUTE=function(e){return(e=N(e))instanceof Error?e:e.getMinutes()},t.MIRR=function(e,t,n){if(M(e=D(b(e)),t=j(t),n=j(n)))return a;const o=e.length,r=[],i=[];for(let t=0;t<o;t++)e[t]<0?r.push(e[t]):i.push(e[t]);const l=-zn(n,i)*Math.pow(1+n,o-1),s=zn(t,r)*(1+t);return Math.pow(l/s,1/(o-1))-1},t.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(e=>!e.length)||t.some(e=>!e.length)||w(e).some(e=>"number"!=typeof e)||w(t).some(e=>"number"!=typeof e)||e[0].length!==t.length?a:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((n,o)=>n.map((n,r)=>e[o].reduce((e,n,o)=>e+n*t[o][r],0)))},t.MOD=function(e,t){const n=L(e=j(e),t=j(t));if(n)return n;if(0===t)return l;let o=Math.abs(e%t);return o=e<0?t-o:o,t>0?o:-o},t.MODE=xe,t.MODEMULT=dn,t.MODESNGL=fn,t.MONTH=function(e){return(e=N(e))instanceof Error?e:e.getMonth()+1},t.MROUND=function(e,t){return L(e=j(e),t=j(t))||(e*t==0?0:e*t<0?u:Math.round(e/t)*t)},t.MULTINOMIAL=function(){const e=D(b(arguments));if(e instanceof Error)return e;let t=0,n=1;for(let o=0;o<e.length;o++)t+=e[o],n*=Ue(e[o]);return Ue(t)/n},t.MUNIT=function(e){return arguments.length>1?d:!(e=parseInt(e))||e<=0?a:Array(e).fill(0).map(()=>Array(e).fill(0)).map((e,t)=>(e[t]=1,e))},t.N=function(e){return $(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:G(e)?e:0},t.NA=function(){return d},t.NEGBINOM=Ee,t.NEGBINOMDIST=pn,t.NETWORKDAYS=lt,t.NETWORKDAYSINTL=hn,t.NOMINAL=function(e,t){return M(e=j(e),t=j(t))?a:e<=0||t<1?u:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NORM=Ae,t.NORMDIST=mn,t.NORMINV=gn,t.NORMSDIST=vn,t.NORMSINV=yn,t.NOT=function(e){return"string"==typeof e?a:e instanceof Error?e:!e},t.NOW=function(){return new Date},t.NPER=function(e,t,n,o,r){if(r=void 0===r?0:r,o=void 0===o?0:o,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r)))return a;if(0===e)return-(n+o)/t;{const i=t*(1+e*r)-o*e,l=n*e+t*(1+e*r);return Math.log(i/l)/Math.log(1+e)}},t.NPV=zn,t.NUMBERVALUE=function(e,t,n){return"number"==typeof(e=R(e)?e:"")?e:"string"!=typeof e?d:(t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,"")))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=!(10!==e.length||"7"!==e.substring(0,1)),o=n?parseInt(e,8)-1073741824:parseInt(e,8);if(o<-512||o>511)return u;if(n)return"1"+vt("0",9-(512+o).toString(2).length)+(512+o).toString(2);const r=o.toString(2);return void 0===t?r:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:u},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return u;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);const o=n.toString(16);return void 0===t?o:isNaN(t)?a:t<0?u:(t=Math.floor(t))>=o.length?vt("0",t-o.length)+o:u},t.ODD=function(e){if((e=j(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.OR=function(){const e=b(arguments);let t=a;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===a&&(t=!1),e[n]&&(t=!0))}return t},t.PDURATION=function(e,t,n){return M(e=j(e),t=j(t),n=j(n))?a:e<=0?u:(Math.log(n)-Math.log(t))/Math.log(1+e)},t.PEARSON=Le,t.PERCENTILE=Me,t.PERCENTILEEXC=bn,t.PERCENTILEINC=wn,t.PERCENTRANK=Ie,t.PERCENTRANKEXC=Cn,t.PERCENTRANKINC=xn,t.PERMUT=function(e,t){return M(e=j(e),t=j(t))?a:Ue(e)/Ue(e-t)},t.PERMUTATIONA=function(e,t){return M(e=j(e),t=j(t))?a:Math.pow(e,t)},t.PHI=function(e){return(e=j(e))instanceof Error?a:Math.exp(-.5*e*e)/2.5066282746310002},t.PI=function(){return Math.PI},t.PMT=Xn,t.POISSON=Te,t.POISSONDIST=En,t.POWER=ze,t.PPMT=function(e,t,n,o,r,i){return r=r||0,i=i||0,M(e=j(e),n=j(n),o=j(o),r=j(r),i=j(i))?a:Xn(e,n,o,r,i)-Wn(e,t,n,o,r,i)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(e,t,n,o,r){if(M(e=N(e),t=N(t),n=j(n),o=j(o),r=(r=j(r))||0))return a;if(n<=0||o<=0)return u;if(e>=t)return a;let i,l;switch(r){case 0:i=360,l=rt(e,t,!1);break;case 1:case 3:i=365,l=tt(e,t,"D");break;case 2:i=360,l=tt(e,t,"D");break;case 4:i=360,l=rt(e,t,!0);break;default:return u}return o-n*o*l/i},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PROB=function(e,t,n,o){if(void 0===n)return 0;if(o=void 0===o?n:o,M(e=D(b(e)),t=D(b(t)),n=j(n),o=j(o)))return a;if(n===o)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;const r=e.sort((e,t)=>e-t),i=r.length;let l=0;for(let a=0;a<i;a++)r[a]>=n&&r[a]<=o&&(l+=t[e.indexOf(r[a])]);return l},t.PRODUCT=Xe,t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return M(e)?e:isNaN(e)&&"number"==typeof e?a:(e=O(e)).replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())},t.PV=function(e,t,n,o,r){return o=o||0,r=r||0,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r))?a:0===e?-n*t-o:((1-Math.pow(1+e,t))/e*n*(1+e*r)-o)/Math.pow(1+e,t)},t.QUARTILE=_e,t.QUARTILEEXC=An,t.QUARTILEINC=Ln,t.QUOTIENT=function(e,t){return L(e=j(e),t=j(t))||parseInt(e/t,10)},t.RADIANS=function(e){return(e=j(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return L(e=j(e),t=j(t))||e+Math.ceil((t-e+1)*Math.random())-1},t.RANK=Ne,t.RANKAVG=Mn,t.RANKEQ=In,t.RATE=function(e,t,n,o,r,i){if(i=void 0===i?.01:i,o=void 0===o?0:o,r=void 0===r?0:r,M(e=j(e),t=j(t),n=j(n),o=j(o),r=j(r),i=j(i)))return a;const l=1e-10;let s=i;r=r?1:0;for(let i=0;i<20;i++){if(s<=-1)return u;let i,a,c;if(Math.abs(s)<l?i=n*(1+e*s)+t*(1+s*r)*e+o:(a=Math.pow(1+s,e),i=n*a+t*(1/s+r)*(a-1)+o),Math.abs(i)<l)return s;if(Math.abs(s)<l)c=n*e+t*r*e;else{a=Math.pow(1+s,e);const o=e*Math.pow(1+s,e-1);c=n*o+t*(1/s+r)*o+t*(-1/(s*s))*(a-1)}s-=i/c}return s},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.REPLACE=function(e,t,n,o){return M(t=j(t),n=j(n))||"string"!=typeof e||"string"!=typeof o?a:e.substr(0,t-1)+o+e.substr(t-1+n)},t.REPT=vt,t.RIGHT=function(e,t){return L(e,t)||(e=O(e),(t=j(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))},t.ROMAN=function(e){if((e=j(e))instanceof Error)return e;const t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",r=3;for(;r--;)o=(n[+t.pop()+10*r]||"")+o;return new Array(+t.join("")+1).join("M")+o},t.ROUND=Ge,t.ROUNDDOWN=function(e,t){return L(e=j(e),t=j(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return L(e=j(e),t=j(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROW=function(e,t){return 2!==arguments.length?d:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?o.row(e,t):void 0:a},t.ROWS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:o.rows(e):a},t.RRI=function(e,t,n){return M(e=j(e),t=j(t),n=j(n))?a:0===e||0===t?u:Math.pow(n/t,1/e)-1},t.RSQ=function(e,t){return M(e=D(b(e)),t=D(b(t)))?a:Math.pow(Le(e,t),2)},t.SEARCH=function(e,t,n){let o;return"string"!=typeof e||"string"!=typeof t?a:(n=void 0===n?0:n,o=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===o?a:o)},t.SEC=function(e){return(e=j(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=j(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SECOND=function(e){return(e=N(e))instanceof Error?e:e.getSeconds()},t.SERIESSUM=function(e,t,n,o){if(M(e=j(e),t=j(t),n=j(n),o=D(o)))return a;let r=o[0]*Math.pow(e,t);for(let i=1;i<o.length;i++)r+=o[i]*Math.pow(e,t+i*n);return r},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.SIGN=function(e){return(e=j(e))instanceof Error?e:e<0?-1:0===e?0:1},t.SIN=function(e){return(e=j(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=j(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SKEW=Se,t.SKEWP=Tn,t.SLN=function(e,t,n){return M(e=j(e),t=j(t),n=j(n))?a:0===n?u:(e-t)/n},t.SLOPE=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;const n=o.mean(t),r=o.mean(e),i=t.length;let l=0,s=0;for(let o=0;o<i;o++)l+=(t[o]-n)*(e[o]-r),s+=Math.pow(t[o]-n,2);return l/s},t.SMALL=je,t.SORT=function(e,t=1,n=1,o=!1){if(!e||!Array.isArray(e))return d;if(0===e.length)return 0;if(!(t=j(t))||t<1)return a;if(1!==(n=j(n))&&-1!==n)return a;if("boolean"!=typeof(o=_(o)))return c;const r=e=>e.sort((e,o)=>(e=O(e[t-1]),o=O(o[t-1]),1===n?e<o?-1*n:n:e>o?n:-1*n)),i=y(e),l=o?E(i):i;return t>=1&&t<=l[0].length?o?E(r(l)):r(l):a},t.SQRT=function(e){return(e=j(e))instanceof Error?e:e<0?u:Math.sqrt(e)},t.SQRTPI=function(e){return(e=j(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.STANDARDIZE=function(e,t,n){return M(e=j(e),t=j(t),n=j(n))?a:(e-t)/n},t.STDEV=De,t.STDEVA=function(){const e=Re.apply(this,arguments);return Math.sqrt(e)},t.STDEVP=_n,t.STDEVPA=function(){const e=He.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},t.STDEVS=Nn,t.STEYX=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;const n=o.mean(t),r=o.mean(e),i=t.length;let l=0,s=0,c=0;for(let o=0;o<i;o++)l+=Math.pow(e[o]-r,2),s+=(t[o]-n)*(e[o]-r),c+=Math.pow(t[o]-n,2);return Math.sqrt((l-s*s/c)/(i-2))},t.SUBSTITUTE=function(e,t,n,o){if(arguments.length<3)return d;if(e&&t){if(void 0===o)return e.split(t).join(n);{if(o=Math.floor(Number(o)),Number.isNaN(o)||o<=0)return a;let r=0,i=0;for(;r>-1&&e.indexOf(t,r)>-1;)if(r=e.indexOf(t,r+1),i++,r>-1&&i===o)return e.substring(0,r)+n+e.substring(r+t.length);return e}}return e},t.SUBTOTAL=function(e,t){if((e=j(e))instanceof Error)return e;switch(e){case 1:case 101:return ee(t);case 2:case 102:return le(t);case 3:case 103:return ae(t);case 4:case 104:return be(t);case 5:case 105:return Ce(t);case 6:case 106:return Xe(t);case 7:case 107:return De.S(t);case 8:case 108:return De.P(t);case 9:case 109:return Ke(t);case 10:case 110:return ke.S(t);case 11:case 111:return ke.P(t)}},t.SUM=Ke,t.SUMIF=function(e,t,n){if(e=b(e),n=n?b(n):e,e instanceof Error)return e;if(null==t||t instanceof Error)return 0;let o=0;const r="*"===t,i=r?null:Y(t+"");for(let t=0;t<e.length;t++){const l=e[t],a=n[t];if(r)o+=l;else{const e=[U(l,q)].concat(i);o+=W(e)?a:0}}return o},t.SUMIFS=function(){const e=m(arguments),t=D(b(e.shift()));if(t instanceof Error)return t;const n=e,o=n.length/2;for(let e=0;e<o;e++)n[2*e]=b(n[2*e]);let r=0;for(let e=0;e<t.length;e++){let i=!1;for(let t=0;t<o;t++){const o=n[2*t][e],r=n[2*t+1];let l=!1;if(void 0===r||"*"===r)l=!0;else{const e=Y(r+""),t=[U(o,q)].concat(e);l=W(t)}if(!l){i=!1;break}i=!0}i&&(r+=t[e])}return r},t.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return a;const e=arguments.length+1;let t,n,o,r,i=0;for(let l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(let o=0;o<arguments[0][l].length;o++){for(t=1,n=1;n<e;n++){const e=arguments[n-1][l][o];if(e instanceof Error)return e;if(r=j(e),r instanceof Error)return r;t*=r}i+=t}else{for(t=1,n=1;n<e;n++){const e=arguments[n-1][l];if(e instanceof Error)return e;if(o=j(e),o instanceof Error)return o;t*=o}i+=t}return i},t.SUMSQ=function(){const e=D(b(arguments));if(e instanceof Error)return e;let t=0;const n=e.length;for(let o=0;o<n;o++)t+=$(e[o])?e[o]*e[o]:0;return t},t.SUMX2MY2=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;let n=0;for(let o=0;o<e.length;o++)n+=e[o]*e[o]-t[o]*t[o];return n},t.SUMX2PY2=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;let n=0;e=D(b(e)),t=D(b(t));for(let o=0;o<e.length;o++)n+=e[o]*e[o]+t[o]*t[o];return n},t.SUMXMY2=function(e,t){if(M(e=D(b(e)),t=D(b(t))))return a;let n=0;e=b(e),t=b(t);for(let o=0;o<e.length;o++)n+=Math.pow(e[o]-t[o],2);return n},t.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],n=arguments.length-1,o=Math.floor(n/2);let r=!1;const i=n%2!=0,l=n%2==0?null:arguments[arguments.length-1];if(o)for(let n=0;n<o;n++)if(t===arguments[2*n+1]){e=arguments[2*n+2],r=!0;break}r||(e=i?l:d)}else e=a;return e},t.SYD=function(e,t,n,o){return M(e=j(e),t=j(t),n=j(n),o=j(o))?a:0===n||o<1||o>n?u:(e-t)*(n-(o=parseInt(o,10))+1)*2/(n*(n+1))},t.T=function(e){return e instanceof Error||"string"==typeof e?e:""},t.TAN=function(e){return(e=j(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){if((e=j(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.TBILLEQ=function(e,t,n){return M(e=N(e),t=N(t),n=j(n))?a:n<=0||e>t||t-e>31536e6?u:365*n/(360-n*rt(e,t,!1))},t.TBILLPRICE=function(e,t,n){return M(e=N(e),t=N(t),n=j(n))?a:n<=0||e>t||t-e>31536e6?u:100*(1-n*rt(e,t,!1)/360)},t.TBILLYIELD=function(e,t,n){return M(e=N(e),t=N(t),n=j(n))?a:n<=0||e>t||t-e>31536e6?u:360*(100-n)/(n*rt(e,t,!1))},t.TDIST=Sn,t.TDISTRT=jn,t.TEXT=function(e,t){if(void 0===e||e instanceof Error||t instanceof Error)return d;if(null==t)return"";if("number"==typeof t)return String(t);if("string"!=typeof t)return a;const n=t.startsWith("$")?"$":"",o=t.endsWith("%");return o&&(e*=100),e=(e=gt(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+n+(e=e.replace("-","")):n+e,o&&(e+="%"),e},t.TEXTJOIN=function(e,t,...n){if("boolean"!=typeof t&&(t=_(t)),arguments.length<3)return d;e=null!=e?e:"";let o=b(n),r=t?o.filter(e=>e):o;if(Array.isArray(e)){e=b(e);let t=r.map(e=>[e]),n=0;for(let o=0;o<t.length-1;o++)t[o].push(e[n]),n++,n===e.length&&(n=0);return r=b(t),r.join("")}return r.join(e)},t.TIME=function(e,t,n){return M(e=j(e),t=j(t),n=j(n))?a:e<0||t<0||n<0?u:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return(e=N(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TINV=Dn,t.TODAY=function(){return nt(new Date)},t.TRANSPOSE=function(e){return e?E(y(e)):d},t.TREND=function(e,t,n){if(M(e=D(b(e)),t=D(b(t)),n=D(b(n))))return a;const o=ve(e,t),r=o[0],i=o[1],l=[];return n.forEach(e=>{l.push(r*e+i)}),l},t.TRIM=function(e){return(e=O(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},t.TRIMMEAN=function(e,t){if(M(e=D(b(e)),t=j(t)))return a;const n=Ye(e.length*t,2)/2;return o.mean((i=(i=n)||1,(r=x(e.sort((e,t)=>e-t),n))&&"function"==typeof r.slice?r.slice(0,r.length-i):r));var r,i},t.TRUE=function(){return!0},t.TRUNC=function(e,t){return L(e=j(e),t=j(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.TTEST=On,t.TYPE=function(e){return $(e)?1:Z(e)?2:K(e)?4:G(e)?16:Array.isArray(e)?64:void 0},t.UNICHAR=yt,t.UNICODE=bt,t.UNIQUE=J,t.UPPER=function(e){return(e=O(e))instanceof Error?e:e.toUpperCase()},t.VALUE=function(e){const t=L(e);if(t)return t;if("number"==typeof e)return e;if(R(e)||(e=""),"string"!=typeof e)return a;const n=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return 0;let o=Number(e);return isNaN(o)?a:(o=o||0,n&&(o*=.01),o)},t.VAR=ke,t.VARA=Re,t.VARP=kn,t.VARPA=He,t.VARS=Rn,t.VDB=function(){throw new Error("VDB is not implemented")},t.VLOOKUP=Q,t.WEEKDAY=function(e,t){if((e=N(e))instanceof Error)return e;void 0===t&&(t=1);const n=e.getDay();return Qe[t][n]},t.WEEKNUM=function(e,t){if((e=N(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return it(e);const n=Je[t];let o=new Date(e.getFullYear(),0,1);const r=o.getDay()<n?1:0;return o-=24*Math.abs(o.getDay()-n)*60*60*1e3,Math.floor((e-o)/864e5/7+1)+r},t.WEIBULL=Pe,t.WEIBULLDIST=Hn,t.WORKDAY=at,t.WORKDAYINTL=Pn,t.XIRR=function(e,t,n){if(M(e=D(b(e)),t=S(b(t)),n=j(n)))return a;const o=(e,t,n)=>{const o=n+1;let r=e[0];for(let n=1;n<e.length;n++)r+=e[n]/Math.pow(o,ot(t[n],t[0])/365);return r},r=(e,t,n)=>{const o=n+1;let r=0;for(let n=1;n<e.length;n++){const i=ot(t[n],t[0])/365;r-=i*e[n]/Math.pow(o,i+1)}return r};let i=!1,l=!1;for(let t=0;t<e.length;t++)e[t]>0&&(i=!0),e[t]<0&&(l=!0);if(!i||!l)return u;let s,c,d,f=n=n||.1,p=!0;do{d=o(e,t,f),s=f-d/r(e,t,f),c=Math.abs(s-f),f=s,p=c>1e-10&&Math.abs(d)>1e-10}while(p);return f},t.XNPV=function(e,t,n){if(M(e=j(e),t=D(b(t)),n=S(b(n))))return a;let o=0;for(let r=0;r<t.length;r++)o+=t[r]/Math.pow(1+e,ot(n[r],n[0])/365);return o},t.XOR=function(){const e=b(arguments);let t=a;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===a&&(t=0),e[n]&&t++)}return t===a?t:!!(1&Math.floor(Math.abs(t)))},t.YEAR=function(e){return(e=N(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=ut,t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},t.Z=Fe,t.ZTEST=Fn,t.utils=Gn}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var r=o(960);t=r}(),t)},881:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var o=function(){var e=this,t=0;if(e.options.freezeColumns&&e.options.freezeColumns>0)for(var n=0;n<e.options.freezeColumns;n++)t+=e.options.columns&&e.options.columns[n]&&void 0!==e.options.columns[n].width?parseInt(e.options.columns[n].width.toString()):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth.toString()):100;return t}},894:function(e,t,n){"use strict";n.d(t,{AG:function(){return r},G_:function(){return i},p6:function(){return l},wu:function(){return o}});var o=function(e){var t,n=this;t=1!=n.options.search&&1!=n.options.filters||!n.results?n.rows:n.results;var o=100;null!=e&&-1!=e||(e=Math.ceil(t.length/o)-1);var r=e*o,i=e*o+o;i>t.length&&(i=t.length),(r=i-100)<0&&(r=0);for(var l=r;l<i;l++){if(1!=n.options.search&&1!=n.options.filters||!n.results)n.tbody.appendChild(t[l].element);else{var a=t[l];n.tbody.appendChild(n.rows[a].element)}n.tbody.children.length>o&&n.tbody.firstChild&&n.tbody.removeChild(n.tbody.firstChild)}},r=function(){var e,t=this;if(t.selectedCell&&t.tbody.firstChild){var n=t.tbody.firstChild.getAttribute("data-y"),o=n?parseInt(n,10)/100:0,r=t.selectedCell[3],i=Math.floor(parseInt(String(r),10)/100),l=Math.floor(t.rows.length/100);if(o!==i&&i<=l){var a="number"==typeof r?r:parseInt(String(r),10);if(!Array.prototype.indexOf.call(t.tbody.children,t.rows[a].element))return null===(e=t.loadPage)||void 0===e||e.call(t,i),!0}}return!1},i=function(){var e,t=this,n=0;if((e=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results).length>100&&t.tbody.firstChild){var o=t.tbody.firstChild.getAttribute("data-y"),r=o?parseInt(o,10):0;if(1!=t.options.search&&1!=t.options.filters||!t.results||(r=e.indexOf(r)),r>0)for(var i=0;i<30;i++)(r-=1)>-1&&t.tbody.firstChild&&(1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.insertBefore(e[r].element,t.tbody.firstChild):t.tbody.insertBefore(t.rows[e[r]].element,t.tbody.firstChild),t.tbody.children.length>100&&t.tbody.lastChild&&(t.tbody.removeChild(t.tbody.lastChild),n=1))}return n},l=function(){var e,t=this,n=0;if((e=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results).length>100&&t.tbody.lastChild){var o=t.tbody.lastChild.getAttribute("data-y"),r=o?parseInt(o,10):0;if(1!=t.options.search&&1!=t.options.filters||!t.results||(r=e.indexOf(r)),r<t.rows.length-1)for(var i=0;i<=30;i++)r<e.length&&t.tbody.firstChild&&(1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.appendChild(e[r].element):t.tbody.appendChild(t.rows[e[r]].element),t.tbody.children.length>100&&(t.tbody.removeChild(t.tbody.firstChild),n=1)),r+=1}return n}},898:function(e,t,n){"use strict";n.d(t,{Hh:function(){return r},t3:function(){return l},vu:function(){return i}});var o=n(9),r=function(e,t,n){if(t<=e.length)return e.slice(0,t).concat(n).concat(e.slice(t));for(var o=e.slice(0,e.length);t>o.length;)o.push(void 0);return o.concat(n)},i=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var o=0,r=0;r<n[0].length;r++)o+=parseInt(String(n[0].charCodeAt(r)-64))*Math.pow(26,n[0].length-1-r);--o<0&&(o=0);var i=/[0-9]+$/.exec(e),l=i?parseInt(i[0]):0;return l>0&&l--,1==t?[o,l]:o+"-"+l}return e},l=function(e){if(!Array.isArray(e)){var t=e.split("-");return(0,o.getColumnName)(parseInt(String(t[0])))+(parseInt(String(t[1]))+1)}return(0,o.getColumnName)(parseInt(String(e[0])))+(parseInt(String(e[1]))+1)}},986:function(e,t,n){"use strict";n.d(t,{IV:function(){return s},MY:function(){return c},ho:function(){return a},lz:function(){return u}});var o=n(587),r=n.n(o),i=n(988),l=n(106),a=function(e){var t,n=this;if(1!=n.options.search&&1!=n.options.filters||!n.results)t="number"==typeof e?e:"string"==typeof e?parseInt(e,10):e&&"number"==typeof e.index?e.index:0;else{"number"==typeof e?t=e:"string"==typeof e?t=parseInt(e,10):e&&"number"==typeof e.index?t=e.index:(t=Number(String(e)),Number.isNaN(t)&&(t=0));var o=n.results.indexOf(t);-1!==o&&(t=o)}var r="number"==typeof n.options.pagination?n.options.pagination:parseInt(String(n.options.pagination||"0"),10)||0;return r?Math.ceil((t+1)/r)-1:0},s=function(){var e,t=this;if(t.pagination&&(t.pagination.children[0].innerHTML="",t.pagination.children[1].innerHTML="",t.options.pagination)){var n;if((n=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results)&&0!==n.length){var o=Array.isArray(n)?n.length:n,i="number"==typeof t.options.pagination?t.options.pagination:parseInt(String(t.options.pagination||"0"),10)||0,l=i?Math.ceil(o/i):0,a=void 0,s=void 0,c=null!==(e=t.pageNumber)&&void 0!==e?e:0;c<6?(a=1,s=l<10?l:10):l-c<5?(s=l,(a=l-9)<1&&(a=1)):(a=c-4,s=c+5),a>1&&t.pagination&&((d=document.createElement("div")).className="jss_page",d.innerHTML="<",d.title="1",t.pagination.children[1].appendChild(d));for(var u=a;u<=s;u++){var d;(d=document.createElement("div")).className="jss_page",d.innerHTML=u.toString(),t.pagination&&t.pagination.children[1].appendChild(d),c==u-1&&d.classList.add("jss_page_selected")}s<l&&t.pagination&&((d=document.createElement("div")).className="jss_page",d.innerHTML=">",d.title=l.toString(),t.pagination.children[1].appendChild(d)),t.pagination&&(t.pagination.children[0].innerHTML=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,function(e,n){var o=parseInt(n,10);return void 0!==t[o]?String(t[o]):e})}(r().translate("Showing page {0} of {1} entries"),(c+1).toString(),l.toString()))}else t.pagination&&(t.pagination.children[0].innerHTML=r().translate("No records found"))}},c=function(e){var t,n=this,o=n.pageNumber;t=1!=n.options.search&&1!=n.options.filters||!n.results?n.rows:n.results;var r=Number(n.options.pagination)||0;null!=e&&-1!=e||(e=Math.ceil(t.length/r)-1),n.pageNumber=e;var a=e*r,c=e*r+r;for(c>t.length&&(c=t.length),a<0&&(a=0);n.tbody.firstChild;)n.tbody.removeChild(n.tbody.firstChild);for(var u=a;u<c;u++)1!=n.options.search&&1!=n.options.filters||!n.results?n.tbody.appendChild(n.rows[u].element):n.tbody.appendChild(n.rows[t[u]].element);Number(n.options.pagination)>0&&s.call(n),l.Aq.call(n),i.A.call(n,"onchangepage",n,e,o,n.options.pagination)},u=function(){var e=this,t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows.length:e.results.length,n="number"==typeof e.options.pagination?e.options.pagination:parseInt(String(e.options.pagination||"0"),10)||0;return n?Math.ceil(t/n):0}},988:function(e,t,n){"use strict";var o=n(587),r=n.n(o),i=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},l=function(e){if(!Array.isArray(e))return[];for(var t=e,n=[],o=0;o<t.length;o++){var r=t[o].x,i=t[o].y,l=this.options.columns&&this.options.columns[r],a=l&&"string"==typeof l.name?l.name:String(r);n[i]||(n[i]={row:i,data:{}}),n[i]&&(n[i].data[a]=t[o].value)}return n.filter(function(e){return null!=e})},a=function(e,t){var n,o=this,i=s.call(o.parent,"onbeforesave",o.parent,o,t);if(i){if(!Array.isArray(i))return!1!==i&&void 0;t=i;var l=r();return null===(n=l.ajax)||void 0===n||n.call(l,{url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){s.call(o,"onsave",o.parent,o,t)}}),!0}},s=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r,s=this,c=null;if(!(r="parent"in s&&s.parent?s.parent:s).ignoreEvents){if(r.config&&"function"==typeof r.config.onevent&&(c=(t=r.config.onevent).call.apply(t,i([this,e],n,!1))),r.config&&"function"==typeof r.config[e]){var u=r.config[e];c=u.apply(this,n)}r.plugins&&Object.entries(r.plugins).forEach(function(t){var o=t[1];o&&"function"==typeof o.onevent&&(c=o.onevent.apply(s,i([e],n,!0)))})}if("onafterchanges"===e&&n.length>=3&&(r.plugins&&Object.entries(r.plugins).forEach(function(e){var t=e[1];t&&"function"==typeof t.persistence&&t.persistence(s,"setValue",{data:n[2]})}),s.options.persistence)){var d=!0===s.options.persistence?s.options.url:s.options.persistence;if("string"==typeof d){var f=l.call(s,n[2]);a.call(s,d,f)}}return c};t.A=s}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};!function(){"use strict";__webpack_require__.d(__webpack_exports__,{default:function(){return Oe}});var e=__webpack_require__(587),t=__webpack_require__.n(e),n={jspreadsheet:{}},o=__webpack_require__(988),r=__webpack_require__(655),i=__webpack_require__(32),l=function(){return l=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},l.apply(this,arguments)},a=function(e,n,i){var a,c,u,d,f,p,h,m,g=this,v=e.getAttribute("data-y"),y=e.getAttribute("data-x"),b=y?parseInt(y):0,w=v?parseInt(v):0;o.A.call(g,"oneditionstart",g,e,b,w),b>0&&w>=0&&(g.records[w][b-1].element.style.overflow="hidden");var C=function(t){var n=e.getBoundingClientRect(),o=document.createElement(t);return o.style.width=n.width+"px",o.style.height=n.height-2+"px",o.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(o),o};if(1==e.classList.contains("readonly"));else if(g.edition=[g.records[w][b].element,g.records[w][b].element.innerHTML,b,w],g.options.columns&&g.options.columns[parseInt(y||"0")]&&"object"==typeof g.options.columns[b].type){var x=g.options.data&&Array.isArray(g.options.data)&&Array.isArray(g.options.data[w])&&null!==(a=g.options.data[w][b])&&void 0!==a?a:"",E=g.options.columns[b].type;null===(c=E.openEditor)||void 0===c||c.call(E,e,x,b,w,g,g.options.columns[b],i),o.A.call(g,"oncreateeditor",g,e,b,w,null,g.options.columns[parseInt(y||"0")])}else if(g.options.columns&&g.options.columns[parseInt(y||"0")]&&"hidden"==g.options.columns[parseInt(y||"0")].type);else if(g.options.columns&&g.options.columns[parseInt(y||"0")]&&("checkbox"==g.options.columns[parseInt(y||"0")].type||"radio"==g.options.columns[parseInt(y||"0")].type)){var A=!e.children[0]||!e.children[0].checked;null===(u=g.setValue)||void 0===u||u.call(g,[{element:e}],A),g.edition=void 0}else if(g.options.columns&&y&&g.options.columns[b]&&"dropdown"==g.options.columns[b].type&&v){A=g.options.data&&Array.isArray(g.options.data)&&Array.isArray(g.options.data[w])&&null!==(d=g.options.data[w][b])&&void 0!==d?d:"",g.options.columns[b].multiple&&!Array.isArray(A)&&(A=String(A).split(";"));var L,M=[];if(L="function"==typeof g.options.columns[b].filter?g.options.columns[b].filter(g.element,e,y,v,g.options.columns[b].source):g.options.columns[b].source)for(var I=0;I<L.length;I++)M.push(L[I]);var T=C("div");o.A.call(g,"oncreateeditor",g,e,parseInt(y||"0"),parseInt(v||"0"),null,y&&g.options.columns?g.options.columns[b]:null);var _={data:M,multiple:!(!y||!g.options.columns[b].multiple),autocomplete:!(!y||!g.options.columns[b].autocomplete),opened:!0,value:A,width:"100%",height:T.style.minHeight,position:1==g.options.tableOverflow||1==g.parent.config.fullscreen,onclose:function(){s.call(g,e,!0)}};g.options.columns[b].options&&g.options.columns[b].options.type&&(_.type=g.options.columns[b].options.type),t().dropdown(T,_)}else if(g.options.columns&&g.options.columns[b]&&("calendar"==g.options.columns[b].type||"color"==g.options.columns[b].type)){if(A=g.options.data&&Array.isArray(g.options.data)&&Array.isArray(g.options.data[w])&&null!==(f=g.options.data[w][b])&&void 0!==f?f:"",T=C("input"),o.A.call(g,"oncreateeditor",g,e,parseInt(y||"0"),parseInt(v||"0"),null,y&&g.options.columns?g.options.columns[b]:null),T.value=String(A),_=y&&g.options.columns[b].options?l({},g.options.columns[b].options):{},1!=g.options.tableOverflow&&1!=g.parent.config.fullscreen||(_.position=!0),_.value=g.options.data&&Array.isArray(g.options.data)&&Array.isArray(g.options.data[w])&&null!==(p=g.options.data[w][b])&&void 0!==p?p:"",_.opened=!0,_.onclose=function(t,n){s.call(g,e,!0)},"color"==g.options.columns[b].type){t().color(T,_);var N=e.getBoundingClientRect();if(_.position&&T.nextSibling&&"children"in T.nextSibling){var S=T.nextSibling;if(S.children&&S.children[1]){var j=S.children[1];j.style.top=N.top+N.height+"px",j.style.left=N.left+"px"}}}else _.format||(_.format="YYYY-MM-DD"),t().calendar(T,_);T.focus()}else if(g.options.columns&&g.options.columns[b]&&"html"==g.options.columns[b].type){A=y&&v&&g.options.data&&Array.isArray(g.options.data)&&Array.isArray(g.options.data[w])&&null!==(h=g.options.data[w][b])&&void 0!==h?h:"",T=C("div"),o.A.call(g,"oncreateeditor",g,e,parseInt(y||"0"),parseInt(v||"0"),null,y&&g.options.columns?g.options.columns[b]:null),T.style.position="relative",(O=document.createElement("div")).classList.add("jss_richtext"),T.appendChild(O),t().editor(O,{focus:!0,value:String(A)}),N=e.getBoundingClientRect();var D=O.getBoundingClientRect();window.innerHeight<N.bottom+D.height?O.style.top=N.bottom-(D.height+2)+"px":O.style.top=N.top+"px",window.innerWidth<N.left+D.width?O.style.left=N.right-(D.width+2)+"px":O.style.left=N.left+"px"}else if(g.options.columns&&g.options.columns[b]&&"image"==g.options.columns[b].type){var O,k=e.children[0];T=C("div"),o.A.call(g,"oncreateeditor",g,e,parseInt(y||"0"),parseInt(v||"0"),null,y&&g.options.columns?g.options.columns[b]:null),T.style.position="relative",(O=document.createElement("div")).classList.add("jclose"),k&&k.src&&O.appendChild(k),T.appendChild(O),t().image(O,g.options.columns[b]),N=e.getBoundingClientRect(),D=O.getBoundingClientRect(),window.innerHeight<N.bottom+D.height?O.style.top=N.top-(D.height+2)+"px":O.style.top=N.top+"px",O.style.left=N.left+"px"}else{if(A=1==n?"":g.options.data&&Array.isArray(g.options.data)&&Array.isArray(g.options.data[w])&&null!==(m=g.options.data[w][b])&&void 0!==m?m:"",T=void 0,T=g.options.columns&&g.options.columns[b]&&0==g.options.columns[b].wordWrap||!(1==g.options.wordWrap||g.options.columns&&g.options.columns[b]&&1==g.options.columns[b].wordWrap)?C("input"):C("textarea"),o.A.call(g,"oncreateeditor",g,e,parseInt(y||"0"),parseInt(v||"0"),null,y&&g.options.columns?g.options.columns[b]:null),T.focus(),T.value=String(A),_=g.options.columns&&g.options.columns[b],!(0,r.dw)(A)&&_){var R=(0,r.rS)(_);if(R){if(!_.disabledMaskOnEdition)if(_.mask){var H=_.mask.split(";");T.setAttribute("data-mask",H[0])}else _.locale&&T.setAttribute("data-locale",String(_.locale));R.input=T,T.mask=R,t().mask.render(String(A),R,!1)}}T.onblur=function(){s.call(g,e,!0)},T.scrollLeft=T.scrollWidth}},s=function(e,n){var i,l,a,s,c,u,d,f,p,h,m,g,v,y,b,w,C,x,E,A,L,M=this,I=e.getAttribute("data-x"),T=e.getAttribute("data-y"),_=I?parseInt(I):0,N=T?parseInt(T):0;if(1==n){if(M.options.columns&&M.options.columns[_]&&"object"==typeof M.options.columns[_].type){var S=M.options.columns[_].type;L=null===(i=S.closeEditor)||void 0===i?void 0:i.call(S,e,n,_,N,M,M.options.columns[_])}else if(M.options.columns&&M.options.columns[_]&&("checkbox"==M.options.columns[_].type||"radio"==M.options.columns[_].type||"hidden"==M.options.columns[_].type));else if(M.options.columns&&M.options.columns[_]&&"dropdown"==M.options.columns[_].type)L=null===(a=null===(l=e.children[0].dropdown)||void 0===l?void 0:l.close)||void 0===a?void 0:a.call(l,!0);else if(M.options.columns&&M.options.columns[_]&&"calendar"==M.options.columns[_].type)L=null===(c=null===(s=e.children[0].calendar)||void 0===s?void 0:s.close)||void 0===c?void 0:c.call(s,!0);else if(M.options.columns&&M.options.columns[_]&&"color"==M.options.columns[_].type)L=null===(d=null===(u=e.children[0].color)||void 0===u?void 0:u.close)||void 0===d?void 0:d.call(u,!0);else if(M.options.columns&&M.options.columns[_]&&"html"==M.options.columns[_].type)L=null===(p=null===(f=e.children[0].children[0].editor)||void 0===f?void 0:f.getData)||void 0===p?void 0:p.call(f);else if(M.options.columns&&M.options.columns[_]&&"image"==M.options.columns[_].type){var j=e.children[0].children[0].children[0];L=j&&"IMG"==j.tagName?j.src:""}else if(M.options.columns&&M.options.columns[_]&&"numeric"==M.options.columns[_].type)"="!=(""+(L=e.children[0].value)).substr(0,1)&&""==L&&(L=M.options.columns[_].allowEmpty?"":0),e.children[0].onblur=null;else{L=e.children[0].value,e.children[0].onblur=null;var D=M.options.columns&&M.options.columns[_];if(D){var O=(0,r.rS)(D);if(O&&""!==L&&!(0,r.dw)(L)&&"number"!=typeof L){var k=t().mask.extract(L,O,!0);k&&""!==k.value&&(L=k.value)}}}(M.options.data&&Array.isArray(M.options.data)&&Array.isArray(M.options.data[N])&&null!==(h=M.options.data[N][_])&&void 0!==h?h:"")==L?e.innerHTML=(null===(m=M.edition)||void 0===m?void 0:m[1])||"":null===(g=M.setValue)||void 0===g||g.call(M,[{element:e}],L)}else M.options.columns&&M.options.columns[_]&&"object"==typeof M.options.columns[_].type?null===(y=(v=M.options.columns[_].type).closeEditor)||void 0===y||y.call(v,e,n,_,N,M,M.options.columns[_]):M.options.columns&&M.options.columns[_]&&"dropdown"==M.options.columns[_].type?null===(w=null===(b=e.children[0].dropdown)||void 0===b?void 0:b.close)||void 0===w||w.call(b,!0):M.options.columns&&M.options.columns[_]&&"calendar"==M.options.columns[_].type?null===(x=null===(C=e.children[0].calendar)||void 0===C?void 0:C.close)||void 0===x||x.call(C,!0):M.options.columns&&M.options.columns[_]&&"color"==M.options.columns[_].type?null===(A=null===(E=e.children[0].color)||void 0===E?void 0:E.close)||void 0===A||A.call(E,!0):e.children[0].onblur=null,e.innerHTML=M.edition&&M.edition[1]?M.edition[1]:"";o.A.call(M,"oneditionend",M,e,_,N,L,n),e.classList.remove("editor"),M.edition=void 0},c=function(){var e,t=this,n=[];if(t.highlighted)for(var l=0;l<t.highlighted.length;l++){var a=t.highlighted[l].element.getAttribute("data-x"),s=t.highlighted[l].element.getAttribute("data-y");if(null!==a&&null!==s&&t.options.columns&&t.options.columns[parseInt(a||"0")]&&("checkbox"==t.options.columns[parseInt(a||"0")].type||"radio"==t.options.columns[parseInt(a||"0")].type)){var c=t.options.data&&Array.isArray(t.options.data)&&Array.isArray(t.options.data[parseInt(s)])&&null!==(e=t.options.data[parseInt(s)][parseInt(a)])&&void 0!==e?e:"";n.push(r.k9.call(t,parseInt(a),parseInt(s),!c))}}if(n.length){i.Dh.call(t,{action:"setValue",records:n,selection:t.selectedCell});var u=n.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});o.A.call(t,"onafterchanges",t,u)}},u=__webpack_require__(894),d=function(e,t){var n,o,r,i=this;e="string"==typeof e?parseInt(e):e;for(var l=(t="string"==typeof t?parseInt(t):t)-1;l>=0;l--)if(i.records[l]&&i.records[l][e]&&i.records[l][e].element&&"none"!==i.records[l][e].element.style.display&&(null===(n=i.rows[l])||void 0===n?void 0:n.element)&&"none"!==i.rows[l].element.style.display){if(i.records[l][e].element.getAttribute("data-merged")&&i.records[l][e].element===(null===(r=null===(o=i.records[t])||void 0===o?void 0:o[e])||void 0===r?void 0:r.element))continue;t=l;break}return t},f=function(e,t){var n,o,r,i,l=this;if(l.selectedCell){if(0===e?(r=l.selectedCell[0],i=l.selectedCell[1]):(r=l.selectedCell[2],i=l.selectedCell[3]),0===t){for(var a=0;a<i;a++)if((null===(n=l.records[a])||void 0===n?void 0:n[r])&&l.records[a][r].element&&"none"!==l.records[a][r].element.style.display&&(null===(o=l.rows[a])||void 0===o?void 0:o.element)&&"none"!==l.rows[a].element.style.display){i=a;break}}else i=d.call(l,r,i);0===e?(l.selectedCell[0]=r,l.selectedCell[1]=i):(l.selectedCell[2]=r,l.selectedCell[3]=i)}},p=function(e,t){var n,o,i,l,a,s,c=this;if(c.selectedCell){if(e?c.selectedCell[3]>0&&f.call(c,1,t?0:1):(c.selectedCell[1]>0&&f.call(c,0,t?0:1),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),null===(n=c.updateSelectionFromCoords)||void 0===n||n.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),!0===c.options.lazyLoading){if(0===c.selectedCell[1]||0===c.selectedCell[3])u.wu.call(c,0),null===(o=c.updateSelectionFromCoords)||void 0===o||o.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]);else if(u.AG.call(c))null===(i=c.updateSelectionFromCoords)||void 0===i||i.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]);else if(c.tbody.firstChild&&c.tbody.firstChild instanceof HTMLElement&&void 0!==c.tbody.firstChild.nodeType){var d=parseInt(c.tbody.firstChild.getAttribute("data-y")||"0");c.selectedCell[1]-d<30&&(u.G_.call(c),null===(l=c.updateSelectionFromCoords)||void 0===l||l.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]))}}else if(c.options.pagination&&"number"==typeof c.options.pagination&&c.options.pagination>0){var p=null===(a=c.whichPage)||void 0===a?void 0:a.call(c,c.selectedCell[3]);void 0!==p&&p!==c.pageNumber&&(null===(s=c.page)||void 0===s||s.call(c,p))}r.Rs.call(c,1)}},h=function(e,t){var n,o,r,i,l,a=this;e="string"==typeof e?parseInt(e):e,t="string"==typeof t?parseInt(t):t;for(var s=e+1;s<a.headers.length;s++)if("none"!==(null===(r=null===(o=null===(n=a.records[t])||void 0===n?void 0:n[s])||void 0===o?void 0:o.element)||void 0===r?void 0:r.style.display)){if(a.records[t][s].element.getAttribute("data-merged")&&a.records[t][s].element===(null===(l=null===(i=a.records[t])||void 0===i?void 0:i[e])||void 0===l?void 0:l.element))continue;e=s;break}return e},m=function(e,t){var n,o,r,i,l,a=this;if(a.selectedCell){if(0===e?(i=a.selectedCell[0],l=a.selectedCell[1]):(i=a.selectedCell[2],l=a.selectedCell[3]),0===t){for(var s=a.headers.length-1;s>i;s--)if("none"!==(null===(r=null===(o=null===(n=a.records[l])||void 0===n?void 0:n[s])||void 0===o?void 0:o.element)||void 0===r?void 0:r.style.display)){i=s;break}}else i=h.call(a,i,l);0===e?(a.selectedCell[0]=i,a.selectedCell[1]=l):(a.selectedCell[2]=i,a.selectedCell[3]=l)}},g=function(e,t){var n,o=this;o.selectedCell&&(e?o.selectedCell[2]<o.headers.length-1&&m.call(o,1,t?0:1):(o.selectedCell[0]<o.headers.length-1&&m.call(o,0,t?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),null===(n=o.updateSelectionFromCoords)||void 0===n||n.call(o,o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),r.Rs.call(o,1))},v=function(e,t){var n,o,r,i=this;e="string"==typeof e?parseInt(e):e;for(var l=(t="string"==typeof t?parseInt(t):t)+1;l<i.rows.length;l++)if(i.records[l]&&i.records[l][e]&&i.records[l][e].element&&"none"!==i.records[l][e].element.style.display&&(null===(n=i.rows[l])||void 0===n?void 0:n.element)&&"none"!==i.rows[l].element.style.display){if(i.records[l][e].element.getAttribute("data-merged")&&i.records[l][e].element===(null===(r=null===(o=i.records[t])||void 0===o?void 0:o[e])||void 0===r?void 0:r.element))continue;t=l;break}return t},y=function(e,t){var n,o,r,i,l=this;if(l.selectedCell){if(0===e?(r=l.selectedCell[0],i=l.selectedCell[1]):(r=l.selectedCell[2],i=l.selectedCell[3]),0===t){for(var a=l.rows.length-1;a>i;a--)if((null===(n=l.records[a])||void 0===n?void 0:n[r])&&l.records[a][r].element&&"none"!==l.records[a][r].element.style.display&&(null===(o=l.rows[a])||void 0===o?void 0:o.element)&&"none"!==l.rows[a].element.style.display){i=a;break}}else i=v.call(l,r,i);0===e?(l.selectedCell[0]=r,l.selectedCell[1]=i):(l.selectedCell[2]=r,l.selectedCell[3]=i)}},b=function(e,t){var n,o,i,l,a,s,c=this;if(c.selectedCell){if(e?c.selectedCell[3]<c.records.length-1&&y.call(c,1,t?0:1):(c.selectedCell[1]<c.records.length-1&&y.call(c,0,t?0:1),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),null===(n=c.updateSelectionFromCoords)||void 0===n||n.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),!0===c.options.lazyLoading)c.selectedCell[1]===c.records.length-1||c.selectedCell[3]===c.records.length-1?(u.wu.call(c,-1),null===(o=c.updateSelectionFromCoords)||void 0===o||o.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3])):u.AG.call(c)?null===(i=c.updateSelectionFromCoords)||void 0===i||i.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]):c.tbody.lastChild&&c.tbody.lastChild instanceof HTMLElement&&parseInt(c.tbody.lastChild.getAttribute("data-y")||"0")-c.selectedCell[3]<30&&(u.p6.call(c),null===(l=c.updateSelectionFromCoords)||void 0===l||l.call(c,c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]));else if(c.options.pagination&&"number"==typeof c.options.pagination&&c.options.pagination>0){var d=null===(a=c.whichPage)||void 0===a?void 0:a.call(c,c.selectedCell[3]);void 0!==d&&d!==c.pageNumber&&(null===(s=c.page)||void 0===s||s.call(c,d))}r.Rs.call(c,1)}},w=function(e,t){var n,o,r,i,l,a=this;e="string"==typeof e?parseInt(e):e,t="string"==typeof t?parseInt(t):t;for(var s=e-1;s>=0;s--)if("none"!==(null===(r=null===(o=null===(n=a.records[t])||void 0===n?void 0:n[s])||void 0===o?void 0:o.element)||void 0===r?void 0:r.style.display)){if(a.records[t][s].element.getAttribute("data-merged")&&a.records[t][s].element===(null===(l=null===(i=a.records[t])||void 0===i?void 0:i[e])||void 0===l?void 0:l.element))continue;e=s;break}return e},C=function(e,t){var n,o,r,i,l,a=this;if(a.selectedCell){if(0===e?(i=a.selectedCell[0],l=a.selectedCell[1]):(i=a.selectedCell[2],l=a.selectedCell[3]),0===t){for(var s=0;s<i;s++)if("none"!==(null===(r=null===(o=null===(n=a.records[l])||void 0===n?void 0:n[s])||void 0===o?void 0:o.element)||void 0===r?void 0:r.style.display)){i=s;break}}else i=w.call(a,i,l);0===e?(a.selectedCell[0]=i,a.selectedCell[1]=l):(a.selectedCell[2]=i,a.selectedCell[3]=l)}},x=function(e,t){var n,o=this;o.selectedCell&&(e?o.selectedCell[2]>0&&C.call(o,1,t?0:1):(o.selectedCell[0]>0&&C.call(o,0,t?0:1),o.selectedCell[2]=o.selectedCell[0],o.selectedCell[3]=o.selectedCell[1]),null===(n=o.updateSelectionFromCoords)||void 0===n||n.call(o,o.selectedCell[0],o.selectedCell[1],o.selectedCell[2],o.selectedCell[3]),r.Rs.call(o,-1))},E=function(e,t){var n,o,i,l=this;if(l.selectedCell){if(e?t?l.selectedCell[3]=0:C.call(l,1,0):(t?l.selectedCell[1]=0:C.call(l,0,0),l.selectedCell[2]=l.selectedCell[0],l.selectedCell[3]=l.selectedCell[1]),!0!==l.options.lazyLoading||0!==l.selectedCell[1]&&0!==l.selectedCell[3]){if(l.options.pagination&&"number"==typeof l.options.pagination&&l.options.pagination>0){var a=null===(n=l.whichPage)||void 0===n?void 0:n.call(l,l.selectedCell[3]);void 0!==a&&a!==l.pageNumber&&(null===(o=l.page)||void 0===o||o.call(l,a))}}else u.wu.call(l,0);null===(i=l.updateSelectionFromCoords)||void 0===i||i.call(l,l.selectedCell[0],l.selectedCell[1],l.selectedCell[2],l.selectedCell[3]),r.Rs.call(l,1)}},A=function(e,t){var n,o,i,l=this;if(l.selectedCell){if(e?t?l.selectedCell[3]=l.records.length-1:m.call(l,1,0):(t?l.selectedCell[1]=l.records.length-1:m.call(l,0,0),l.selectedCell[2]=l.selectedCell[0],l.selectedCell[3]=l.selectedCell[1]),!0!==l.options.lazyLoading||l.selectedCell[1]!==l.records.length-1&&l.selectedCell[3]!==l.records.length-1){if(l.options.pagination&&"number"==typeof l.options.pagination&&l.options.pagination>0){var a=null===(n=l.whichPage)||void 0===n?void 0:n.call(l,l.selectedCell[3]);void 0!==a&&a!==l.pageNumber&&(null===(o=l.page)||void 0===o||o.call(l,a))}}else u.wu.call(l,-1);null===(i=l.updateSelectionFromCoords)||void 0===i||i.call(l,l.selectedCell[0],l.selectedCell[1],l.selectedCell[2],l.selectedCell[3]),r.Rs.call(l,1)}},L=__webpack_require__(195),M=__webpack_require__(106),I=__webpack_require__(9),T=__webpack_require__(898),_=function(e,t,n,r,i,l,a){var s=this;t||(t="\t");var c=new RegExp(t,"ig"),u=[],d=[],f=[],p=[],h=[],m=s.options.data;if(!m||0===m.length)return"";for(var g=(Array.isArray(m[0])?m[0]:Object.values(m[0]||{})).length,v=m.length,y=!1,b="",w="",C=0,x=0,E=0,A=0,L=0;L<v;L++)for(var I=Array.isArray(m[L])?m[L]:Object.values(m[L]||{}),T=Array.isArray(I)?I.length:0,_=0;_<g&&_<T;_++)e&&!s.records[L][_].element.classList.contains("highlight")||(E<=_&&(E=_),A<=L&&(A=L));if(i&&(1==s.parent.config.includeHeadersOnDownload||r)){if(s.options.nestedHeaders&&s.options.nestedHeaders.length>0){var N=s.options.nestedHeaders;for(L=0;L<N.length;L++){var S=[];for(_=0;_<N[L].length;_++){var j=N[L][_],D=j&&j.colspan?Number(j.colspan):1;S.push(j&&j.title?String(j.title):"");for(var O=0;O<D-1;O++)S.push("")}w+=S.join(t)+"\r\n"}}y=!0}for(s.style=[],L=0;L<v;L++){for(d=[],f=[],I=Array.isArray(m[L])?m[L]:Object.values(m[L]||{}),T=Array.isArray(I)?I.length:0,_=0;_<g&&_<T;_++)if(!e||s.records[L][_].element.classList.contains("highlight")){1==y&&u.push(s.headers[_].textContent);var k=Array.isArray(I)?I[_]:String(I[_]||"");"string"==typeof k&&(k.match(c)||k.match(/,/g)||k.match(/\n/)||k.match(/\"/))&&(k='"'+(k=k.replace(new RegExp('"',"g"),'""'))+'"'),d.push(k);var R=void 0;s.options.columns&&s.options.columns[_]&&("checkbox"==s.options.columns[_].type||"radio"==s.options.columns[_].type)?R=k:(R=s.records[L][_].element.innerHTML).match&&(R.match(c)||R.match(/,/g)||R.match(/\n/)||R.match(/\"/))&&(R='"'+(R=R.replace(new RegExp('"',"g"),'""'))+'"'),f.push(R);var H=s.records[L][_].element.getAttribute("style")||"";s.style.push(H.replace("display: none;",""))}d.length&&(y&&(C=d.length,p.push(u.join(t))),p.push(d.join(t))),f.length&&(x++,y&&(h.push(u.join(t)),y=!1),h.push(f.join(t)))}g==C&&v==x&&(b=w);var P=b+p.join("\r\n"),F=b+h.join("\r\n");if(!n){if(!s.selectedCell||s.selectedCell.length<4)return"";var V=[Math.min(s.selectedCell[0],s.selectedCell[2]),Math.min(s.selectedCell[1],s.selectedCell[3]),Math.max(s.selectedCell[0],s.selectedCell[2]),Math.max(s.selectedCell[1],s.selectedCell[3])],B=o.A.call(s,"oncopy",s,V,F,Boolean(l));if("string"==typeof B)F=B;else if(!1===B)return!1;s.textarea&&(s.textarea.value=F,s.textarea.select(),document.execCommand("copy"))}if(s.data=1==a?F:P,s.hashString=String(M.tW.call(s,s.data)),!n&&(M.kA.call(s),s.highlighted))for(_=0;_<s.highlighted.length;_++)s.highlighted[_].element.classList.add("copying"),s.highlighted[_].element.classList.contains("highlight-left")&&s.highlighted[_].element.classList.add("copying-left"),s.highlighted[_].element.classList.contains("highlight-right")&&s.highlighted[_].element.classList.add("copying-right"),s.highlighted[_].element.classList.contains("highlight-top")&&s.highlighted[_].element.classList.add("copying-top"),s.highlighted[_].element.classList.contains("highlight-bottom")&&s.highlighted[_].element.classList.add("copying-bottom");return s.data},N=function(e,n,l){var a,s,c,u,d,f,p=this,m="string"==typeof l?l:String(l),g=String((0,M.tW)(m)),y=g===(p.hashString||"")&&p.hashString&&p.style?p.style:null;g===(p.hashString||"")&&p.data&&(m=p.data);var b=(0,I.parseCSV)(m,"\t");if(!p.selectedCell||p.selectedCell.length<4)return!1;var w=p.selectedCell[2]-e+1,C=p.selectedCell[3]-n+1;if(!Array.isArray(b)||0===b.length||!Array.isArray(b[0]))return!1;var x=b[0].length;if(w>1&&Number.isInteger(w/x)){var E=w/x;if(y){for(var A=[],L=0;L<y.length;L+=x)for(var _=y.slice(L,L+x),N=0;N<E;N++)A.push.apply(A,_);y=A}var S=b.map(function(e,t){var n=Array.from({length:E*e.length},function(t,n){return e[n%e.length]});return n});b=S}var j=b.length;if(C>1&&Number.isInteger(C/j)){var D=C/j;if(y){for(A=[],N=0;N<D;N++)A.push.apply(A,y);y=A}S=Array.from({length:D*j},function(e,t){return b[t%j]}),b=S}var O=o.A.call(p,"onbeforepaste",p,b.map(function(e){return e.map(function(e){return{value:e}})}),e,n);if(!1===O)return!1;if(O&&Array.isArray(O)&&(b=O),null!=e&&null!=n&&b){L=0,N=0;var k=[],R=(A={},{}),H=0,P=e,F=n,V=null,B=Array.isArray(b[0])?b[0]:[],q=p.headers.slice(P).filter(function(e){return"none"===e.style.display}).length,U=P+q+B.length,Y=p.headers.length;U>Y&&(p.skipUpdateTableReferences=!0,null===(a=p.insertColumn)||void 0===a||a.call(p,U-Y));var W=p.rows.slice(F).filter(function(e){return"none"===e.element.style.display}).length,z=F+W+b.length,X=p.rows.length;for(z>X&&(p.skipUpdateTableReferences=!0,null===(s=p.insertRow)||void 0===s||s.call(p,z-X)),p.skipUpdateTableReferences&&(p.skipUpdateTableReferences=!1,r.o8.call(p));N<b.length&&(V=b[N]);){for(L=0,P=e;L<V.length&&null!=V[L];){var G=V[L];if(p.options.columns&&p.options.columns[L]&&"calendar"==p.options.columns[L].type){var K=(null===(c=p.options.columns[L].options)||void 0===c?void 0:c.format)||"YYYY-MM-DD",$=t().calendar.extractDateFromString(G,K);G=$?String($):G}var Z=r.k9.call(p,P,F,G);if(k.push(Z),r.xF.call(p,P,F,k),y&&y[H]){var J=(0,T.t3)([P,F]);A[J]=y[H],R[J]=(null===(u=p.getStyle)||void 0===u?void 0:u.call(p,J))||"",p.records[F][P].element.setAttribute("style",String(y[H])),H++}if(++L<V.length&&null!=V[L]){if(P>=p.headers.length-1){if(0==p.options.allowInsertColumn)break;null===(d=p.insertColumn)||void 0===d||d.call(p)}P=h.call(p,P,F)}}if(++N<b.length&&b[N]){if(F>=p.rows.length-1){if(0==p.options.allowInsertRow)break;null===(f=p.insertRow)||void 0===f||f.call(p,1)}F=v.call(p,e,F)}}M.AH.call(p,e,n,P,F),i.Dh.call(p,{action:"setValue",records:k,selection:p.selectedCell||[],newStyle:A,oldStyle:R}),r.am.call(p);for(var Q=[],ee=0;ee<b.length;ee++){var te=b[ee];if(Array.isArray(te))for(var ne=0;ne<te.length;ne++)Q.push({x:ne+e,y:ee+n,value:te[ne]})}o.A.call(p,"onpaste",p,Q);var oe=k.map(function(e){return{x:e.x,y:e.y,value:e.value,oldValue:e.oldValue}});o.A.call(p,"onafterchanges",p,oe)}return(0,M.kA)(),!0},S=__webpack_require__(752),j=__webpack_require__(685),D=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},O=function(){var e=this,t=e.options.columns&&e.options.columns.length||0;if(e.options.data&&e.options.data.length>0&&void 0!==e.options.data[0]){var n=e.options.data[0],o=Array.isArray(n)?[]:Object.keys(n);o.length>t&&(t=o.length)}return e.options.minDimensions&&e.options.minDimensions[0]>t&&(t=e.options.minDimensions[0]),t},k=function(e){var t=this,n=t.options.columns&&t.options.columns[e]&&t.options.columns[e].width||t.options.defaultColWidth||100,o=t.options.columns&&t.options.columns[e]&&t.options.columns[e].align||t.options.defaultColAlign||"center";t.headers||(t.headers=[]),t.headers[e]=document.createElement("td"),t.headers[e].textContent=t.options.columns&&t.options.columns[e]&&t.options.columns[e].title||(0,I.getColumnName)(e),t.headers[e].setAttribute("data-x",e.toString()),t.headers[e].style.textAlign=o,t.options.columns&&t.options.columns[e]&&t.options.columns[e].title&&t.headers[e].setAttribute("title",t.headers[e].innerText),t.options.columns&&t.options.columns[e]&&"string"==typeof t.options.columns[e].id&&t.headers[e].setAttribute("id",t.options.columns[e].id||"");var r=document.createElement("col");r.setAttribute("width",n.toString()),t.cols||(t.cols=[]),t.cols[e]={colElement:r,x:e},t.options.columns&&t.options.columns[e]&&"hidden"==t.options.columns[e].type&&(t.headers[e].style.display="none",r.style.display="none")},R=function(e,t,n){var r=this;if(t){var l=n||0;if(Array.isArray(e)){for(var a=[],s=0;s<e.length;s++){var c=void 0,u=e[s];c="number"==typeof u?u:parseInt(u.getAttribute("data-x")||"0")||0,a[s]||(a[s]=parseInt(r.cols[c].colElement.getAttribute("width")||"0"));var d=Array.isArray(t)&&t[s]?t[s]:t;r.cols[c].colElement.setAttribute("width",d),r.options.columns||(r.options.columns=[]),r.options.columns[c]||(r.options.columns[c]={}),r.options.columns[c].width=d}l=a}else c="number"==typeof e?e:parseInt(e.getAttribute("data-x")||"0"),n||(n=parseInt(r.cols[c].colElement.getAttribute("width")||"0")),r.cols[c].colElement.setAttribute("width",String(t)),r.options.columns||(r.options.columns=[]),r.options.columns[c]||(r.options.columns[c]={}),r.options.columns[c].width=t;var f=Array.isArray(e)?"number"==typeof e[0]?e[0]:0:"number"==typeof e?e:0,p=Array.isArray(l)?l[0]:l;if(i.Dh.call(r,{action:"setWidth",column:f,oldValue:p,newValue:t}),o.A.call(r,"onresizecolumn",r,e,t,l),"worksheets"in r&&r.worksheets&&r.worksheets[0])M.Aq.call(r.worksheets[0]);else{var h=r.parent;h&&h.worksheets&&h.worksheets[0]&&M.Aq.call(h.worksheets[0])}}},H=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},P=function(e,t){var n,o,i=this;if(i.records[e]||(i.records[e]=[]),!t)if(Array.isArray(null===(n=i.options.data)||void 0===n?void 0:n[e]))t=i.options.data[e];else if(null===(o=i.options.data)||void 0===o?void 0:o[e]){var l=i.options.data[e];t=[];for(var a=0;a<i.headers.length;a++)t[a]=l[a]||""}else t=[];var s={element:document.createElement("tr"),y:e,cells:[],index:e,height:parseInt(String(i.options.defaultRowHeight||"20"),10)||20};i.rows[e]=s,s.element.setAttribute("data-y",e.toString());var c=null;if(i.options.defaultRowHeight&&(s.element.style.height=i.options.defaultRowHeight+"px"),i.options.rows&&i.options.rows[e]){var u=i.options.rows[e];u.height&&(s.element.style.height=String(u.height)),u.title&&(c=u.title)}c||(c=e+1);var d=document.createElement("td");d.innerHTML=c.toString(),d.setAttribute("data-y",e.toString()),d.className="jss_row",s.element.appendChild(d);var f=O.call(i);for(a=0;a<f;a++)i.records[e][a]={element:r.P9.call(this,a,e,t&&void 0!==t[a]?t[a]:""),x:a,y:e},s.element.appendChild(i.records[e][a].element),i.options.columns&&i.options.columns[a]&&"function"==typeof i.options.columns[a].render&&i.options.columns[a].render(i.records[e][a].element,t&&void 0!==t[a]?t[a]:"",""+a,""+e,i,i.options.columns[a]);return s},F=function(e,n,l){var a,s=this;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0){var c;if(c=e>n,L.D0.call(s,e,void 0).length||L.D0.call(s,n,c).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;null===(a=s.destroyMerge)||void 0===a||a.call(s)}}if(1==s.options.search){if(s.results&&s.results.length!=s.rows.length){if(!confirm(t().translate("This action will clear your search results. Are you sure?")))return!1;s.parent&&"function"==typeof s.parent.resetSearch&&s.parent.resetSearch()}s.results=null}l||(Array.prototype.indexOf.call(s.tbody.children,s.rows[n].element)>=0?e>n?s.tbody.insertBefore(s.rows[e].element,s.rows[n].element):s.tbody.insertBefore(s.rows[e].element,s.rows[n].element.nextSibling):s.tbody.removeChild(s.rows[e].element)),s.rows.splice(n,0,s.rows.splice(e,1)[0]),s.records.splice(n,0,s.records.splice(e,1)[0]),s.options.data&&Array.isArray(s.options.data)&&s.options.data.splice(n,0,s.options.data.splice(e,1)[0]);for(var u=Math.min(e,n),d=Math.max(e,n),f=u;f<=d;f++)s.rows[f].y=f;for(f=u;f<=d;f++)for(var p=0;p<s.records[f].length;p++)s.records[f][p].y=f;"number"==typeof s.options.pagination&&s.options.pagination>0&&s.tbody.children.length!=s.options.pagination&&s.page&&void 0!==s.pageNumber&&s.page(s.pageNumber),i.Dh.call(s,{action:"moveRow",oldValue:e,newValue:n}),r.o8.call(s),o.A.call(s,"onmoverow",s,e,n,1)},V=function(e,t,n){var r=this;if(t>0){if(!n){var l=r.rows[e].element.getAttribute("height");l&&(n=parseInt(l)||void 0),n||(n=r.rows[e].element.getBoundingClientRect().height)}t=Math.round(t),r.rows[e].element.style.height=t+"px",r.options.rows||(r.options.rows=[]),r.options.rows[e]||(r.options.rows[e]={}),r.options.rows[e].height=t,i.Dh.call(r,{action:"setHeight",row:e,oldValue:n,newValue:t}),o.A.call(r,"onresizerow",r,e,t,n),M.Aq.call(r)}},B={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license]]}},q=function(e,t){var n,o=Y(e);return null!==(n=null==o?void 0:o.getAttribute(t))&&void 0!==n?n:""},U=function(e,t){return parseInt(q(e,t),10)},Y=function(e){return e instanceof HTMLElement?e:null},W=function(e){var t=0,n=null;return function e(o){if(o){if(o.classList){var r=o.classList;if(r.contains("jss_container")&&(n=o),r.contains("jss_spreadsheet")){var i=o.querySelector(":scope > .jtabs-content > .jtabs-selected");i instanceof HTMLElement&&(n=i)}}var l=o.tagName;"THEAD"==l?t=1:"TBODY"==l&&(t=2);var a=o.parentElement;a&&!n&&e(a)}}(e),[n,t]},z=function(e){var t,o,r,i,l,a,s,c=n.jspreadsheet.current;if(c)if(c.resizing){var u=c.resizing;if("number"==typeof u.column){var d=u.column,f=U(c.cols[d].colElement,"width"),p=null!==(o=null===(t=c.getSelectedColumns)||void 0===t?void 0:t.call(c))&&void 0!==o?o:[];if(p.length>1){for(var h=[],m=0;m<p.length;m++)h.push(U(c.cols[p[m]].colElement,"width"));var g=p.indexOf(d);h[g]=null!==(i=null!==(r=u.width)&&void 0!==r?r:h[g])&&void 0!==i?i:0,R.call(c,p,f,h)}else R.call(c,d,f,u.width);c.headers[d].classList.remove("resizing");for(var v=0;v<c.records.length;v++)c.records[v][d]&&c.records[v][d].element.classList.remove("resizing")}else{var y=u.row;c.rows[y].element.children[0].classList.remove("resizing");var b=U(c.rows[y].element,"height");V.call(c,y,b,u.height),null===(l=u.element)||void 0===l||l.classList.remove("resizing")}c.resizing=null}else if(c.dragging){var w=c.dragging;if(w){if("number"==typeof w.column){var C=q(e.target,"data-x"),x=C?parseInt(C,10):void 0,E=w.column;for(c.headers[E].classList.remove("dragging"),v=0;v<c.rows.length;v++)c.records[v][E]&&c.records[v][E].element.classList.remove("dragging");for(m=0;m<c.headers.length;m++)c.headers[m].classList.remove("dragging-left"),c.headers[m].classList.remove("dragging-right");void 0!==x&&"number"==typeof w.destination&&E!=w.destination&&(null===(a=c.moveColumn)||void 0===a||a.call(c,E,w.destination))}else{var A=void 0,L=w.element;L&&L.nextSibling?(A=parseInt(L.nextSibling.getAttribute("data-y"),10),w.row<A&&(A-=1)):A=L&&L.previousSibling?parseInt(L.previousSibling.getAttribute("data-y"),10):w.destination,w.row!=w.destination&&F.call(c,w.row,A,!0),null==L||L.classList.remove("dragging")}c.dragging=null}}else if(c.selectedCorner){c.selectedCorner=!1;var I=null!==(s=c.selection)&&void 0!==s?s:[];I.length>0&&(M.kF.call(c,I[0],I[I.length-1]),M.gG.call(c))}n.jspreadsheet.timeControl&&(clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=null),n.jspreadsheet.isMouseAction=!1},X=function(e){var t,o,r,i,l,a,c,u,d,f,p,h;h=(e=e||window.event).buttons?e.buttons:e.button?e.button:e.which;var m=Y(e.target),g=W(m);if(m){var v=n.jspreadsheet.current;if(g[0]?v!=g[0].jssWorksheet&&(v&&(v.edition&&s.call(v,v.edition[0],!0),null===(t=v.resetSelection)||void 0===t||t.call(v)),n.jspreadsheet.current=g[0].jssWorksheet,v=n.jspreadsheet.current):v&&(v.edition&&s.call(v,v.edition[0],!0),m.classList.contains("jss_object")||(M.gE.call(v,!0),n.jspreadsheet.current=null,v=null)),v&&1==h){var y=null!==(o=v.options.data)&&void 0!==o?o:[],b=y.length,w=y[0]?y[0].length:0,C=null!==(r=v.options.columns)&&void 0!==r?r:[],x=0!=v.options.columnResize,E=0!=v.options.columnDrag,A=0!=v.options.rowResize,I=0!=v.options.rowDrag,T=1==v.options.search,_=0!=v.options.allowRenameColumn;if(m.classList.contains("jss_selectall"))v&&M.Ub.call(v);else if(m.classList.contains("jss_corner"))0!=v.options.editable&&(v.selectedCorner=!0);else{if(1==g[1]){var N=m.getAttribute("data-x"),S=null!==N?parseInt(N,10):void 0;if(void 0!==S){var j=m.getBoundingClientRect();if(x&&j.width-e.offsetX<6){v.resizing={mousePosition:e.pageX,column:S,width:j.width},v.headers[S].classList.add("resizing");for(var D=0;D<v.records.length;D++)v.records[D][S]&&v.records[D][S].element.classList.add("resizing")}else if(E&&j.height-e.offsetY<6)if(L.Lt.call(v,S).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(null===(i=v.resetSelection)||void 0===i||i.call(v),v.dragging={element:m,column:S,destination:S},v.headers[S].classList.add("dragging"),D=0;D<v.records.length;D++)v.records[D][S]&&v.records[D][S].element.classList.add("dragging");else{var O=void 0,k=void 0;v.selectedHeader&&(e.shiftKey||e.ctrlKey)?(O=v.selectedHeader,k=S):(v.selectedHeader==S&&_&&(n.jspreadsheet.timeControl=setTimeout(function(){var e;null===(e=v.setHeader)||void 0===e||e.call(v,S)},800)),v.selectedHeader=S,O=S,k=S);var R="number"==typeof O?O:0,H="number"==typeof k?k:0;M.AH.call(v,R,0,H,b-1,e)}}else if(null===(l=m.parentElement)||void 0===l?void 0:l.classList.contains("jss_nested")){var P=void 0,F=void 0;if(m.getAttribute("data-column")){var V=(m.getAttribute("data-column")||"").split(",");P=parseInt(V[0]),F=parseInt(V[V.length-1])}else P=0,F=C.length-1;M.AH.call(v,P,0,F,b-1,e)}}else v.selectedHeader=!1;if(2==g[1]){var B=m.getAttribute("data-y"),q=null!==B?parseInt(B,10):void 0;if(m.classList.contains("jss_row"))j=m.getBoundingClientRect(),A&&j.height-e.offsetY<6?(v.resizing={element:m.parentElement,mousePosition:e.pageY,row:q,height:j.height},null===(a=m.parentElement)||void 0===a||a.classList.add("resizing")):I&&j.width-e.offsetX<6?"number"==typeof q&&L.D0.call(v,q,!1).length?console.error("Jspreadsheet: This row is part of a merged cell"):T&&v.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(null===(c=v.resetSelection)||void 0===c||c.call(v),v.dragging={element:m.parentElement,row:q,destination:q},null===(u=m.parentElement)||void 0===u||u.classList.add("dragging")):(O=void 0,k=void 0,null!=v.selectedRow&&(e.shiftKey||e.ctrlKey)?(O=v.selectedRow,k=q):(v.selectedRow=q,O=q,k=q),"number"==typeof O&&"number"==typeof k&&M.AH.call(v,0,O,w-1,k,e));else if(m.classList.contains("jclose")&&m.clientWidth-e.offsetX<50&&e.offsetY<50)s.call(v,v.edition[0],!0);else{var U=function(e){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?[t,n]:e.parentNode?U(e.parentNode):void 0},z=U(m);if(z){var X=parseInt(z[0]),G=parseInt(z[1]);v.edition&&(v.edition[2]==X&&v.edition[3]==G||s.call(v,v.edition[0],!0)),v.edition||(e.shiftKey&&v.selectedCell?M.AH.call(v,v.selectedCell[0],v.selectedCell[1],X,G,e):M.AH.call(v,X,G,X,G,e)),v.selectedHeader=null,v.selectedRow=null}}}else v.selectedRow=!1;if(m.classList.contains("jss_page"))if("<"==m.textContent)null===(d=v.page)||void 0===d||d.call(v,0);else if(">"==m.textContent){var K=m.getAttribute("title");null===(f=v.page)||void 0===f||f.call(v,null!==K?parseInt(K,10)-1:0)}else null===(p=v.page)||void 0===p||p.call(v,m.textContent?parseInt(m.textContent,10)-1:0)}v.edition?n.jspreadsheet.isMouseAction=!1:n.jspreadsheet.isMouseAction=!0}else n.jspreadsheet.isMouseAction=!1}else n.jspreadsheet.isMouseAction=!1},G=function(e){var t,o,r,i,l,a,s,c,u;((e=e||window.event).buttons?e.buttons:e.button?e.button:e.which)||(n.jspreadsheet.isMouseAction=!1);var d=Y(e.target);if(d){var f=n.jspreadsheet.current;if(f)if(1==n.jspreadsheet.isMouseAction){if(f.resizing)if(f.resizing.column){var p=e.pageX-(null!==(t=f.resizing.mousePosition)&&void 0!==t?t:0);if((null!==(o=f.resizing.width)&&void 0!==o?o:0)+p>0){var h=(null!==(r=f.resizing.width)&&void 0!==r?r:0)+p,m=f.resizing.column;"number"==typeof m&&f.cols[m]&&f.cols[m].colElement.setAttribute("width",h.toString()),M.Aq.call(f)}}else{var g=e.pageY-(null!==(i=f.resizing.mousePosition)&&void 0!==i?i:0);if((null!==(l=f.resizing.height)&&void 0!==l?l:0)+g>0){var v=(null!==(a=f.resizing.height)&&void 0!==a?a:0)+g,y=f.resizing.row;"number"==typeof y&&f.rows[y]&&f.rows[y].element.setAttribute("height",v.toString()),M.Aq.call(f)}}else if(f.dragging)if(f.dragging.column){var b=d.getAttribute("data-x"),w=null!==b?parseInt(b,10):void 0;if(void 0!==w)if(L.Lt.call(f,w).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var C=0;C<f.headers.length;C++)f.headers[C].classList.remove("dragging-left"),f.headers[C].classList.remove("dragging-right");f.dragging.column==w?f.dragging.destination=w:d.clientWidth/2>e.offsetX?(f.dragging.column<w?f.dragging.destination=w-1:f.dragging.destination=w,f.headers[w].classList.add("dragging-left")):(f.dragging.column<w?f.dragging.destination=w:f.dragging.destination=w+1,f.headers[w].classList.add("dragging-right"))}}else{var x=d.getAttribute("data-y"),E=null!==x?parseInt(x,10):void 0;if(void 0!==E)if(L.D0.call(f,E,!1).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var A=d.clientHeight/2>e.offsetY?null===(s=d.parentElement)||void 0===s?void 0:s.nextSibling:d.parentElement,I=null===(c=d.parentElement)||void 0===c?void 0:c.parentElement,T=f.dragging.element;T&&T!=A&&I&&(I.insertBefore(T,A),T.parentNode&&(f.dragging.destination=Array.prototype.indexOf.call(T.parentNode.children,T)))}}}else{var _=d.getAttribute("data-x"),N=d.getAttribute("data-y"),S=d.getBoundingClientRect();f.cursor&&(f.cursor.style.cursor="",f.cursor=null);var j=null===(u=d.parentElement)||void 0===u?void 0:u.parentElement;j&&"string"==typeof j.className&&(j.classList.contains("resizable")&&(d&&_&&!N&&S.width-(e.clientX-S.left)<6?(f.cursor=d,f.cursor.style.cursor="col-resize"):!_&&N&&S.height-(e.clientY-S.top)<6&&(f.cursor=d,f.cursor.style.cursor="row-resize")),j.classList.contains("draggable")&&(!_&&N&&S.width-(e.clientX-S.left)<6||_&&!N&&S.height-(e.clientY-S.top)<6)&&(f.cursor=d,f.cursor.style.cursor="move"))}}else n.jspreadsheet.isMouseAction=!1},K=function(e,t){var n=this;M.gG.call(n);var o=n.selectedContainer;if(o&&!(o.length<4)){var r=o[0],i=o[1],l=o[2],a=o[3];if(null!=e&&null!=t){var s=void 0,c=void 0;e-l>0?(s=l+1,c=e):(s=e,c=r-1);var u=void 0,d=void 0;t-a>0?(u=a+1,d=t):(u=t,d=i-1),c-s<=d-u?(s=parseInt(r.toString()),c=parseInt(l.toString())):(u=parseInt(i.toString()),d=parseInt(a.toString()));for(var f=u;f<=d;f++)for(var p=s;p<=c;p++)n.records[f][p]&&"none"!=n.rows[f].element.style.display&&"none"!=n.records[f][p].element.style.display&&(n.records[f][p].element.classList.add("selection"),n.records[u][p].element.classList.add("selection-top"),n.records[d][p].element.classList.add("selection-bottom"),n.records[f][s].element.classList.add("selection-left"),n.records[f][c].element.classList.add("selection-right"),n.selection&&n.selection.push(n.records[f][p].element))}}},Z=function(e){var t;((e=e||window.event).buttons?e.buttons:e.button?e.button:e.which)||(n.jspreadsheet.isMouseAction=!1);var o=n.jspreadsheet.current;if(o&&1==n.jspreadsheet.isMouseAction){var r=null!==(t=o.options.data)&&void 0!==t?t:[],i=r.length,l=r[0]?r[0].length:0,a=(o.options.columns,Y(e.target));if(!a)return!1;var s=W(a);if(s[0]){if(o!=s[0].jssWorksheet&&o)return!1;var c=a.getAttribute("data-x"),u=null!==c?parseInt(c,10):void 0,d=a.getAttribute("data-y"),f=null!==d?parseInt(d,10):void 0;if(o.resizing||o.dragging);else{if(1==s[1]&&o.selectedHeader){var p=a.getAttribute("data-x");u=null!==p?parseInt(p,10):void 0;var h=o.selectedHeader;"number"==typeof(m=u)&&M.AH.call(o,h,0,m,i-1,e)}if(2==s[1])if(a.classList.contains("jss_row")){if(null!=o.selectedRow){var m=f;"number"==typeof(h=o.selectedRow)&&"number"==typeof m&&M.AH.call(o,0,h,l-1,m,e)}}else o.edition||void 0!==u&&void 0!==f&&(o.selectedCorner?K.call(o,u,f):o.selectedCell&&M.AH.call(o,o.selectedCell[0],o.selectedCell[1],u,f,e))}}}n.jspreadsheet.timeControl&&(clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=null)},J=function(e){var t,o,r=Y(e.target);if(r){var i=n.jspreadsheet.current;if(i){var l=null!==(t=i.options.data)&&void 0!==t?t:[],s=(l.length,l[0]&&l[0].length,i.options.columns,0!=i.options.editable),c=0!=i.options.columnSorting;if(r.classList.contains("jss_corner")){if(i.highlighted&&i.highlighted.length>0){var u=i.highlighted[0].element.getAttribute("data-x"),d=u?parseInt(u,10):0,f=parseInt(i.highlighted[i.highlighted.length-1].element.getAttribute("data-y")||"0")+1,p=i.highlighted[i.highlighted.length-1].element.getAttribute("data-x"),h=p?parseInt(p,10):0,m=i.records.length-1;i.records[f]&&i.records[f][d]&&i.records[m]&&i.records[m][h]&&M.kF.call(i,i.records[f][d].element,i.records[m][h].element)}}else if(r.classList.contains("jss_column_filter"))null!==(g=r.getAttribute("data-x"))&&S.N$.call(i,g);else{var g,v=W(r);if(1==v[1]&&c&&(g=r.getAttribute("data-x"))&&(null===(o=i.orderBy)||void 0===o||o.call(i,parseInt(g))),2==v[1]&&s&&!i.edition){var y=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?e:y(e.parentNode)}},b=y(r);b&&b.classList.contains("highlight")&&a.call(i,b,!1,e)}}}}},Q=function(e){var t=n.jspreadsheet.current;t&&t.selectedCell&&(t.edition||0!=t.options.editable&&(e&&"clipboardData"in e&&e.clipboardData?(N.call(t,t.selectedCell[0],t.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):"clipboardData"in window&&window.clipboardData&&N.call(t,t.selectedCell[0],t.selectedCell[1],window.clipboardData.getData("text"))))},ee=function(e){var t,n=null===(t=e.parentElement)||void 0===t?void 0:t.children;if(!n)return-1;for(var o=0;o<n.length;o++)if(e===n[o])return o;return-1},te=function(e){(function(e){if(e&&"object"==typeof e){var t=e;"number"==typeof t.buttons?t.buttons:"number"==typeof t.button?t.button:"number"==typeof t.which&&t.which}})(e=e||window.event);var o,r=n.jspreadsheet.current;if(r){var i=r.parent;if(r.edition)e.preventDefault();else{i.contextMenu.contextmenu.close();var l=Y(e.target);if(!l)return;var a=null!==(o=r.options.data)&&void 0!==o?o:[],s=a.length,c=a[0]?a[0].length:0,u=function(e){if(e.classList.contains("jss_selectall"))return"select-all";if(e.classList.contains("jss_corner"))return"fill-handle";for(var t=e;t&&!t.classList.contains("jss_spreadsheet");){if(t.classList.contains("jss_row"))return"row";if(t.classList.contains("jss_nested"))return"nested";if(t.classList.contains("jtabs-headers"))return"tabs";if(t.classList.contains("jtoolbar"))return"toolbar";if(t.classList.contains("jss_pagination"))return"pagination";if("TBODY"===t.tagName)return"cell";if("TFOOT"===t.tagName)return 0===ee(e)?"grid":"footer";if("THEAD"===t.tagName)return"header";t=t.parentElement}return"applications"}(l),d=null,f=null,p=null,h=null;if("cell"===u){for(var m=l;m&&"TD"!==m.tagName;)m=m.parentElement;if(!m)return;f=m.getAttribute("data-y"),p=null!==(d=m.getAttribute("data-x"))?parseInt(d,10):null,h=null!==f?parseInt(f,10):null,(null===p||null===h||!r.selectedCell||!r.selectedCell[0]||!r.selectedCell[1]||!r.selectedCell[2]||!r.selectedCell[3]||p<r.selectedCell[0]||p>r.selectedCell[2]||h<r.selectedCell[1]||h>r.selectedCell[3])&&null!==p&&null!==h&&M.AH.call(r,p,h,p,h,e)}else if("row"===u)null!==(h=null!==(f=l.getAttribute("data-y"))?parseInt(f,10):null)&&M.AH.call(r,0,h,c-1,h,e);else if("header"===u)null!==(p=null!==(d=l.getAttribute("data-x"))?parseInt(d,10):null)&&M.AH.call(r,p,0,p,s-1,e);else if("nested"===u){var g=l.getAttribute("data-column"),v=g?g.split(",").map(function(e){return parseInt(e,10)}):[];p=ee(l)-1,h=ee(l.parentElement);var y=r.selectedCell;y&&v[0]==y[0]&&v[v.length-1]==y[2]&&null==y[1]&&null==y[3]||M.AH.call(r,v[0],0,v[v.length-1],s-1,e)}else"select-all"===u?M.Ub.call(r):"tabs"===u?p=ee(l):"footer"===u&&(p=ee(l)-1,h=ee(l.parentElement));var b=null!=p?p:0,w=null!=h?h:0,C=function(e,n,o,r){var i=[];if("header"===r&&(0!=e.options.allowInsertColumn&&i.push({title:t().translate("Insert a new column before"),onclick:function(){var t;null===(t=e.insertColumn)||void 0===t||t.call(e,1,n,!0)}}),0!=e.options.allowInsertColumn&&i.push({title:t().translate("Insert a new column after"),onclick:function(){var t;null===(t=e.insertColumn)||void 0===t||t.call(e,1,n,!1)}}),0!=e.options.allowDeleteColumn&&i.push({title:t().translate("Delete selected columns"),onclick:function(){var t,o,r,i=null!==(o=null===(t=e.getSelectedColumns)||void 0===t?void 0:t.call(e))&&void 0!==o?o:[],l=i.length>0?i[0]:n;"number"==typeof l&&(null===(r=e.deleteColumn)||void 0===r||r.call(e,l))}}),0!=e.options.allowRenameColumn&&i.push({title:t().translate("Rename this column"),onclick:function(){var o,r,i=null===(o=e.getHeader)||void 0===o?void 0:o.call(e,n),l=prompt(t().translate("Column name"),i);null!==l&&(null===(r=e.setHeader)||void 0===r||r.call(e,n,l))}}),0!=e.options.columnSorting&&(i.push({type:"line"}),i.push({title:t().translate("Order ascending"),onclick:function(){var t;null===(t=e.orderBy)||void 0===t||t.call(e,n,"asc")}}),i.push({title:t().translate("Order descending"),onclick:function(){var t;null===(t=e.orderBy)||void 0===t||t.call(e,n,"desc")}}))),"row"!==r&&"cell"!==r||(0!=e.options.allowInsertRow&&(i.push({title:t().translate("Insert a new row before"),onclick:function(){var t;null===(t=e.insertRow)||void 0===t||t.call(e,1,o,!0)}}),i.push({title:t().translate("Insert a new row after"),onclick:function(){var t;null===(t=e.insertRow)||void 0===t||t.call(e,1,o,!1)}})),0!=e.options.allowDeleteRow&&i.push({title:t().translate("Delete selected rows"),onclick:function(){var t,n,r,i=null!==(n=null===(t=e.getSelectedRows)||void 0===t?void 0:t.call(e))&&void 0!==n?n:[],l=i.length>0?i[0]:o;"number"==typeof l&&(null===(r=e.deleteRow)||void 0===r||r.call(e,l))}})),"cell"===r&&0!=e.options.allowComments){i.push({type:"line"});var l=e.records[o][n].element.getAttribute("title")||"";i.push({title:t().translate(l?"Edit comments":"Add comments"),onclick:function(){var r,i=prompt(t().translate("Comments"),l);i&&(null===(r=e.setComments)||void 0===r||r.call(e,(0,I.getCellNameFromCoords)(n,o),i))}}),l&&i.push({title:t().translate("Clear comments"),onclick:function(){var t;null===(t=e.setComments)||void 0===t||t.call(e,(0,I.getCellNameFromCoords)(n,o),"")}})}return 0!==i.length&&i.push({type:"line"}),"header"!==r&&"row"!==r&&"cell"!==r||(i.push({title:t().translate("Copy")+"...",shortcut:"Ctrl + C",onclick:function(){_.call(e,!0)}}),navigator&&navigator.clipboard&&i.push({title:t().translate("Paste")+"...",shortcut:"Ctrl + V",onclick:function(){var t=e.selectedCell;t&&t.length>=2&&navigator.clipboard.readText().then(function(n){n&&N.call(e,t[0],t[1],n)})}})),0!=e.parent.config.allowExport&&i.push({title:t().translate("Save as")+"...",shortcut:"Ctrl + S",onclick:function(){var t;null===(t=e.download)||void 0===t||t.call(e)}}),0!=e.parent.config.about&&i.push({title:t().translate("About"),onclick:function(){void 0===e.parent.config.about||!0===e.parent.config.about?alert(B.print()):alert(e.parent.config.about)}}),i}(r,b,w,u);if("function"==typeof i.config.contextMenu)if(T=i.config.contextMenu(r,b,w,e,C,u,b,w))C=T;else if(!1===T)return;var x=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.contextMenu};if("object"==typeof i.plugins&&null!==i.plugins)for(var E=0,A=Object.values(i.plugins);E<A.length;E++){var L=A[E];if(x(L)){var T;if(!1===(T=L.contextMenu(r,b,w,e,C,u,b,w)))return;Array.isArray(T)&&(C=T)}}i.contextMenu.contextmenu.open(e,C),e.preventDefault()}}},ne=function(e){var t,o,r=W(Y(e.target)),i=n.jspreadsheet.current;if(r[0]?i!=r[0].jssWorksheet&&(i&&(null===(t=i.resetSelection)||void 0===t||t.call(i)),n.jspreadsheet.current=r[0].jssWorksheet,i=n.jspreadsheet.current):i&&(null===(o=i.resetSelection)||void 0===o||o.call(i),n.jspreadsheet.current=null,i=null),i&&!i.edition){var l=Y(e.target);if(!l)return;var s=l.getAttribute("data-x"),c=l.getAttribute("data-y"),u=null!=s?parseInt(s,10):null,d=null!=c?parseInt(c,10):null;null!==u&&null!==d&&(M.AH.call(i,u,d,u,d),n.jspreadsheet.timeControl=setTimeout(function(){var t,o=null!==(t=i.options.columns)&&void 0!==t?t:[];o[u]&&"color"==o[u].type?n.jspreadsheet.tmpElement=null:n.jspreadsheet.tmpElement=l,a.call(i,l,!1,e)},500))}},oe=function(e){if(n.jspreadsheet.timeControl&&(clearTimeout(n.jspreadsheet.timeControl),n.jspreadsheet.timeControl=null,n.jspreadsheet.tmpElement)){var t=n.jspreadsheet.tmpElement.children[0];t instanceof HTMLElement&&"INPUT"===t.tagName&&t.focus(),n.jspreadsheet.tmpElement=null}},re=function(e){var t,o=n.jspreadsheet.current;o&&(o.edition||(null==_||_.call(o,!0,void 0,void 0,void 0,void 0,!0),0!=o.options.editable&&o.highlighted&&(null===(t=o.setValue)||void 0===t||t.call(o,o.highlighted.map(function(e){return e.element}),""))))},ie=function(e){var t=n.jspreadsheet.current;t&&(t.edition||_.call(t,!0))},le=function(e){var o,r,i,l,u,d,f,h,m,v,y,w=n.jspreadsheet.current;if(w){var C=null!==(o=w.options.data)&&void 0!==o?o:[],L=C.length,I=C[0]?C[0].length:0,T=null!==(r=w.options.columns)&&void 0!==r?r:[],N=0!=w.options.editable,S=0!=w.options.allowDeleteRow,j=1==w.options.wordWrap,D=0!=w.options.allowDeleteColumn,O=0!=w.options.allowInsertRow,k=0!=w.options.allowManualInsertRow,R=0!=w.options.allowInsertColumn,H=0!=w.options.allowManualInsertColumn;if(w.edition)if(27==e.which)w.edition&&s.call(w,w.edition[0],!1),e.preventDefault();else if(13==e.which)if(T[w.edition[2]]&&"calendar"==T[w.edition[2]].type)s.call(w,w.edition[0],!0);else if(T[w.edition[2]]&&"dropdown"==T[w.edition[2]].type);else if((j||T[w.edition[2]]&&1==T[w.edition[2]].wordWrap||Array.isArray(C)&&C[w.edition[3]]&&Array.isArray(C[w.edition[3]])&&C[w.edition[3]][w.edition[2]]&&(Array.isArray(C[w.edition[3]][w.edition[2]])||"string"==typeof C[w.edition[3]][w.edition[2]])&&C[w.edition[3]][w.edition[2]].length>200)&&e.altKey){var P=w.edition[0].children[0],F=P.value,V=null!==(i=P.selectionStart)&&void 0!==i?i:0;F=F.slice(0,V)+"\n"+F.slice(V),P.value=F,P.focus(),P.selectionStart=V+1,P.selectionEnd=V+1}else(B=w.edition[0].children[0])instanceof HTMLElement&&B.blur();else if(9==e.which){var B;T[w.edition[2]]&&["calendar","html"].includes(T[w.edition[2]].type)?s.call(w,w.edition[0],!0):(B=w.edition[0].children[0])instanceof HTMLElement&&B.blur()}if(!w.edition&&w.selectedCell)if(37==e.which)x.call(w,e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)g.call(w,e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)p.call(w,e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)b.call(w,e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)E.call(w,e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)A.call(w,e.shiftKey,e.ctrlKey),e.preventDefault();else if(46==e.which||8==e.which)N&&(null!=w.selectedRow?S&&confirm(t().translate("Are you sure to delete the selected rows?"))&&"number"==typeof w.selectedRow&&(null===(l=w.deleteRow)||void 0===l||l.call(w,w.selectedRow)):w.selectedHeader?D&&confirm(t().translate("Are you sure to delete the selected columns?"))&&"number"==typeof w.selectedHeader&&(null===(u=w.deleteColumn)||void 0===u||u.call(w,w.selectedHeader)):w.highlighted&&(null===(d=w.setValue)||void 0===d||d.call(w,w.highlighted.map(function(e){return e.element}),"")));else if(13==e.which)e.shiftKey?p.call(w,e.shiftKey,e.ctrlKey):(O&&k&&w.selectedCell[1]==L-1&&(null===(f=w.insertRow)||void 0===f||f.call(w,1)),b.call(w,e.shiftKey,e.ctrlKey)),e.preventDefault();else if(9==e.which)e.shiftKey?x.call(w,e.shiftKey,e.ctrlKey):(R&&H&&w.selectedCell[0]==I-1&&(null===(h=w.insertColumn)||void 0===h||h.call(w)),g.call(w,e.shiftKey,e.ctrlKey)),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(w.selectedCell&&N){var q=w.selectedCell[1],U=w.selectedCell[0];32==e.keyCode?(e.preventDefault(),!T[U]||"checkbox"!=T[U].type&&"radio"!=T[U].type?a.call(w,w.records[q][U].element,!0,e):c.call(w)):113==e.keyCode?a.call(w,w.records[q][U].element,!1,e):1!==e.key.length&&"Process"!==e.key||e.altKey||function(e){return navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey:e.ctrlKey}(e)||(a.call(w,w.records[q][U].element,!0,e),T[U]&&"calendar"==T[U].type&&e.preventDefault())}}else 65==e.which?(M.Ub.call(w),e.preventDefault()):83==e.which?(null===(m=w.download)||void 0===m||m.call(w),e.preventDefault()):89==e.which?(null===(v=w.redo)||void 0===v||v.call(w),e.preventDefault()):90==e.which?(null===(y=w.undo)||void 0===y||y.call(w),e.preventDefault()):67==e.which?(_.call(w,!0),e.preventDefault()):88==e.which?(N?re.call(w,e):ie.call(w,e),e.preventDefault()):86==e.which&&Q.call(w,e)}else{var W=Y(e.target);if(W&&W.classList.contains("jss_search")){n.jspreadsheet.timeControl&&clearTimeout(n.jspreadsheet.timeControl);var z=W;n.jspreadsheet.timeControl=setTimeout(function(){var e,t=n.jspreadsheet.current;t&&(null===(e=t.search)||void 0===e||e.call(t,z.value))},200)}}},ae=function(e){var t=this;1==t.options.lazyLoading&&null==n.jspreadsheet.timeControlLoading&&(n.jspreadsheet.timeControlLoading=setTimeout(function(){t.content&&t.content.scrollTop+t.content.clientHeight>=t.content.scrollHeight-10?u.p6.call(t)&&(t.content&&t.content.scrollTop+t.content.clientHeight>t.content.scrollHeight-10&&(t.content.scrollTop=t.content.scrollTop-t.content.clientHeight),M.Aq.call(t)):t.content&&t.content.scrollTop<=t.content.clientHeight&&u.G_.call(t)&&(t.content.scrollTop<10&&(t.content.scrollTop=t.content.scrollTop+t.content.clientHeight),M.Aq.call(t)),n.jspreadsheet.timeControlLoading=null},100))},se=0,ce=function(){var e=this;if(e.content){var t=0;if((se=e.content.scrollLeft)>50&&e.options.freezeColumns)for(var n=0;n<e.options.freezeColumns;n++){!(n>0)||e.options.columns&&e.options.columns[n-1]&&"hidden"===e.options.columns[n-1].type||(t+=e.options.columns&&e.options.columns[n-1]&&void 0!==e.options.columns[n-1].width?parseInt(String(e.options.columns[n-1].width)):void 0!==e.options.defaultColWidth?parseInt(String(e.options.defaultColWidth)):100),e.headers[n].classList.add("jss_freezed"),e.headers[n].style.left=t+"px";for(var o=0;o<e.rows.length;o++)if(e.rows[o]&&e.records[o][n]){var r=se+(n>0?parseInt(String(e.records[o][n-1].element.style.width)):0)-51+"px";e.records[o][n].element.classList.add("jss_freezed"),e.records[o][n].element.style.left=r}}else if(e.options.freezeColumns)for(n=0;n<e.options.freezeColumns;n++)for(e.headers[n].classList.remove("jss_freezed"),e.headers[n].style.left="",o=0;o<e.rows.length;o++)e.records[o][n]&&(e.records[o][n].element.classList.remove("jss_freezed"),e.records[o][n].element.style.left="");M.Aq.call(e)}},ue=function(e){var t=this;if(ae.call(t,e),t.options.freezeColumns&&t.options.freezeColumns>0&&t.content&&t.content.scrollLeft!=se&&ce.call(t),(1==t.options.lazyLoading||1==t.options.tableOverflow)&&t.edition){var n=e.target;n&&"string"==typeof n.className&&"jdropdown"!=n.className.substr(0,9)&&s.call(t,t.edition[0],!0)}},de=function(e){fe(e),e.addEventListener("mouseup",z),e.addEventListener("mousedown",X),e.addEventListener("mousemove",G),e.addEventListener("mouseover",Z),e.addEventListener("dblclick",J),e.addEventListener("paste",Q),e.addEventListener("contextmenu",te),e.addEventListener("touchstart",ne),e.addEventListener("touchend",oe),e.addEventListener("touchcancel",oe),e.addEventListener("touchmove",oe),document.addEventListener("keydown",le)},fe=function(e){e.removeEventListener("mouseup",z),e.removeEventListener("mousedown",X),e.removeEventListener("mousemove",G),e.removeEventListener("mouseover",Z),e.removeEventListener("dblclick",J),e.removeEventListener("paste",Q),e.removeEventListener("contextmenu",te),e.removeEventListener("touchstart",ne),e.removeEventListener("touchend",oe),e.removeEventListener("touchcancel",oe),document.removeEventListener("keydown",le)},pe=__webpack_require__(87),he=__webpack_require__(986),me=function(e){return this.headers[e].textContent},ge=function(e,t,n,r,l){var a=this,s={},c={},u=function(e,t,n){var o=(0,T.vu)(e,!0);if(a.records[o[1]]&&a.records[o[1]][o[0]]&&(0==a.records[o[1]][o[0]].element.classList.contains("readonly")||r)){var i=a.records[o[1]][o[0]].element.style[t];i!=n||r?a.records[o[1]][o[0]].element.style[t]=n:(n="",a.records[o[1]][o[0]].element.style[t]=""),c[e]||(c[e]=[]),s[e]||(s[e]=[]),c[e].push(t+":"+i),s[e].push(t+":"+n)}};if(t&&n)"string"==typeof e&&u(e,t,n);else for(var d=Object.keys(e),f=0;f<d.length;f++){var p=e[d[f]];"string"==typeof p&&(p=p.split(";"));for(var h=0;h<p.length;h++)if("string"==typeof p[h]){var m=p[h].split(":");m[0]&&m[0].trim()&&u(d[f],m[0].trim(),m[1])}}var g=Object.keys(c);for(f=0;f<g.length;f++)c[g[f]]=c[g[f]].join(";");for(g=Object.keys(s),f=0;f<g.length;f++)s[g[f]]=s[g[f]].join(";");l||i.Dh.call(a,{action:"setStyle",oldValue:c,newValue:s}),o.A.call(a,"onchangestyle",a,s)},ve=function(e){var t,n,o,r,i=this,l=e;if(l){if("string"!=typeof l)return ve.call(i);var a=(0,T.vu)(l,!0);return a&&"string"!=typeof a&&i.records[a[1]][a[0]].element.getAttribute("title")||""}for(var s={},c=null!==(t=i.options.data)&&void 0!==t?t:[],u=null!==(n=i.options.columns)&&void 0!==n?n:[],d=0;d<c.length;d++)for(var f=0;f<u.length;f++){var p=null===(r=null===(o=i.records[d])||void 0===o?void 0:o[f])||void 0===r?void 0:r.element.getAttribute("title");p&&(s[(0,T.t3)([f,d])]=p)}return s},ye=__webpack_require__(745),be=function(){return this.config},we=function(e,t){var n=this;if("object"==typeof e&&null!==e){var o,r=e,i=Object.keys(r);n.parent?o=n.parent:(t=!0,o=n),i.forEach(function(e){var i,l;if(t){if(o.config[e]=r[e],"toolbar"===e){var a=o;!0===r[e]?null===(i=a.showToolbar)||void 0===i||i.call(a):!1===r[e]&&(null===(l=a.hideToolbar)||void 0===l||l.call(a))}}else n.options[e]=r[e]})}},Ce=__webpack_require__(211),xe=function(){var e,n,o,i,l=this;!function(e){for(var t=0;t<Te;t++){var n=Ie[t],o=n[0],r=n[1];e[o]=r.bind(e)}}(l),l.table=document.createElement("table"),l.thead=document.createElement("thead"),l.tbody=document.createElement("tbody"),l.headers=[],l.cols=[],l.content=document.createElement("div"),l.content.classList.add("jss_content"),l.content.onscroll=function(e){ue.call(l,e)},l.content.onwheel=function(e){ae.call(l,e)};var a=document.createElement("div"),s=document.createElement("label");s.innerHTML=t().translate("Search")+": ",a.appendChild(s),l.searchInput=document.createElement("input"),l.searchInput.classList.add("jss_search"),s.appendChild(l.searchInput),l.searchInput.onfocus=function(){"function"==typeof l.resetSelection&&l.resetSelection()};var c=document.createElement("div");if(l.options.pagination&&"number"==typeof l.options.pagination&&l.options.pagination>0&&l.options.paginationOptions&&Array.isArray(l.options.paginationOptions)&&l.options.paginationOptions.length>0){l.paginationDropdown=document.createElement("select"),l.paginationDropdown.classList.add("jss_pagination_dropdown"),l.paginationDropdown.onchange=function(){l.options.pagination=parseInt(this.value||"0"),"function"==typeof l.page&&l.page(0)};for(var u=0;u<l.options.paginationOptions.length;u++){var d=document.createElement("option");d.value=String(l.options.paginationOptions[u]),d.innerHTML=String(l.options.paginationOptions[u]),l.paginationDropdown.appendChild(d)}l.paginationDropdown.value=String(l.options.pagination),c.appendChild(document.createTextNode(t().translate("Show "))),c.appendChild(l.paginationDropdown),c.appendChild(document.createTextNode(t().translate("entries")))}var f=document.createElement("div");f.classList.add("jss_filter"),f.appendChild(c),f.appendChild(a),l.colgroupContainer=document.createElement("colgroup");var p=document.createElement("col");if(p.setAttribute("width","50"),l.colgroupContainer.appendChild(p),l.options.nestedHeaders&&l.options.nestedHeaders.length>0&&l.options.nestedHeaders[0]&&l.options.nestedHeaders[0][0])for(var h=0;h<l.options.nestedHeaders.length;h++)l.thead.appendChild(r.ju.call(l,l.options.nestedHeaders[h]));l.headerContainer=document.createElement("tr");var m=document.createElement("td");m.classList.add("jss_selectall"),l.headerContainer.appendChild(m);var g=O.call(l);for(u=0;u<g;u++)k.call(l,u),l.headerContainer.appendChild(l.headers[u]),l.colgroupContainer.appendChild(l.cols[u].colElement);if(l.thead.appendChild(l.headerContainer),1==l.options.filters){l.filter=document.createElement("tr");var v=document.createElement("td");if(l.filter.appendChild(v),l.options.columns)for(u=0;u<l.options.columns.length;u++){var y=document.createElement("td");y.innerHTML="&nbsp;",y.setAttribute("data-x",u.toString()),y.className="jss_column_filter",l.options.columns[u]&&"hidden"==l.options.columns[u].type&&(y.style.display="none"),l.filter.appendChild(y)}l.thead.appendChild(l.filter)}l.table=document.createElement("table"),l.table.classList.add("jss_worksheet"),l.table.setAttribute("cellpadding","0"),l.table.setAttribute("cellspacing","0"),l.table.setAttribute("unselectable","yes"),l.table.appendChild(l.colgroupContainer),l.table.appendChild(l.thead),l.table.appendChild(l.tbody),l.options.textOverflow||l.table.classList.add("jss_overflow"),l.corner=document.createElement("div"),l.corner.className="jss_corner",l.corner.setAttribute("unselectable","on"),l.corner.setAttribute("onselectstart","return false"),0==l.options.selectionCopy&&(l.corner.style.display="none"),l.textarea=document.createElement("textarea"),l.textarea.className="jss_textarea",l.textarea.id="jss_textarea",l.textarea.tabIndex=-1,l.textarea.ariaHidden="true";var b=document.createElement("a");b.setAttribute("href","https://bossanova.uk/jspreadsheet/"),l.ads=document.createElement("div"),l.ads.className="jss_about";var w=document.createElement("span");w.innerHTML="Jspreadsheet CE",b.appendChild(w),l.ads.appendChild(b),document.createElement("div").classList.add("jss_table"),l.pagination=document.createElement("div"),l.pagination.classList.add("jss_pagination");var C=document.createElement("div"),x=document.createElement("div");if(l.pagination.appendChild(C),l.pagination.appendChild(x),l.options.pagination||(l.pagination.style.display="none"),1==l.options.search&&l.element.appendChild(f),l.content.appendChild(l.table),l.content.appendChild(l.corner),l.content.appendChild(l.textarea),l.element.appendChild(l.content),l.element.appendChild(l.pagination),l.element.appendChild(l.ads),l.element.classList.add("jss_container"),l.element.jssWorksheet=l,l.element.jspreadsheet=l,1==l.options.tableOverflow&&(l.options.tableHeight&&(l.content.style["overflow-y"]="auto",l.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",l.content.style.maxHeight="string"==typeof l.options.tableHeight?l.options.tableHeight:l.options.tableHeight+"px"),l.options.tableWidth&&(l.content.style["overflow-x"]="auto",l.content.style.width="string"==typeof l.options.tableWidth?l.options.tableWidth:l.options.tableWidth+"px")),1!=l.options.tableOverflow&&l.parent.config.toolbar&&l.element.classList.add("with-toolbar"),0!=l.options.columnDrag&&l.thead.classList.add("draggable"),0!=l.options.columnResize&&l.thead.classList.add("resizable"),0!=l.options.rowDrag&&l.tbody.classList.add("draggable"),0!=l.options.rowResize&&l.tbody.classList.add("resizable"),null===(e=l.setData)||void 0===e||e.call(l,void 0),l.options.style){var E={};if(Array.isArray(l.options.style));else if("object"==typeof l.options.style)for(var A=0,L=Object.entries(l.options.style);A<L.length;A++){var M=L[A],I=M[0],_=M[1];"string"==typeof _?E[I]=_:"number"==typeof _&&(E[I]=_.toString())}Object.keys(E).length>0&&(null===(n=l.setStyle)||void 0===n||n.call(l,E,null,null,!0,!0)),delete l.options.style}if(Object.defineProperty(l.options,"style",{enumerable:!0,configurable:!0,get:function(){var e;return null===(e=l.getStyle)||void 0===e?void 0:e.call(l)}}),l.options.comments&&(null===(o=l.setComments)||void 0===o||o.call(l,l.options.comments)),l.options.classes)for(var N=0,S=Object.entries(l.options.classes);N<S.length;N++){var j=S[N],D=(I=j[0],j[1]),R=(0,T.vu)(I,!0),H=null===(i=l.records[R[1]])||void 0===i?void 0:i[R[0]];H&&D&&H.element.classList.add(D)}},Ee=function(){var e=this;1==e.options.lazyLoading&&1!=e.options.tableOverflow&&1!=e.parent.config.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),e.options.lazyLoading=!1),e.options.columns||(e.options.columns=[]);var n,o=e.options.columns.length;if(e.options.data&&void 0!==e.options.data[0])if(Array.isArray(e.options.data[0])){var r=e.options.data[0].length;r>o&&(o=r)}else(n=Object.keys(e.options.data[0])).length>o&&(o=n.length);e.options.minDimensions||(e.options.minDimensions=[0,0]),e.options.minDimensions[0]>o&&(o=e.options.minDimensions[0]);for(var i=[],l=function(t){e.options.columns[t]||(e.options.columns[t]={}),!e.options.columns[t].name&&n&&n[t]&&(e.options.columns[t].name=n[t]),"dropdown"==e.options.columns[t].type&&e.options.columns[t].url&&i.push({url:e.options.columns[t].url,index:t,method:"GET",dataType:"json",success:function(n){if(e.options.columns&&e.options.columns[t]){e.options.columns[t].source||(e.options.columns[t].source=[]);var o=e.options.columns[t].source;if(Array.isArray(o)&&Array.isArray(n))for(var r=0;r<n.length;r++)o.push(n[r])}}})},a=0;a<o;a++)l(a);if(i.length){var s=0,c=i.length;i.forEach(function(n){t().ajax({url:n.url,method:n.method||"GET",dataType:n.dataType||"json",success:function(t){n.success&&n.success.call(e,t),++s>=c&&xe.call(e)},error:function(){++s>=c&&xe.call(e)}})})}else xe.call(e)},Ae=function(e){var t=/^Sheet(\d+)$/,n=0;return e.worksheets.forEach(function(e){var o=t.exec(e.options.worksheetName||"");o&&(n=Math.max(n,parseInt(o[1])))}),"Sheet"+(n+1)},Le=function(){return e=this,o=void 0,i=function(){var e,o,r,i;return function(e,t){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,function(l){switch(l.label){case 0:return(e=this).element,"object"==typeof(o=e.parent).plugins&&Object.entries(o.plugins).forEach(function(t){var n=t[1];"function"==typeof n.beforeinit&&n.beforeinit(e)}),n.jspreadsheet.current=e,r=[],e.options.csv?(i=new Promise(function(n){t().ajax({url:e.options.csv,method:"GET",dataType:"text",success:function(t){var o=(0,I.parseCSV)(t,e.options.csvDelimiter);if(1==e.options.csvHeaders&&o.length>0){var r=o.shift();if(r&&r.length>0){e.options.columns||(e.options.columns=[]);for(var i=0;i<r.length;i++)e.options.columns[i]||(e.options.columns[i]={}),void 0===e.options.columns[i].title&&(e.options.columns[i].title=r[i])}}e.options.data=o,Ee.call(e),n()}})}),r.push(i)):e.options.url?(i=new Promise(function(n){t().ajax({url:e.options.url,method:"GET",dataType:"json",success:function(t){var o=t;e.options.data=o&&"object"==typeof o&&"data"in o&&o.data?o.data:o,Ee.call(e),n()}})}),r.push(i)):Ee.call(e),[4,Promise.all(r)];case 1:return l.sent(),"object"==typeof o.plugins&&Object.entries(o.plugins).forEach(function(t){var n=t[1];"function"==typeof n.init&&n.init(e)}),[2]}})},new((r=void 0)||(r=Promise))(function(t,n){function l(e){try{s(i.next(e))}catch(e){n(e)}}function a(e){try{s(i.throw(e))}catch(e){n(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r(function(e){e(n)})).then(l,a)}s((i=i.apply(e,o||[])).next())});var e,o,r,i},Me=function(e){var t=this.parent;e.worksheetName||(e.worksheetName=Ae(this.parent));var n={parent:t,options:e,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return t.config.worksheets||(t.config.worksheets=[]),t.config.worksheets.push(n.options),t.worksheets.push(n),n},Ie=[["selectAll",M.Ub],["updateSelectionFromCoords",function(e,t,n,o){return M.AH.call(this,e,t,n,o)}],["resetSelection",function(){return M.gE.call(this,!1)}],["getSelection",M.Lo],["getSelected",M.ef],["getSelectedColumns",M.Jg],["getSelectedRows",M.R5],["getData",function(e,t,n,o){for(var r,i,l,a,s,c,u,d=this,f=[],p=0,h=0,m=d.options.columns?d.options.columns.length:0,g=null!==(r=d.options.data)&&void 0!==r?r:[],v=Math.max.apply(Math,function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}([0],g.map(function(e){return Array.isArray(e)?e.length:m}),!1)),y=g.length,b=0;b<y;b++){p=0;for(var w=0;w<v;w++)if(!e||d.records[b][w].element.classList.contains("highlight")){if(f[h]||(f[h]=[]),t)f[h][p]=d.records[b][w].element.innerHTML;else{var C=(null!==(i=d.options.data)&&void 0!==i?i:[])[b];if(void 0!==C)if(Array.isArray(C))f[h][p]=null!==(l=C[w])&&void 0!==l?l:"";else{var x=null!==(c=null===(s=(null!==(a=d.options.columns)&&void 0!==a?a:[])[w])||void 0===s?void 0:s.name)&&void 0!==c?c:String(w);f[h][p]=null!==(u=C[x])&&void 0!==u?u:""}else f[h][p]=""}p++}p>0&&h++}return n?f.map(function(e){return e.map(function(e){return String(null!=e?e:"")}).join(n)}).join("\r\n")+"\r\n":o?f.map(function(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}):f}],["setData",function(e){var t,n,o,i,l,a,s,c=this,u=null!==(t=c.options.columns)&&void 0!==t?t:[];if(e&&(c.options.data=e),c.options.data||(c.options.data=[]),c.options.data&&c.options.data[0]&&!Array.isArray(c.options.data[0])){e=[];for(var d=0;d<c.options.data.length;d++){for(var f=[],p=c.options.data[d],h=0;h<u.length;h++){var m=null!==(o=null===(n=u[h])||void 0===n?void 0:n.name)&&void 0!==o?o:String(h);f[h]=p[m]}e.push(f)}c.options.data=e}var g,v,y=0,b=0,w=u.length,C=c.options.data.length,x=null!==(i=c.options.minDimensions)&&void 0!==i?i:[0,0],E=x[0],A=x[1],M=E>w?E:w,I=A>C?A:C;for(y=0;y<I;y++)if(c.options.data[y]||(c.options.data[y]=[]),f=c.options.data[y],Array.isArray(f)){var T=f;for(b=0;b<M;b++)null==T[b]&&(T[b]="")}else for(p=f,b=0;b<M;b++)null==p[m=null!==(a=null===(l=u[b])||void 0===l?void 0:l.name)&&void 0!==a?a:String(b)]&&(p[m]="");c.rows=[],c.results=null,c.records=[],c.history=[],c.historyIndex=-1,c.tbody.innerHTML="",1==c.options.lazyLoading?(g=0,v=c.options.data.length<100?c.options.data.length:100,c.options.pagination&&(c.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):c.options.pagination?(c.pageNumber||(c.pageNumber=0),c.options.pagination,g=c.options.pagination*c.pageNumber,v=c.options.pagination*c.pageNumber+c.options.pagination,c.options.data.length<v&&(v=c.options.data.length)):(g=0,v=c.options.data.length);var _=function(){var e=c.options.data[y],t=Array.isArray(e)?e:(null!==(s=c.options.columns)&&void 0!==s?s:[]).map(function(t,n){var o;return e[null!==(o=null==t?void 0:t.name)&&void 0!==o?o:String(n)]}),n=P.call(c,y,t);y>=g&&y<v&&c.tbody.appendChild(n.element)};for(y=0;y<c.options.data.length;y++)_();if(1==c.options.lazyLoading||c.options.pagination&&he.IV.call(c),c.options.mergeCells)for(var N=c.options.mergeCells,S=Object.keys(N),j=0;j<S.length;j++){var D=N[S[j]];Array.isArray(D)&&L.FU.call(c,S[j],D[0],D[1],!0)}r.am.call(c)}],["getValue",function(e,t){var n,o,r,i,l,a=this;if("string"!=typeof e)return null;var s=(0,T.vu)(e,!0);i=s[0],l=s[1];var c=null;if(null!=i&&null!=l)if(a.records[l]&&a.records[l][i]&&t)c=a.records[l][i].element.innerHTML;else{var u=a.options.data;if(u&&void 0!==u[l]){var d=u[l];if(Array.isArray(d))void 0!==d[i]&&(c=d[i]);else{var f=d,p=null!==(r=null===(o=(null!==(n=a.options.columns)&&void 0!==n?n:[])[i])||void 0===o?void 0:o.name)&&void 0!==r?r:String(i);p in f&&(c=f[p])}}}return c}],["getValueFromCoords",function(e,t,n){var o,r,i,l=this,a=null;if(null!=e&&null!=t)if(l.records[t]&&l.records[t][e]&&n)a=l.records[t][e].element.innerHTML;else{var s=l.options.data;if(s&&void 0!==s[t]){var c=s[t];if(Array.isArray(c))void 0!==c[e]&&(a=c[e]);else{var u=c,d=null!==(i=null===(r=(null!==(o=l.options.columns)&&void 0!==o?o:[])[e])||void 0===r?void 0:r.name)&&void 0!==i?i:String(e);d in u&&(a=u[d])}}}return a}],["setValue",function(e,t,n){var l=this,a=[];if("string"==typeof e){var s=(0,T.vu)(e,!0);if(Array.isArray(s)&&s.length>=2){var c=s[0],u=s[1];a.push(r.k9.call(l,c,u,t,n)),r.xF.call(l,c,u,a)}}else if(!Array.isArray(e)&&(null==e?void 0:e.getAttribute)){var d=e,f=parseInt(d.getAttribute("data-x")||"",10),p=parseInt(d.getAttribute("data-y")||"",10);isNaN(f)||isNaN(p)||(a.push(r.k9.call(l,f,p,t,n)),r.xF.call(l,f,p,a))}else for(var h=Array.isArray(e)?e:Object.keys(e).map(function(t){return e[t]}),m=0;m<h.length;m++){var g=h[m],v=null,y=null;"string"==typeof g?(v=(s=(0,T.vu)(g,!0))[0],y=s[1]):g&&"object"==typeof g&&("x"in g&&"y"in g?(v=Number(g.x),y=Number(g.y),"value"in g&&(t=g.value)):(d="element"in g&&g.element&&g.element.getAttribute?g.element:g,v=parseInt(d.getAttribute("data-x")||"",10),y=parseInt(d.getAttribute("data-y")||"",10))),null==v||null==y||isNaN(v)||isNaN(y)||(a.push(r.k9.call(l,v,y,t,n)),r.xF.call(l,v,y,a))}i.Dh.call(l,{action:"setValue",records:a,selection:l.selectedCell}),r.am.call(l);var b=a.map(function(e){var t,n;return{x:e.x,y:e.y,value:null!==(t=e.value)&&void 0!==t?t:"",oldValue:null!==(n=e.oldValue)&&void 0!==n?n:""}});o.A.call(l,"onafterchanges",l,b)}],["setValueFromCoords",function(e,t,n,l){var a=this,s=[];s.push(r.k9.call(a,e,t,n,l)),r.xF.call(a,e,t,s),i.Dh.call(a,{action:"setValue",records:s,selection:a.selectedCell}),r.am.call(a);var c=s.map(function(e){var t,n;return{x:e.x,y:e.y,value:null!==(t=e.value)&&void 0!==t?t:"",oldValue:null!==(n=e.oldValue)&&void 0!==n?n:""}});o.A.call(a,"onafterchanges",a,c)}],["getWidth",function(e){var t,n=this;if(void 0===e){t=[];for(var o=0;o<n.headers.length;o++)t.push(Number(n.options.columns&&n.options.columns[o]&&n.options.columns[o].width||n.options.defaultColWidth||100))}else{var r="number"==typeof e?e:parseInt(e.getAttribute("data-x")||"0");t=parseInt(n.cols[r].colElement.getAttribute("width")||"0")}return t}],["setWidth",function(e,t){return R.call(this,e,t,void 0)}],["insertRow",function(e,n,l){var a,s,c,u,d,f,p,h,m,g=this;if(0!=g.options.allowInsertRow){var v=[],y=void 0;Array.isArray(e)?(y=1,e&&(v=e)):y=void 0!==e?e:1,l=!!l;var b=(null!==(s=null===(a=g.options.data)||void 0===a?void 0:a.length)&&void 0!==s?s:1)-1;(null==n||n>=b||n<0)&&(n=b);for(var w=[],C=0;C<y;C++){for(var x=[],E=0;E<(null!==(u=null===(c=g.options.columns)||void 0===c?void 0:c.length)&&void 0!==u?u:0);E++)x[E]=v[E]?v[E]:"";w.push({row:C+n+(l?0:1),data:x})}if(!1===o.A.call(g,"onbeforeinsertrow",g,w))return!1;if(g.options.mergeCells&&Object.keys(g.options.mergeCells).length>0&&L.D0.call(g,n,l).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;"function"==typeof g.destroyMerge&&g.destroyMerge()}if(1==g.options.search){if(g.results&&g.results.length!=g.rows.length){if(!confirm(t().translate("This action will clear your search results. Are you sure?")))return!1;g.parent&&"function"==typeof g.parent.resetSearch&&g.parent.resetSearch()}g.results=null}var A=l?n:n+1,M=g.records.splice(A),I=(null===(d=g.options.data)||void 0===d?void 0:d.splice(A))||[],T=g.rows.splice(A),_=[],N=[],S=[];for(C=A;C<y+A;C++){for(g.options.data||(g.options.data=[]),g.options.data[C]=[],E=0;E<(null!==(p=null===(f=g.options.columns)||void 0===f?void 0:f.length)&&void 0!==p?p:0);E++)g.options.data[C][E]=v[E]?v[E]:"";var j=Array.isArray(null===(h=g.options.data)||void 0===h?void 0:h[C])?g.options.data[C]:void 0;x=P.call(g,C,j),T[0]?Array.prototype.indexOf.call(g.tbody.children,T[0].element)>=0&&g.tbody.insertBefore(x.element,T[0].element):Array.prototype.indexOf.call(g.tbody.children,g.rows[n].element)>=0&&g.tbody.appendChild(x.element),_.push(g.records[C].map(function(e){return e.value||""}));var D=Array.isArray(null===(m=g.options.data)||void 0===m?void 0:m[C])?H([],g.options.data[C],!0):[];N.push(D||[]),S.push(x)}Array.prototype.push.apply(g.records,M),g.options.data&&Array.prototype.push.apply(g.options.data,I),Array.prototype.push.apply(g.rows,T);for(var O=A;O<g.rows.length;O++)g.rows[O].y=O;for(O=A;O<g.records.length;O++)for(var k=0;k<g.records[O].length;k++)g.records[O][k].y=O;"number"==typeof g.options.pagination&&g.options.pagination>0&&g.page&&void 0!==g.pageNumber&&g.page(g.pageNumber),i.Dh.call(g,{action:"insertRow",rowNumber:n,numOfRows:y,insertBefore:l,rowRecords:_,rowData:N,rowNode:S}),r.o8.call(g),o.A.call(g,"oninsertrow",g,w)}return!0}],["moveRow",function(e,t){return F.call(this,e,t,!1)}],["deleteRow",function(e,n){var l,a,s,c,u=this;if(!u.options.data)return!1;if(0!=u.options.allowDeleteRow)if(1==u.options.allowDeletingAllRows||u.options.data.length>1){if(null==e){var d=M.R5.call(u,!1);0===d.length?(e=u.options.data.length-1,n=1):(e=d[0],n=d.length)}var f=u.options.data.length-1;(null==e||e>f||e<0)&&(e=f),n||(n=1),e+n>=u.options.data.length&&(n=u.options.data.length-e);for(var p=[],h=0;h<n;h++)p.push(h+e);if(!1===o.A.call(u,"onbeforedeleterow",u,p))return!1;if(e>-1){var m=!1;if(u.options.mergeCells&&Object.keys(u.options.mergeCells).length>0)for(var g=e;g<e+n;g++)L.D0.call(u,g,!1).length&&(m=!0);if(m){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;null===(l=u.destroyMerge)||void 0===l||l.call(u)}if(1==u.options.search){if(u.results&&u.results.length!=u.rows.length){if(!confirm(t().translate("This action will clear your search results. Are you sure?")))return!1;u.parent&&"function"==typeof u.parent.resetSearch&&u.parent.resetSearch()}u.results=null}for(1!=u.options.allowDeletingAllRows&&f+1===n&&(n--,console.error("Jspreadsheet: It is not possible to delete the last row")),g=e;g<e+n;g++)Array.prototype.indexOf.call(u.tbody.children,u.rows[g].element)>=0&&(u.rows[g].element.className="",null===(a=u.rows[g].element.parentNode)||void 0===a||a.removeChild(u.rows[g].element));for(var v=u.records.splice(e,n),y=u.options.data.splice(e,n),b=u.rows.splice(e,n),w=e;w<u.rows.length;w++)u.rows[w].y=w;for(w=e;w<u.records.length;w++)for(h=0;h<u.records[w].length;h++)u.records[w][h].y=w;u.options.pagination&&"number"==typeof u.options.pagination&&u.options.pagination>0&&u.tbody.children.length!=u.options.pagination&&(null===(s=u.page)||void 0===s||s.call(u,null!==(c=u.pageNumber)&&void 0!==c?c:0)),M.at.call(u,1,e,e+n-1),i.Dh.call(u,{action:"deleteRow",rowNumber:e,numOfRows:n,insertBefore:!0,rowRecords:v,rowData:y,rowNode:b}),r.o8.call(u),o.A.call(u,"ondeleterow",u,p)}}else console.error("Jspreadsheet: It is not possible to delete the last row")}],["hideRow",function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach(function(e){t.rows[e].element.style.display="none"})}],["showRow",function(e){var t=this;Array.isArray(e)||(e=[e]),e.forEach(function(e){t.rows[e].element.style.display=""})}],["getRowData",function(e,t){var n;return t?this.records[e].map(function(e){return e.element.innerHTML}):((null===(n=this.options.data)||void 0===n?void 0:n[e])||[]).map(function(e){return String(e)})}],["setRowData",function(e,t,n){for(var o,r=this,i=0;i<r.headers.length;i++){var l=(0,T.t3)([i,e]);null!=t[i]&&(null===(o=r.setValue)||void 0===o||o.call(r,l,t[i],n))}}],["getHeight",function(e){var t,n=this;if(void 0===e){t=[];for(var o=0;o<n.rows.length;o++){var r=n.rows[o].element.style.height;r&&(t[o]=parseInt(r)||0)}}else{if("object"==typeof e){var i=$(e).getAttribute("data-y");i&&(e=parseInt(i))}t=parseInt(n.rows[e].element.style.height)||0}return t}],["setHeight",function(e,t){return V.call(this,e,t,void 0)}],["getMerge",L.fd],["setMerge",function(e,t,n){return L.FU.call(this,e,t,n,void 0)}],["destroyMerge",function(){return L.VP.call(this,void 0)}],["removeMerge",function(e,t){return L.Zp.call(this,e,t,void 0)}],["search",function(e){var t,n,o=this;if(o.options.filters&&S.dr.call(o),null===(t=o.resetSelection)||void 0===t||t.call(o),o.pageNumber=0,o.results=[],e){(null===(n=o.searchInput)||void 0===n?void 0:n.value)!==e&&(o.searchInput.value=e);var i=function(e,t,n){for(var r,i,l=0;l<e.length;l++)if((""+e[l]).toLowerCase().search(t)>=0||(""+(null===(i=null===(r=o.records[n])||void 0===r?void 0:r[l])||void 0===i?void 0:i.element.innerHTML)).toLowerCase().search(t)>=0)return!0;return!1},l=function(e){o.results&&-1==o.results.indexOf(e)&&o.results.push(e)},a=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),s=new RegExp(a,"i");o.options.data&&(Array.isArray(o.options.data)?o.options.data.forEach(function(e,t){if(i(e,s,t)){var n=L.D0.call(o,t,void 0);if(n.length)for(var r=0;r<n.length;r++){var a=(0,T.vu)(n[r],!0);if(o.options.mergeCells&&o.options.mergeCells[n[r]]&&Array.isArray(o.options.mergeCells[n[r]]))for(var c=o.options.mergeCells[n[r]],u=0;u<c[1];u++)l(Number(a[1])+u)}else l(t)}}):o.options.data.forEach(function(e,t){var n=Object.values(e);if(i(n,s,t)){var r=L.D0.call(o,t,void 0);if(r.length)for(var a=0;a<r.length;a++){var c=(0,T.vu)(r[a],!0);if(o.options.mergeCells&&o.options.mergeCells[r[a]]&&Array.isArray(o.options.mergeCells[r[a]]))for(var u=o.options.mergeCells[r[a]],d=0;d<u[1];d++)l(Number(c[1])+d)}else l(t)}}))}else o.results=null;r.hG.call(o)}],["resetSearch",function(){var e,t=this;t.searchInput&&(t.searchInput.value=""),null===(e=t.search)||void 0===e||e.call(t,""),t.results=null}],["getHeader",me],["getHeaders",function(e){for(var t=this,n=[],o=0;o<t.headers.length;o++)n.push(me.call(t,o));return e?n:n.join(t.options.csvDelimiter)}],["setHeader",function(e,t){var n=this;if(n.headers[e]){var r=n.headers[e].textContent,l=n.options.columns&&n.options.columns[e]&&n.options.columns[e].title||"";t||(t=(0,I.getColumnName)(e)),n.headers[e].textContent=t,n.headers[e].setAttribute("title",t),n.options.columns||(n.options.columns=[]),n.options.columns[e]||(n.options.columns[e]={}),n.options.columns[e].title=t,i.Dh.call(n,{action:"setHeader",column:e,oldValue:r,newValue:t}),o.A.call(n,"onchangeheader",n,e,t,l)}}],["getStyle",function(e,t){var n,o=this;if(e){var r=(0,T.vu)(e,!0);return t?o.records[r[1]][r[0]].element.style[t]:o.records[r[1]][r[0]].element.getAttribute("style")}var i={},l=o.options.data;if(!l||!Array.isArray(l)||0===l.length)return{};for(var a=(Array.isArray(l[0])?l[0].length:0)||0,s=l.length,c=0;c<s;c++)for(var u=0;u<a;u++){var d=null===(n=o.records[c])||void 0===n?void 0:n[u];if(d){var f=t?d.element.style[t]:d.element.getAttribute("style");f&&(i[(0,T.t3)([u,c])]=f)}}return i}],["setStyle",function(e,t,n,o,r){return ge.call(this,e,t,n,o,r)}],["resetStyle",function(e,t){for(var n,o=this,r=Object.keys(e),i=0;i<r.length;i++){var l=(0,T.vu)(r[i],!0);o.records[l[1]]&&o.records[l[1]][l[0]]&&o.records[l[1]][l[0]].element.setAttribute("style","")}null===(n=o.setStyle)||void 0===n||n.call(o,e,null,null,void 0,t)}],["insertColumn",function(e,n,l,a){var s,c,u,d,f,p,h,m,g,v,y,b,w,C,x,E,A,M,I,_,N=this;if(0!=N.options.allowInsertColumn){var S=[],j=void 0;Array.isArray(e)?(j=1,e&&(S=e)):j="number"==typeof e?e:1,l=!!l;var O=0;if(N.options.data)for(var R=0,H=N.options.data;R<H.length;R++){var P=H[R],F=Array.isArray(P)?P.length:Object.keys(P).length;F>O&&(O=F)}var V=Math.max((null===(c=N.options.columns)||void 0===c?void 0:c.length)||0,O)-1;(null==n||n>=V||n<0)&&(n=V),Array.isArray(a)||(a=a?[a]:[]);for(var B=0;B<j;B++)a[B]||(a[B]={});var q=[];if(Array.isArray(e)){var U=[];for(B=0;B<((null===(u=N.options.data)||void 0===u?void 0:u.length)||0);B++)U.push(B<e.length?e[B]:"");Y={column:n+(l?0:1),options:Object.assign({},a[0]),data:U},q.push(Y)}else for(B=0;B<(e||0);B++){var Y={column:n+B+(l?0:1),options:Object.assign({},a[B])};q.push(Y)}if(!1===o.A.call(N,"onbeforeinsertcolumn",N,q))return!1;if(N.options.mergeCells&&Object.keys(N.options.mergeCells).length>0&&(null===(d=N.worksheets)||void 0===d?void 0:d[0])&&L.Lt.call(N.worksheets[0],n,l).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;null===(f=N.destroyMerge)||void 0===f||f.call(N)}var W=l?n:n+1;N.options.columns=(0,T.Hh)(N.options.columns||[],W,a);for(var z=N.headers.splice(W),X=N.cols.splice(W),G=[],K=[],$=[],Z=[],J=[],Q=W;Q<j+W;Q++)k.call(N,Q),null===(p=N.headerContainer)||void 0===p||p.insertBefore(N.headers[Q],N.headerContainer.children[Q+1]),null===(h=N.colgroupContainer)||void 0===h||h.insertBefore(N.cols[Q].colElement,N.colgroupContainer.children[Q+1]),G.push(N.headers[Q]),K.push(N.cols[Q]);if(N.options.footers)for(var ee=0;ee<N.options.footers.length;ee++){for(J[ee]=[],B=0;B<j;B++)J[ee].push("");(s=N.options.footers[ee]).splice.apply(s,D([W,0],J[ee],!1))}for(P=0;P<((null===(m=N.options.data)||void 0===m?void 0:m.length)||0);P++){var te=N.options.data&&Array.isArray(N.options.data)&&Array.isArray(N.options.data[P])?N.options.data[P].splice(W):[],ne=N.records[P].splice(W);for(Z[P]=[],$[P]=[],Q=W;Q<j+W;Q++){var oe=S[P]?S[P]:"";N.options.data&&Array.isArray(N.options.data)&&Array.isArray(N.options.data[P])&&(N.options.data[P][Q]=oe);var re=N.options.data&&Array.isArray(N.options.data)&&Array.isArray(N.options.data[P])&&null!==(g=N.options.data[P][Q])&&void 0!==g?g:"",ie=r.P9.call(N.worksheets[0],Q,P,re);N.records[P][Q]={element:ie,x:Q,y:P},N.rows[P]&&N.rows[P].element.insertBefore(ie,N.rows[P].element.children[Q+1]),N.options.columns&&N.options.columns[Q]&&"function"==typeof N.options.columns[Q].render&&(null===(y=(v=N.options.columns[Q]).render)||void 0===y||y.call(v,ie,oe,Q.toString(),P.toString(),N,N.options.columns[Q])),Z[P].push(oe),$[P].push({element:ie,x:Q,y:P})}N.options.data&&N.options.data[P]&&Array.prototype.push.apply(N.options.data[P],te),Array.prototype.push.apply(N.records[P],ne)}for(Array.prototype.push.apply(N.headers,z),Array.prototype.push.apply(N.cols,X),B=W;B<N.cols.length;B++)N.cols[B].x=B;for(ee=0;ee<N.records.length;ee++)for(B=0;B<N.records[ee].length;B++)N.records[ee][B].x=B;if(N.options.nestedHeaders&&N.options.nestedHeaders.length>0&&N.options.nestedHeaders[0]&&N.options.nestedHeaders[0][0])for(ee=0;ee<N.options.nestedHeaders.length;ee++){var le=parseInt((N.options.nestedHeaders[ee][N.options.nestedHeaders[ee].length-1].colspan||"1").toString())+j;N.options.nestedHeaders[ee][N.options.nestedHeaders[ee].length-1].colspan=le,null===(C=null===(w=null===(b=N.thead)||void 0===b?void 0:b.children[ee])||void 0===w?void 0:w.children[N.thead.children[ee].children.length-1])||void 0===C||C.setAttribute("colspan",le.toString());var ae=null===(A=null===(E=null===(x=N.thead)||void 0===x?void 0:x.children[ee])||void 0===E?void 0:E.children[N.thead.children[ee].children.length-1])||void 0===A?void 0:A.getAttribute("data-column"),se=(null==ae?void 0:ae.split(","))||[];for(Q=W;Q<j+W;Q++)se.push(Q.toString());null===(_=null===(I=null===(M=N.thead)||void 0===M?void 0:M.children[ee])||void 0===I?void 0:I.children[N.thead.children[ee].children.length-1])||void 0===_||_.setAttribute("data-column",se.join(","))}i.Dh.call(N,{action:"insertColumn",columnNumber:n,numOfColumns:j,insertBefore:l,columns:a,headers:G,cols:K,records:$,footers:J,data:Z}),N.worksheets&&N.worksheets[0]&&r.o8.call(N.worksheets[0]),o.A.call(N,"oninsertcolumn",N,q)}}],["moveColumn",function(e,n){var l,a,s,c,u,d,f,p,h,m=this;if(h=e>n,(null===(l=m.worksheets)||void 0===l?void 0:l[0])&&L.Lt.call(m.worksheets[0],e).length||(null===(a=m.worksheets)||void 0===a?void 0:a[0])&&L.Lt.call(m.worksheets[0],n,!!h).length){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;null===(s=m.destroyMerge)||void 0===s||s.call(m)}if(e>n){null===(c=m.headerContainer)||void 0===c||c.insertBefore(m.headers[e],m.headers[n]),null===(u=m.colgroupContainer)||void 0===u||u.insertBefore(m.cols[e].colElement,m.cols[n].colElement);for(var g=0;g<m.rows.length;g++)m.rows[g].element.insertBefore(m.records[g][e].element,m.records[g][n].element)}else for(null===(d=m.headerContainer)||void 0===d||d.insertBefore(m.headers[e],m.headers[n].nextSibling),null===(f=m.colgroupContainer)||void 0===f||f.insertBefore(m.cols[e].colElement,m.cols[n].colElement.nextSibling),g=0;g<m.rows.length;g++)m.rows[g].element.insertBefore(m.records[g][e].element,m.records[g][n].element.nextSibling);null===(p=m.options.columns)||void 0===p||p.splice(n,0,m.options.columns.splice(e,1)[0]),m.headers.splice(n,0,m.headers.splice(e,1)[0]),m.cols.splice(n,0,m.cols.splice(e,1)[0]);var v=Math.min(e,n),y=Math.max(e,n);for(g=0;g<m.rows.length;g++){if(m.options.data&&Array.isArray(m.options.data)&&Array.isArray(m.options.data[g])){var b=m.options.data[g].splice(e,1)[0];m.options.data[g].splice(n,0,b)}m.records[g].splice(n,0,m.records[g].splice(e,1)[0])}for(var w=v;w<=y;w++)m.cols[w].x=w;for(g=0;g<m.records.length;g++)for(w=v;w<=y;w++)m.records[g][w].x=w;if(m.options.footers)for(g=0;g<m.options.footers.length;g++)m.options.footers[g].splice(n,0,m.options.footers[g].splice(e,1)[0]);i.Dh.call(m,{action:"moveColumn",oldValue:e,newValue:n}),m.worksheets&&m.worksheets[0]&&r.o8.call(m.worksheets[0]),o.A.call(m,"onmovecolumn",m,e,n,1)}],["deleteColumn",function(e,n){var l,a,s,c,u,d,f,p,h,m,g,v,y,b,w=this;if(0!=w.options.allowDeleteColumn)if(w.headers.length>1){if(null==e){var C=(null===(l=w.getSelectedColumns)||void 0===l?void 0:l.call(w,!0))||[];C.length?(e=null!==(a=C[0])&&void 0!==a?a:0,n=C.length):(e=w.headers.length-1,n=1)}var x=w.options.data&&Array.isArray(w.options.data)&&w.options.data[0]&&Array.isArray(w.options.data[0])?w.options.data[0].length-1:0;(null==e||e>x||e<0)&&(e=x),(!n||n<1)&&(n=1),w.options.data&&Array.isArray(w.options.data)&&w.options.data[0]&&Array.isArray(w.options.data[0])&&n>w.options.data[0].length-e&&(n=w.options.data[0].length-e);for(var E=[],A=0;A<n;A++)E.push(A+e);if(!1===o.A.call(w,"onbeforedeletecolumn",w,E))return!1;if(e>-1){var I=!1;if(w.options.mergeCells&&Object.keys(w.options.mergeCells).length>0)for(var T=e;T<e+n;T++)(null===(s=w.worksheets)||void 0===s?void 0:s[0])&&L.Lt.call(w.worksheets[0],T,void 0).length&&(I=!0);if(I){if(!confirm(t().translate("This action will destroy any existing merged cells. Are you sure?")))return!1;null===(c=w.destroyMerge)||void 0===c||c.call(w)}var _=w.options.columns?w.options.columns.splice(e,n):void 0;for(T=e;T<e+n;T++)w.cols[T].colElement.className="",w.headers[T].className="",null===(u=w.cols[T].colElement.parentNode)||void 0===u||u.removeChild(w.cols[T].colElement),null===(d=w.headers[T].parentNode)||void 0===d||d.removeChild(w.headers[T]);for(var N=w.headers.splice(e,n),S=w.cols.splice(e,n),j=[],D=[],O=[],k=0;k<((null===(f=w.options.data)||void 0===f?void 0:f.length)||0);k++)for(T=e;T<e+n;T++)w.records[k][T].element.className="",null===(p=w.records[k][T].element.parentNode)||void 0===p||p.removeChild(w.records[k][T].element);for(k=0;k<((null===(h=w.options.data)||void 0===h?void 0:h.length)||0);k++)D[k]=w.options.data&&Array.isArray(w.options.data)&&Array.isArray(w.options.data[k])?w.options.data[k].splice(e,n):[],j[k]=w.records[k].splice(e,n);for(A=e;A<w.cols.length;A++)w.cols[A].x=A;for(var R=0;R<w.records.length;R++)for(A=e;A<w.records[R].length;A++)w.records[R][A].x=A;if(w.options.footers)for(k=0;k<w.options.footers.length;k++)O[k]=w.options.footers[k].splice(e,n);if(M.at.call(w.worksheets[0],0,e,e+n-1),w.options.nestedHeaders&&w.options.nestedHeaders.length>0&&w.options.nestedHeaders[0]&&w.options.nestedHeaders[0][0])for(R=0;R<w.options.nestedHeaders.length;R++){var H=parseInt(String((null===(g=null===(m=w.options.nestedHeaders[R])||void 0===m?void 0:m[w.options.nestedHeaders[R].length-1])||void 0===g?void 0:g.colspan)||"1"))-n;w.options.nestedHeaders[R][w.options.nestedHeaders[R].length-1].colspan=H,null===(b=null===(y=null===(v=w.thead)||void 0===v?void 0:v.children[R])||void 0===y?void 0:y.children[w.thead.children[R].children.length-1])||void 0===b||b.setAttribute("colspan",String(H))}i.Dh.call(w,{action:"deleteColumn",columnNumber:e,numOfColumns:n,insertBefore:!1,columns:_,headers:N,cols:S,records:j,footers:O,data:D}),w.worksheets&&w.worksheets[0]&&r.o8.call(w.worksheets[0]),o.A.call(w,"ondeletecolumn",w,E)}}else console.error("Jspreadsheet: It is not possible to delete the last column")}],["getColumnData",function(e,t){for(var n,o=this,r=[],i=0;i<((null===(n=o.options.data)||void 0===n?void 0:n.length)||0);i++)if(t)r.push(o.records[i][e].element.innerHTML);else{var l=o.options.data&&Array.isArray(o.options.data)&&Array.isArray(o.options.data[i])?o.options.data[i][e]:void 0;r.push(l)}return r.filter(function(e){return void 0!==e})}],["setColumnData",function(e,t,n){for(var o,r=this,i=0;i<r.rows.length;i++){var l=(0,T.t3)([e,i]);null!=t[i]&&(null===(o=r.setValue)||void 0===o||o.call(r,l,t[i],n))}}],["whichPage",he.ho],["page",he.MY],["download",function(e,t){var n=this;if(0==n.parent.config.allowExport)console.error("Export not allowed");else{var o="";o+=_.call(n,!1,n.options.csvDelimiter,!0,e,!0,void 0,t);var r=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"}),i=window.navigator;if(i&&i.msSaveOrOpenBlob)i.msSaveOrOpenBlob(r,(n.options.csvFileName||n.options.worksheetName)+".csv");else{var l=document.createElement("a");l.setAttribute("target","_top");var a=URL.createObjectURL(r);l.href=a,l.setAttribute("download",(n.options.csvFileName||n.options.worksheetName)+".csv"),document.body.appendChild(l),l.click(),l.parentNode&&l.parentNode.removeChild(l)}}}],["getComments",ve],["setComments",function(e,t){var n,r,l=this;"string"==typeof e?((n={})[e]=t,r=n):r=e;var a={};Object.entries(r).forEach(function(e){var t,n,o,r,i=e[0],s=e[1],c=(0,I.getCoordsFromCellName)(i);if(c[0]&&c[1])if(a[i]=l.records[c[1]][c[0]].element.getAttribute("title"),l.records[c[1]][c[0]].element.setAttribute("title",s||""),s)null===(n=null===(t=l.records[c[1]])||void 0===t?void 0:t[c[0]])||void 0===n||n.element.classList.add("jss_comments"),l.options.comments||(l.options.comments={}),l.options.comments[i]=s;else{null===(r=null===(o=l.records[c[1]])||void 0===o?void 0:o[c[0]])||void 0===r||r.element.classList.remove("jss_comments");var u=l.options.comments;u&&u[i]&&delete u[i]}}),i.Dh.call(l,{action:"setComments",newValue:r,oldValue:a}),o.A.call(l,"oncomments",l,r,a)}],["orderBy",ye.My],["undo",i.tN],["redo",i.ZS],["getCell",r.tT],["getCellFromCoords",r.Xr],["getLabel",r.p9],["getConfig",function(){return this.options}],["setConfig",we],["getMeta",function(e){return Ce.IQ.call(this,e,void 0)}],["setMeta",Ce.iZ],["showColumn",function(e){var t,n,o=this;Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var i=e[r];o.headers[i].style.display="",o.cols[i].colElement.style.display="",o.filter&&o.filter.children.length>i+1&&(o.filter.children[i+1].style.display="");for(var l=0;l<((null===(t=o.options.data)||void 0===t?void 0:t.length)||0);l++)o.records[l][i].element.style.display=""}o.options.footers&&j.e.call(o),null===(n=o.resetSelection)||void 0===n||n.call(o)}],["hideColumn",function(e){var t,n,o=this;Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++){var i=e[r];o.headers[i].style.display="none",o.cols[i].colElement.style.display="none",o.filter&&o.filter.children.length>i+1&&(o.filter.children[i+1].style.display="none");for(var l=0;l<((null===(t=o.options.data)||void 0===t?void 0:t.length)||0);l++)o.records[l][i].element.style.display="none"}o.options.footers&&j.e.call(o),null===(n=o.resetSelection)||void 0===n||n.call(o)}],["showIndex",r.C6],["hideIndex",r.TI],["getWorksheetActive",r.$O],["openEditor",a],["closeEditor",s],["createWorksheet",function(e){var t=this.parent;t.creationThroughJss=!0,Me.call(this,e),t.element.tabs.create(e.worksheetName)}],["openWorksheet",function(e){this.parent.element.tabs.open(e)}],["deleteWorksheet",function(e){var t=this;t.parent.element.tabs.remove(e);var n=t.parent.worksheets.splice(e,1)[0];o.A.call(t.parent,"ondeleteworksheet",n,e)}],["copy",function(e){e?re.call(this,void 0):_.call(this,!0)}],["paste",N],["executeFormula",r.Em],["getDataFromRange",function(e,t){for(var n,o,r,i,l,a,s=this,c=(0,I.getCoordsFromRange)(e),u=[],d=c[1];d<=c[3];d++){u.push([]);for(var f=c[0];f<=c[2];f++)if(t)u[u.length-1].push(s.records[d][f].element.innerHTML);else{var p=(null!==(n=s.options.data)&&void 0!==n?n:[])[d];if(void 0!==p)if(Array.isArray(p))u[u.length-1].push(null!==(o=p[f])&&void 0!==o?o:"");else{var h=null!==(l=null===(i=(null!==(r=s.options.columns)&&void 0!==r?r:[])[f])||void 0===i?void 0:i.name)&&void 0!==l?l:String(f);u[u.length-1].push(null!==(a=p[h])&&void 0!==a?a:"")}else u[u.length-1].push("")}}return u}],["quantityOfPages",he.lz],["getRange",M.eO],["isSelected",M.sp],["setReadOnly",function(e,t){var n,o=this;if("string"==typeof e){var r=(0,I.getCoordsFromCellName)(e);if(null===r[0]||null===r[1])return;var i=r[0],l=r[1],a=o.records[l];if(!a||!a[i])return;n=a[i]}else{var s=e.getAttribute("data-x"),c=e.getAttribute("data-y");if(null===s||null===c)return;if(i=parseInt(s),l=parseInt(c),!o.records[l]||!o.records[l][i])return;n=o.records[l][i]}n&&(t?n.element.classList.add("readonly"):n.element.classList.remove("readonly"))}],["isReadOnly",function(e,t){var n;if("string"==typeof e&&void 0===t){var o=(0,I.getCoordsFromCellName)(e);if(null===o[0]||null===o[1])return!1;e=(n=o)[0],t=n[1]}if(void 0!==t){var r=this.records[t];if(r&&r[e])return r[e].element.classList.contains("readonly")}return!1}],["getHighlighted",M.kV],["dispatch",o.A],["down",b],["first",E],["last",A],["left",x],["right",g],["up",p],["openFilter",S.N$],["resetFilters",S.dr]],Te=Ie.length,_e=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(l,a)}s((o=o.apply(e,t||[])).next())})},Ne=function(e,t){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Se=function(){},je=function(e,n,r){return _e(this,void 0,void 0,function(){var i,l,a,s,c,u,d,f;return Ne(this,function(p){switch(p.label){case 0:if(!(i=n.worksheets))return[3,5];for(l={animation:!0,onbeforecreate:function(t,n){return n||Ae(e)},oncreate:function(t,r){if(e.creationThroughJss)e.creationThroughJss=!1;else{var i=t.tabs.headers.children[t.tabs.headers.children.length-2].innerHTML;Me.call(e.worksheets[0],{minDimensions:[10,15],worksheetName:i})}var l=e.worksheets[e.worksheets.length-1];l.element=r,Le.call(l).then(function(){pe.nK.call(e,l),o.A.call(l,"oncreateworksheet",l,n,e.worksheets.length-1)})},onchange:function(t,n,o){0!=e.worksheets.length&&e.worksheets[o]&&pe.nK.call(e,e.worksheets[o])}},1==n.tabs?l.allowCreate=!0:l.hideHeaders=!0,l.data=[],a=1,d=0;d<i.length;d++)i[d].worksheetName||(i[d].worksheetName="Sheet"+a++),l.data.push({title:i[d].worksheetName||"Sheet"+a++,content:""});r.classList.add("jss_spreadsheet"),r.tabIndex=0,s=t().tabs(r,l),c=null!==(f=n.style)&&void 0!==f?f:{},delete n.style,u=function(t){var n;return Ne(this,function(o){switch(o.label){case 0:return i[t].style&&"object"==typeof i[t].style&&!Array.isArray(i[t].style)&&(n=i[t].style,Object.entries(n).forEach(function(e){var t=e[0],o=e[1];"number"==typeof o&&c[o]&&(n[t]=c[o])})),e.worksheets.push({parent:e,element:s.content.children[t],options:i[t],filters:[],formula:{},history:[],selection:[],historyIndex:-1}),[4,Le.call(e.worksheets[t])];case 1:return o.sent(),[2]}})},d=0,p.label=1;case 1:return d<i.length?[5,u(d)]:[3,4];case 2:p.sent(),p.label=3;case 3:return d++,[3,1];case 4:return[3,6];case 5:throw new Error("JSS: worksheets are not defined");case 6:return[2]}})})};Se.spreadsheet=function(e,o,i){return _e(this,void 0,void 0,function(){var l,a,s;return Ne(this,function(c){switch(c.label){case 0:return"TABLE"==e.tagName&&(o||(o={}),o.worksheets||(o.worksheets=[]),l=(0,I.createFromTable)(e,o.worksheets[0]),o.worksheets[0]=l,a=document.createElement("div"),e.parentNode&&(e.parentNode.insertBefore(a,e),e.remove(),e=a)),(s={worksheets:i,config:o,element:e,el:e,options:o,headers:[],rows:[],cols:[],tbody:document.createElement("tbody"),table:document.createElement("table"),parent:{},records:[]}).contextMenu=document.createElement("div"),s.contextMenu.className="jss_contextmenu",s.getWorksheetActive=r.$O.bind(s),s.fullscreen=r.Y5.bind(s),s.showToolbar=pe.ll.bind(s),s.hideToolbar=pe.Ar.bind(s),s.getConfig=be.bind(s),s.setConfig=we.bind(s),s.setPlugins=function(e){s.plugins||(s.plugins={}),"object"==typeof e&&e&&Object.entries(e).forEach(function(e){var t=e[0],o=e[1];s.plugins[t]=o.call(s,n.jspreadsheet,{},s.config)})},s.setPlugins(o.plugins),[4,je.call(s,s,o,e)];case 1:return c.sent(),s.element.appendChild(s.contextMenu),t().contextmenu(s.contextMenu,{onclick:function(){s.contextMenu.contextmenu.close(!1)}}),1==s.config.fullscreen&&s.element.classList.add("fullscreen"),pe.ll.call(s.worksheets[0]||s),o.root&&o.root instanceof HTMLElement?de(o.root):de(document.body),e.spreadsheet=s,[2,s]}})})},Se.worksheet=function(e,t,n){var o={parent:e,options:{},headers:[],rows:[],cols:[],element:document.createElement("div"),config:e.config,worksheets:[],tbody:document.createElement("tbody"),table:document.createElement("table"),records:[]};return void 0===n?e.worksheets.push(o):e.worksheets.splice(n,0,o),Object.assign(o.options,t),o};var De=Se;n.jspreadsheet=function(e,t){try{var r=[];return De.spreadsheet(e,t,r).then(function(e){n.jspreadsheet.spreadsheet.push(e),o.A.call(e,"onload")}),r}catch(e){return console.error(e),[]}},n.jspreadsheet.getWorksheetInstanceByName=function(e,t){var o=n.jspreadsheet.spreadsheet.find(function(e){return e.config.namespace===t});if(!o)return null;if(null==e){var r=o.worksheets.map(function(e){return[e.options.worksheetName,e]});return Object.fromEntries(r)}return o.worksheets.find(function(t){return t.options.worksheetName===e})||null},n.jspreadsheet.setDictionary=function(e){t().setDictionary(e)},n.jspreadsheet.destroy=function(e,t){if(e.spreadsheet){var o=n.jspreadsheet.spreadsheet.indexOf(e.spreadsheet);o>=0&&n.jspreadsheet.spreadsheet.splice(o,1);var r=e.spreadsheet.config.root||document.body;e.spreadsheet=void 0,e.innerHTML="",t&&fe(r)}},n.jspreadsheet.destroyAll=function(){for(var e=0;e<n.jspreadsheet.spreadsheet.length;e++){var t=n.jspreadsheet.spreadsheet[e];n.jspreadsheet.destroy(t.element)}},n.jspreadsheet.current=null,n.jspreadsheet.spreadsheet=[],n.jspreadsheet.helpers={},n.jspreadsheet.version=function(){return B.version},Object.entries(I).forEach(function(e){var t=e[0],o=e[1];n.jspreadsheet.helpers[t]=o});var Oe=n.jspreadsheet}(),jspreadsheet=__webpack_exports__.default})();

    return jspreadsheet;
})));